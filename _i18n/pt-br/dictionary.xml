<?xml version="1.0" encoding="UTF-8"?>
<blocks>
  <block id="fb012f1e7970d8285bd5d6c5a7f7d523" category="doc">Agregados SSD, incluindo sistemas AFF</block>
  <block id="cb8e4651c457f71d5788f38eac01471f" category="paragraph">O espaço livre é definido como qualquer espaço que não é usado para dados reais e inclui espaço não alocado no próprio agregado e espaço não utilizado dentro dos volumes constituintes. O thin Provisioning também deve ser considerado. Por exemplo, um volume pode conter um LUN de 1TB, dos quais apenas 50% são utilizados por dados reais. Em um ambiente thin Provisioning, isso parece estar consumindo 500GBMB de espaço corretamente. No entanto, em um ambiente totalmente provisionado, a capacidade total de 1TB TB parece estar em uso. O 500GB de espaço não alocado está oculto. Este espaço não é utilizado pelos dados reais e, portanto, deve ser incluído no cálculo do espaço livre total.</block>
  <block id="d3487661d9a0702bd5915d49070f62dc" category="paragraph">As recomendações da NetApp para sistemas de storage usados para aplicações empresariais são as seguintes:</block>
  <block id="678e476783bceae80094bcb4c1f32969" category="admonition">*A NetApp recomenda* um mínimo de 10% de espaço livre. Isso inclui todo o espaço não utilizado, incluindo espaço livre dentro do agregado ou de um volume e qualquer espaço livre alocado devido ao uso de provisionamento completo, mas não é usado por dados reais. O espaço lógico não é importante, a questão é quanto espaço físico livre real está disponível para armazenamento de dados.</block>
  <block id="2171d172d184f1202a686849c85dce91" category="paragraph">A recomendação de 10% de espaço livre é muito conservadora. Agregados SSD podem dar suporte a workloads em níveis ainda mais altos de utilização sem afetar a performance. No entanto, à medida que a utilização do agregado aumenta, o risco de ficar sem espaço também aumenta se a utilização não for monitorada com cuidado. Além disso, ao executar um sistema com 99% de capacidade pode não incorrer em uma penalidade de desempenho, mas provavelmente incorreria em esforço de gerenciamento tentando impedi-lo de preencher completamente enquanto hardware adicional é solicitado, e pode levar algum tempo para adquirir e instalar unidades adicionais.</block>
  <block id="789243e17acb0b134f435d6c4c1350f2" category="section-title">Agregados de HDD, incluindo agregados Flash Pool</block>
  <block id="b7ce758ec5c25cb23edfa4ead0d0097e" category="admonition">*A NetApp recomenda* um mínimo de 15% de espaço livre quando as unidades giratórias são usadas. Isso inclui todo o espaço não utilizado, incluindo espaço livre dentro do agregado ou de um volume e qualquer espaço livre alocado devido ao uso de provisionamento completo, mas não é usado por dados reais. O desempenho será impactado à medida que o espaço livre se aproxima de 10%.</block>
  <block id="14c3c56ff2a98d1a9c47b63a917f67a3" category="doc">Compactação de dados</block>
  <block id="1afe2c0821b67085f9ea2d2deeb2e92a" category="paragraph">A compactação de dados é uma tecnologia que melhora a eficiência da compressão. Como dito anteriormente, a compactação adaptável por si só pode proporcionar, na melhor das hipóteses, economias de 2:1x porque está limitada a armazenar uma e/S de 8KBx em um bloco de 4KB WAFL. Os métodos de compressão com tamanhos de bloco maiores proporcionam melhor eficiência. No entanto, eles não são adequados para dados sujeitos a pequenas substituições de blocos. A descompressão de 32KB unidades de dados, a atualização de uma porção 8KB, a recompressão e a gravação de volta nas unidades cria sobrecarga.</block>
  <block id="0b01f66d49b9df153ee76048de44f6eb" category="paragraph">A compactação de dados funciona permitindo que vários blocos lógicos sejam armazenados em blocos físicos. Por exemplo, um banco de dados com dados altamente compressíveis, como texto ou blocos parcialmente completos, pode compactar de 8KB a 1KB. Sem compactação, 1KB PB de dados ainda ocupariam um bloco inteiro de 4KB TB. A compactação de dados in-line permite que 1KB TB de dados compatados sejam armazenados em apenas 1KB TB de espaço físico, juntamente com outros dados compatados. Não é uma tecnologia de compressão; é simplesmente uma maneira mais eficiente de alocar espaço nas unidades e, portanto, não deve criar qualquer efeito de desempenho detetável.</block>
  <block id="82116b39cd4d0d1920fab1ab4515603b" category="paragraph">O grau de poupança obtido varia. Os dados que já estão compatados ou criptografados geralmente não podem ser mais compatados e, portanto, esses conjuntos de dados não se beneficiam com a compactação. Em contraste, datafiles recém-inicializados que contêm pouco mais do que metadados de bloco e zeros compactam até 80:1.</block>
  <block id="82af841589057aa8922b1ac3bb4a28a4" category="doc">Compactação</block>
  <block id="786d7cc1b18aa3d9c3e8d3e30865240e" category="paragraph">Antes da disponibilidade de sistemas de storage all-flash, a compactação baseada em array era de valor limitado porque a maioria dos workloads com uso intenso de e/S exigia um número muito grande de fusos para fornecer desempenho aceitável. Os sistemas de armazenamento invariavelmente continham muito mais capacidade do que o necessário como um efeito colateral do grande número de unidades. A situação mudou com o aumento do armazenamento de estado sólido. Não há mais a necessidade de superprovisionamento vastamente de unidades puramente para obter um bom desempenho. O espaço da unidade em um sistema de armazenamento pode ser correspondente às necessidades reais de capacidade.</block>
  <block id="b207c460d31fea9e1cfab71057e8152c" category="paragraph">A maior funcionalidade de IOPS das solid-State drives (SSDs) quase sempre produz economias de custo em comparação com as unidades giratórias, mas a compactação pode gerar mais economias ao aumentar a capacidade efetiva da Mídia de estado sólido.</block>
  <block id="8bc1cc1880ea3a623cb9b80b8cbb7b72" category="paragraph">Existem várias maneiras de compactar dados. Muitos bancos de dados incluem suas próprias capacidades de compressão, mas isso raramente é observado em ambientes de clientes. A razão é geralmente a penalidade de desempenho para uma *mudança* para dados compatados, além disso, com alguns aplicativos, há altos custos de licenciamento para compactação no nível do banco de dados. Finalmente, há as consequências gerais de desempenho para as operações do banco de dados. Faz pouco sentido pagar um alto custo de licença por CPU para uma CPU que executa compactação de dados e descompressão em vez de trabalho real de banco de dados. Uma opção melhor é descarregar o trabalho de compressão para o sistema de storage.</block>
  <block id="6296c8b7406b90d37edf269f1ea6f6ee" category="section-title">Compressão adaptável</block>
  <block id="1245fef302b5da2c27766d9a98ad358c" category="paragraph">A compactação adaptável foi totalmente testada com workloads empresariais sem efeito observado no desempenho, mesmo em um ambiente all-flash em que a latência é medida em microssegundos. Alguns clientes até relataram um aumento de desempenho com o uso de compactação porque os dados permanecem compatados no cache, aumentando efetivamente a quantidade de cache disponível em um controlador.</block>
  <block id="93e0a644c8f1b7f7f378bc071d15d1e9" category="paragraph">O ONTAP gerencia blocos físicos em 4KB unidades. A compactação adaptável usa um tamanho de bloco de compressão padrão de 8KB, o que significa que os dados são compatados em unidades 8KB. Isso corresponde ao tamanho do bloco 8KB mais frequentemente usado por bancos de dados relacionais. Os algoritmos de compressão tornam-se mais eficientes à medida que mais dados são compatados como uma única unidade. Um tamanho de bloco de compressão 32KB seria mais eficiente em termos de espaço do que uma unidade de bloco de compressão 8KB. Isso significa que a compactação adaptável usando o tamanho padrão de bloco 8KB leva a taxas de eficiência ligeiramente menores, mas também há um benefício significativo para o uso de um tamanho menor de bloco de compressão. As cargas de trabalho de banco de dados incluem uma grande quantidade de atividade de substituição. Substituir um 8KB de um bloco de dados comprimido 32KB requer a leitura de todo o 32KB de dados lógicos, descomprimindo-o, atualizando a região 8KB necessária, recomprimindo e gravando o 32KB inteiro de volta às unidades. Esta é uma operação muito cara para um sistema de storage e é o motivo pelo qual alguns storage arrays concorrentes baseados em tamanhos de bloco de compressão maiores também incorrer em uma penalidade de desempenho significativa nos workloads de banco de dados.</block>
  <block id="3e98696b9bb83904c14603458a8c3728" category="admonition">O tamanho do bloco usado pela compressão adaptável pode ser aumentado até 32KBMB. Isso pode melhorar a eficiência do storage e deve ser considerado para arquivos inativos, como logs de transações e arquivos de backup, quando uma quantidade substancial de tais dados é armazenada no array. Em algumas situações, os bancos de dados ativos que usam um tamanho de bloco 16KB ou 32KB também podem se beneficiar do aumento do tamanho de bloco da compactação adaptável a corresponder. Consulte um representante da NetApp ou do parceiro para obter orientação sobre se isso é apropriado para sua carga de trabalho.</block>
  <block id="0e6f69b7cb8364ed908c411686154808" category="admonition">Tamanhos de blocos de compactação maiores que 8KBMB não devem ser usados juntamente com a deduplicação em destinos de backup de streaming. A razão é que pequenas alterações nos dados de backup afetam a janela de compressão 32KB. Se a janela mudar, os dados compatados resultantes diferem em todo o arquivo. A deduplicação ocorre após a compactação, o que significa que o mecanismo de deduplicação vê cada backup compactado de forma diferente. Se a deduplicação de backups de streaming for necessária, somente a compactação adaptável de bloco 8KB deve ser usada. A compactação adaptável é preferível, porque funciona em um tamanho de bloco menor e não prejudica a eficiência da deduplicação. Por razões semelhantes, a compactação no lado do host também interfere na eficiência da deduplicação.</block>
  <block id="02e44d620def629a6c145ccd0d9a0fd3" category="section-title">Alinhamento da compressão</block>
  <block id="3b6e6c232a02ab9c64199eb9efae012c" category="paragraph">A compactação adaptável em um ambiente de banco de dados requer alguma consideração do alinhamento do bloco de compressão. Fazer isso é apenas uma preocupação para os dados que estão sujeitos a substituições aleatórias de blocos muito específicos. Essa abordagem é semelhante em conceito ao alinhamento geral do sistema de arquivos, onde o início de um sistema de arquivos deve ser alinhado a um limite de dispositivo 4K e o tamanho de bloco de um sistema de arquivos deve ser um múltiplo de 4K.</block>
  <block id="e8a7060409e1a82af9dacfe72458ffac" category="paragraph">Por exemplo, uma gravação 8KBD em um arquivo é compactada somente se ele se alinhar com um limite 8KBD dentro do próprio sistema de arquivos. Este ponto significa que ele deve cair no primeiro 8KB do arquivo, o segundo 8KB do arquivo, e assim por diante. A maneira mais simples de garantir o alinhamento correto é usar o tipo de LUN correto, qualquer partição criada deve ter um deslocamento desde o início do dispositivo que é um múltiplo de 8K, e usar um tamanho de bloco de sistema de arquivos que é um múltiplo do tamanho do bloco de banco de dados.</block>
  <block id="96738983d52a374cb4a8c958e924836e" category="paragraph">Dados como backups ou logs de transações são operações sequencialmente escritas que abrangem vários blocos, todos eles compatados. Portanto, não há necessidade de considerar o alinhamento. O único padrão de e/S de preocupação é as substituições aleatórias de arquivos.</block>
  <block id="d41d8cd98f00b204e9800998ecf8427e" category="doc"></block>
  <block id="0c99cedb6f39d8ac16d5b4c01c162c23" category="paragraph">O log de refazer/transações do banco de dados normalmente gera e/S desalinhadas que podem causar avisos enganosos sobre LUNs desalinhados no ONTAP.</block>
  <block id="b2f7bb8e75b21ee3e883141c6ac1defe" category="paragraph">O log executa uma gravação sequencial do arquivo de log com gravações de tamanho variável. Uma operação de gravação de log que não esteja alinhada aos limites do 4KB normalmente não causa problemas de desempenho porque a próxima operação de gravação de log completa o bloco. O resultado é que o ONTAP é capaz de processar quase todas as gravações como blocos 4KB completos, mesmo que os dados em cerca de 4KB blocos tenham sido gravados em duas operações separadas.</block>
  <block id="0e635e1f8ffad809203304cf41ed45c4" category="inline-link-macro">Verificação do alinhamento do WAFL</block>
  <block id="bf837d24f10c904e697e3c0092da43b9" category="paragraph">Verifique o alinhamento usando utilitários como<block ref="40883add63f1fbabc7fe6158f93c1246" prefix=" " category="inline-code"></block> ou<block ref="1aabac6d068eef6a7bad3fdf50a05cc8" prefix=" " category="inline-code"></block> que podem gerar e/S em um tamanho de bloco definido. As estatísticas de alinhamento de e/S no sistema de storage podem ser visualizadas com o<block ref="446501053769c06c565094b26d26e8ef" prefix=" " category="inline-code"></block> comando. Consulte <block ref="ebccec7997af507c87f985ec4ccec634" category="inline-link-macro-rx"></block> para obter mais informações.</block>
  <block id="83f45cad5e6f535ff10e564a526baad0" category="doc">Deduplicação</block>
  <block id="f591ef30da06841378ee7f595e63a93c" category="paragraph">A deduplicação é a remoção de tamanhos de bloco duplicados de um conjunto de dados. Por exemplo, se o mesmo bloco 4KB existisse em 10 arquivos diferentes, a deduplicação redirecionaria esse bloco 4KB dentro de todos os arquivos 10 para o mesmo bloco físico 4KB. O resultado seria uma melhoria de 10:1 na eficiência para esses dados.</block>
  <block id="699c85c5df1985b2af588f9e6c1ad353" category="paragraph">Dados como LUNs de inicialização convidado da VMware geralmente deduplicam muito bem porque consistem em várias cópias dos mesmos arquivos do sistema operacional. A eficiência de 100:1 e maior foi observada.</block>
  <block id="50812cc1b8d48579d382b689e4393be6" category="paragraph">Alguns dados não contêm dados duplicados. Por exemplo, um bloco Oracle contém um cabeçalho que é globalmente exclusivo para o banco de dados e um trailer que é quase único. Como resultado, a deduplicação de um banco de dados Oracle raramente oferece mais de 1% de economia. A deduplicação com bancos de dados MS SQL é um pouco melhor, mas metadados exclusivos no nível de bloco ainda são uma limitação.</block>
  <block id="9653a3d4907877aae00bb7d39eeec66d" category="paragraph">Economia de espaço de até 15% em bancos de dados com 16KB e grandes blocos foram observadas em alguns casos. O 4KB inicial de cada bloco contém o cabeçalho globalmente exclusivo, e o último bloco de 4KB contém o trailer quase único. Os blocos internos são candidatos à deduplicação, embora na prática isso seja quase inteiramente atribuído à deduplicação de dados zerados.</block>
  <block id="2608473fa5767385d01f256eccbc1cc4" category="paragraph">Muitos arrays concorrentes afirmam a capacidade de deduplicar bancos de dados com base na presunção de que um banco de dados é copiado várias vezes. A esse respeito, a deduplicação NetApp também pode ser usada, mas o ONTAP oferece uma opção melhor: A tecnologia NetApp FlexClone. O resultado final é o mesmo; várias cópias de um banco de dados que compartilham a maioria dos blocos físicos subjacentes são criadas. Usar o FlexClone é muito mais eficiente do que ter tempo para copiar arquivos de banco de dados e, em seguida, deduplicá-los. É, na verdade, não duplicação em vez de deduplicação, porque uma duplicata nunca é criada em primeiro lugar.</block>
  <block id="c031febc35017c70bf3b526723756b2a" category="doc">ISCSI e NVMe/TCP</block>
  <block id="4da35d461815e71b97bda03476e89b7b" category="paragraph">Um host usando iSCSI ou NVMe/TCP pode ser conetado diretamente a um sistema de storage e operar normalmente. A razão é pathing. Conexões diretas a dois controladores de storage diferentes resultam em dois caminhos independentes para o fluxo de dados. A perda de caminho, porta ou controlador não impede que o outro caminho seja usado.</block>
  <block id="1d1a594959ec615f56516f5d0f5e8ddb" category="section-title">NFS</block>
  <block id="40715d81cea527f13cdf470773fc3a65" category="paragraph">O armazenamento NFS com conexão direta pode ser usado, mas com uma limitação significativa - o failover não funcionará sem um esforço significativo de script, o que seria da responsabilidade do cliente.</block>
  <block id="d0b13bfd23c05f64222869de30f81000" category="paragraph">O motivo pelo qual o failover sem interrupções é complicado com o storage NFS com conexão direta é o roteamento que ocorre no sistema operacional local. Por exemplo, suponha que um host tenha um endereço IP de 192.168.1.1/24 e esteja conetado diretamente a um controlador ONTAP com um endereço IP de 192.168.1.50/24. Durante o failover, esse endereço 192.168.1.50 pode fazer failover para a outra controladora e estará disponível para o host, mas como o host deteta sua presença? O endereço 192.168.1.1 original ainda existe na NIC host que não se coneta mais a um sistema operacional. O tráfego destinado a 192.168.1.50 continuaria a ser enviado para uma porta de rede inoperável.</block>
  <block id="288a0a5ebbc70fb3b968ec58d36d71ab" category="paragraph">A segunda NIC do SO poderia ser configurada como 19 2.168.1.2 e seria capaz de se comunicar com o endereço 192.168.1.50 com falha, mas as tabelas de roteamento local teriam um padrão de usar um endereço *e apenas um* para se comunicar com a sub-rede 192.168.1.0/24. Um sysadmin poderia criar uma estrutura de script que detetaria uma conexão de rede com falha e alteraria as tabelas de roteamento local ou colocaria interfaces para cima e para baixo. O procedimento exato dependeria do SO em uso.</block>
  <block id="d6ce8522932df7ae76aa0b963ad9ef7d" category="paragraph">Na prática, os clientes da NetApp têm NFS com conexão direta, mas normalmente apenas para workloads em que as pausas de e/S durante failovers são aceitáveis. Quando os suportes rígidos são usados, não deve haver nenhum erro de e/S durante essas pausas. O IO deve travar até que os serviços sejam restaurados, seja por um failback ou intervenção manual para mover endereços IP entre NICs no host.</block>
  <block id="8f076395fe8f8f46c03efb655db313e6" category="section-title">Conexão direta FC</block>
  <block id="b7981516813a09695906aa429b07f48f" category="paragraph">Não é possível conectar diretamente um host a um sistema de storage ONTAP usando o protocolo FC. A razão é o uso de NPIV. A WWN que identifica uma porta ONTAP FC para a rede FC usa um tipo de virtualização chamado NPIV. Qualquer dispositivo conetado a um sistema ONTAP deve ser capaz de reconhecer um NPIV WWN. Não há fornecedores atuais de HBA que ofereçam um HBA que possa ser instalado em um host que possa suportar um destino NPIV.</block>
  <block id="32aeb47267cb2045610b468115f3ae0e" category="doc">Eficiência e thin Provisioning</block>
  <block id="3381946611f34fb44ad8a38a0c44e0a8" category="paragraph">Os recursos de eficiência são formas de thin Provisioning. Por exemplo, um LUN de 100GB GB ocupando um volume de 100GB TB pode ser compactado para 50GB TB. Ainda não há economias reais realizadas porque o volume ainda é 100GB. O volume deve primeiro ser reduzido em tamanho para que o espaço guardado possa ser utilizado noutro local do sistema. Se as alterações posteriores ao LUN 100GBD resultarem em menos compressíveis os dados, o LUN crescerá em tamanho e o volume poderá ser preenchido.</block>
  <block id="7e96c1b651af3f28c27b78807f0310e2" category="paragraph">O thin Provisioning é altamente recomendado porque pode simplificar o gerenciamento e fornecer melhorias substanciais na capacidade utilizável com economias de custo associadas. O motivo é simples: Os ambientes de banco de dados geralmente incluem muito espaço vazio, um grande número de volumes e LUNs e dados compressíveis. O provisionamento thick resulta na reserva de espaço no storage para volumes e LUNs, caso eles se tornem 100% cheios e contenham dados 100% não compactáveis. É pouco provável que isso ocorra. O thin Provisioning permite que esse espaço seja recuperado e usado em outros lugares e permite que o gerenciamento de capacidade seja baseado no próprio sistema de storage, em vez de muitos volumes e LUNs menores.</block>
  <block id="38ef8b6f2fc332958c293d93c61d7756" category="paragraph">Alguns clientes preferem usar o provisionamento thick, seja para cargas de trabalho específicas ou, geralmente, com base em práticas operacionais e de aquisição estabelecidas.</block>
  <block id="0e7c78164adb6d4650ea685a79d8e99e" category="doc">Práticas recomendadas de eficiência</block>
  <block id="ec499ad25fa5a765ba43ec2c87819623" category="section-title">Padrões do AFF</block>
  <block id="f67b854e2d644480b0ec40d7de2b773d" category="paragraph">Os volumes criados no ONTAP executados em um sistema all-flash AFF são thin Provisioning com todos os recursos de eficiência in-line habilitados. Embora os bancos de dados geralmente não se beneficiem da deduplicação e possam incluir dados não compressíveis, as configurações padrão são, no entanto, apropriadas para quase todas as cargas de trabalho. O ONTAP foi projetado para processar com eficiência todos os tipos de dados e padrões de e/S, resultando ou não em economia. Os padrões só devem ser alterados se os motivos forem totalmente compreendidos e houver um benefício para se desviar.</block>
  <block id="9f7127e69d50bf7b844ff3723b86fbd1" category="section-title">Recomendações gerais</block>
  <block id="4922fe547c351d6a121465da036d478e" category="list-text">Se os dados não estiverem sujeitos a sobrescritas, como backups ou logs de transação de banco de dados, você poderá obter maior eficiência ativando o TSSE com um período de resfriamento baixo.</block>
  <block id="e75fd383e4106eb78482b18896975daf" category="list-text">Alguns arquivos podem conter uma quantidade significativa de dados não compressíveis, por exemplo, quando a compactação já está ativada no nível de aplicativo de arquivos são criptografados. Se qualquer um desses cenários for verdadeiro, considere desativar a compactação para permitir uma operação mais eficiente em outros volumes que contenham dados compressíveis.</block>
  <block id="649141c6b8267ea3df10949a853d22cb" category="list-text">Não use a compactação e a deduplicação do 32KB com backups de bancos de dados. Consulte a secção <block ref="57ee2712afc5e59236f86db0537b05dc" category="inline-xref-macro-rx"></block> para obter detalhes.</block>
  <block id="e242ff0701d9ed7d8317b32fd762a100" category="paragraph">Os recursos de eficiência de espaço, como compressão, compactação e deduplicação, foram projetados para aumentar a quantidade de dados lógicos compatíveis com uma determinada quantidade de storage físico. O resultado são custos mais baixos e sobrecarga de gerenciamento.</block>
  <block id="13b992c3d358d786db03341886472c4f" category="paragraph">Em um alto nível, a compressão é um processo matemático pelo qual padrões nos dados são detetados e codificados de uma forma que reduz os requisitos de espaço. Em contraste, a deduplicação deteta blocos repetidos reais de dados e remove as cópias externas. A compactação permite que vários blocos lógicos de dados compartilhem o mesmo bloco físico na Mídia.</block>
  <block id="710cf627a103721a0452cb72494ea742" category="admonition">Veja as seções abaixo sobre provisionamento de thin para uma explicação da interação entre eficiência de armazenamento e reserva fracionária.</block>
  <block id="de932976b195d4755fcbea64295fc7cb" category="doc">Configurações do sistema operacional do host</block>
  <block id="f62cb371f65c322cd9e17a5c2cecd1c8" category="paragraph">A maioria da documentação do fornecedor de aplicativos inclui configurações específicas de TCP e ethernet destinadas a garantir que o aplicativo esteja funcionando de forma ideal. Essas mesmas configurações geralmente são suficientes para oferecer também um desempenho ideal de storage baseado em IP.</block>
  <block id="ae7a0bb210cbd1edb935128116a21c55" category="section-title">Controle de fluxo Ethernet</block>
  <block id="a3c15fb208efc85bdfe72c57d56c92b8" category="paragraph">Esta tecnologia permite que um cliente solicite que um remetente pare temporariamente a transmissão de dados. Isso geralmente é feito porque o recetor não consegue processar os dados de entrada com rapidez suficiente. Ao mesmo tempo, solicitar que um remetente cessasse a transmissão era menos disruptivo do que ter um recetor descartar pacotes porque os buffers estavam cheios. Este não é mais o caso com as pilhas TCP usadas nos sistemas operacionais atuais. Na verdade, o controle de fluxo causa mais problemas do que resolve.</block>
  <block id="950d31923e253d170d6c994801ce7cec" category="paragraph">Os problemas de desempenho causados pelo controle de fluxo Ethernet têm aumentado nos últimos anos. Isso ocorre porque o controle de fluxo Ethernet opera na camada física. Se uma configuração de rede permitir que qualquer sistema operacional host envie uma solicitação de controle de fluxo Ethernet para um sistema de armazenamento, o resultado será uma pausa em e/S para todos os clientes conetados. Como um número crescente de clientes é servido por um único controlador de armazenamento, a probabilidade de um ou mais desses clientes enviar solicitações de controle de fluxo aumenta. O problema tem sido visto frequentemente em sites de clientes com ampla virtualização de SO.</block>
  <block id="6bfd8563627c68f73c30581843441a74" category="paragraph">Uma NIC em um sistema NetApp não deve receber solicitações de controle de fluxo. O método utilizado para alcançar este resultado varia consoante o fabricante do comutador de rede. Na maioria dos casos, o controle de fluxo em um switch Ethernet pode ser definido como<block ref="a67b5ddb674c9ca32d9c9e1ca81578ee" prefix=" " category="inline-code"></block><block ref="f4eb0bfa09695eb47ff4f3bd3ca4449d" prefix=" " category="inline-code"></block> ou , o que significa que uma solicitação de controle de fluxo não é encaminhada para o controlador de armazenamento. Em outros casos, a conexão de rede no controlador de armazenamento pode não permitir a desativação do controle de fluxo. Nesses casos, os clientes devem ser configurados para nunca enviar solicitações de controle de fluxo, seja alterando para a configuração da NIC no próprio servidor host ou para as portas de switch às quais o servidor host está conetado.</block>
  <block id="7496f3ff64e30d4732c2c64880faf186" category="admonition">*A NetApp recomenda* certificando-se de que os controladores de armazenamento NetApp não recebam pacotes de controle de fluxo Ethernet. Isso geralmente pode ser feito definindo as portas do switch às quais o controlador está conetado, mas alguns hardwares do switch têm limitações que podem exigir alterações no lado do cliente.</block>
  <block id="ae6d0fc57efaf02ad7dfdacd3575e315" category="section-title">Tamanhos de MTU</block>
  <block id="ff13ea04765cd9c9aed7b839f15eb2b4" category="paragraph">O uso de quadros jumbo tem sido mostrado para oferecer alguma melhoria de desempenho em redes 1GBG, reduzindo a sobrecarga de CPU e rede, mas o benefício geralmente não é significativo.</block>
  <block id="ee3f364287a30ef10dfdce2f37d94ed2" category="admonition">*A NetApp recomenda* a implementação de quadros jumbo quando possível, tanto para obter quaisquer benefícios potenciais de desempenho quanto para preparar a solução para o futuro.</block>
  <block id="2c6ba27b7ed602a9089da6ad9f762c9a" category="paragraph">Usar quadros jumbo em uma rede 10GbG é quase obrigatório. Isso ocorre porque a maioria das implementações 10Gb atingem um limite de pacotes por segundo sem quadros jumbo antes que atinjam a marca 10Gb. O uso de quadros jumbo melhora a eficiência no processamento TCP/IP porque permite que o sistema operacional, servidor, NICs e o sistema de armazenamento processem menos pacotes, mas maiores. A melhoria do desempenho varia de NIC para NIC, mas é significativa.</block>
  <block id="a44be1bbfde97e4a64b50282325165e7" category="paragraph">Para implementações de quadros jumbo, existe a crença comum, mas incorreta, de que todos os dispositivos conetados devem suportar quadros jumbo e que o tamanho da MTU deve corresponder de ponta a ponta Em vez disso, os dois pontos de extremidade da rede negociam o tamanho de quadro mais alto mutuamente aceitável ao estabelecer uma conexão. Em um ambiente típico, um switch de rede é definido para um tamanho MTU de 9216, o controlador NetApp é definido como 9000 e os clientes são definidos como uma combinação de 9000 e 1514. Os clientes que podem suportar um MTU de 9000 podem usar quadros jumbo, e os clientes que só podem suportar 1514 podem negociar um valor mais baixo.</block>
  <block id="a31484167f31e1c3f36f7cea821bc581" category="paragraph">Problemas com este arranjo são raros em um ambiente completamente comutado. No entanto, tenha cuidado em um ambiente roteado que nenhum roteador intermediário é forçado a fragmentar quadros jumbo.</block>
  <block id="c805e9846e6fca449dbe3233cc5dbdf5" category="paragraph">*A NetApp recomenda* configurando o seguinte:</block>
  <block id="b4446b5ca60d915111af271495bd4c17" category="list-text">Os quadros jumbo são desejáveis, mas não são necessários com Ethernet de 1GB GB (GbE).</block>
  <block id="5b1ea13ac12a9c8be0d09303f637dba4" category="list-text">Os quadros Jumbo são necessários para o máximo desempenho com 10GbE e mais rápido.</block>
  <block id="08a8dce78637f5dd14ed052163feb9da" category="section-title">Parâmetros TCP</block>
  <block id="1a999618685598bee637262fe589de70" category="paragraph">Três configurações geralmente são mal configuradas: Carimbos de data/hora TCP, reconhecimento seletivo (SACK) e escala de janela TCP. Muitos documentos desatualizados na Internet recomendam desativar um ou mais desses parâmetros para melhorar o desempenho. Havia algum mérito a esta recomendação há muitos anos, quando os recursos da CPU eram muito menores e havia um benefício para reduzir a sobrecarga no processamento TCP sempre que possível.</block>
  <block id="6a594ec6f0bb742c1d2b0f631cf65ba1" category="paragraph">No entanto, com os sistemas operacionais modernos, desabilitar qualquer um desses recursos TCP geralmente resulta em nenhum benefício detetável, ao mesmo tempo em que potencialmente danifica o desempenho. Os danos no desempenho são especialmente prováveis em ambientes de rede virtualizados, pois esses recursos são necessários para o manuseio eficiente da perda de pacotes e alterações na qualidade da rede.</block>
  <block id="cdc44d05b1633e8a8c7835010c423dd6" category="admonition">*A NetApp recomenda* a ativação de timestamps TCP, SACK e escala de janelas TCP no host, e todos esses três parâmetros devem estar ativados por padrão em qualquer sistema operacional atual.</block>
  <block id="d75b0d8f723c3e97eaa4ca39630c7420" category="doc">MetroCluster e vários agregados</block>
  <block id="df5855269b493a27a5565dfd9f2584f0" category="list-text">Em condições normais, as gravações recebidas em um determinado controlador são espelhadas de forma síncrona para seu parceiro. Em um ambiente NetApp MetroCluster, as gravações também são espelhadas em um controle remoto. Até que uma gravação seja armazenada em Mídia não volátil em todos os locais, ela não será reconhecida para a aplicação host.</block>
  <block id="05b60db315aa45e1524b7a6ffa242fa8" category="list-text">A Mídia que armazena os dados de gravação é chamada de memória não volátil ou NVMEM. Ele também é por vezes referido à memória de acesso aleatório não volátil (NVRAM), e pode ser considerado como um cache de escrita, embora funcione como um diário. Em uma operação normal, os dados do NVMEM não são lidos; eles são usados apenas para proteger os dados em caso de falha de software ou hardware. Quando os dados são gravados em unidades, os dados são transferidos da RAM no sistema, e não da NVMEM.</block>
  <block id="e6dd8b559da6e046f2043043a55faafc" category="list-text">Durante uma operação de takeover, um nó em um par de alta disponibilidade (HA) assume as operações de seu parceiro. Um switchover é essencialmente o mesmo, mas se aplica às configurações do MetroCluster nas quais um nó remoto assume as funções de um nó local.</block>
  <block id="33c0c466972aae7427262e3075a2ed07" category="paragraph">Durante as operações de manutenção de rotina, uma operação de aquisição ou comutação de storage deve ser transparente, exceto para uma breve pausa em operações à medida que os caminhos de rede mudam. No entanto, a rede pode ser complicada, e é fácil fazer erros. Por isso, a NetApp recomenda fortemente testar cuidadosamente as operações de takeover e switchover antes de colocar um sistema de storage em produção. Fazer isso é a única maneira de ter certeza de que todos os caminhos de rede estão configurados corretamente. Em um ambiente SAN, verifique cuidadosamente a saída do comando<block ref="41dc2c94e82e1c56ba876085acf5a974" prefix=" " category="inline-code"></block> para garantir que todos os caminhos primários e secundários esperados estejam disponíveis.</block>
  <block id="d33ea1ad1493de23aafd480e95fea159" category="paragraph">Deve ser tomado cuidado ao emitir uma tomada ou mudança forçada. Forçar uma alteração na configuração de armazenamento com essas opções significa que o estado do controlador que possui as unidades é ignorado e o nó alternativo assume forçosamente o controle das unidades. Forçar uma aquisição incorreta pode resultar em perda ou corrupção de dados. Isso ocorre porque uma tomada ou comutação forçada pode descartar o conteúdo do NVMEM. Após a conclusão do takeover ou switchover, a perda desses dados significa que os dados armazenados nas unidades podem reverter para um estado um pouco mais antigo do ponto de vista do banco de dados.</block>
  <block id="c226371d96b605ccff84ad23db0069b8" category="paragraph">Uma aquisição forçada com um par de HA normal raramente deve ser necessária. Em quase todos os cenários de falha, um nó desliga e informa o parceiro para que ocorra um failover automático. Existem alguns casos de borda, como uma falha contínua em que a interconexão entre nós é perdida e, em seguida, um controlador é perdido, na qual uma tomada pública forçada é necessária. Em tal situação, o espelhamento entre nós é perdido antes da falha do controlador, o que significa que o controlador sobrevivente não teria mais uma cópia das gravações em andamento. Então, a aquisição precisa ser forçada, o que significa que os dados podem ser perdidos.</block>
  <block id="418f81f529a577cb711b44adece1376f" category="paragraph">A mesma lógica se aplica a um switchover MetroCluster. Em condições normais, uma mudança é quase transparente. No entanto, um desastre pode resultar em uma perda de conetividade entre o local sobrevivente e o local do desastre. Do ponto de vista do site sobrevivente, o problema não poderia ser mais do que uma interrupção na conetividade entre sites, e o site original ainda pode estar processando dados. Se um nó não puder verificar o estado do controlador principal, somente um switchover forçado é possível.</block>
  <block id="ae0c16d397348d8f8fd4e56b08b06c7c" category="paragraph">*A NetApp recomenda* tomar as seguintes precauções:</block>
  <block id="79fd18cb18befbe5c2113757478be193" category="list-text">Tenha muito cuidado para não forçar acidentalmente uma aquisição ou uma mudança. Normalmente, forçar não deve ser necessário e forçar a mudança pode causar perda de dados.</block>
  <block id="26cece11254903c5ba8bfdd8d54ae779" category="list-text">Se for necessário um controle ou switchover forçado, certifique-se de que os aplicativos sejam desligados, todos os sistemas de arquivos sejam desmontados e os grupos de volume do gerenciador de volumes lógico (LVM) sejam variados. Os grupos de discos ASM devem ser desmontados.</block>
  <block id="0b6986eb1285d28a9987ea13adbca358" category="list-text">No caso de um switchover forçado do MetroCluster, feche o nó com falha de todos os recursos de storage sobreviventes. Para obter mais informações, consulte o Guia de gerenciamento e recuperação de desastres do MetroCluster para obter a versão relevante do ONTAP.</block>
  <block id="71303adf87737046acd4381c72151278" category="paragraph">O MetroCluster é uma tecnologia de replicação síncrona que alterna para o modo assíncrono se a conetividade for interrompida. Essa é a solicitação mais comum dos clientes, pois a replicação síncrona garantida significa que a interrupção na conectividade do local leva a uma interrupção completa da e/S do banco de dados, retirando o banco de dados do serviço.</block>
  <block id="cb791a44ee361703eb7594a7932f57de" category="paragraph">Com o MetroCluster, agregados ressincronizam rapidamente após a restauração da conectividade. Diferentemente de outras tecnologias de storage, o MetroCluster nunca deve exigir um reespelhamento completo após falha do local. Apenas as alterações delta devem ser enviadas.</block>
  <block id="c1536091d7c1ca33c9dc4dfa8c0852a2" category="paragraph">Em conjuntos de dados que abrangem agregados, existe um pequeno risco de que etapas adicionais de recuperação de dados sejam necessárias em um cenário de desastre contínuo. Especificamente, se (a) a conetividade entre sites for interrompida, (b) a conetividade for restaurada, (c) os agregados atingirem um estado em que alguns são sincronizados e alguns não são, e então (d) o local primário é perdido, o resultado é um local sobrevivente no qual os agregados não são sincronizados uns com os outros. Se isso acontecer, partes do conjunto de dados são sincronizadas entre si e não é possível abrir aplicativos, bancos de dados ou datastores sem recuperação. Se um conjunto de dados abranger agregados, o NetApp recomenda fortemente a utilização de backups baseados em snapshot com uma das muitas ferramentas disponíveis para verificar a capacidade de recuperação rápida neste cenário incomum.</block>
  <block id="79768a069a539d4f130e672a660bf45f" category="doc">Zoneamento</block>
  <block id="e237dd01ca20b300861ea50239fefbf9" category="paragraph">Isso inclui medidas de Planejamento típicas, como garantir a existência de largura de banda suficiente na SAN entre o host e o sistema de storage, verificar se todos os caminhos de SAN existem entre todos os dispositivos necessários, usar as configurações de porta FC exigidas pelo fornecedor do switch FC, evitar a contenção de ISL e usar o monitoramento adequado da malha SAN.</block>
  <block id="a0bdb98e8b9da585816478d24278e42f" category="paragraph">Uma zona FC nunca deve conter mais de um iniciador. Tal arranjo pode parecer funcionar inicialmente, mas a conversa cruzada entre iniciadores eventualmente interfere com o desempenho e a estabilidade.</block>
  <block id="8ef958d9e25538841b306960ab117626" category="paragraph">As zonas de destino múltiplo são geralmente consideradas seguras, embora em raras circunstâncias o comportamento das portas de destino FC de diferentes fornecedores tenha causado problemas. Por exemplo, evite incluir as portas de destino de um storage array NetApp e não NetApp na mesma zona. Além disso, é ainda mais provável que colocar um sistema de storage NetApp e um dispositivo de fita na mesma zona cause problemas.</block>
  <block id="8ee38535add58992c14b23a6f7cf8d27" category="doc">Tipos de LIF</block>
  <block id="50d034374ef68094a0f6c8e8d06a77af" category="inline-link-macro">Documentação do Gerenciamento de rede da ONTAP</block>
  <block id="fc25025f3f0a2afd42465a55f35c02d0" category="paragraph">Esta seção fornece uma visão geral dos principais princípios de design de LIF. Para obter documentação mais abrangente, consulte o <block ref="a3e6361e1a52d384f542a2f2d8bc9bb1" category="inline-link-macro-rx"></block>. Assim como em outros aspectos da arquitetura de banco de dados, as melhores opções para o design de máquina virtual de storage (SVM, conhecido como vserver na CLI) e interface lógica (LIF) dependem muito dos requisitos de dimensionamento e necessidades de negócios.</block>
  <block id="be0801f7fb241be642bec73b799d45cb" category="paragraph">Considere os seguintes tópicos principais ao criar uma estratégia de LIF:</block>
  <block id="362c2978dddcf6988ce266d3d60f5beb" category="list-text">*Desempenho.* A largura de banda da rede é suficiente?</block>
  <block id="cfc88efb72b2c7ea83a4a3d68b760d55" category="list-text">*Resiliência.* Há algum ponto único de falha no projeto?</block>
  <block id="af02972fd4dc1e949d800731d9518812" category="list-text">*Capacidade de gerenciamento.* A rede pode ser dimensionada sem interrupções?</block>
  <block id="fdcbadc80d2dd31527cc91cf81fb725d" category="paragraph">Esses tópicos se aplicam à solução completa, desde o host até os switches até o sistema de storage.</block>
  <block id="f45fe079103703d0b315ff2e339728fd" category="inline-link-macro">Documentação do ONTAP sobre tipos de LIF</block>
  <block id="cc4583278db25277db9ddcd781cbf992" category="paragraph">Existem vários tipos de LIF. <block ref="9d27879d9d2bd4f0f081ffed63159522" category="inline-link-macro-rx"></block> Forneça informações mais completas sobre este tópico, mas de uma perspetiva funcional os LIFs podem ser divididos nos seguintes grupos:</block>
  <block id="f34a52d788c5a4cf56d7ae8ccb85f8c2" category="list-text">*LIFs de gerenciamento de clusters e nós.* LIFs usadas para gerenciar o cluster de armazenamento.</block>
  <block id="73ac4e00a9ff3caf31e6df13a6df2f78" category="list-text">*LIFs de gerenciamento de SVM.* Interfaces que permitem o acesso a um SVM por meio da API REST ou ONTAPI (também conhecida como ZAPI) para funções como criação de snapshot ou redimensionamento de volume. Produtos como o SnapManager para Oracle (SMO) precisam ter acesso a um LIF de gerenciamento de SVM.</block>
  <block id="b7010e46f4769f638197aa230f448ba0" category="list-text">*LIFs de dados.* Interfaces para dados FC, iSCSI, NVMe/FC, NVMe/TCP, NFS ou SMB/CIFS.</block>
  <block id="1eb4f53fa8ee8f0954514a1b9858bf6b" category="admonition">Um LIF de dados usado para tráfego NFS também pode ser usado para gerenciamento alterando a política de firewall de<block ref="8d777f385d3dfec8815d20f7496026dc" prefix=" " category="inline-code"></block> para<block ref="d724f231a9a7b89757c4394d6622bc47" prefix=" " category="inline-code"></block> ou outra política que permita HTTP, HTTPS ou SSH. Essa alteração pode simplificar a configuração de rede evitando a configuração de cada host para acesso ao LIF de dados NFS e a um LIF de gerenciamento separado. Não é possível configurar uma interface para iSCSI e tráfego de gerenciamento, apesar do fato de ambos usarem um protocolo IP. Um LIF de gerenciamento separado é necessário em ambientes iSCSI.</block>
  <block id="85d465743ad38be108b50648ab283d78" category="section-title">Design de SAN LIF</block>
  <block id="8800a54085e1b2987d83537423221cf9" category="paragraph">O design de LIF em um ambiente SAN é relativamente simples por um motivo: Multipathing. Todas as implementações de SAN modernas permitem que um cliente acesse dados em vários caminhos de rede independentes e selecione o melhor caminho ou caminhos para acesso. Como resultado, o desempenho em relação ao design de LIF é mais simples de abordar, pois os clientes SAN equilibram automaticamente a e/S de carga nos melhores caminhos disponíveis.</block>
  <block id="e33c923a4d6280bf6f2b2a982ff74ee3" category="paragraph">Se um caminho ficar indisponível, o cliente selecionará automaticamente um caminho diferente. A simplicidade resultante do design torna os LIFs SAN geralmente mais gerenciáveis. Isso não significa que um ambiente SAN sempre seja gerenciado com mais facilidade, porque há muitos outros aspectos do storage SAN que são muito mais complicados do que o NFS. Isso significa simplesmente que o design de SAN LIF é mais fácil.</block>
  <block id="9446a98ad14416153cc4d45ab8b531bf" category="section-title">Desempenho</block>
  <block id="141614e246b14131ec01a449d61ed657" category="paragraph">A consideração mais importante com o desempenho de LIF em um ambiente SAN é a largura de banda. Por exemplo, um cluster ONTAP AFF de dois nós com duas portas FC de 16GB GB por nó permite até 32GB Gbps de largura de banda de/para cada nó.</block>
  <block id="02bc0523497de72834c4c7990e32d155" category="section-title">Resiliência</block>
  <block id="01b1d8276ca14813ff4804089a9ac082" category="paragraph">OS LIFs DE SAN não fazem failover em um sistema de storage da AFF. Se um LIF SAN falhar devido ao failover de controladora, o software multipathing do cliente deteta a perda de um caminho e redireciona e/S para um LIF diferente. Com os sistemas de armazenamento ASA, os LIFs serão falhados após um curto atraso, mas isso não interrompe a e/S porque já existem caminhos ativos no outro controlador. O processo de failover ocorre para restaurar o acesso do host em todas as portas definidas.</block>
  <block id="b7c94ef25c0629a65f8a1f6ce7014d95" category="section-title">Capacidade de gerenciamento</block>
  <block id="1325935a6fa0e88cfec45038005f18e3" category="paragraph">A migração de LIF é uma tarefa muito mais comum em um ambiente NFS, pois a migração de LIF geralmente é associada à realocação de volumes no cluster. Não é necessário migrar um LIF em um ambiente SAN quando os volumes são transferidos para o par de HA. Isso ocorre porque, após a conclusão da movimentação de volume, o ONTAP envia uma notificação à SAN sobre uma alteração nos caminhos e os clientes SAN reotimizam automaticamente. A migração de LIF com SAN está associada principalmente a grandes alterações de hardware físico. Por exemplo, se uma atualização sem interrupções dos controladores for necessária, um LIF SAN é migrado para o novo hardware. Se uma porta FC estiver defeituosa, um LIF pode ser migrado para uma porta não utilizada.</block>
  <block id="dbb887b1373e51dab774976c5a556964" category="section-title">Recomendações de design</block>
  <block id="076872b2444637e6142c3c6f0f157423" category="paragraph">A NetApp faz as seguintes recomendações:</block>
  <block id="d8d6bca7c981c13479781da85883cfef" category="list-text">Não crie mais caminhos do que o necessário. O número excessivo de caminhos torna o gerenciamento geral mais complicado e pode causar problemas com failover de caminho em alguns hosts. Além disso, alguns hosts têm limitações de caminho inesperadas para configurações como inicialização por SAN.</block>
  <block id="bd662d86fcca370cddf188ff5378fb1b" category="list-text">Poucas configurações devem exigir mais de quatro caminhos para um LUN. O valor de ter mais de dois nós anunciando caminhos para LUNs é limitado porque o host agregado de um LUN fica inacessível se o nó proprietário do LUN e seu parceiro de HA falhar. A criação de caminhos em nós que não o par de HA principal não é útil em tal situação.</block>
  <block id="8873f044ab7c082f16372e4b8bdc6e03" category="list-text">Embora o número de caminhos de LUN visíveis possa ser gerenciado selecionando quais portas estão incluídas nas zonas FC, geralmente é mais fácil incluir todos os pontos de destino potenciais na zona FC e controlar a visibilidade de LUN no nível ONTAP.</block>
  <block id="0ebc6267761306c4daefb9871a470e4b" category="list-text">No ONTAP 8,3 e posterior, o recurso de mapeamento de LUN seletivo (SLM) é o padrão. Com o SLM, qualquer novo LUN é automaticamente anunciado a partir do nó que é proprietário do agregado subjacente e do parceiro de HA do nó. Esse arranjo evita a necessidade de criar conjuntos de portas ou configurar o zoneamento para limitar a acessibilidade de portas. Cada LUN está disponível no número mínimo de nós necessário para ter a melhor performance e resiliência. *Caso um LUN precise ser migrado para fora dos dois controladores, os nós adicionais podem ser adicionados com o<block ref="02d0bbdc14988c85bbd7994723f4dd7f" prefix=" " category="inline-code"></block> comando para que os LUNs sejam anunciados nos novos nós. Isso cria caminhos SAN adicionais para os LUNs para migração de LUN. No entanto, o host deve executar uma operação de descoberta para usar os novos caminhos.</block>
  <block id="cc4b24f288afae5889c6061466dda472" category="list-text">Não se preocupe excessivamente com o tráfego indireto. É melhor evitar o tráfego indireto em um ambiente com uso intenso de e/S para o qual cada microssegundo de latência é crítico, mas o efeito de performance visível é insignificante para workloads típicos.</block>
  <block id="f54fccb82abaa995eb9f86264f431505" category="section-title">Design de LIF de NFS</block>
  <block id="e68dee93f11ae71aebd7a1e4c2abfc5a" category="paragraph">Em contraste com os protocolos SAN, o NFS tem uma capacidade limitada de definir vários caminhos para os dados. As extensões NFS paralelas (pNFS) para NFSv4 abordam essa limitação, mas como as velocidades ethernet atingiram 100GBMbps e além raramente há valor na adição de caminhos adicionais.</block>
  <block id="391dc675ec3d853200129b799ed5923e" category="section-title">Performance e resiliência</block>
  <block id="a0bd34f908e3947aa4aba15382354836" category="paragraph">Embora a medição do desempenho do SAN LIF seja principalmente uma questão de calcular a largura de banda total de todos os caminhos principais, determinar o desempenho do NFS LIF requer uma visão mais detalhada da configuração exata da rede. Por exemplo, duas portas 10Gb podem ser configuradas como portas físicas brutas ou podem ser configuradas como um grupo de interfaces LACP (Link Aggregation Control Protocol). Se eles estiverem configurados como um grupo de interfaces, várias políticas de balanceamento de carga estarão disponíveis que funcionam de forma diferente, dependendo se o tráfego é comutado ou roteado. Por fim, o Oracle Direct NFS (DNFS) oferece configurações de balanceamento de carga que não existem em nenhum cliente NFS do sistema operacional no momento.</block>
  <block id="e500ca27c6b92454c989d80e0445c359" category="paragraph">Diferentemente dos protocolos SAN, os sistemas de arquivos NFS exigem resiliência na camada do protocolo. Por exemplo, um LUN é sempre configurado com multipathing habilitado, o que significa que vários canais redundantes estão disponíveis para o sistema de storage, cada um dos quais usa o protocolo FC. Um sistema de arquivos NFS, por outro lado, depende da disponibilidade de um único canal TCP/IP que só pode ser protegido na camada física. Esse arranjo é o motivo pelo qual existem opções como failover de portas e agregação de portas LACP.</block>
  <block id="35926e2ada969ad80fd3b16c0cd7d35a" category="paragraph">Em um ambiente NFS, a performance e a resiliência são fornecidas na camada de protocolo de rede. Como resultado, ambos os tópicos estão interligados e devem ser discutidos juntos.</block>
  <block id="84f4a5dfaa9613a469cd783c353a186c" category="section-title">Vincular LIFs a grupos de portas</block>
  <block id="44bfb87c11d83c1b91c3589f2081e7ca" category="paragraph">Para vincular um LIF a um grupo de portas, associe o endereço IP de LIF a um grupo de portas físicas. O método principal para agregar portas físicas em conjunto é o LACP. A capacidade de tolerância a falhas do LACP é bastante simples; cada porta em um grupo LACP é monitorada e removida do grupo de portas em caso de mau funcionamento. Existem, no entanto, muitos equívocos sobre como o LACP funciona em relação ao desempenho:</block>
  <block id="19a43026949fb6ef1017a54cf7c94f9b" category="list-text">O LACP não requer a configuração no switch para corresponder ao endpoint. Por exemplo, o ONTAP pode ser configurado com balanceamento de carga baseado em IP, enquanto um switch pode usar balanceamento de carga baseado em MAC.</block>
  <block id="86501252b34395de5303a65f5e9943e3" category="list-text">Cada endpoint que usa uma conexão LACP pode escolher independentemente a porta de transmissão de pacotes, mas não pode escolher a porta usada para recebimento. Isso significa que o tráfego de ONTAP para um destino específico está vinculado a uma porta específica, e o tráfego de retorno pode chegar em uma interface diferente. No entanto, isso não causa problemas.</block>
  <block id="298ca40b99dd3540dcd82ba5537f3f8d" category="list-text">O LACP não distribui uniformemente o tráfego o tempo todo. Em um ambiente grande com muitos clientes NFS, o resultado é normalmente até mesmo o uso de todas as portas em uma agregação LACP. No entanto, qualquer sistema de arquivos NFS no ambiente é limitado à largura de banda de apenas uma porta, e não a agregação inteira.</block>
  <block id="d071b5ccd1569aace97a0b4d6c0a71ac" category="list-text">Embora as políticas LACP robin estejam disponíveis no ONTAP, essas políticas não abordam a conexão de um switch para um host. Por exemplo, uma configuração com um tronco LACP de quatro portas em um host e um tronco LACP de quatro portas no ONTAP ainda é capaz de ler apenas um sistema de arquivos usando uma única porta. Embora o ONTAP possa transmitir dados através das quatro portas, não há tecnologias de switch disponíveis que sejam enviadas do switch para o host através das quatro portas. Apenas um é usado.</block>
  <block id="6e9e98dfaea1ca7860606f1fc05e414a" category="paragraph">A abordagem mais comum em ambientes maiores que consistem em muitos hosts de banco de dados é construir um agregado LACP de um número apropriado de interfaces 10Gb (ou mais rápidas) usando o balanceamento de carga IP. Essa abordagem permite que o ONTAP forneça uso uniforme de todas as portas, desde que existam clientes suficientes. O balanceamento de carga é interrompido quando há menos clientes na configuração porque o entroncamento LACP não redistribui dinamicamente a carga.</block>
  <block id="7815da600ab459d2b05c5792f2271c1a" category="paragraph">Quando uma conexão é estabelecida, o tráfego em uma determinada direção é colocado em apenas uma porta. Por exemplo, um banco de dados que executa uma verificação de tabela completa em um sistema de arquivos NFS conetado por meio de um tronco LACP de quatro portas lê dados através de apenas uma placa de interface de rede (NIC). Se apenas três servidores de banco de dados estiverem em tal ambiente, é possível que todos os três estejam lendo da mesma porta, enquanto as outras três portas estiverem ociosas.</block>
  <block id="153f704ea16440133d51b1877af2a657" category="section-title">Vincule LIFs a portas físicas</block>
  <block id="70e655aa3c03f840747c5272142b3527" category="paragraph">Vincular um LIF a uma porta física resulta em um controle mais granular sobre a configuração de rede, pois um determinado endereço IP em um sistema ONTAP está associado a apenas uma porta de rede de cada vez. A resiliência é então realizada por meio da configuração de grupos de failover e políticas de failover.</block>
  <block id="218f00463f5281b8ead536582c69ac3a" category="section-title">Políticas de failover e grupos de failover</block>
  <block id="0a53c26a1bc4036c84fc3b4b63542744" category="inline-link-macro">Documentação de gerenciamento de rede ONTAP para grupos e políticas de failover</block>
  <block id="f29ae31443947c9782482ee9683dbc0e" category="paragraph">O comportamento dos LIFs durante a interrupção da rede é controlado por políticas de failover e grupos de failover. As opções de configuração foram alteradas com as diferentes versões do ONTAP. Consulte o <block ref="96c8cd47b667604fb9991ace7d2eff29" category="inline-link-macro-rx"></block> para obter detalhes específicos sobre a versão do ONTAP que está sendo implantado.</block>
  <block id="0f2f345dd1247ae428cee703c1bf1c84" category="paragraph">O ONTAP 8,3 e superior permitem o gerenciamento de failover de LIF com base em domínios de broadcast. Portanto, um administrador pode definir todas as portas que têm acesso a uma determinada sub-rede e permitir que o ONTAP selecione um LIF de failover apropriado. Essa abordagem pode ser usada por alguns clientes, mas tem limitações em um ambiente de rede de storage de alta velocidade devido à falta de previsibilidade. Por exemplo, um ambiente pode incluir ambas as portas 1GB para acesso de rotina ao sistema de arquivos e portas 10Gb para e/S de arquivo de dados Se ambos os tipos de portas existirem no mesmo domínio de broadcast, o failover de LIF pode resultar na movimentação de e/S de um arquivo de dados de uma porta 10Gb para uma porta 1GB.</block>
  <block id="ced0729d57c08312b2b12382f2147d26" category="paragraph">Em resumo, considere as seguintes práticas:</block>
  <block id="57cb6a7ba8acb7faa31cc5219bae83b3" category="list-text">Configurar um grupo de failover conforme definido pelo usuário.</block>
  <block id="b444855eccae552d7fb79bf3d31a4f7b" category="list-text">Preencha o grupo de failover com portas na controladora de parceiro de failover de storage (SFO) para que as LIFs sigam os agregados durante um failover de storage. Isso evita a criação de tráfego indireto.</block>
  <block id="86c48b21d166ed8e440a07e1d4a0b15d" category="list-text">Use portas de failover com caraterísticas de desempenho correspondentes ao LIF original. Por exemplo, um LIF em uma única porta 10Gb física deve incluir um grupo de failover com uma única porta 10Gb. Um LIF LACP de quatro portas deve falhar para outro LIF LACP de quatro portas. Essas portas seriam um subconjunto das portas definidas no domínio de broadcast.</block>
  <block id="3e839a73f7dc1262508f23a89628ca2d" category="list-text">Defina a política de failover como somente parceiro SFO. Isso garante que o LIF siga o agregado durante o failover.</block>
  <block id="85e82ce4c9842f978fa774c4fe96b14c" category="section-title">Reversão automática</block>
  <block id="3dc8610f78478640e47688101cecbfad" category="paragraph">Defina<block ref="9f1b7141f09f19c4e33409646aef43cf" prefix=" " category="inline-code"></block> o parâmetro conforme desejado. A maioria dos clientes prefere definir este parâmetro para que<block ref="b326b5062b2f0e69046810717534cb09" prefix=" " category="inline-code"></block> o LIF reverta para sua porta inicial. No entanto, em alguns casos, os clientes definiram isso como "falso" que um failover inesperado pode ser investigado antes de retornar um LIF à sua porta inicial.</block>
  <block id="edf6d4c299bc2890ba63c7eb3ef8b4d2" category="section-title">Relação LIF-volume</block>
  <block id="9c75becef8c432a0152a40c7c037a04c" category="paragraph">Um equívoco comum é que deve haver uma relação do 1:1 entre volumes e LIFs NFS. Embora essa configuração seja necessária para mover um volume em qualquer lugar em um cluster, sem nunca criar tráfego de interconexão adicional, ela não é categoricamente um requisito. O tráfego entre clusters deve ser considerado, mas a mera presença de tráfego entre clusters não cria problemas. Muitos dos benchmarks publicados criados para o ONTAP incluem predominantemente I/O. indireto</block>
  <block id="2b4ebcd522b07b80d3fd76b301c506e8" category="paragraph">Por exemplo, um projeto de banco de dados contendo um número relativamente pequeno de bancos de dados críticos ao desempenho que exigiam apenas um total de 40 volumes pode garantir um volume 1:1 para a estratégia LIF, um arranjo que exigiria 40 endereços IP. Qualquer volume poderia então ser movido para qualquer lugar do cluster junto com o LIF associado, e o tráfego sempre seria direto, minimizando cada fonte de latência, mesmo nos níveis de microssegundos.</block>
  <block id="38bad4911bcdf1117d37eb1195566f8c" category="paragraph">Como um exemplo de contador, um ambiente grande e hospedado pode ser mais facilmente gerenciado com um relacionamento 1:1 entre clientes e LIFs. Com o tempo, um volume pode precisar ser migrado para um nó diferente, o que causaria algum tráfego indireto. No entanto, o efeito de desempenho deve ser indetetável, a menos que as portas de rede no switch de interconexão estejam saturando. Se houver problema, um novo LIF pode ser estabelecido em nós adicionais e o host pode ser atualizado na próxima janela de manutenção para remover o tráfego indireto da configuração.</block>
  <block id="a19665c8f7c0210f96ad2934ad0ee361" category="paragraph">Em um sistema ONTAP, o storage é organizado em 4KB unidades. Um bloco 8KB do banco de dados ou do sistema de arquivos deve ser mapeado para exatamente dois blocos 4KB. Se um erro na configuração de LUN mudar o alinhamento em 1KB em qualquer direção, cada bloco 8KB existiria em três blocos de armazenamento 4KB diferentes em vez de dois. Esse arranjo causaria maior latência e causaria a realização de e/S adicionais no sistema de storage.</block>
  <block id="211a9fe299057fe8665b591dddbac56d" category="paragraph">O alinhamento também afeta arquiteturas LVM. Se um volume físico dentro de um grupo de volumes lógicos for definido em todo o dispositivo da unidade (nenhuma partição é criada), o primeiro bloco 4KB no LUN se alinha com o primeiro bloco 4KB no sistema de armazenamento. Este é um alinhamento correto. Problemas surgem com partições porque eles mudam o local inicial onde o sistema operacional usa o LUN. Desde que o deslocamento seja deslocado em unidades inteiras de 4KB, o LUN é alinhado.</block>
  <block id="c6f01c78bfe0a0a495cb5d3ed77824a9" category="doc">Volumes</block>
  <block id="2ee3c7318caa2523e9c749e4e2152266" category="paragraph">Um ponto comum de confusão com os clientes novos no ONTAP é o uso de FlexVols, comumente chamado de simplesmente "volumes".</block>
  <block id="ff2dabe8a40c84d01b0584c50319a79e" category="paragraph">Um volume não é um LUN. Esses termos são usados de forma sinônima com muitos outros produtos de fornecedores, incluindo provedores de nuvem. O ONTAP volumes é simplesmente volumes de gerenciamento. Eles não servem dados por si mesmos, nem ocupam espaço. Eles são contentores para arquivos ou LUNs e existem para melhorar e simplificar a capacidade de gerenciamento, especialmente em escala.</block>
  <block id="92a5781e05d0d9b7044f44e2ef7bff84" category="section-title">Volumes e LUNs</block>
  <block id="faf1e8eebcac2d18d4ac10e75f416a3f" category="paragraph">Os LUNs relacionados normalmente são colocalizados em um único volume. Por exemplo, um banco de dados que requer 10 LUNs normalmente teria todos os 10 LUNs colocados no mesmo volume.</block>
  <block id="3a5bf2895b95fa2b89fce4dcf94fd2f9" category="list-text">Usar uma proporção de 1:1:1, de LUNs para volumes, ou seja, um LUN por volume, é *não* uma prática recomendada formal.</block>
  <block id="1886f4ac4aa2f64bf8224f178a36ba92" category="list-text">Em vez disso, os volumes devem ser vistos como contêineres para workloads ou conjuntos de dados. Pode haver um único LUN por volume, ou pode haver muitos. A resposta certa depende dos requisitos de gerenciabilidade.</block>
  <block id="0de05608a70e8ec5863afc41ba150178" category="list-text">Espalhar LUNs em um número desnecessário de volumes pode levar a problemas adicionais de sobrecarga e agendamento para operações, como operações de snapshot, números excessivos de objetos exibidos na IU e resultar em alcançar limites de volume da plataforma antes que o limite de LUN seja atingido.</block>
  <block id="0955dbd01a9f8194cad5a6876b931f5a" category="section-title">Volumes, LUNs e instantâneos</block>
  <block id="9bbd4f2fca3a1e1aaa76abf8cb43351c" category="paragraph">As políticas e programações de snapshot são colocadas no volume, não no LUN. Um conjunto de dados que consiste em 10 LUNs exigiria apenas uma única política de snapshot quando os LUNs estiverem colocalizados no mesmo volume.</block>
  <block id="f34f28bb7a1701ded173c2ab504f5c20" category="paragraph">Além disso, a localização conjunta de todos os LUNs relacionados para um determinado conjunto de dados em um único volume proporciona operações de snapshot atômico. Por exemplo, um banco de dados que residia em 10 LUNs ou um ambiente de aplicativo baseado em VMware que consiste em 10 sistemas operacionais diferentes pode ser protegido como um único objeto consistente se os LUNs subjacentes forem todos colocados em um único volume. Se forem colocados em volumes diferentes, os instantâneos podem ou não estar 100% sincronizados, mesmo que programados ao mesmo tempo.</block>
  <block id="fe7797cb1dbe36223357d4c25ff30c9e" category="paragraph">Em alguns casos, um conjunto relacionado de LUNs pode precisar ser dividido em dois volumes diferentes devido aos requisitos de recuperação. Por exemplo, um banco de dados pode ter quatro LUNs para datafiles e dois LUNs para logs. Nesse caso, um volume de arquivo de dados com 4 LUNs e um volume de log com 2 LUNs podem ser a melhor opção. A razão é recuperabilidade independente. Por exemplo, o volume do arquivo de dados poderia ser restaurado seletivamente para um estado anterior, o que significa que todos os quatro LUNs seriam revertidos para o estado do instantâneo, enquanto o volume de log com seus dados críticos não seria afetado.</block>
  <block id="66383d632fe33f1b7c20af9c1c142028" category="section-title">Volumes, LUNs e SnapMirror</block>
  <block id="8fb29c5f40886ece62abcd994f1aa202" category="paragraph">As políticas e operações do SnapMirror são, como operações de snapshot, executadas no volume, e não no LUN.</block>
  <block id="7d8d0afc8d9998a7e6457c6251b4defc" category="paragraph">A realocação de LUNs relacionados em um único volume permite criar uma única relação do SnapMirror e atualizar todos os dados contidos com uma única atualização. Tal como acontece com instantâneos, a atualização também será uma operação atômica. O destino do SnapMirror teria a garantia de ter uma réplica pontual das LUNs de origem. Se os LUNs foram espalhados por vários volumes, as réplicas podem ou não ser consistentes umas com as outras.</block>
  <block id="e45ffde45b5f4090fe8c92a49d38bcb2" category="section-title">Volumes, LUNs e QoS</block>
  <block id="756a4c619fb81eafd00bc072334a5877" category="paragraph">Embora a QoS possa ser aplicada seletivamente a LUNs individuais, geralmente é mais fácil defini-la no nível do volume. Por exemplo, todos os LUNs usados pelos convidados em um determinado servidor ESX podem ser colocados em um único volume e, em seguida, uma política de QoS adaptável do ONTAP pode ser aplicada. O resultado é um limite de IOPS por TB com dimensionamento automático que se aplica a todos os LUNs.</block>
  <block id="fb219ca81e7a635609b70d290a7a3aa2" category="paragraph">Da mesma forma, se um banco de dados exigisse 100K IOPS e 10 LUNs ocupados, seria mais fácil definir um único limite de 100K IOPS em um único volume do que definir 10 limites de 10K IOPS individuais, um em cada LUN.</block>
  <block id="56739402ea66bd29b7303b69ee165d5b" category="section-title">Esquemas de vários volumes</block>
  <block id="c509cb5f7def30cc77b15b0e91ab39a4" category="paragraph">Há alguns casos em que a distribuição de LUNs em vários volumes pode ser benéfica. O principal motivo é o striping do controlador. Por exemplo, um sistema de storage de HA pode hospedar um único banco de dados em que o potencial de processamento e armazenamento em cache completo de cada controlador é necessário. Nesse caso, um design típico seria colocar metade dos LUNs em um único volume no controlador 1 e a outra metade dos LUNs em um único volume no controlador 2.</block>
  <block id="ad328d1793d6c3621e91d83556548a01" category="paragraph">Da mesma forma, o striping do controlador pode ser usado para balanceamento de carga. Um sistema de HA que hospedava 100 bancos de dados de 10 LUNs cada um pode ser projetado no local em que cada banco de dados recebe um volume de 5 LUN em cada uma das duas controladoras. O resultado é o carregamento simétrico garantido de cada controlador à medida que bancos de dados adicionais são provisionados.</block>
  <block id="4cd2d5d8d873ad1f707d88334324153a" category="paragraph">No entanto, nenhum desses exemplos envolve uma proporção de volume para LUN de 1:1:1. O objetivo continua a ser otimizar a capacidade de gerenciamento, colocando LUNs relacionados em volumes.</block>
  <block id="a9fd7be1f3363701ad1b35b16af02c9e" category="paragraph">Um exemplo em que uma taxa de 1:1 LUN para volume faz sentido é a Conteinerização, onde cada LUN pode realmente representar uma única carga de trabalho e precisa ser gerenciado individualmente. Nesses casos, uma proporção de 1:1 pode ser ótima.</block>
  <block id="117c4b6bad0236ab23e0fe29aead8aef" category="paragraph">Embora o redimensionamento LUN seja uma opção para aumentar a capacidade, geralmente é melhor usar um LVM, incluindo o Oracle ASM. Uma das principais razões pelas quais LVMs existem é evitar a necessidade de um redimensionamento LUN. Com uma LVM, vários LUNs são colados em um pool virtual de storage. Os volumes lógicos esculpidos fora deste pool são gerenciados pela LVM e podem ser facilmente redimensionados. Um benefício adicional é evitar hotspots em uma determinada unidade, distribuindo um determinado volume lógico em todos os LUNs disponíveis. A migração transparente geralmente pode ser realizada usando o gerenciador de volumes para realocar as extensões subjacentes de um volume lógico para novos LUNs.</block>
  <block id="baba038803e218b2ac3b2688bc2fd5db" category="doc">Contagem de LUN</block>
  <block id="b0e4db975ae00108abe9f47db9be5668" category="paragraph">Um LUN é um objeto virtualizado no ONTAP que existe em todas as unidades no agregado de hospedagem. Como resultado, o desempenho do LUN não é afetado pelo seu tamanho porque o LUN se baseia no potencial de desempenho total do agregado, independentemente do tamanho escolhido.</block>
  <block id="7235d4b71fadc2fe03d09d863c7cdd66" category="paragraph">Por uma questão de conveniência, os clientes podem querer usar um LUN de um tamanho específico. Por exemplo, se um banco de dados for construído em um grupo de discos LVM ou Oracle ASM composto por dois LUNs de 1TB cada, esse grupo de discos deve ser aumentado em incrementos de 1TB. Pode ser preferível construir o grupo de discos a partir de oito LUNs de 500GB cada, para que o grupo de discos possa ser aumentado em incrementos menores.</block>
  <block id="4b1ffe65479a23391a2c7f9caf467a35" category="paragraph">A prática de estabelecer um tamanho de LUN padrão universal é desencorajada porque isso pode complicar a capacidade de gerenciamento. Por exemplo, um tamanho de LUN padrão de 100GB pode funcionar bem quando um banco de dados ou datastore está no intervalo de 1TB a 2TB, mas um banco de dados ou datastore de 20TB GB de tamanho exigiria 200 LUNs. Isso significa que os tempos de reinicialização do servidor são mais longos, há mais objetos para gerenciar nas várias UIs e produtos como SnapCenter devem executar a descoberta em muitos objetos. O uso de menos LUNs maiores evita esses problemas.</block>
  <block id="4afa3de974c36a09c2055d30989bb405" category="list-text">A contagem de LUN é mais importante do que o tamanho do LUN.</block>
  <block id="691c70133d96d57796a9299359666f80" category="list-text">O tamanho do LUN é controlado principalmente pelos requisitos de contagem de LUN.</block>
  <block id="8af9e525c143179b948a11fc382a331e" category="list-text">Evite criar mais LUNs do que o necessário.</block>
  <block id="407b2218ad77513a7e3964f169d07e66" category="paragraph">Ao contrário do tamanho do LUN, a contagem de LUN afeta o desempenho. O desempenho da aplicação geralmente depende da capacidade de executar e/S paralela pela camada SCSI. Como resultado, dois LUNs oferecem melhor performance do que um único LUN. Usar um LVM como Veritas VxVM, Linux LVM2 ou Oracle ASM é o método mais simples para aumentar o paralelismo.</block>
  <block id="39143fe6204f383e4ce3bb3b77926455" category="paragraph">Os clientes da NetApp geralmente experimentaram o mínimo de benefícios ao aumentar o número de LUNs além de dezasseis, embora o teste de ambientes 100% SSD com e/S aleatória muito pesada tenha demonstrado melhorias adicionais em até 64 LUNs.</block>
  <block id="9875f7503e59521e91e519abd87f5c9e" category="paragraph">*A NetApp recomenda* o seguinte:</block>
  <block id="57153ab478a4958250d76ac6bf4e3ac0" category="paragraph">Em geral, quatro a dezesseis LUNs são suficientes para atender às necessidades de e/S de qualquer workload de banco de dados. Menos de quatro LUNs podem criar limitações de desempenho devido às limitações nas implementações de SCSI de host.</block>
  <block id="12c3fe87fd5a746ce8a7cbe25dc1c25b" category="paragraph">Antes da era das unidades flash, a distribuição foi usada para ajudar a superar as limitações de desempenho das unidades giratórias. Por exemplo, se um sistema operacional precisar executar uma operação de leitura 1MB, ler que 1MB TB de dados de uma única unidade exigiria muita busca e leitura de cabeça de unidade, pois o 1MB é transferido lentamente. Se esse 1MB TB de dados fosse distribuído em 8 LUNs, o sistema operacional poderia emitir oito operações de leitura 128K em paralelo e reduzir o tempo necessário para concluir a transferência 1MB.</block>
  <block id="e337352c3d57672fd08af8ba709b544f" category="paragraph">Riscar com unidades giratórias foi mais difícil porque o padrão de e/S tinha que ser conhecido com antecedência. Se o striping não foi ajustado corretamente para os padrões de e/S verdadeiros, as configurações listradas podem danificar o desempenho. Com os bancos de dados Oracle e, especialmente, com configurações all-flash, a distribuição é muito mais fácil de configurar e, comprovadamente, aumentou significativamente o desempenho.</block>
  <block id="7025652291dc6872022b0f79a2b2be21" category="paragraph">Gerenciadores de volume lógicos, como o Oracle ASM stripe por padrão, mas o LVM de SO nativo não. Alguns deles unem vários LUNs como um dispositivo concatenado, o que resulta em datafiles que existem em um e apenas um dispositivo LUN. Isso causa pontos quentes. Outras implementações de LVM são padrão para extensões distribuídas. Isso é semelhante ao striping, mas é mais grosseiro. Os LUNs no grupo de volumes são cortados em pedaços grandes, chamados de extensões e normalmente medidos em muitos megabytes, e os volumes lógicos são então distribuídos por essas extensões. O resultado é a e/S aleatória contra um arquivo deve ser bem distribuída entre LUNs, mas as operações de e/S sequenciais não são tão eficientes quanto poderiam ser.</block>
  <block id="0c2f3b2ec9d90baa0a0a0b6fb673a113" category="paragraph">A e/S de aplicativos intensivos quase sempre é (a) em unidades do tamanho básico do bloco ou (b) um megabyte.</block>
  <block id="804d5b1f06570b4d242be0c2f0c3392c" category="paragraph">O principal objetivo de uma configuração de distribuição é garantir que a e/S de arquivo único possa ser executada como uma única unidade, e as e/S de vários blocos, que devem ter 1MB MB de tamanho, possam ser paralelizadas uniformemente em todos os LUNs no volume distribuído. Isso significa que o tamanho do stripe não deve ser menor que o tamanho do bloco do banco de dados e o tamanho do stripe multiplicado pelo número de LUNs deve ser 1MB.</block>
  <block id="0598f393baefd05d48b48076cc7df606" category="paragraph">A figura a seguir mostra três opções possíveis para o tamanho da faixa e ajuste de largura. O número de LUNs é selecionado para atender aos requisitos de performance conforme descrito acima, mas, em todos os casos, o total de dados em um único stripe é de 1MB.</block>
  <block id="341d84aa26cb4521474864e04ea2a63b" category="inline-image-macro">Erro: Imagem gráfica em falta</block>
  <block id="4d4855a15e1f9d6fd8f8bdf1668c537e" category="doc">NVFAIL forçado manualmente</block>
  <block id="8772c1c8bed97f5c942657feeb8bfb6f" category="admonition">Esta seção expande a explicação do NVFAIL básico do ONTAP para cobrir tópicos específicos do MetroCluster.</block>
  <block id="14d74316044293d1ebd8c5a01ff90055" category="paragraph">Com o MetroCluster, uma gravação não é reconhecida até que ela tenha sido registrada no NVRAM local e no NVRAM em pelo menos um outro controlador. Essa abordagem garante que uma falha de hardware ou falha de energia não resulte na perda de e/S em trânsito Se o NVRAM local falhar ou a conectividade com outros nós falhar, os dados não serão mais espelhados.</block>
  <block id="d820d86d09ea05a0de19c3aacbfb72b2" category="paragraph">Se o NVRAM local relatar um erro, o nó será encerrado. Esse desligamento resulta em failover para uma controladora de parceiro quando os pares de HA são usados. Com o MetroCluster, o comportamento depende da configuração geral escolhida, mas pode resultar em failover automático para a nota remota. Em qualquer caso, nenhum dado é perdido porque o controlador que está tendo a falha não reconheceu a operação de gravação.</block>
  <block id="886174de078cee4595eb8a8d07f81703" category="paragraph">Uma falha de conectividade local a local que bloqueia a replicação do NVRAM para nós remotos é uma situação mais complicada. As gravações não são mais replicadas nos nós remotos, criando uma possibilidade de perda de dados se ocorrer um erro catastrófico em um controlador. Mais importante ainda, tentar fazer failover para um nó diferente durante essas condições resulta em perda de dados.</block>
  <block id="790ec042c9b89dac2390ea81b9c29a51" category="paragraph">O fator de controle é se o NVRAM está sincronizado. Se o NVRAM estiver sincronizado, o failover de nó para nó será seguro para prosseguir sem o risco de perda de dados. Em uma configuração do MetroCluster, se o NVRAM e os plexos agregados subjacentes estiverem sincronizados, é seguro prosseguir com o switchover sem o risco de perda de dados.</block>
  <block id="3d936bb059b98a2fc7c177d20eb755c9" category="paragraph">O ONTAP não permite um failover ou switchover quando os dados estão fora de sincronia, a menos que o failover ou switchover seja forçado. Forçar uma alteração de condições desta forma reconhece que os dados podem ser deixados para trás no controlador original e que a perda de dados é aceitável.</block>
  <block id="3d37a3a8ed77bebc986238aedccecbc9" category="paragraph">Os bancos de dados são especialmente vulneráveis à corrupção se um failover ou switchover for forçado porque os bancos de dados mantêm caches internos maiores de dados no disco. Se ocorrer um failover forçado ou switchover, as alterações anteriormente confirmadas serão efetivamente descartadas. O conteúdo da matriz de armazenamento salta efetivamente para trás no tempo, e o estado do cache do banco de dados não reflete mais o estado dos dados no disco.</block>
  <block id="7ad23b7fa394c8666b132d78a58b1987" category="paragraph">Para proteger aplicativos contra essa situação, o ONTAP permite que volumes sejam configurados para proteção especial contra falha do NVRAM. Quando acionado, esse mecanismo de proteção resulta em um volume entrando em um estado chamado NVFAIL. Esse estado resulta em erros de e/S que causam o desligamento de um aplicativo para que eles não usem dados obsoletos. Os dados não devem ser perdidos porque quaisquer gravações reconhecidas ainda estão presentes no sistema de armazenamento e, com bancos de dados, quaisquer dados de transações confirmadas devem estar presentes nos logs.</block>
  <block id="99259586124503e22927506a7ed3738d" category="paragraph">As próximas etapas usuais são para que um administrador desligue totalmente os hosts antes de colocar manualmente os LUNs e volumes novamente on-line. Embora essas etapas possam envolver algum trabalho, essa abordagem é a maneira mais segura de garantir a integridade dos dados. Nem todos os dados exigem essa proteção, e é por isso que o comportamento do NVFAIL pode ser configurado volume a volume.</block>
  <block id="13fbc5a220fe8007dcaea69217bba134" category="paragraph">A opção mais segura para forçar um switchover com um cluster de aplicativos (incluindo VMware, Oracle RAC e outros) que é distribuído entre locais é especificando<block ref="71e644310ff0f1164d905d6e80174023" prefix=" " category="inline-code"></block> na linha de comando. Essa opção está disponível como uma medida de emergência para garantir que todos os dados em cache sejam limpos. Se um host estiver usando recursos de armazenamento localizados originalmente no local afetado por desastre, ele receberá erros de e/S ou um <block ref="a3c6541ac12f1f06a81cc9b03e6bd094" prefix="(" category="inline-code"></block>erro de identificador de arquivo obsoleto ). Os bancos de dados Oracle falham e os sistemas de arquivos ficam totalmente offline ou mudam para o modo somente leitura.</block>
  <block id="dc6683d37e50abd82911fa91c036fbb2" category="paragraph">Após a conclusão do switchover, o<block ref="6b0a5ec5ecf08db5d4b32d860214d098" prefix=" " category="inline-code"></block> sinalizador precisa ser limpo e os LUNs precisam ser colocados on-line. Depois de concluir esta atividade, a base de dados pode ser reiniciada. Essas tarefas podem ser automatizadas para reduzir o rto.</block>
  <block id="a2626552f293b2377efe829e69d14daa" category="section-title">dr-force-nvfail</block>
  <block id="f0cc4bbe3d196251009dbe9f0ac42ffc" category="paragraph">Como medida geral de segurança, defina o<block ref="a2626552f293b2377efe829e69d14daa" prefix=" " category="inline-code"></block> sinalizador em todos os volumes que possam ser acessados de um local remoto durante operações normais, o que significa que são atividades usadas antes do failover. O resultado desta definição é que os volumes remotos selecionados ficam indisponíveis quando entram<block ref="6b0a5ec5ecf08db5d4b32d860214d098" prefix=" " category="inline-code"></block> durante um switchover. Após a conclusão do switchover, o<block ref="6b0a5ec5ecf08db5d4b32d860214d098" prefix=" " category="inline-code"></block> sinalizador deve ser limpo e os LUNs devem ser colocados on-line. Depois de concluir estas atividades, as aplicações podem ser reiniciadas. Essas tarefas podem ser automatizadas para reduzir o rto.</block>
  <block id="5f6aa76cc0fe886c07f242f921486ef7" category="paragraph">O resultado é como usar a<block ref="71e644310ff0f1164d905d6e80174023" prefix=" " category="inline-code"></block> bandeira para switchovers manuais. No entanto, o número de volumes afetados pode ser limitado apenas aos volumes que devem ser protegidos de aplicativos ou sistemas operacionais com caches obsoletos.</block>
  <block id="4df566a29b44806612369c0c1f67521b" category="paragraph">Há dois requisitos essenciais para um ambiente que não é usado<block ref="a2626552f293b2377efe829e69d14daa" prefix=" " category="inline-code"></block> em volumes de aplicações:</block>
  <block id="aaf1cc67bd88c39a71e691d413ded49f" category="list-text">Um switchover forçado não deve ocorrer mais de 30 segundos após a perda do local principal.</block>
  <block id="7f9cc623e2a11875714cf4bc64f148fd" category="list-text">Um switchover não deve ocorrer durante as tarefas de manutenção ou quaisquer outras condições em que os plexos SyncMirror ou a replicação NVRAM estejam fora de sincronia. O primeiro requisito pode ser atendido usando o software tiebreaker configurado para executar um switchover em 30 segundos após uma falha no local. Esse requisito não significa que o switchover deve ser executado dentro de 30 segundos após a deteção de uma falha no local. Isso significa que não é mais seguro forçar uma mudança se tiverem decorrido 30 segundos desde que um local foi confirmado como operacional.</block>
  <block id="0929cc8043c21dcf0163f06424677ede" category="paragraph">O segundo requisito pode ser parcialmente atendido desativando todos os recursos de switchover automatizado quando a configuração do MetroCluster estiver fora de sincronia. Uma opção melhor é ter uma solução de desempate que possa monitorar a integridade da replicação do NVRAM e dos plexes do SyncMirror. Se o cluster não estiver totalmente sincronizado, o desempate não deverá acionar um switchover.</block>
  <block id="a168430c68d0310385371eabe149a118" category="paragraph">O software MCTB da NetApp não consegue monitorizar o estado da sincronização, pelo que deve ser desativado quando o MetroCluster não está sincronizado por qualquer motivo. O ClusterLion inclui recursos de monitoramento NVRAM e monitoramento Plex e pode ser configurado para não acionar o switchover, a menos que o sistema MetroCluster seja confirmado como totalmente sincronizado.</block>
  <block id="e98a692d783d8d778aab49ed4c55e214" category="doc">Proteção contra falha do local: NVRAM e MetroCluster</block>
  <block id="186577daf29184ed8a55cf899ba2979c" category="paragraph">A MetroCluster estende a proteção de dados da NVRAM das seguintes maneiras:</block>
  <block id="679f5a5873d7d3378cf4b3035fd5cb13" category="list-text">Em uma configuração de dois nós, os dados do NVRAM são replicados usando os ISLs (Inter-Switch Links) para o parceiro remoto.</block>
  <block id="00bec98f52b9151dd2e0c760becd4ca8" category="list-text">Em uma configuração de par de HA, os dados do NVRAM são replicados para o parceiro local e para um parceiro remoto.</block>
  <block id="94deccfbf8f798c1661000b27a568b18" category="list-text">Uma gravação não é reconhecida até que seja replicada para todos os parceiros. Essa arquitetura protege a e/S em trânsito contra falhas do local replicando dados do NVRAM para um parceiro remoto. Este processo não está envolvido com a replicação de dados no nível da unidade. A controladora que detém os agregados é responsável pela replicação de dados por gravação em ambos os plexos no agregado, mas ainda deve haver proteção contra perda de e/S em trânsito em caso de perda do local. Os dados replicados do NVRAM só serão usados se um controlador do parceiro precisar assumir o controle de uma controladora com falha.</block>
  <block id="996aa1ed8a906e55c7f157a1643021b7" category="section-title">Proteção contra falhas no local e no compartimento: SyncMirror e plexos</block>
  <block id="1c114a932963683e04dc7dece97c15c9" category="paragraph">O SyncMirror é uma tecnologia de espelhamento que aprimora, mas não substitui, o RAID DP ou o RAID-teC. Ele espelha o conteúdo de dois grupos RAID independentes. A configuração lógica é a seguinte:</block>
  <block id="b4b4f1d65cb5f1370402220b00584e79" category="list-text">As unidades são configuradas em dois pools com base no local. Um pool é composto por todas as unidades no local A, e o segundo pool é composto por todas as unidades no local B..</block>
  <block id="418f0763b76bff8e324f1afdd5456b49" category="list-text">Um pool comum de armazenamento, conhecido como agregado, é criado com base em conjuntos espelhados de grupos RAID. Um número igual de unidades é extraído de cada local. Por exemplo, um agregado SyncMirror de 20 unidades seria composto por 10 unidades do local A e 10 unidades do local B..</block>
  <block id="51bf74357f742acfa0a7cd11ce52ed7f" category="list-text">Cada conjunto de unidades em um determinado local é configurado automaticamente como um ou mais grupos RAID DP ou RAID-teC totalmente redundantes, independentemente do uso do espelhamento. Esse uso de RAID por baixo do espelhamento fornece proteção de dados mesmo após a perda de um site.</block>
  <block id="8a35ad1e53533c7a3a8ff427bda0deb2" category="paragraph"><block ref="8a35ad1e53533c7a3a8ff427bda0deb2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="abf64dbc3ac20af1b4a30150a016ca58" category="paragraph">A figura acima ilustra um exemplo de configuração do SyncMirror. Um agregado de 24 unidades foi criado na controladora com 12 unidades de um compartimento alocado no local A e 12 unidades de um compartimento alocado no local B. as unidades foram agrupadas em dois grupos RAID espelhados. RAID grupo 0 inclui um Plex de 6 unidades no local Um espelhado para um Plex de 6 unidades no local B. da mesma forma, RAID grupo 1 inclui um Plex de 6 unidades no local Um espelhado para um Plex de 6 unidades no local B.</block>
  <block id="d9945e1dbadc87ba8e52a5e69376005c" category="paragraph">O SyncMirror normalmente é usado para fornecer espelhamento remoto com sistemas MetroCluster, com uma cópia dos dados em cada local. Ocasionalmente, ele tem sido usado para fornecer um nível extra de redundância em um único sistema. Em particular, ele fornece redundância em nível de prateleira. Um compartimento de unidades já contém fontes de alimentação duplas e controladores e é, no geral, pouco mais do que chapas metálicas, mas em alguns casos, a proteção extra pode ser garantida. Por exemplo, um cliente da NetApp implantou o SyncMirror para uma plataforma móvel de análise em tempo real usada durante testes automotivos. O sistema foi separado em dois racks físicos fornecidos com alimentação de energia independente e sistemas UPS independentes.</block>
  <block id="f3495a1e6cf563a617c71164f3b11ca3" category="section-title">Falha de redundância: NVFAIL</block>
  <block id="c7474a3ed1a224804e4741a256bdd953" category="paragraph">Como discutido anteriormente, uma gravação não é reconhecida até que ela tenha sido registrada no NVRAM local e no NVRAM em pelo menos um outro controlador. Essa abordagem garante que uma falha de hardware ou falha de energia não resulte na perda de e/S em trânsito Se o NVRAM local falhar ou a conectividade com outros nós falhar, os dados não serão mais espelhados.</block>
  <block id="4774101e81ea03c43fe20e0d7f2d21d1" category="paragraph">O fator de controle é se o NVRAM está sincronizado. Se o NVRAM estiver sincronizado, o failover de nó para nó será seguro para prosseguir sem risco de perda de dados. Em uma configuração do MetroCluster, se o NVRAM e os plexos agregados subjacentes estiverem sincronizados, é seguro prosseguir com o switchover sem risco de perda de dados.</block>
  <block id="03e97c023521445cd70307afabdcf0d5" category="paragraph">Bancos de dados e outros aplicativos ficam especialmente vulneráveis à corrupção se um failover ou switchover for forçado, porque eles mantêm caches internos maiores de dados no disco. Se ocorrer um failover forçado ou switchover, as alterações anteriormente confirmadas serão efetivamente descartadas. O conteúdo da matriz de armazenamento salta efetivamente para trás no tempo, e o estado do cache não reflete mais o estado dos dados no disco.</block>
  <block id="ff7a32ed70b7df57dd29a3ed75e8c787" category="paragraph">Para evitar essa situação, o ONTAP permite que os volumes sejam configurados para proteção especial contra falha do NVRAM. Quando acionado, esse mecanismo de proteção resulta em um volume entrando em um estado chamado NVFAIL. Esse estado resulta em erros de e/S que causam uma falha no aplicativo. Esta falha faz com que os aplicativos sejam desligados para que eles não usem dados obsoletos. Os dados não devem ser perdidos porque quaisquer dados de transação confirmados devem estar presentes nos logs. As próximas etapas usuais são para que um administrador desligue totalmente os hosts antes de colocar manualmente os LUNs e volumes novamente on-line. Embora essas etapas possam envolver algum trabalho, essa abordagem é a maneira mais segura de garantir a integridade dos dados. Nem todos os dados exigem essa proteção, e é por isso que o comportamento do NVFAIL pode ser configurado volume a volume.</block>
  <block id="637d4b37868fb7825461df6edd674158" category="section-title">Pares DE HA e MetroCluster</block>
  <block id="9d8738f531e6c6a809ba66315beaa2f4" category="paragraph">O MetroCluster está disponível em duas configurações: Dois nós e par de HA. A configuração de dois nós se comporta da mesma forma que um par de HA em relação ao NVRAM. Em caso de falha repentina, o nó do parceiro pode repetir dados do NVRAM para tornar as unidades consistentes e garantir que nenhuma gravação reconhecida tenha sido perdida.</block>
  <block id="936f4311b16ee4dc74a5564892f8976d" category="paragraph">A configuração de par de HA replica NVRAM também para o nó do parceiro local. Uma simples falha do controlador resulta em uma repetição do NVRAM no nó do parceiro, como é o caso de um par de HA autônomo sem MetroCluster. Em caso de perda súbita total do local, o local remoto também tem o NVRAM necessário para tornar as unidades consistentes e começar a fornecer dados.</block>
  <block id="83b6c3c3018b913ecf1aca67e0daa35e" category="paragraph">Um aspeto importante do MetroCluster é que os nós remotos não têm acesso aos dados do parceiro em condições operacionais normais. Cada site funciona essencialmente como um sistema independente que pode assumir a personalidade do site oposto. Esse processo é conhecido como switchover e inclui um switchover planejado no qual as operações do local são migradas sem interrupções para o local oposto. Ele também inclui situações não planejadas em que um local é perdido e um switchover manual ou automático é necessário como parte da recuperação de desastres.</block>
  <block id="58504b36cfdfd10d5f2802d7b943a379" category="section-title">Comutação e comutação</block>
  <block id="d505751d1708fb5d57b0e23d089507a9" category="paragraph">Os termos switchover e switchback referem-se ao processo de transição de volumes entre controladores remotos em uma configuração do MetroCluster. Este processo aplica-se apenas aos nós remotos. Quando o MetroCluster é usado em uma configuração de quatro volumes, o failover de nó local é o mesmo processo de aquisição e giveback descrito anteriormente.</block>
  <block id="1127608e73df5ede22b149c8f19fc860" category="section-title">Comutação planejada e switchback</block>
  <block id="a6733335678588619c977608e891e54e" category="paragraph">Um switchover planejado ou switchback é semelhante a um takeover ou giveback entre nós. O processo tem várias etapas e pode parecer exigir vários minutos, mas o que está realmente acontecendo é uma transição graciosa multifásica de recursos de armazenamento e rede. O momento em que as transferências de controle ocorrem muito mais rapidamente do que o tempo necessário para que o comando completo seja executado.</block>
  <block id="4bb5647dcff332f0b53819ecd631303c" category="paragraph">A principal diferença entre o takeover/giveback e o switchover/switchback está com o efeito na conectividade FC SAN. Com a takeover local/giveback, um host sofre a perda de todos os caminhos FC para o nó local e conta com o MPIO nativo para mudar para caminhos alternativos disponíveis. As portas não são realocadas. Com o switchover e o switchback, as portas de destino FC virtual nos controladores fazem a transição para o outro local. Eles efetivamente deixam de existir na SAN por um momento e, em seguida, reaparecem em um controlador alternativo.</block>
  <block id="0ba902ec3f6ce91c2e801715bb8b96fa" category="section-title">Tempos limite do SyncMirror</block>
  <block id="9c8a1814b60b84d1aa68fa7bba69138b" category="paragraph">O SyncMirror é uma tecnologia de espelhamento ONTAP que fornece proteção contra falhas nas shelves. Quando as gavetas são separadas à distância, o resultado é a proteção de dados remota.</block>
  <block id="68cf36f65a7e56ff3b6c0894be3ed9e8" category="paragraph">O SyncMirror não fornece espelhamento síncrono universal. O resultado é uma melhor disponibilidade. Alguns sistemas de storage usam espelhamento constante de tudo ou nada, às vezes chamado de modo domino. Essa forma de espelhamento é limitada no aplicativo porque toda atividade de gravação deve cessar se a conexão com o local remoto for perdida. Caso contrário, uma escrita existiria em um site, mas não no outro. Normalmente, esses ambientes são configurados para colocar LUNs off-line se a conetividade site-a-site for perdida por mais de um curto período (como 30 segundos).</block>
  <block id="84ad4c21def9c355e80ef250d910bfa2" category="paragraph">Este comportamento é desejável para um pequeno subconjunto de ambientes. No entanto, a maioria dos aplicativos exige uma solução que ofereça replicação síncrona garantida em condições operacionais normais, mas com a capacidade de suspender a replicação. Uma perda completa de conetividade local a local é frequentemente considerada uma situação de quase desastre. Normalmente, esses ambientes são mantidos on-line e fornecem dados até que a conectividade seja reparada ou uma decisão formal seja tomada para encerrar o ambiente para proteger os dados. Um requisito para o desligamento automático do aplicativo puramente por causa de falha de replicação remota é incomum.</block>
  <block id="e3bd381a7bbaee6c741aee230972acf4" category="paragraph">O SyncMirror dá suporte aos requisitos de espelhamento síncrono com a flexibilidade de um tempo limite. Se a conetividade com o telecomando e/ou Plex for perdida, um temporizador de 30 segundos começa a contagem decrescente. Quando o contador atinge 0, o processamento de e/S de escrita é retomado utilizando os dados locais. A cópia remota dos dados é utilizável, mas fica congelada no tempo até que a conetividade seja restaurada. A ressincronização utiliza snapshots em nível agregado para retornar o sistema ao modo síncrono o mais rápido possível.</block>
  <block id="0c919cd6511df6d83b811234b0448374" category="paragraph">Notavelmente, em muitos casos, esse tipo de replicação universal do modo dominó tudo ou nada é melhor implementado na camada de aplicativo. Por exemplo, o Oracle DataGuard inclui o modo de proteção máximo, o que garante replicação de longa instância em todas as circunstâncias. Se o link de replicação falhar por um período que excede um tempo limite configurável, os bancos de dados serão desligados.</block>
  <block id="ba92cbe464cfee8aa12c41e6aecd1071" category="section-title">Switchover automático sem supervisão com MetroCluster conectado à malha</block>
  <block id="515094655d10031595da776c94b3d710" category="paragraph">O switchover automático sem supervisão (AUSO) é um recurso de MetroCluster anexado a malha que fornece uma forma de HA entre os locais. Como discutido anteriormente, o MetroCluster está disponível em dois tipos: Um único controlador em cada local ou um par de HA em cada local. A principal vantagem da opção HA é que o desligamento planejado ou não planejado do controlador ainda permite que todas as I/o sejam locais. A vantagem da opção de nó único é reduzir os custos, a complexidade e a infraestrutura.</block>
  <block id="29d4da26af76b66db3a172a39edf8367" category="paragraph">O principal valor do AUSO é melhorar os recursos de HA dos sistemas MetroCluster conectados a malha. Cada local monitora a integridade do local oposto e, se nenhum nó permanecer para fornecer dados, o AUSO resulta em switchover rápido. Essa abordagem é especialmente útil nas configurações do MetroCluster com apenas um nó único por local, pois aproxima a configuração de um par de HA em termos de disponibilidade.</block>
  <block id="6b3a5f7923b2d803fd3b28c255fef420" category="paragraph">A AUSO não pode oferecer monitoramento abrangente no nível de um par de HA. Um par de HA pode fornecer disponibilidade extremamente alta porque inclui dois cabos físicos redundantes para comunicação direta de nó a nó. Além disso, ambos os nós de um par de HA têm acesso ao mesmo conjunto de discos em loops redundantes, entregando outra rota para um nó monitorar a integridade de outro.</block>
  <block id="da87dad268507a3523bc38275b1d3fbc" category="paragraph">Os clusters do MetroCluster existem em locais para os quais a comunicação nó a nó e o acesso ao disco dependem da conectividade de rede local a local. A capacidade de monitorar o batimento cardíaco do restante do cluster é limitada. AUSO tem que discriminar entre uma situação em que o outro site está realmente inativo, em vez de indisponível devido a um problema de rede.</block>
  <block id="e8e4f55c4203e7fb24d4543a7a0f65da" category="paragraph">Como resultado, uma controladora em um par de HA pode solicitar um takeover se detetar uma falha na controladora que ocorreu por um motivo específico, como pânico do sistema. Ele também pode solicitar uma aquisição se houver uma perda completa de conetividade, às vezes conhecida como batimento cardíaco perdido.</block>
  <block id="91aa4ce36cb243281f3777d66c8f89e0" category="paragraph">Um sistema MetroCluster só pode efetuar uma mudança automática em segurança quando é detetada uma avaria específica no local original. Além disso, a controladora que assume a propriedade do sistema de storage deve ser capaz de garantir que os dados do disco e do NVRAM estejam sincronizados. O controlador não pode garantir a segurança de uma mudança apenas porque perdeu o Contato com o local de origem, que ainda poderia estar operacional. Para obter opções adicionais para automatizar um switchover, consulte as informações sobre a solução MetroCluster tiebreaker (MCTB) na próxima seção.</block>
  <block id="8e7705fe4aea384d7f6a99ab6dc0f408" category="section-title">Desempate MetroCluster com MetroCluster conectado à malha</block>
  <block id="897b7698cb343dbc3452e845705ab0f3" category="inline-link">Desempate de NetApp MetroCluster</block>
  <block id="9c093f14319e8253b8c9b37290597239" category="inline-link">Site de suporte da NetApp</block>
  <block id="6f29b1849750ceee5eb7f6f02d100e6b" category="paragraph">O switchover automático com AUSO também é compatível com o MCTB. O AUSO reage muito rapidamente porque foi concebido para detetar eventos de falha específicos e, em seguida, invocar o switchover apenas quando os plexos NVRAM e SyncMirror estão em sincronia.</block>
  <block id="6f5c7ae76595eca2ca83c5dd30cd8e9f" category="paragraph">Em contraste, o desempate está localizado remotamente e, portanto, deve esperar que um temporizador decorra antes de declarar um local morto. O tiebreaker eventualmente deteta o tipo de falha de controladora coberta pelo AUSO, mas, em geral, a AUSO já iniciou o switchover e possivelmente concluiu o switchover antes que o tiebreaker atue. O segundo comando de comutação resultante vindo do tiebreaker seria rejeitado.</block>
  <block id="7110edd59c3d0f25a584723f6fea26a0" category="paragraph">Além disso, o MCTB pode não resolver um desastre contínuo que leva à seguinte sequência de eventos:</block>
  <block id="93d732b784eaf1a323f191e75c10f233" category="list-text">A conetividade entre locais é interrompida durante mais de 30 segundos.</block>
  <block id="81d4275cc3534a9fa8cfdcdb5172eb94" category="list-text">O tempo de replicação do SyncMirror expirou e as operações continuam no local principal, deixando a réplica remota obsoleta.</block>
  <block id="44441f68631008a941ce92e985131ff9" category="list-text">O site principal é perdido. O resultado é a presença de alterações não replicadas no site principal. Uma mudança pode então ser indesejável por uma série de razões, incluindo o seguinte:</block>
  <block id="499527dd40fad77b119b8b33c99cd614" category="list-text">Dados críticos podem estar presentes no site principal e esses dados podem eventualmente ser recuperáveis. Um switchover que permitiu que o aplicativo continuasse operando descartaria efetivamente esses dados críticos.</block>
  <block id="86de4e3737e3d871dacf8ffef353fc31" category="list-text">Um aplicativo no site que estava usando recursos de armazenamento no site principal no momento da perda do site pode ter dados em cache. Um switchover introduziria uma versão obsoleta dos dados que não corresponde ao cache.</block>
  <block id="dbb2a01afe28c8310daf781bb80b795f" category="list-text">Um sistema operacional no site sobrevivente que estava usando recursos de armazenamento no site principal no momento da perda do site pode ter dados em cache. Um switchover introduziria uma versão obsoleta dos dados que não corresponde ao cache. A opção mais segura é configurar o tiebreaker para enviar um alerta se ele detetar falha no local e, em seguida, fazer com que uma pessoa tome uma decisão sobre se deve forçar um switchover. Os aplicativos e/ou sistemas operacionais podem precisar primeiro ser desligados para limpar os dados armazenados em cache. Além disso, as configurações NVFAIL podem ser usadas para adicionar mais proteção e ajudar a simplificar o processo de failover.</block>
  <block id="ec6b0ea9c511479c118aa0f028f6519d" category="section-title">Mediador ONTAP com MetroCluster IP</block>
  <block id="991d7d7d7388ccdd87c65ca09aa804f2" category="paragraph">Um MetroCluster conectado à malha tem acesso direto aos dispositivos de storage no local oposto. Isso permite que um controlador MetroCluster monitore a integridade dos outros controladores lendo dados de batimentos cardíacos das unidades. Isso permite que um controlador reconheça a falha de outro controlador e execute um switchover.</block>
  <block id="db2e932a11478bcf14c75d38e8b9a170" category="paragraph">Em contraste, a arquitetura IP do MetroCluster roteia todas as I/o exclusivamente através da conexão controlador-controlador; não há acesso direto a dispositivos de armazenamento no local remoto. Isso limita a capacidade de um controlador detetar falhas e executar um switchover. O Mediador ONTAP é, portanto, necessário como um dispositivo de desempate para detetar a perda do local e executar automaticamente um switchover.</block>
  <block id="8004e6d63f487a456290225b74768a6c" category="section-title">Terceiro site virtual com ClusterLion</block>
  <block id="f1d5a7305654a402a719675fbec810e7" category="paragraph">O ClusterLion é um dispositivo avançado de monitoramento MetroCluster que funciona como um terceiro site virtual. Essa abordagem permite que o MetroCluster seja implantado com segurança em uma configuração de dois locais com recurso de switchover totalmente automatizado. Além disso, o ClusterLion pode executar um monitor de nível de rede adicional e executar operações pós-switchover. A documentação completa está disponível no ProLion.</block>
  <block id="f8aae92ec17ec82868ef9ffc767dbd03" category="list-text">Os dispositivos ClusterLion monitoram a integridade dos controladores com cabos Ethernet e seriais conetados diretamente.</block>
  <block id="c5f8963a91e3d8e7ac0abda2eab9f17d" category="list-text">Os dois aparelhos estão conetados entre si com conexões sem fio redundantes de 3G GHz.</block>
  <block id="24de16a13a1b584832d19117982cbfa6" category="list-text">A alimentação para o controlador ONTAP é direcionada através de relés internos. No caso de uma falha no local, o ClusterLion, que contém um sistema interno de UPS, corta as conexões de energia antes de chamar uma mudança. Este processo garante que nenhuma condição de divisão cerebral ocorra.</block>
  <block id="b2bcd3c3c555e2e4f27d453de4e0f06d" category="list-text">O ClusterLion executa um switchover dentro do tempo limite de 30 segundos do SyncMirror ou não.</block>
  <block id="390fb5f827a3fbcdc7d05e6e7db03223" category="list-text">O ClusterLion não executa uma mudança a menos que os estados dos plexes NVRAM e SyncMirror estejam sincronizados.</block>
  <block id="f322f850d55e87946f9660e4ccb1bbb6" category="list-text">Como o ClusterLion só executa um switchover se o MetroCluster estiver totalmente sincronizado, o NVFAIL não é necessário. Essa configuração permite que ambientes que abrangem o local, como um Oracle RAC estendido, permaneçam on-line, mesmo durante um switchover não planejado.</block>
  <block id="5c132e05fb0e306f56955603619de359" category="list-text">O suporte inclui MetroCluster conectado à malha e MetroCluster IP</block>
  <block id="0694b4972669f201ca85f9427a230208" category="doc">O MetroCluster pode ser usado em 3 configurações diferentes</block>
  <block id="948676ffa8073153cbe404795950ad85" category="list-text">Pares HA com conetividade IP</block>
  <block id="ef012b81fd45a95681a584a59f8df77e" category="list-text">Pares DE HA com conectividade FC</block>
  <block id="6ffec869ba36dff4e093b5ed8bac798a" category="list-text">Controladora única com conectividade FC</block>
  <block id="38653f1dd04b13c5276f4f4a82e8506f" category="admonition">O termo 'conetividade' refere-se à conexão de cluster usada para replicação entre sites. Não se refere aos protocolos de host. Todos os protocolos do lado do host são suportados como de costume em uma configuração MetroCluster, independentemente do tipo de conexão usada para comunicação entre clusters.</block>
  <block id="4767099b22895a8101a1cba45d8cf6e9" category="section-title">IP MetroCluster</block>
  <block id="adc397d87c1a7827f2df9fdd362d5ff7" category="paragraph">A configuração MetroCluster IP de par de HA usa dois ou quatro nós por local. Essa opção de configuração aumenta a complexidade e os custos em relação à opção de dois nós, mas oferece um benefício importante: A redundância intrasite. Uma simples falha do controlador não requer acesso aos dados na WAN. O acesso aos dados permanece local por meio do controlador local alternativo.</block>
  <block id="c15560f2ae5432223c591c5f5d9db5c1" category="paragraph">A maioria dos clientes está escolhendo a conetividade IP porque os requisitos de infraestrutura são mais simples. No passado, a conetividade entre locais de alta velocidade era geralmente mais fácil de provisionar usando switches FC e fibra escura, mas hoje em dia os circuitos IP de baixa latência e alta velocidade estão mais prontamente disponíveis.</block>
  <block id="b28c5a429800ea9669a191a402a72b49" category="paragraph">A arquitetura também é mais simples porque as únicas conexões entre locais são para os controladores. No Metroclusters FC SAN conetados, um controlador grava diretamente nas unidades no local oposto e, portanto, requer conexões, switches e bridges SAN adicionais. Em contraste, um controlador em uma configuração IP grava nas unidades opostas através do controlador.</block>
  <block id="457b0075e8f0333975a8e2aaeaceb149" category="inline-link">Arquitetura e design da solução IP da MetroCluster</block>
  <block id="82aa44c8aa5ebe78f1496c8fc80cb954" category="paragraph">Para obter informações adicionais, consulte a documentação oficial do ONTAP e<block ref="03a3c76178d2d43147a2756857a0985e" category="inline-link-rx"></block>.</block>
  <block id="0d2d438a72f6c558744351265fa49a62" category="section-title">MetroCluster conectados a FC de par HA SAN</block>
  <block id="3e9133ff590581b29a911d9631ab1737" category="paragraph">A configuração de MetroCluster FC de par de HA usa dois ou quatro nós por local. Essa opção de configuração aumenta a complexidade e os custos em relação à opção de dois nós, mas oferece um benefício importante: A redundância intrasite. Uma simples falha do controlador não requer acesso aos dados na WAN. O acesso aos dados permanece local por meio do controlador local alternativo.</block>
  <block id="4bc2926f030255369db3e4435de5c774" category="paragraph">Algumas infraestruturas multisite não foram desenvolvidas para operações ativas-ativas, mas são usadas mais como local principal e local de recuperação de desastres. Nesta situação, uma opção MetroCluster de par de HA é geralmente preferível pelas seguintes razões:</block>
  <block id="5f49f48dd22b405a813e2ef7cc02e9f8" category="list-text">Embora um cluster de dois nós MetroCluster seja um sistema de HA, a falha inesperada de uma controladora ou a manutenção planejada exige que os serviços de dados fiquem online no local oposto. Se a conetividade de rede entre locais não puder suportar a largura de banda necessária, o desempenho é afetado. A única opção seria também falhar sobre os vários sistemas operacionais host e serviços associados ao site alternativo. O cluster de MetroCluster de par de HA elimina esse problema porque a perda de uma controladora resulta em failover simples no mesmo local.</block>
  <block id="0ce798a4f2e77d6aa1a6e0d718fa8e98" category="list-text">Algumas topologias de rede não são projetadas para acesso entre sites, mas usam sub-redes diferentes ou SANs FC isoladas. Nesses casos, o cluster MetroCluster de dois nós não funciona mais como um sistema de HA porque o controlador alternativo não pode fornecer dados aos servidores no local oposto. A opção MetroCluster de par de HA é necessária para fornecer redundância completa.</block>
  <block id="098fa44ef37572e0f8ea717199ac72e6" category="list-text">Se uma infraestrutura de dois locais for vista como uma única infraestrutura altamente disponível, a configuração de dois nós do MetroCluster será adequada. No entanto, se o sistema precisar funcionar por um longo período de tempo após a falha do local, é preferível usar um par de HA porque ele continua fornecendo HA em um único local.</block>
  <block id="ea8bb3e5a357ca97851352f6944342c9" category="section-title">MetroCluster com conexão SAN FC de dois nós</block>
  <block id="b759079fef92c80eca80e7349bf84363" category="paragraph">A configuração do MetroCluster de dois nós usa apenas um nó por local. Esse design é mais simples do que a opção de par de HA, pois há menos componentes para configurar e manter. Ele também reduziu as demandas de infraestrutura em termos de cabeamento e switch FC. Finalmente, reduz custos.</block>
  <block id="bcf549481eb36a62594e938bca6a10bb" category="paragraph">O impactos óbvio desse projeto é que a falha do controlador em um único local significa que os dados estão disponíveis no local oposto. Esta restrição não é necessariamente um problema. Muitas empresas têm operações de data center multisite com redes estendidas, de alta velocidade e baixa latência, que funcionam essencialmente como uma única infraestrutura. Nesses casos, a versão de dois nós do MetroCluster é a configuração preferida. Sistemas de dois nós são usados atualmente em escala de petabyte por vários provedores de serviços.</block>
  <block id="78558542e724655ba80fc4879399f103" category="section-title">Recursos de resiliência do MetroCluster</block>
  <block id="5427d2eb91f25a425f13544e56fb12c4" category="paragraph">Não há pontos únicos de falha em uma solução MetroCluster:</block>
  <block id="6a988bf07e73bcbf69f62ce9724dd0f3" category="list-text">Cada controladora tem dois caminhos independentes para os compartimentos de unidades no local.</block>
  <block id="2c98a75e02c6e103b43724f02e99e393" category="list-text">Cada controladora tem dois caminhos independentes para o shelves de unidades no local remoto.</block>
  <block id="e18f703538cd1f5af3b9185eed57b49b" category="list-text">Cada controlador tem dois caminhos independentes para os controladores no local oposto.</block>
  <block id="800ec0ea85a62c2fb192ac2f79ee1d02" category="list-text">Na configuração de par de HA, cada controladora tem dois caminhos para seu parceiro local.</block>
  <block id="a3d7a569ad6ea771a0ad9b995619251b" category="paragraph">Em resumo, qualquer componente na configuração pode ser removido sem comprometer a capacidade do MetroCluster de fornecer dados. A única diferença em termos de resiliência entre as duas opções é que a versão do par de HA ainda é um sistema de storage de HA geral após uma falha do local.</block>
  <block id="c56ec9836fbbd9c0a426a40fc71c265c" category="paragraph">As tabelas de slot TCP são equivalentes a NFSv3 mm de profundidade de fila do adaptador de barramento do host (HBA). Essas tabelas controlam o número de operações NFS que podem ficar pendentes de uma só vez. O valor padrão é geralmente 16, o que é muito baixo para um desempenho ideal. O problema oposto ocorre em kernels Linux mais recentes, que podem aumentar automaticamente o limite da tabela de slots TCP para um nível que satura o servidor NFS com solicitações.</block>
  <block id="5270700baa50d07af667096293a27564" category="paragraph">Para um desempenho ideal e para evitar problemas de desempenho, ajuste os parâmetros do kernel que controlam as tabelas de slots TCP.</block>
  <block id="5b29db1d99e19013580fa375a5f87fa5" category="paragraph">Executar o<block ref="1a1e44f7a3390ed4647a7d5b7e8b08ed" prefix=" " category="inline-code"></block> comando e respeitar os seguintes parâmetros:</block>
  <block id="8821adf56df4952370cfaa57ccaac68d" category="paragraph">Todos os sistemas Linux devem incluir<block ref="c5f48b899461d4c2b9ddc0b24ea87744" prefix=" " category="inline-code"></block>, mas apenas alguns incluem<block ref="6f72acaebcb9a0de6696aaf3508a6144" prefix=" " category="inline-code"></block>. Ambos devem ser definidos para 128.</block>
  <block id="764a2caff05993fc0d3eff5de7b225e9" category="cell">Cuidado</block>
  <block id="3a954c4e5e8d5ac3af590651efc5a2cb" category="cell">A falha em definir esses parâmetros pode ter efeitos significativos no desempenho. Em alguns casos, o desempenho é limitado porque o sistema operacional linux não está emitindo e/S suficiente Em outros casos, as latências de e/S aumentam à medida que o sistema operacional linux tenta emitir mais e/S do que pode ser reparado.</block>
  <block id="1e207db9a7c8127a6c43c771b89254fb" category="paragraph">Por padrão, o ONTAP limita os tamanhos de e/S de NFS a 64K.</block>
  <block id="72d22e3b9af95e272859e64eb1d82df7" category="paragraph">A e/S aleatória com a maioria dos aplicativos e bancos de dados usa um tamanho de bloco muito menor que está bem abaixo do máximo 64K. A e/S de bloco grande geralmente é paralelizada, portanto o máximo de 64K GB também não é uma limitação para obter largura de banda máxima.</block>
  <block id="ebf61afddb34d070825eb696bea48813" category="paragraph">Existem algumas cargas de trabalho em que o máximo 64K cria uma limitação. Em particular, operações de um único processo, como operação de backup ou recuperação ou uma verificação de tabela completa de banco de dados, são executadas de forma mais rápida e eficiente se o banco de dados puder executar menos, mas maiores I/os. O tamanho ideal de manuseio de e/S para ONTAP é 256K.</block>
  <block id="b0a5b394f3a29e64573049cda19fbacc" category="paragraph">O tamanho máximo de transferência para um determinado SVM do ONTAP pode ser alterado da seguinte forma:</block>
  <block id="b070b82d66be7116d5fd6dfd8172351b" category="cell">Nunca diminua o tamanho máximo de transferência permitido no ONTAP abaixo do valor de rsize/wsize dos sistemas de arquivos NFS atualmente instalados. Isso pode criar pendências ou até mesmo corrupção de dados com alguns sistemas operacionais. Por exemplo, se os clientes NFS estiverem atualmente definidos em um rsize/wsize de 65536, o tamanho máximo de transferência do ONTAP poderá ser ajustado entre 65536 e 1048576 sem efeito porque os próprios clientes são limitados. Reduzir o tamanho máximo de transferência abaixo de 65536 pode danificar a disponibilidade ou os dados.</block>
  <block id="ace0bd0c1be3a9e17d9736d93e7a1da2" category="doc">QoS de IOPS</block>
  <block id="786ee59e0cdaa09335e12fea3a168653" category="paragraph">Especificamente, o aumento da adoção do storage all-flash possibilitou a consolidação de workloads. Os storage arrays que dependem de Mídia giratória costumavam dar suporte a apenas um número limitado de workloads de e/S com uso intenso de e/S devido aos recursos limitados de IOPS da tecnologia de unidade de rotação mais antiga. Um ou dois bancos de dados altamente ativos saturariam as unidades subjacentes muito antes que as controladoras de storage atingissem seus limites. Isso mudou. A capacidade de desempenho de um número relativamente pequeno de unidades SSD pode saturar até mesmo os controladores de armazenamento mais poderosos. Isso significa que todos os recursos das controladoras podem ser aproveitados sem o medo de colapso repentino da performance na medida em que picos de latência de Mídia giratórios.</block>
  <block id="270d79669200ef485add1ecc1833cc94" category="paragraph">Como exemplo de referência, um simples sistema HA AFF A800 de dois nós é capaz de atender a até um milhão de IOPS aleatórios antes que a latência suba acima de um milissegundo. Espera-se que muito poucas cargas de trabalho individuais alcancem tais níveis. A utilização total desse array de sistema AFF A800 envolverá o hospedar vários workloads e isso com segurança, garantindo a previsibilidade requer controles de QoS.</block>
  <block id="4dca0c3547523a2e5bd1b8d0e2ff8de5" category="paragraph">Há dois tipos de qualidade de serviço (QoS) no ONTAP: IOPS e largura de banda. Controles de QoS podem ser aplicados a SVMs, volumes, LUNs e arquivos.</block>
  <block id="3ea539ed2021ba46a3658039e8af419f" category="paragraph">Um controle de QoS de IOPS é obviamente baseado no total de IOPS de um determinado recurso, mas há vários aspetos da QoS de IOPS que podem não ser intuitivos. Alguns clientes inicialmente ficaram intrigados com o aparente aumento da latência quando um limite de IOPS é atingido. O aumento da latência é o resultado natural da limitação do IOPS. Logicamente, ele funciona de forma semelhante a um sistema de token. Por exemplo, se um determinado volume contendo datafiles tiver um limite de 10K IOPS, cada I/o que chegar deve receber primeiro um token para continuar o processamento. Desde que não mais de 10K tokens tenham sido consumidos em um determinado segundo, nenhum atraso está presente. Se as operações de e/S precisarem esperar para receber o token, essa espera aparecerá como latência adicional. Quanto mais difícil uma carga de trabalho ultrapassar o limite de QoS, mais tempo cada IO deve esperar na fila para que sua vez seja processada, o que parece ao usuário como maior latência.</block>
  <block id="34a96885dd7f4501920b13026e7f2cab" category="admonition">Tenha cuidado ao aplicar controles de QoS a dados de log de transação/refazer de banco de dados. Embora as demandas de desempenho do Registro de refazer sejam normalmente muito, muito mais baixas do que datafiles, a atividade do log de refazer é bursty. O IO acontece em breves pulsos, e um limite de QoS que parece apropriado para os níveis médios de e/S refazer pode ser muito baixo para os requisitos reais. O resultado pode ser limitações graves de desempenho, pois a QoS interage com cada sequência de log de refazer. Em geral, refazer e arquivar o log não deve ser limitado pela QoS.</block>
  <block id="c79dc76371299e08f4b4ebd609314ca4" category="section-title">QoS de largura de banda</block>
  <block id="b9d5c520039715de9b997c5a69f4aeaa" category="paragraph">Nem todos os tamanhos de e/S são iguais. Por exemplo, um banco de dados pode estar executando um grande número de leituras de blocos pequenos, o que resultaria no limite de IOPS ser atingido, mas os bancos de dados também podem estar executando uma operação de verificação de tabela completa que consistiria em um número muito pequeno de leituras de blocos grandes, consumindo uma quantidade muito grande de largura de banda, mas relativamente poucos IOPS.</block>
  <block id="4930ae83bb8dd5e539dc9f7e73c6d74c" category="paragraph">Da mesma forma, um ambiente VMware pode gerar um número muito alto de IOPS aleatório durante a inicialização, mas executaria um iOS menor, mas maior, durante um backup externo.</block>
  <block id="eabb5a523a77d4521c12622ee9388aa6" category="paragraph">Às vezes, o gerenciamento eficaz da performance exige limites de QoS de IOPS ou largura de banda, ou até mesmo ambos.</block>
  <block id="13dac55a5f26cefab26368ea5a67e29f" category="section-title">QoS mínima/garantida</block>
  <block id="68559688130772c84bb39b2a9ca2c2af" category="paragraph">Muitos clientes procuram uma solução que inclua QoS garantida, que é mais difícil de alcançar do que parece e é potencialmente um desperdício. Por exemplo, a colocação de bancos de dados 10 com uma garantia de 10K IOPS exige o dimensionamento de um sistema para um cenário em que todos os bancos de dados 10 estejam sendo executados simultaneamente a 10K IOPS, totalizando 100KK.</block>
  <block id="c0938f706c890ea85c86388391ffad22" category="paragraph">A melhor utilização para controles mínimos de QoS é proteger workloads críticos. Por exemplo, considere um controlador ONTAP com um máximo de IOPS possível de 500K K e uma combinação de workloads de produção e desenvolvimento. Você deve aplicar políticas máximas de QoS a workloads de desenvolvimento para impedir que qualquer banco de dados monopolize o controlador. Em seguida, você aplicaria políticas mínimas de QoS a workloads de produção para garantir que eles sempre tenham o IOPS necessário disponível quando necessário.</block>
  <block id="acdda1c20fb3985ce840929f7525c803" category="section-title">QoS adaptável</block>
  <block id="dd5bc58ed6ab031b170a409470d9a763" category="paragraph">QoS adaptável refere-se ao recurso ONTAP em que o limite de QoS é baseado na capacidade do objeto de storage. Raramente é usado com bancos de dados porque geralmente não há nenhum link entre o tamanho de um banco de dados e seus requisitos de desempenho. Bancos de dados grandes podem ser quase inertes, enquanto bancos de dados menores podem ser os mais intensivos em IOPS.</block>
  <block id="eb595833577352045f92d14ac4315ad2" category="paragraph">A QoS adaptável pode ser muito útil com armazenamentos de dados de virtualização, pois os requisitos de IOPS desses conjuntos de dados tendem a se correlacionar com o tamanho total do banco de dados. Um datastore mais recente contendo 1TB TB de arquivos VMDK provavelmente precisará de cerca de metade do desempenho como um datastore 2TB. A QoS adaptável permite que você aumente os limites de QoS automaticamente à medida que o armazenamento de dados se torna preenchido com dados.</block>
  <block id="a42c87064c284490a38efac4bf0b7f7f" category="paragraph">RAID 4, RAID 5, RAID 6, RAID DP e RAID-teC usam paridade para garantir que a falha da unidade não resulte na perda de dados. Essas opções de RAID oferecem uma utilização do storage muito melhor em comparação com o espelhamento, mas a maioria das implementações de RAID tem uma desvantagem que afeta as operações de gravação. A conclusão de uma operação de gravação em outras implementações de RAID pode exigir várias leituras de unidade para regenerar os dados de paridade, um processo comumente chamado de penalidade de RAID.</block>
  <block id="3cfcf9a3299db75df9aa0e024ebef965" category="paragraph">O ONTAP, no entanto, não incorre nessa penalidade de RAID. Isso ocorre devido à integração do NetApp WAFL (Write Anywhere File Layout) com a camada RAID. As operações de gravação são Unidas na RAM e preparadas como um stripe RAID completo, incluindo geração de paridade. O ONTAP não precisa executar uma leitura para concluir uma gravação, o que significa que o ONTAP e o WAFL evitam a penalidade de RAID. A performance de operações críticas à latência, como refazer o log, não é impedida, e as gravações aleatórias de arquivos de dados não incorrem em nenhuma penalidade de RAID resultante da necessidade de gerar novamente a paridade.</block>
  <block id="5ff9a871332f0f82f38d880b68a9874b" category="paragraph">Com relação à confiabilidade estatística, até mesmo o RAID DP oferece melhor proteção do que o espelhamento RAID. O principal problema é a demanda feita nas unidades durante uma reconstrução RAID. Com um conjunto RAID espelhado, o risco de perda de dados de uma unidade falhar durante a reconstrução para seu parceiro no conjunto RAID é muito maior do que o risco de uma falha de unidade tripla em um conjunto RAID DP.</block>
  <block id="92d0a1aef2134a70d5c0f0279dc22ec6" category="doc">Cópias Snapshot</block>
  <block id="0c47b4eb567b018e3d2e5882b88eaca9" category="paragraph">Os instantâneos de armazenamento são réplicas pontuais dos dados de destino. A implementação do ONTAP inclui a capacidade de definir várias políticas e armazenar até 1024 instantâneos por volume. Os snapshots no ONTAP economizam espaço. O espaço só é consumido à medida que o conjunto de dados original muda. Eles também são somente leitura. Um instantâneo pode ser excluído, mas não pode ser alterado.</block>
  <block id="7986a4827296ca9cd0b991ded9f8a10d" category="paragraph">Em alguns casos, os snapshots podem ser agendados diretamente no ONTAP. Em outros casos, softwares como o SnapCenter podem ser necessários para orquestrar operações de aplicativos ou sistemas operacionais antes de criar snapshots. Qualquer que seja a melhor abordagem para seu workload, uma estratégia de snapshot agressiva pode fornecer segurança dos dados por meio de acesso frequente e fácil a backups de tudo, desde LUNs de inicialização a bancos de dados essenciais.</block>
  <block id="8e52de0d4b03d5fe87dc88da09616c7f" category="inline-link-macro">aqui.</block>
  <block id="c4bf0f56feeec9a45e973768fbc4f47e" category="section-title">Snapshots à prova de violações</block>
  <block id="38fef959179f8d3eb79a68a5ce747bdc" category="paragraph">Isso garante que um intruso, um insider malicioso, ou mesmo um ataque de ransomware não seja capaz de comprometer os backups, mesmo que isso tenha resultado no acesso ao próprio sistema ONTAP. Quando combinado a uma programação de snapshot frequente, o resultado é uma proteção de dados extremamente poderosa com RPO muito baixo.</block>
  <block id="a1f41e52e9ddbd9f87ecd032c237b1c0" category="section-title">Replicação SnapMirror</block>
  <block id="18d315ae923785b3f9c5234724b0ab42" category="paragraph">Um segundo sistema também abre novas opções de segurança administrativa. Por exemplo, alguns clientes do NetApp segregam credenciais de autenticação para os sistemas de storage primário e secundário. Nenhum usuário administrativo tem acesso a ambos os sistemas, o que significa que um administrador mal-intencionado não pode excluir todas as cópias de dados.</block>
  <block id="500569e3cc0764260a592cb176921ca3" category="section-title">Máquinas virtuais de armazenamento</block>
  <block id="597cb258dd509add7cd999794c60d430" category="paragraph">Por exemplo, você pode configurar um SVM para workloads de produção críticos e um segundo SVM em um segmento de rede diferente para atividades de desenvolvimento. Dessa forma, você poderia restringir o acesso ao SVM de produção a certos administradores, enquanto concederia aos desenvolvedores um controle mais expansivo sobre os recursos de storage no SVM de desenvolvimento. Você também pode precisar fornecer um terceiro SVM para suas equipes financeiras e de RH para armazenar dados especialmente críticos apenas para os olhos.</block>
  <block id="7d0fc71fe28e011ca49b06214469d484" category="section-title">RBAC administrativo</block>
  <block id="4f0dae2ba2fd11c533349d6ade4f81de" category="paragraph">O ONTAP oferece controle de acesso baseado em funções (RBAC) avançado para logins administrativos. Alguns administradores podem precisar de acesso total ao cluster, enquanto outros podem precisar de acesso a determinados SVMs. O pessoal avançado do helpdesk pode precisar da capacidade de aumentar o tamanho dos volumes. O resultado é que você pode conceder aos usuários administrativos o acesso necessário para desempenhar suas responsabilidades de trabalho, e nada mais. Além disso, você pode proteger esses logins usando PKI de vários fornecedores, restringir o acesso apenas a chaves ssh e impor bloqueios de tentativa de login com falha.</block>
  <block id="722830ffc5e46dbe206670f85cd1d889" category="paragraph">A ONTAP e alguns outros produtos da NetApp agora oferecem suporte à autenticação multifator (MFA) usando diversos métodos. O resultado é que um nome de usuário/senha comprometidos por si só não é uma thread de segurança sem os dados do segundo fator, como um FOB ou um aplicativo de smartphone.</block>
  <block id="852741d2a7fb0a8a1a5dd748dbbd6734" category="section-title">API RBAC</block>
  <block id="bbbea5fec67f15424fa77aa563754c49" category="paragraph">A automação requer chamadas de API, mas nem todas as ferramentas exigem acesso administrativo completo. Para ajudar a proteger os sistemas de automação, o RBAC também está disponível no nível da API. Você pode limitar as contas de usuário de automação às chamadas de API necessárias. Por exemplo, o software de monitoramento não precisa alterar o acesso, ele só requer acesso de leitura. Os fluxos de trabalho que provisionam o storage não precisam da capacidade de excluir o storage.</block>
  <block id="37c43820ab88f1340855c30955eec330" category="section-title">Verificação multi-admin (MAV)</block>
  <block id="7604bad489eaec7e27d112c63d3e2936" category="paragraph">A autenticação multi "fator" pode ser levada ainda mais longe, exigindo que dois administradores diferentes, cada um com suas próprias credenciais, aprovem determinadas atividades. Isso inclui alterar permissões de login, executar comandos de diagnóstico e excluir dados.</block>
  <block id="6c92285fa6d3e827b198d120ea3ac674" category="inline-link-macro">aqui</block>
  <block id="86bcf99dbc3944da56f06b48074d09f6" category="doc">Funcionamento normal</block>
  <block id="ea7df930bd6bec6222e23d2b3af02a50" category="paragraph">O SnapMirror active Sync oferece suporte a dois tipos de operações de failover de storage: Planejadas e não planejadas, que funcionam de maneiras ligeiramente diferentes. Um failover planejado é iniciado manualmente pelo administrador para o switchover rápido para um local remoto, enquanto o failover não planejado é iniciado automaticamente pelo mediador no terceiro local. O principal objetivo de um failover planejado é executar patches e atualizações incrementais, executar testes de recuperação de desastres ou adotar uma política formal de alternar as operações entre locais ao longo do ano para provar a capacidade de sincronização ativa total.</block>
  <block id="f7c8b0ba16967990d91c2ca78d655eaa" category="paragraph">Os diagramas mostram o que acontece durante operações normais de failover e failback. Para facilitar a ilustração, eles retratam um LUN replicado. Em uma configuração de sincronização ativa do SnapMirror real, a replicação é baseada em volumes, onde cada volume contém um ou mais LUNs, mas para simplificar a imagem, a camada de volume foi removida.</block>
  <block id="e48472f7daf781b63506f9e296443027" category="paragraph">Em funcionamento normal, é possível aceder a um LUN a partir da réplica local ou remota. A linha vermelha indica o caminho otimizado como anunciado pela ALUA, e o resultado deve ser que o IO seja enviado preferencialmente por esse caminho.</block>
  <block id="cfa86460b638615878bbee89b1b6d4c7" category="paragraph">A linha verde é um caminho ativo, mas incorreria em mais latência porque a e/S nesse caminho precisaria ser passada pelo caminho de sincronização ativa do SnapMirror. A latência adicional dependeria da velocidade da interconexão entre locais que é usada para a sincronização ativa do SnapMirror.</block>
  <block id="e139a585510a502bbf1841cf589f5086" category="section-title">Falha</block>
  <block id="7ed516552b652790c92df0bf237264b2" category="paragraph">Se a cópia espelhada ativa ficar indisponível, seja por causa de failover planejado ou não planejado, obviamente ela não será mais utilizável. No entanto, o sistema remoto possui uma réplica síncrona e já existem caminhos SAN para o local remoto. O sistema remoto é capaz de atender a e/S para esse LUN.</block>
  <block id="7388404ef116c3ff812bfd290b094d9e" category="section-title">Failover</block>
  <block id="997dfe060d2107e84407cfb41e692c54" category="paragraph">O failover faz com que a cópia remota se torne a cópia ativa. Os caminhos são alterados de Ativo para Ativo/otimizado, e a e/S continua a ser atendida sem perda de dados.</block>
  <block id="0493d27e20d11e356e53e0a730b0ad08" category="section-title">Repare</block>
  <block id="22ea45ef5d49a1b807d571799d80613d" category="paragraph">Uma vez que o sistema de origem é retornado ao serviço, o SnapMirror ative Sync pode ressincronizar a replicação, mas executando a outra direção. A configuração agora é essencialmente a mesma que o ponto de partida, exceto os sites ative-mirror foram invertidos.</block>
  <block id="6d80a3efb80520f47b63dc279e1bea3d" category="section-title">Failback</block>
  <block id="d47f47372b9b94d274cceb3638b28845" category="paragraph">Se desejado, um administrador pode executar um failback e mover a cópia ativa dos LUN(s) de volta para os controladores originais.</block>
  <block id="6f343e6c5daed91ac953577dd5e1e06e" category="doc">Perda de conetividade de replicação</block>
  <block id="6f04ca443b44ef3da2adedd7c0cf36fa" category="paragraph">Para os exemplos a seguir, suponha que o site A esteja configurado como o site preferido.</block>
  <block id="f553ed0b13f8b38932589ba34432ab5a" category="paragraph">Se a replicação SM-as for interrompida, não é possível concluir a e/S de gravação porque seria impossível que um cluster replique alterações no local oposto.</block>
  <block id="2ef1646841c5728f668289819e837437" category="section-title">Local A (local preferido)</block>
  <block id="47d7b1b43310c2ce615be2e71aed414d" category="paragraph">O resultado da falha do link de replicação no site preferido será uma pausa de aproximadamente 15 segundos no processamento de e/S de gravação, à medida que o ONTAP tenta novamente as operações de gravação replicadas antes de determinar que o link de replicação é genuinamente inacessível. Após os 15 segundos decorridos, o Site Um sistema retoma o processamento de e/S de leitura e escrita. Os caminhos de SAN não serão alterados e os LUNs permanecerão online.</block>
  <block id="bb713afeab82bcb45a45d3cc1411e3eb" category="section-title">Local B</block>
  <block id="dc68c1abbc392a93905ce712c45999eb" category="paragraph">Como o local B não é o site preferido de sincronização ativa do SnapMirror, seus caminhos de LUN ficarão indisponíveis após cerca de 15 segundos.</block>
  <block id="3784559d5087e35dc7372b1c51cf920e" category="section-title">Falha do sistema de storage</block>
  <block id="901afcf3108cffc70b3209e8613babf0" category="paragraph">O resultado de uma falha do sistema de armazenamento é quase idêntico ao resultado da perda do link de replicação. O local sobrevivente deve experimentar uma pausa de IO de aproximadamente 15 segundos. Uma vez decorrido esse período de 15 segundos, o IO será retomado nesse site como de costume.</block>
  <block id="0ce6f0c843cdd28d3ff7284039730959" category="section-title">Perda do mediador</block>
  <block id="6b9600f6a35d60a0773b02ff771e5be1" category="paragraph">O serviço mediador não controla diretamente as operações de storage. Ele funciona como um caminho de controle alternativo entre clusters. Ele existe principalmente para automatizar o failover sem o risco de um cenário de divisão cerebral. Em operação normal, cada cluster replica alterações em seu parceiro, e cada cluster pode verificar se o cluster do parceiro está on-line e fornecendo dados. Se o link de replicação falhar, a replicação cessaria.</block>
  <block id="878273b0ad33bf4f330480ad6262d08c" category="paragraph">O motivo pelo qual um mediador é necessário para o failover automatizado seguro é porque, de outra forma, seria impossível que um cluster de storage pudesse determinar se a perda de comunicação bidirecional foi o resultado de uma interrupção da rede ou falha real do storage.</block>
  <block id="7bccc28ee4a5fac4fa93b691ca9733bc" category="paragraph">O mediador fornece um caminho alternativo para cada cluster para verificar a integridade de seu parceiro. Os cenários são os seguintes:</block>
  <block id="7ba0268be94dd09db527214e2f2862b4" category="list-text">Se um cluster puder entrar em Contato diretamente com seu parceiro, os serviços de replicação estarão operacionais. Nenhuma ação necessária.</block>
  <block id="5c3163ce1d24869bf6e6594bcd37901d" category="list-text">Se um site preferido não puder entrar em Contato diretamente com seu parceiro ou por meio do mediador, ele assumirá que ele está realmente indisponível ou foi isolado e que levou seus caminhos LUN off-line. O site preferido continuará lançando o estado RPO/0 e continuará processando e/S de leitura e gravação.</block>
  <block id="e2c06d8468f627e9f8fdc9380204f00f" category="list-text">Se um site não preferencial não puder entrar em Contato diretamente com seu parceiro, mas puder contatá-lo por meio do mediador, ele tomará seus caminhos off-line e aguardará o retorno da conexão de replicação.</block>
  <block id="f7fd4567c8be042fc3f9be5b45124d76" category="list-text">Se um site não preferencial não puder entrar em Contato com seu parceiro diretamente ou por meio de um mediador operacional, ele assumirá que o parceiro está realmente indisponível ou foi isolado e que tomou seus caminhos LUN off-line. O site não preferencial lançará o estado RPO 0 e continuará processando e/S de leitura e gravação. Ele assumirá o papel da fonte de replicação e se tornará o novo site preferido.</block>
  <block id="1286d22222876588b31270c148d8c480" category="paragraph">Se o mediador não estiver totalmente disponível:</block>
  <block id="3cc95aae492aaec45753d6e6b7d91c12" category="list-text">A falha dos serviços de replicação por qualquer motivo, incluindo a falha do sistema de storage ou local não preferido, resultará no lançamento do estado RPO/0 e no reinício do processamento de e/S de leitura e gravação. O site não preferencial tomará seus caminhos off-line.</block>
  <block id="92395625e4bc805c933a9b4f52c5c594" category="list-text">A falha do site preferido resultará em uma falha porque o site não-preferido não será capaz de verificar se o site oposto está realmente off-line e, portanto, não seria seguro para o site não-preferido retomar os serviços.</block>
  <block id="3450c1f3c1166bb5f38dd42c45eb1b70" category="section-title">Restauração de serviços</block>
  <block id="5a0a7b8380bda809ef1b210c3bb41b93" category="paragraph">Depois que uma falha é resolvida, como restaurar a conetividade site-a-site ou ligar um sistema com falha, os pontos de extremidade de sincronização ativa do SnapMirror detetarão automaticamente a presença de uma relação de replicação com defeito e o devolverão ao estado RPO-0. Uma vez que a replicação síncrona for restabelecida, os caminhos com falha ficarão online novamente.</block>
  <block id="8f3219fa36fad5d789373fdf883d28b1" category="paragraph">Em muitos casos, os aplicativos em cluster detetarão automaticamente o retorno de caminhos com falha, e esses aplicativos também voltarão online. Em outros casos, pode ser necessária uma análise SAN no nível do host ou os aplicativos podem precisar ser colocados online manualmente. Depende do aplicativo e como ele é configurado e, em geral, essas tarefas podem ser facilmente automatizadas. O próprio ONTAP é com autorrecuperação e não deve exigir a intervenção do usuário para retomar as operações de storage RPO de 0.</block>
  <block id="52ec8762530eb85c0734309b6747a861" category="section-title">Failover manual</block>
  <block id="afe62727c9717a186ce014753f902c8a" category="paragraph">Alterar o local preferido requer uma operação simples. A e/S pausa por um segundo ou dois como autoridade sobre os switches de comportamento de replicação entre clusters, mas a e/S não é afetada.</block>
  <block id="2d430e41b39275608ed6816ee435f2c4" category="paragraph">O mediador não é realmente um tiebreaker, embora essa seja efetivamente a função que ele fornece. Ele não realiza nenhuma ação; em vez disso, fornece um canal de comunicação alternativo para comunicação de cluster para cluster.</block>
  <block id="caeb8c810d4965bfc8ad369332977e54" category="inline-image-macro">Diagrama de sincronização ativa do SnapMirror com mediador</block>
  <block id="2767cf2bbeaf5540c1e615745cfead81" category="paragraph">O desafio nº 1 com failover automatizado é o problema de split-brain, e esse problema surge se os dois locais perderem a conetividade entre si. O que deve acontecer? Você não quer que dois sites diferentes se designem como as cópias sobreviventes dos dados, mas como um único site pode dizer a diferença entre a perda real do site oposto e a incapacidade de se comunicar com o site oposto?</block>
  <block id="661d0a9679d7d1af0f76f646c941e5cc" category="paragraph">É aqui que o mediador entra na imagem. Se for colocado em um site 3rd e cada site tiver uma conexão de rede separada com esse site, então você terá um caminho adicional para cada site validar a integridade do outro. Olhe para a imagem acima novamente e considere os seguintes cenários.</block>
  <block id="d0c23d9c3fc0a960d3362e7ba10243f5" category="list-text">O que acontece se o mediador falhar ou não estiver acessível a partir de um ou de ambos os sites?</block>
  <block id="123c024944e0a1dd3f71661e6d0e5005" category="list-text">Os dois clusters ainda podem se comunicar entre si pelo mesmo link usado para serviços de replicação.</block>
  <block id="00a2d2948ebb25dba32d9366b8655dfc" category="list-text">Os dados ainda são servidos com proteção RPO igual a 0</block>
  <block id="7ac2e4e468f2c732023f530f71ac9dbb" category="list-text">O que acontece se o Site A falhar?</block>
  <block id="ce89434a9a13b39dccbbded97d674de0" category="list-text">O local B verá ambos os canais de comunicação diminuírem.</block>
  <block id="0a22d4bfa3bb021654f02d82cdbb9422" category="list-text">O local B assumirá os serviços de dados, mas sem o espelhamento RPO igual a 0</block>
  <block id="2a7681a43b5e9647d24566f342ab0b27" category="list-text">O que acontece se o local B falhar?</block>
  <block id="1c8ff8325f78bcc084c3c197606b5482" category="list-text">O local A verá ambos os canais de comunicação diminuírem.</block>
  <block id="8a8e5bd62b16753898cefd37bdf7ccb4" category="list-text">O local A assumirá os serviços de dados, mas sem o espelhamento do RPO igual a 0</block>
  <block id="11b1ce76911fece428e0edd5c9e7682f" category="paragraph">Há um outro cenário a considerar: Perda do link de replicação de dados. Se o link de replicação entre locais for perdido, o espelhamento RPO 0 obviamente será impossível. O que deve acontecer então?</block>
  <block id="3e2a78d8ed8be1e5b40ff81cc9e2a2d6" category="paragraph">Isso é controlado pelo status do site preferido. Em uma relação SM-as, um dos locais é secundário ao outro. Isso não tem efeito nas operações normais, e todo o acesso aos dados é simétrico, mas se a replicação for interrompida, o empate terá que ser quebrado para retomar as operações. O resultado é que o local preferido continuará as operações sem espelhamento, e o local secundário interromperá o processamento de e/S até que a comunicação de replicação seja restaurada.</block>
  <block id="8c340dc334134096f68b880b42a8692c" category="doc">Replicação</block>
  <block id="225caaa9ecf3ac7dfb141c808a1c1651" category="paragraph">O SnapMirror active Sync (anteriormente conhecido como SnapMirror Business Continuity ou SM-bc) permite que bancos de dados e aplicações individuais do SQL Server continuem a funcionar em caso de interrupções, com failover transparente do storage sem qualquer intervenção manual.</block>
  <block id="700cb79deb6ef819c0aacbb228c5a16b" category="paragraph">A sincronização ativa do SnapMirror (SM-as) é baseada no SnapMirror síncrono. Ambos podem fornecer replicação síncrona RPO igual a 0, mas o SM-as leva a solução ainda mais ao fornecer disponibilidade quase zero de rto para dados SAN. Isso é feito por meio de automação que gerencia caminhos SAN para manter seus dados disponíveis. Falhas no local, no controlador e na comunicação são tratadas automaticamente pela ONTAP.</block>
  <block id="2d242bb36ec91b32005f9296ff03a912" category="section-title">Arquitetura</block>
  <block id="c159224eea5fb4a30b3cc9be6e90cd6c" category="paragraph">A sincronização ativa do SnapMirror fornece LUNs que existem em dois locais diferentes. Em funcionamento normal, não existe "origem" ou "destino". A direção é bidirecional. Todas as IO de leitura direcionadas para um determinado caminho de LUN serão atendidas pelo controlador local usando sua cópia local dos dados. Todas as gravações serão replicadas para o parceiro remoto, bem como gravadas localmente antes de serem reconhecidas.</block>
  <block id="4a85397e66688e4e619ffe832e627548" category="inline-image-macro">Descrição geral da sincronização ativa do SnapMirror</block>
  <block id="ddc1e5dc440806435445e7a532ad1198" category="paragraph">Logicamente, o comportamento é como um único conjunto de LUNs. E/S pode ser direcionado a esses LUNs lógicos por caminhos SAN que existem em dois clusters diferentes, mas os dados sempre são os mesmos. O comportamento de e/S é simétrico, o que é essencial para muitas configurações de aplicativos ativo-ativo.</block>
  <block id="ddc5ca7c74db522011a3b2ddccda5b40" category="inline-image-macro">Design lógico de sincronização ativa do SnapMirror</block>
  <block id="daadd24f5163a10f9a2f016019883886" category="section-title">Gerenciamento de caminho</block>
  <block id="9bb9bee58b329761e36c7d9bf8900d6f" category="paragraph">Há duas abordagens para a topologia de rede síncrona SnapMirror, uniforme e não uniforme. A principal consideração ao escolher entre acesso uniforme e não uniforme é se você pode ou deve estender a SAN entre locais. A sincronização ativa do SnapMirror pode ser usada em ambas as situações.</block>
  <block id="0cf4a786acebd750bbfdfc4416c89406" category="section-title">Hardware de storage</block>
  <block id="ea1d91c32fcf0f4a1090fd0da341c014" category="paragraph">Ao contrário de outras soluções de recuperação de desastres de storage, o SnapMirror active Sync oferece flexibilidade assimétrica de plataforma. O hardware em cada local não precisa ser idêntico. Esse recurso permite dimensionar corretamente o hardware usado para suportar a sincronização ativa do SnapMirror. O sistema de storage remoto pode ser idêntico ao local principal se precisar dar suporte a uma carga de trabalho de produção completa, mas se um desastre resultar em e/S reduzida, do que um sistema menor no local remoto pode ser mais econômico.</block>
  <block id="ea9f3de5dd21190fbc6bca180b2040f1" category="section-title">Mediador do ONTAP</block>
  <block id="1f46c4a6c97a8add22ae7c23181c23d8" category="paragraph">O Mediador ONTAP é um aplicativo de software que é baixado do site de suporte da NetApp e normalmente é implantado em uma máquina virtual.</block>
  <block id="91e17573d84d7d626cc27e989a3957bc" category="inline-link-macro">Documentação do ONTAP na sincronização ativa do SnapMirror</block>
  <block id="ae81dd17263728532627374843ee0ff8" category="paragraph">Para obter informações sobre as etapas de Planejamento e configuração, <block ref="44f5d8051247437425911d96f84db248" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="5abea2d56204d1c15aa063dc90ccfb4f" category="paragraph">A sincronização ativa do SnapMirror considerará um site a "fonte" e o outro o "destino". Isso implica uma relação de replicação unidirecional, mas isso não se aplica ao comportamento de IO. A replicação é bidirecional e simétrica, e os tempos de resposta de e/S são os mesmos em ambos os lados do espelho.</block>
  <block id="e5086daa5843466ff5f04f20d4c19d74" category="paragraph">A<block ref="36cd38f49b9afa08222c0dc9ebfe35eb" prefix=" " category="inline-code"></block> designação é controla o local preferido. Se o link de replicação for perdido, os caminhos de LUN na cópia de origem continuarão a servir dados enquanto os caminhos de LUN na cópia de destino ficarão indisponíveis até que a replicação seja restabelecida e o SnapMirror reinsira um estado síncrono. Os caminhos irão então retomar a veiculação de dados.</block>
  <block id="a0bbe7bd1e93252f1267d98703905552" category="paragraph">A configuração de origem/destino pode ser visualizada através do SystemManager:</block>
  <block id="13d0a54956b2dd09d5e909acadfb1694" category="inline-image-macro">Captura de tela SM da fonte SM-as</block>
  <block id="5b53b7d18b58af25bcf47dc21678038f" category="paragraph">Ou na CLI:</block>
  <block id="498b1bbe0e017f1ad405fe4c77fb8ea1" category="paragraph">O segredo é que a fonte é o SVM no cluster1. Como mencionado acima, os termos "fonte" e "destino" não descrevem o fluxo de dados replicados. Ambos os sites podem processar uma gravação e replicá-la para o site oposto. Com efeito, ambos os clusters são fontes e destinos. O efeito de designar um cluster como uma fonte simplesmente controla qual cluster sobrevive como um sistema de armazenamento de leitura e gravação se o link de replicação for perdido.</block>
  <block id="18a07170e14f5cbc26533f0a136dfdd0" category="inline-image-macro">Rede não uniforme de sincronização ativa do SnapMirror</block>
  <block id="9532c9e7afcd43c7d9bb5740695fc259" category="paragraph">O principal benefício dessa abordagem é a simplicidade da SAN - você elimina a necessidade de estender uma SAN pela rede. Alguns clientes não têm conetividade de baixa latência suficiente entre locais ou não têm infraestrutura para túnel do tráfego SAN FC em uma rede entre locais.</block>
  <block id="439caacb19fa16f2c21563703ed645d7" category="paragraph">A desvantagem para o acesso não uniforme é que certos cenários de falha, incluindo a perda do link de replicação, resultarão em alguns hosts perdendo acesso ao armazenamento. Os aplicativos que são executados como instâncias únicas, como um banco de dados não agrupado, que inerentemente está sendo executado apenas em um único host em qualquer montagem, falharão se a conetividade de armazenamento local for perdida. Os dados ainda seriam protegidos, mas o servidor de banco de dados não teria mais acesso. Ele precisaria ser reiniciado em um local remoto, de preferência através de um processo automatizado. Por exemplo, o VMware HA pode detetar uma situação de todos os caminhos em um servidor e reiniciar uma VM em outro servidor onde os caminhos estão disponíveis.</block>
  <block id="9fad44ede04fb95c16ea64be5e51836c" category="paragraph">Em muitos casos, a sobrecarga de latência adicional de um aplicativo que acessa o storage em um link local a local seria inaceitável. Isso significa que a disponibilidade aprimorada de redes uniformes é mínima, uma vez que a perda de armazenamento em um local levaria à necessidade de encerrar serviços nesse local com falha de qualquer maneira.</block>
  <block id="15da96ce40136a3259e04ae0dc25fc95" category="paragraph">Há caminhos redundantes pelo cluster local que não são mostrados nesses diagramas por uma questão de simplicidade. Os sistemas de storage da ONTAP estão HA, portanto, uma falha da controladora não deve resultar em falha do local. Deve apenas resultar em uma mudança na qual os caminhos locais são usados no site afetado.</block>
  <block id="05b66cacce7105ad4a548ef5054997f0" category="doc">Definições de proximidade</block>
  <block id="bb12626aefb7c36f9b13694d35dadd5d" category="paragraph">Um recurso importante do SM-as é a capacidade de configurar os sistemas de storage para saber onde os hosts estão localizados. Quando você mapeia os LUNs para um determinado host, você pode indicar se eles são ou não proximais a um determinado sistema de armazenamento.</block>
  <block id="eccafd14420b568fff639755b251d1bd" category="paragraph">Proximidade refere-se a uma configuração por cluster que indica que um determinado host WWN ou ID de iniciador iSCSI pertence a um host local. É uma segunda etapa opcional para configurar o acesso LUN.</block>
  <block id="d99ea4fad7d0a9010283969d9ddf89aa" category="paragraph">O primeiro passo é a configuração usual do igroup. Cada LUN deve ser mapeado para um grupo que contenha as IDs WWN/iSCSI dos hosts que precisam de acesso a esse LUN. Isso controla qual host tem _access_ para um LUN.</block>
  <block id="bba32ce1a7b85dd9ba50c49b1a53fe4c" category="paragraph">A segunda etapa opcional é configurar a proximidade do host. Isso não controla o acesso, ele controla _Priority_.</block>
  <block id="98271aec6138a28e374c8f3724a535b6" category="paragraph">Por exemplo, um host no local A pode ser configurado para acessar um LUN que é protegido pela sincronização ativa do SnapMirror e, como a SAN é estendida entre sites, há caminhos disponíveis para esse LUN usando armazenamento no local A ou armazenamento no local B.</block>
  <block id="81959299f52ddb567fd902f3e1ae5311" category="paragraph">Sem configurações de proximidade, esse host usará ambos os sistemas de storage igualmente porque ambos os sistemas de storage anunciarão caminhos ativos/otimizados. Se a latência da SAN e/ou a largura de banda entre locais for limitada, isso pode não ser desejado e você pode querer garantir que, durante a operação normal, cada host utilize preferencialmente caminhos para o sistema de armazenamento local. Isso é configurado adicionando o ID WWN/iSCSI do host ao cluster local como um host proximal. Isso pode ser feito na CLI ou no SystemManager.</block>
  <block id="c8984126713ed072b9cb0a44a162be4d" category="section-title">AFF</block>
  <block id="f08670cf73640d447fb34d01b0f6418f" category="paragraph">Com um sistema AFF, os caminhos aparecerão como mostrado abaixo quando a proximidade do host for configurada.</block>
  <block id="4590bab77464ba1a9c8ee6b8095eef60" category="inline-image-macro">SnapMirror ative Sync AFF rede uniforme</block>
  <block id="2b2fdfa824f1319cc47992b1277faa78" category="paragraph">Em operação normal, todo o IO é IO local. Leituras e gravações são atendidas a partir do storage array local. É claro que o write IO também precisará ser replicado pelo controlador local para o sistema remoto antes de ser reconhecido, mas todas as IO de leitura serão atendidas localmente e não incorrerão latência extra ao atravessar o link SAN entre locais.</block>
  <block id="97b2bb0cfbae3fe49433caf537e819ec" category="paragraph">A única vez que os caminhos não otimizados serão usados é quando todos os caminhos ativos/otimizados forem perdidos. Por exemplo, se todo o array no local perder energia, os hosts no local A ainda poderão acessar caminhos para o array no local B e, portanto, permanecer operacionais, embora estejam com maior latência.</block>
  <block id="b7b46ce5d1a547db89c0bc615ff272a5" category="section-title">ASA</block>
  <block id="5ab085bf88338486e590861594d3947a" category="paragraph">Os sistemas NetApp ASA oferecem multipathing ativo-ativo em todos os caminhos em um cluster. Isso também se aplica às configurações SM-as.</block>
  <block id="6511f0e2589c08e82bc8dd3e9bc93185" category="inline-image-macro">SnapMirror ative Sync ASA rede uniforme</block>
  <block id="c3fe6771b27ffcb15a75ae88f6d57c4b" category="paragraph">Uma configuração ASA com acesso não uniforme funcionaria em grande parte da mesma forma que faria com o AFF. Com acesso uniforme, o IO estaria atravessando a WAN. Isto pode ou não ser desejável.</block>
  <block id="498a9faf271a73dcf026b1041b66ef2a" category="paragraph">Se os dois locais estivessem a 100 metros de distância com conetividade de fibra, não deveria haver latência adicional detetável cruzando a WAN, mas se os locais estivessem a uma distância longa, então o desempenho de leitura sofreria em ambos os locais. Em contraste, com o AFF, esses caminhos de cruzamento de WAN só seriam usados se não houvesse caminhos locais disponíveis e o desempenho do dia-a-dia seria melhor porque todo o IO seria IO local. O ASA com rede de acesso não uniforme seria uma opção para obter os benefícios de custo e recursos do ASA sem incorrer em uma penalidade de acesso à latência entre locais.</block>
  <block id="15ab92b8042738f6acc912e2d98ae17a" category="paragraph">O ASA com SM-as em uma configuração de baixa latência oferece dois benefícios interessantes. Primeiro, ele basicamente *dobra* a performance de qualquer host porque a e/S pode ser atendida por duas vezes mais controladoras usando o dobro de caminhos. Em segundo lugar, em um ambiente de local único, ele oferece disponibilidade extrema porque todo um sistema de storage pode ser perdido sem interromper o acesso de host.</block>
  <block id="642223473862db290604321fe2ebe763" category="doc">SVMs</block>
  <block id="47ea917cf14ad91c68c407f90a7a189d" category="paragraph">Um SVM, conhecido como vserver na CLI do ONTAP, é uma unidade funcional básica de storage e é útil comparar um SVM com um convidado em um servidor VMware ESX.</block>
  <block id="284558d4613b1e72103300f1b8973b3b" category="paragraph">Quando instalado pela primeira vez, o ESX não tem recursos pré-configurados, como hospedar um sistema operacional convidado ou suportar um aplicativo de usuário final. É um recipiente vazio até que uma máquina virtual (VM) seja definida. ONTAP é semelhante. Quando o ONTAP é instalado pela primeira vez, ele não tem funcionalidades de fornecimento de dados até que um SVM seja criado. É a personalidade do SVM que define os serviços de dados.</block>
  <block id="13ce2622b2cc2118c44d3aae7df8167d" category="paragraph">Assim como em outros aspectos da arquitetura de storage, as melhores opções para SVM e design de interface lógica (LIF) dependem muito dos requisitos de dimensionamento e das necessidades empresariais.</block>
  <block id="8fb41a27984f0beba2e12fb920a486aa" category="paragraph">Não há prática recomendada oficial para provisionar SVMs para ONTAP. A abordagem certa depende dos requisitos de gerenciamento e segurança.</block>
  <block id="f4d8541bb6d07f7533a6b5aa6cfb2455" category="paragraph">A maioria dos clientes opera um SVM principal para a maioria de seus requisitos diários, mas cria um pequeno número de SVMs para necessidades especiais. Por exemplo, você pode querer criar:</block>
  <block id="259908e9e431c0fbb9d425249ceb7930" category="list-text">SVM para um banco de dados de negócios essencial gerenciado por uma equipe de especialistas</block>
  <block id="0e10f2715884f3538282397d69b2cd00" category="list-text">Um SVM para um grupo de desenvolvimento a quem controle administrativo completo foi dado para que eles possam gerenciar seu próprio storage de forma independente</block>
  <block id="7624156e307247e4ea1ec8bf574136a1" category="list-text">SVM para dados empresariais confidenciais, como recursos humanos ou dados de relatórios financeiros, em que a equipe administrativa deve ser limitada</block>
  <block id="e5e09031843479ef9ef8cbbd4c2f404c" category="inline-link-macro">NetApp Hardware Universe</block>
  <block id="2737c9012caaebb1cbb9e526400a2345" category="paragraph">Em um ambiente de alocação a vários clientes, os dados de cada locatário podem receber um SVM dedicado. O limite para o número de SVMs e LIFs por cluster, par de HA e nó depende do protocolo que está sendo usado, do modelo de nó e da versão do ONTAP. Consulte o <block ref="41f66f34b3a905f864500c9319fdff8f" category="inline-link-macro-rx"></block> para estes limites.</block>
  <block id="0f54fb931dbdeea735f18a8e73f9eab5" category="doc">Proteção de dados com o SyncMirror</block>
  <block id="d7023f86951b6c3c009891a468c3effd" category="paragraph">No nível mais simples, a replicação síncrona significa que qualquer alteração deve ser feita em ambos os lados do storage espelhado antes que seja reconhecida. Por exemplo, se um banco de dados estiver escrevendo um log ou se um convidado VMware estiver sendo corrigido, uma gravação nunca deve ser perdida. Como um nível de protocolo, o sistema de storage não deve reconhecer a gravação até que ela tenha sido comprometida com a Mídia não volátil em ambos os locais. Só então é seguro prosseguir sem o risco de perda de dados.</block>
  <block id="eee4f7a4e0ed3a8646a97bcf3e118fb9" category="paragraph">O uso de uma tecnologia de replicação síncrona é a primeira etapa no projeto e gerenciamento de uma solução de replicação síncrona. A consideração mais importante é entender o que poderia acontecer durante vários cenários de falha planejados e não planejados. Nem todas as soluções de replicação síncrona oferecem os mesmos recursos. Se você precisa de uma solução que forneça um objetivo de ponto de restauração (RPO) zero, o que significa perda de dados zero, é necessário considerar todos os cenários de falha. Em particular, qual é o resultado esperado quando a replicação é impossível devido à perda de conetividade entre sites?</block>
  <block id="71554672a088c43ab21c759ddd161928" category="section-title">Disponibilidade de dados do SyncMirror</block>
  <block id="bab63c3a8b4ae009c3596c809e27d73b" category="paragraph">A replicação do MetroCluster é baseada na tecnologia NetApp SyncMirror, projetada para entrar e sair do modo síncrono com eficiência. Essa funcionalidade atende aos requisitos dos clientes que exigem replicação síncrona, mas que também precisam de alta disponibilidade para seus serviços de dados. Por exemplo, se a conetividade a um local remoto for cortada, geralmente é preferível que o sistema de armazenamento continue operando em um estado não replicado.</block>
  <block id="bf4d44f407dab4b746f1eaeb06e897af" category="paragraph">Muitas soluções de replicação síncrona só são capazes de operar no modo síncrono. Esse tipo de replicação tudo ou nada é às vezes chamado de modo domino. Esses sistemas de storage param de fornecer dados em vez de permitir que cópias locais e remotas dos dados fiquem não sincronizadas. Se a replicação for violada à força, a ressincronização pode ser extremamente demorada e pode deixar um cliente exposto à perda completa de dados durante o tempo em que o espelhamento é restabelecido.</block>
  <block id="8646bb558f8f18a200cce2f70602627a" category="paragraph">O SyncMirror não só pode alternar facilmente do modo síncrono se o local remoto não estiver acessível, como também pode sincronizar rapidamente para um estado RPO de 0 quando a conetividade é restaurada. A cópia obsoleta dos dados no local remoto também pode ser preservada em um estado utilizável durante a ressincronização, o que garante que cópias locais e remotas dos dados existam em todos os momentos.</block>
  <block id="bc86ce4caa57368f9094a93dd72ffd28" category="paragraph">Quando o modo domino é necessário, o NetApp oferece SnapMirror Synchronous (SM-S). Opções de nível de aplicativo também existem, como o Oracle DataGuard ou o SQL Server Always On Availability Groups. O espelhamento de disco no nível DO SO pode ser uma opção. Consulte sua equipe de conta do NetApp ou do parceiro para obter informações e opções adicionais.</block>
  <block id="9b4c3976d453e66a3dd22e2793fc3a8e" category="doc">Gerenciamento de espaço</block>
  <block id="e89d3732a2fbc592923c30e54522dcdb" category="paragraph">O thin Provisioning vem em várias formas e é parte integrante de muitos recursos que a ONTAP oferece a um ambiente de aplicações empresariais. O provisionamento de thin também está intimamente relacionado às tecnologias de eficiência pelo mesmo motivo: Os recursos de eficiência permitem que mais dados lógicos sejam armazenados do que o que existe tecnicamente no sistema de storage.</block>
  <block id="537642ed3bfef7f2bb3e580b3b266bd3" category="paragraph">Quase qualquer uso de snapshots envolve thin Provisioning. Por exemplo, um banco de dados 10TB típico no storage NetApp inclui cerca de 30 dias de snapshots. Esse arranjo resulta em aproximadamente 10TB GB de dados visíveis no sistema de arquivos ativo e 300TB dedicados a snapshots. O total de 310TB TB de storage geralmente reside em aproximadamente 12TB a 15TB TB de espaço. O banco de dados ativo consome 10TB, e os 300TB restantes de dados requerem apenas 2TB a 5TB GB de espaço porque apenas as alterações aos dados originais são armazenadas.</block>
  <block id="a19609016ad1cb6b7bae7cac796a26a4" category="paragraph">A clonagem também é um exemplo de thin Provisioning. Um grande cliente da NetApp criou 40 clones de um banco de dados 80TB para uso por desenvolvimento. Se todos os desenvolvedores do 40 que usam esses clones sobrescrevessem cada bloco em cada arquivo de dados, mais de 3,2PB GB de armazenamento seriam necessários. Na prática, a rotatividade é baixa e a exigência de espaço coletivo está mais próxima de 40TB, porque apenas as alterações são armazenadas nas unidades.</block>
  <block id="2433af6347e4871be5af0f2af0f6bd6e" category="paragraph">Alguns cuidados devem ser tomados com o thin Provisioning de um ambiente de aplicativo porque as taxas de alteração de dados podem aumentar inesperadamente. Por exemplo, o consumo de espaço devido a snapshots pode crescer rapidamente se as tabelas do banco de dados forem reindexadas ou se aplicar patches em larga escala aos convidados VMware. Um backup perdido pode gravar uma grande quantidade de dados em um tempo muito curto. Finalmente, pode ser difícil recuperar alguns aplicativos se um sistema de arquivos ficar sem espaço livre inesperadamente.</block>
  <block id="5cf4dc4d1ce52ff655ea7f1157a72e2e" category="paragraph">Felizmente, esses riscos podem ser resolvidos com uma configuração cuidadosa de<block ref="f9e1f2ea1a2becbaf82dd54e55a12e6b" prefix=" " category="inline-code"></block> políticas e<block ref="24d554277b3513bb6cef3f0a336725a9" prefix=" " category="inline-code"></block>. Como os nomes deles implicam, essas opções permitem que um usuário crie políticas que desobstruam automaticamente o espaço consumido por snapshots ou aumentem um volume para acomodar dados adicionais. Muitas opções estão disponíveis e as necessidades variam de acordo com o cliente.</block>
  <block id="6a28738961e6f6e4b57e4dd70c446600" category="inline-link-macro">documentação de gerenciamento de storage lógico</block>
  <block id="01570cb5a3aec2324ab56e318e1de04d" category="paragraph">Consulte o <block ref="e69bd75bdb49183ee90588843edb33f4" category="inline-link-macro-rx"></block> para obter uma discussão completa sobre esses recursos.</block>
  <block id="66a41fd6fc38c454973e91d92cf0e291" category="section-title">Reservas fracionárias</block>
  <block id="e8a206fe65814e0ea465e32487544751" category="paragraph">A reserva fracionária refere-se ao comportamento de um LUN em um volume com relação à eficiência do espaço. Quando a opção<block ref="c1acac5c4332e37ec1f281fcbaf0765a" prefix=" " category="inline-code"></block> é definida para 100%, todos os dados no volume podem experimentar 100% de rotatividade com qualquer padrão de dados sem esgotar espaço no volume.</block>
  <block id="a3cd28aef7d0becd57b60187fdc4a24e" category="paragraph">Por exemplo, considere um banco de dados em um único LUN 250GB em um volume 1TB. Criar um instantâneo resultaria imediatamente na reserva de 250GBMB de espaço adicional no volume para garantir que o volume não fique sem espaço por qualquer motivo. O uso de reservas fracionárias geralmente é desperdiçado porque é extremamente improvável que cada byte no volume do banco de dados precise ser substituído. Não há razão para reservar espaço para um evento que nunca acontece. Ainda assim, se um cliente não puder monitorar o consumo de espaço em um sistema de armazenamento e tiver certeza de que o espaço nunca se esgote, reservas fracionárias de 100% seriam necessárias para usar snapshots.</block>
  <block id="e30fbe8981929fb070a820a213381bab" category="section-title">Compactação e deduplicação</block>
  <block id="1b6e4e9a2be031edc6f3da1f559ef884" category="paragraph">Compactação e deduplicação são ambas formas de thin Provisioning. Por exemplo, um espaço físico de dados de 50TB GB pode ser compactado para 30TB GB, resultando em uma economia de 20TB GB. Para que a compactação possa gerar quaisquer benefícios, alguns desses 20TB precisam ser usados para outros dados, ou o sistema de storage precisa ser adquirido com menos de 50TB TB. O resultado é o armazenamento de mais dados do que o tecnicamente disponível no sistema de armazenamento. Do ponto de vista dos dados, há 50TB TB de dados, embora ocupe apenas 30TB TB nas unidades.</block>
  <block id="dbca4bb791f36eac2c11c32f73f2b4ec" category="paragraph">Há sempre a possibilidade de que a compressibilidade de um conjunto de dados mude, o que resultaria em aumento do consumo de espaço real. Esse aumento no consumo significa que a compactação deve ser gerenciada como com outras formas de thin Provisioning em termos de monitoramento e uso<block ref="f9e1f2ea1a2becbaf82dd54e55a12e6b" prefix=" " category="inline-code"></block> e<block ref="24d554277b3513bb6cef3f0a336725a9" prefix=" " category="inline-code"></block>.</block>
  <block id="ad241666a88b5414e8c2fe6d1cc1edb0" category="paragraph">A compactação e a deduplicação são discutidas em mais detalhes na seção link:efficiency.html</block>
  <block id="8ecfcadfebb472a089481e8554ebed87" category="section-title">Compressão e reservas fracionárias</block>
  <block id="4f8fcc146d2e8e712dcd8c56b1684fcc" category="paragraph">A compactação é uma forma de thin Provisioning. Reservas fracionárias afetam o uso da compressão, com uma nota importante; o espaço é reservado antes da criação do snapshot. Normalmente, a reserva fracionária só é importante se existir um instantâneo. Se não houver instantâneo, a reserva fracionária não é importante. Este não é o caso da compressão. Se um LUN for criado em um volume com compactação, o ONTAP preservará espaço para acomodar um snapshot. Esse comportamento pode ser confuso durante a configuração, mas é esperado.</block>
  <block id="e26f8048b4bf60dad827c5a425271361" category="paragraph">Por exemplo, considere um volume de 10GB TB com um LUN de 5GB GB que foi comprimido até 2,5GB TB sem instantâneos. Considere estes dois cenários:</block>
  <block id="ade18971a2dab7e37335e95d81da0ef1" category="list-text">A reserva fracionária é de 100 resultados na utilização de 7,5GB</block>
  <block id="1d07b8e7c92488a55301ea201328cf35" category="list-text">A reserva fracionária é de 0 resultados na utilização de 2,5GB</block>
  <block id="aa410d0e46ec94b6efcf344f0d870c1a" category="paragraph">O primeiro cenário inclui 2,5GB GB de consumo de espaço para dados atuais e 5GB GB de espaço para representar 100% de rotatividade da fonte em antecipação ao uso de instantâneos. O segundo cenário não reserva espaço extra.</block>
  <block id="e79414ad391b126cc9bd53af1624c8de" category="paragraph">Embora esta situação possa parecer confusa, é improvável que seja encontrada na prática. A compactação implica thin Provisioning, e thin Provisioning em um ambiente LUN requer reservas fracionárias. É sempre possível que os dados compatados sejam sobrescritos por algo não compressível, o que significa que um volume deve ser thin Provisioning para compactação para resultar em qualquer economia.</block>
  <block id="499a10b92cb9ca6b3412d4bf5a91a2b0" category="paragraph">*A NetApp recomenda* as seguintes configurações de reserva:</block>
  <block id="7f26e875cee50c1b3baf71a014043794" category="list-text">Defina<block ref="c1acac5c4332e37ec1f281fcbaf0765a" prefix=" " category="inline-code"></block> como 0 quando o monitoramento de capacidade básica estiver em vigor, juntamente com<block ref="f9e1f2ea1a2becbaf82dd54e55a12e6b" prefix=" " category="inline-code"></block> e<block ref="24d554277b3513bb6cef3f0a336725a9" prefix=" " category="inline-code"></block>.</block>
  <block id="675996bd34ec0d8c134215f5be73fb3a" category="list-text">Defina<block ref="c1acac5c4332e37ec1f281fcbaf0765a" prefix=" " category="inline-code"></block> para 100 se não houver capacidade de monitorização ou se for impossível esgotar o espaço em qualquer circunstância.</block>
  <block id="0b0a68e2dedde9c0b9a3ea4276f4b85c" category="paragraph">A<block ref="9df22f196a33acd0b372fe502de51211" prefix=" " category="inline-code"></block> política é a política mais adequada para dados de backup. Isso garante a disposição de camadas de prompt quando o limite de resfriamento tiver sido atingido, independentemente de os arquivos terem sido excluídos ou continuarem existindo no sistema de arquivos primário. Armazenar todos os arquivos potencialmente necessários em um único local no sistema de arquivos ativo também simplifica o gerenciamento. Não há razão para pesquisar instantâneos para localizar um arquivo que precisa ser restaurado.</block>
  <block id="11a75a1257cc68a4a46bc553dabe0c0d" category="paragraph">A<block ref="8805d416ce540c5f2df34af5b18d742b" prefix=" " category="inline-code"></block> política poderia ser feita para funcionar, mas essa política só se aplica a blocos que não estão mais no sistema de arquivos ativo. Portanto, os arquivos em um compartilhamento NFS ou SMB devem ser excluídos primeiro antes que os dados possam ser categorizados.</block>
  <block id="b4af96e8cea99b56592db816cab30fce" category="paragraph">Esta política seria ainda menos eficiente com uma configuração LUN porque a exclusão de um arquivo de um LUN só remove as referências de arquivo dos metadados do sistema de arquivos. Os blocos reais nos LUNs permanecem no lugar até que sejam substituídos. Essa situação pode criar um longo atraso entre o tempo em que um arquivo é excluído e o tempo em que os blocos são substituídos e se tornam candidatos à disposição em camadas. Há algum benefício ao migrar<block ref="8805d416ce540c5f2df34af5b18d742b" prefix=" " category="inline-code"></block> os blocos para a categoria de capacidade, mas, no geral, o gerenciamento de dados de backup da FabricPool funciona melhor com essa<block ref="9df22f196a33acd0b372fe502de51211" prefix=" " category="inline-code"></block> política.</block>
  <block id="1c237d1ebcdeff13ae0145c741d9401d" category="admonition">Essa abordagem ajuda os usuários a gerenciar o espaço necessário para backups com mais eficiência, mas o próprio FabricPool não é uma tecnologia de backup. A disposição em camadas dos arquivos de backup no armazenamento de objetos simplifica o gerenciamento porque os arquivos ainda estão visíveis no sistema de storage original, mas os blocos de dados no destino do armazenamento de objetos dependem do sistema de storage original. Se o volume de origem for perdido, os dados do armazenamento de objetos não serão mais utilizáveis.</block>
  <block id="9e476387322a5c250893cf9c5c4ce78c" category="doc">Políticas</block>
  <block id="b5ffbfb0c082804ad41d0f61c87525ed" category="paragraph">Muitos conjuntos de dados de aplicações são organizados por data, e esses dados geralmente têm cada vez menos probabilidade de serem acessados à medida que envelhecem. Por exemplo, um banco pode ter um repositório de arquivos PDF que contém cinco anos de declarações de clientes, mas apenas os últimos meses estão ativos. O FabricPool pode ser usado para realocar arquivos de dados mais antigos para o nível de capacidade. Um período de resfriamento de 14 dias garantiria que os 14 dias mais recentes de arquivos PDF permaneçam no nível de desempenho. Além disso, os arquivos que são lidos pelo menos a cada 14 dias permanecerão ativos e, portanto, permanecerão no nível de desempenho.</block>
  <block id="ed7e2cc7ff107d4b2032fe65cf4e756a" category="paragraph">Para implementar uma abordagem de disposição em camadas baseada em arquivos, você precisa ter arquivos gravados e não modificados posteriormente. A<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> política deve ser definida suficientemente alta para que os arquivos que você possa precisar permaneçam no nível de desempenho. Por exemplo, um conjunto de dados para o qual os 60 dias de dados mais recentes são necessários com garantias de desempenho ideais, definindo<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> o período como 60. Resultados semelhantes também podem ser alcançados com base nos padrões de acesso ao arquivo. Por exemplo, se os 90 dias mais recentes de dados forem necessários e o aplicativo estiver acessando esse período de 90 dias de dados, os dados permanecerão na categoria de performance. Ao definir<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> o período como 2, você obtém a disposição imediata de categorias após os dados ficarem menos ativos.</block>
  <block id="25d9496e96e698b08c4fc713bfc9a5ca" category="paragraph"><block ref="9df22f196a33acd0b372fe502de51211" prefix=" " category="inline-code"></block>A política é necessária para impulsionar a disposição em camadas desses blocos, porque somente a<block ref="9df22f196a33acd0b372fe502de51211" prefix=" " category="inline-code"></block> política afeta os blocos que estão no sistema de arquivos ativo.</block>
  <block id="8a467b35326e4738b1bd39865c3b21a0" category="admonition">Qualquer tipo de acesso aos dados repõe os dados do mapa de calor. A verificação de vírus, a indexação e até mesmo a atividade de backup que lê os arquivos de origem impedem a categorização porque o limite necessário<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> nunca é atingido.</block>
  <block id="64d5def835c194cac8afe4fafded756e" category="doc">Políticas - instantâneos locais</block>
  <block id="baa596d0db91317fa83739a95649752e" category="paragraph">A versão inicial do FabricPool visou o caso de uso de backup. O único tipo de blocos que podiam ser dispostos em camadas eram blocos que não estavam mais associados aos dados no sistema de arquivos ativo. Portanto, apenas os blocos de dados do snapshot podem ser movidos para a camada de capacidade. Essa continua sendo uma das opções de disposição em categorias mais seguras quando você precisa garantir que a performance nunca seja afetada.</block>
  <block id="b21eb7f0b67c3e27e915183638bf92cf" category="paragraph">Existem duas opções para a disposição em camadas de blocos snapshot inativos na camada de capacidade. Primeiro, a<block ref="8805d416ce540c5f2df34af5b18d742b" prefix=" " category="inline-code"></block> política segmenta apenas os blocos de snapshot. Embora<block ref="9df22f196a33acd0b372fe502de51211" prefix=" " category="inline-code"></block> a política inclua os<block ref="8805d416ce540c5f2df34af5b18d742b" prefix=" " category="inline-code"></block> blocos, ela também dispõe blocos do sistema de arquivos ativo. Isso pode não ser desejável.</block>
  <block id="eeba990304f236b36a9fec2434c77470" category="paragraph">O<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> valor deve ser definido para um período de tempo que torne os dados que possam ser necessários durante uma restauração disponíveis no nível de desempenho. Por exemplo, a maioria dos cenários de restauração de um banco de dados de produção crítico inclui um ponto de restauração em algum momento nos últimos dias. Definir um<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> valor de 3 garantirá que qualquer restauração do arquivo resulte em um arquivo que imediatamente forneça o máximo de desempenho. Todos os blocos nos arquivos ativos ainda estão presentes no storage rápido sem a necessidade de recuperá-los da camada de capacidade.</block>
  <block id="baf531ed01ad56f5614e1a68e8a2e7aa" category="section-title">Políticas - instantâneos replicados</block>
  <block id="27e5121a4c75181022e7be2b738339d0" category="paragraph">Um snapshot replicado com o SnapMirror ou o SnapVault que é usado somente para recuperação geralmente deve usar a política FabricPool<block ref="a181a603769c1f98ad927e7367c7aa51" prefix=" " category="inline-code"></block>. Com essa política, os metadados são replicados, mas todos os blocos de dados são imediatamente enviados para a categoria de capacidade, o que proporciona o máximo de performance. A maioria dos processos de recuperação envolve e/S sequenciais, que é inerentemente eficiente. O tempo de recuperação do destino do armazenamento de objetos deve ser avaliado, mas, em uma arquitetura bem projetada, esse processo de recuperação não precisa ser significativamente mais lento do que a recuperação de dados locais.</block>
  <block id="639e481de0ffe002bd83251b26a2540a" category="paragraph">Se os dados replicados também se destinarem a ser usados para clonagem, a<block ref="9df22f196a33acd0b372fe502de51211" prefix=" " category="inline-code"></block> política é mais apropriada, com um<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> valor que engloba dados que se espera que sejam usados regularmente em um ambiente de clonagem. Por exemplo, o conjunto de trabalho ativo de um banco de dados pode incluir dados lidos ou gravados nos três dias anteriores, mas também pode incluir outros 6 meses de dados históricos. Em caso afirmativo, a<block ref="9df22f196a33acd0b372fe502de51211" prefix=" " category="inline-code"></block> política no destino do SnapMirror torna o conjunto de trabalho disponível no nível de desempenho.</block>
  <block id="b9e18a3460bc17eb9ea65b03f0167453" category="paragraph">Isso é comum com bancos de dados. Bancos de dados que contêm blocos inativos também são candidatos à disposição em camadas do FabricPool. Por exemplo, um banco de dados de gerenciamento da cadeia de suprimentos pode conter informações históricas que devem estar disponíveis se necessário, mas não são acessadas durante operações normais. O FabricPool pode ser usado para realocar seletivamente os blocos inativos.</block>
  <block id="95e955bbbe5dd9520a6bf45b0d8a9d4c" category="paragraph">Por exemplo, os arquivos de dados executados em um volume FabricPool com<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> um período de 90 dias mantêm todos os blocos acessados nos 90 dias anteriores no nível de performance. No entanto, qualquer coisa que não seja acessada por 90 dias é realocada para o nível de capacidade. Em outros casos, a atividade normal da aplicação preserva os blocos corretos no nível correto. Por exemplo, se um banco de dados é normalmente usado para processar os 60 dias anteriores de dados regularmente, um período muito menor<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> pode ser definido porque a atividade natural do aplicativo garante que os blocos não sejam transferidos prematuramente.</block>
  <block id="c33af7c93d461803ceaf8531e861017d" category="paragraph">A<block ref="9df22f196a33acd0b372fe502de51211" prefix=" " category="inline-code"></block> política deve ser usada com cuidado com bancos de dados. Muitos bancos de dados têm atividades periódicas, como processo de fim de trimestre ou operações de reindexação. Se o período dessas operações for maior do que os<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> problemas de desempenho podem ocorrer. Por exemplo, se o processamento no final do trimestre exigir 1TB TB de dados que, de outra forma, foram intocados, esses dados podem agora estar presentes na camada de capacidade. As leituras do nível de capacidade geralmente são extremamente rápidas e podem não causar problemas de desempenho, mas os resultados exatos dependerão da configuração do armazenamento de objetos.</block>
  <block id="03431a55183cb73a12c1bbc3e1927678" category="paragraph">A<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> política deve ser definida suficientemente alta para reter arquivos que possam ser necessários no nível de desempenho. Por exemplo, um banco de dados em que os 60 dias mais recentes de dados possam ser necessários com desempenho ideal garantiria a definição<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> do período para 60 dias. Resultados semelhantes também podem ser alcançados com base nos padrões de acesso dos arquivos. Por exemplo, se os 90 dias mais recentes de dados forem necessários e o aplicativo estiver acessando esse período de 90 dias de dados, os dados permanecerão no nível de desempenho. Definir o<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> período para 2 dias classificaria os dados imediatamente após os dados ficarem menos ativos.</block>
  <block id="55fad400d892fb6062e67904fa9be485" category="admonition">Qualquer tipo de acesso aos dados repõe os dados do mapa de calor. Portanto, varreduras completas de tabela de banco de dados e até mesmo atividades de backup que leem os arquivos de origem impedem a categorização porque o limite necessário<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> nunca é atingido.</block>
  <block id="0f8062f9220efe4f38e7236fe8885379" category="paragraph">A maioria dos bancos de dados relacionais opera no modo de arquivamento de log de transações para fornecer recuperação pontual. As alterações nos bancos de dados são confirmadas registrando as alterações nos logs de transação e o log de transação é mantido sem ser substituído. O resultado pode ser um requisito para manter um enorme volume de logs de transações arquivados. Exemplos semelhantes existem com muitos outros fluxos de trabalho de aplicações que geram dados que precisam ser retidos, mas é altamente improvável que nunca sejam acessados.</block>
  <block id="229384bbfb1db19c4897d87ba4b9bc2d" category="paragraph">A FabricPool soluciona esses problemas ao fornecer uma única solução com disposição em camadas integrada. Os arquivos são armazenados e permanecem acessíveis em seu local habitual, mas praticamente não ocupam espaço na matriz primária.</block>
  <block id="f60aec7aaed8420e09f17a8cfd1d7d37" category="paragraph">O uso de uma<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> política de poucos dias resulta na retenção de blocos nos arquivos criados recentemente (que são os arquivos mais prováveis de serem necessários no curto prazo) na categoria de performance. Os blocos de dados de arquivos mais antigos são movidos para o nível de capacidade.</block>
  <block id="485e24df9e0ebeecf416daa6e5441bba" category="paragraph">O<block ref="9df22f196a33acd0b372fe502de51211" prefix=" " category="inline-code"></block> aplica a disposição em camadas quando o limite de resfriamento tiver sido atingido, independentemente de os logs terem sido excluídos ou continuarem a existir no sistema de arquivos primário. Armazenar todos os logs potencialmente necessários em um único local no sistema de arquivos ativo também simplifica o gerenciamento. Não há razão para pesquisar instantâneos para localizar um arquivo que precisa ser restaurado.</block>
  <block id="bbe0132696bc482e0ba7a1f293d80083" category="paragraph">Alguns aplicativos, como o Microsoft SQL Server, truncam arquivos de log de transações durante operações de backup para que os logs não estejam mais no sistema de arquivos ativo. A capacidade pode ser salva usando a<block ref="8805d416ce540c5f2df34af5b18d742b" prefix=" " category="inline-code"></block> política de disposição em camadas, mas a<block ref="9df22f196a33acd0b372fe502de51211" prefix=" " category="inline-code"></block> política não é útil para dados de log, porque raramente devem existir dados de log refrigerados no sistema de arquivos ativo.</block>
  <block id="23f3d415bb4fe6f99165df604b24da0e" category="paragraph">A disposição em categorias de um conjunto de dados com o FabricPool resulta em uma dependência entre o storage array primário e a categoria de armazenamento de objetos. Há muitas opções de armazenamento de objetos que oferecem níveis variados de disponibilidade. É importante entender o impacto de uma possível perda de conectividade entre o storage array primário e a camada de storage de objetos.</block>
  <block id="7e856c11a853d276fd5d6274bf60fafd" category="paragraph">Se uma e/S emitida para o ONTAP exigir dados da camada de capacidade e o ONTAP não puder alcançar o nível de capacidade para recuperar blocos, a e/S eventualmente expirará. O efeito deste tempo limite depende do protocolo utilizado. Em um ambiente NFS, o ONTAP responde com uma resposta EJUKEBOX ou EDELAY, dependendo do protocolo. Alguns sistemas operacionais mais antigos podem interpretar isso como um erro, mas os sistemas operacionais atuais e os níveis de patch atuais do cliente Oracle Direct NFS tratam isso como um erro recuperável e continuam aguardando a conclusão da e/S.</block>
  <block id="207d9fe0f57910936bfa043248f3afca" category="paragraph">Um tempo limite mais curto se aplica a ambientes SAN. Se um bloco no ambiente de armazenamento de objetos for necessário e permanecer inacessível por dois minutos, um erro de leitura será retornado ao host. O volume ONTAP e os LUNs permanecem online, mas o sistema operacional do host pode sinalizar o sistema de arquivos como estando em um estado de erro.</block>
  <block id="c9251835da8df507ca4f6ce02d4216be" category="paragraph">A política de problemas de conetividade de storage de objetos<block ref="8805d416ce540c5f2df34af5b18d742b" prefix=" " category="inline-code"></block> é menos preocupante porque apenas os dados de backup são dispostos em camadas. Problemas de comunicação atrasariam a recuperação de dados, mas de outra forma não afetariam os dados que estão sendo usados ativamente. As<block ref="9df22f196a33acd0b372fe502de51211" prefix=" " category="inline-code"></block> políticas e<block ref="a181a603769c1f98ad927e7367c7aa51" prefix=" " category="inline-code"></block> permitem a disposição em camadas de dados inativos do LUN ativo, o que significa que um erro durante a recuperação de dados do armazenamento de objetos pode afetar a disponibilidade do banco de dados. Uma implantação de SAN com essas políticas deve ser usada somente com conexões de rede e storage de objetos de classe empresarial projetadas para alta disponibilidade. NetApp StorageGRID é a opção superior.</block>
  <block id="1d12d7a206d9b5337ae6fa442f23d377" category="doc">Apenas Snapshot</block>
  <block id="64c29f2f2feedeb607ff588b13d9758b" category="paragraph">O<block ref="8805d416ce540c5f2df34af5b18d742b" prefix=" " category="inline-code"></block><block ref="964193481f440d73ce3474a7a09bc3ac" prefix=" " category="inline-code"></block> aplica-se apenas a blocos que não são partilhados com o sistema de ficheiros ativo. Essencialmente, isso resulta em camadas de backups de bancos de dados. Os blocos se tornam candidatos à disposição em camadas depois que um snapshot é criado e o bloco é substituído, resultando em um bloco que existe apenas no snapshot. O atraso antes de um<block ref="8805d416ce540c5f2df34af5b18d742b" prefix=" " category="inline-code"></block> bloco ser considerado frio é controlado pela<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> definição do volume. A gama a partir de ONTAP 9.8 é de 2 a 183 dias.</block>
  <block id="ebd9889c847a7a3ddeccd2717ead46f2" category="paragraph">Muitos conjuntos de dados têm taxas de alteração baixas, o que resulta em economias mínimas com essa política. Por exemplo, um banco de dados típico observado no ONTAP tem uma taxa de alteração inferior a 5% por semana. Os logs de arquivo de banco de dados podem ocupar um espaço extenso, mas eles geralmente continuam a existir no sistema de arquivos ativo e, portanto, não seriam candidatos para a disposição em camadas sob esta política.</block>
  <block id="06b9281e396db002010bde1de57262eb" category="section-title">Auto</block>
  <block id="ecf602bd5abbd6a605debedbb6c3d4e0" category="paragraph">A<block ref="9df22f196a33acd0b372fe502de51211" prefix=" " category="inline-code"></block> política de disposição em camadas estende a disposição em camadas para blocos específicos de snapshot e blocos no sistema de arquivos ativo. O atraso antes de um bloco ser considerado frio é controlado pela<block ref="e5e88684921dd21f3f86c28343a3082f" prefix=" " category="inline-code"></block> definição do volume. A gama a partir de ONTAP 9.8 é de 2 a 183 dias.</block>
  <block id="6256ce48698ff0bde6f818679cdfb382" category="paragraph">Essa abordagem permite opções de disposição em categorias que não estão disponíveis na<block ref="8805d416ce540c5f2df34af5b18d742b" prefix=" " category="inline-code"></block> política. Por exemplo, uma política de proteção de dados pode exigir 90 dias de retenção de determinados arquivos de log. Definir um período de resfriamento de 3 dias resulta em todos os arquivos de log com mais de 3 dias para serem dispostos na camada de desempenho. Essa ação libera espaço substancial na categoria de performance e ainda permite que você visualize e gerencie todos os 90 dias de dados.</block>
  <block id="6adf97f83acf6453d4a6a4b1070f3754" category="section-title">Nenhum</block>
  <block id="7026ff5c5d4ab3946ff2d86f0e2cca6f" category="paragraph">A<block ref="334c4a4c42fdb79d7ebc3e73b517e6f8" prefix=" " category="inline-code"></block> política de disposição em categorias impede que blocos adicionais sejam dispostos em camadas na camada de storage, mas todos os dados ainda na camada de capacidade permanecem na camada de capacidade até que sejam lidos. Se o bloco for então lido, ele será puxado para trás e colocado no nível de desempenho.</block>
  <block id="d152c7b0939fb6d35fdb0433de0d6369" category="paragraph">O principal motivo para usar a<block ref="334c4a4c42fdb79d7ebc3e73b517e6f8" prefix=" " category="inline-code"></block> política de disposição em camadas é impedir que blocos sejam dispostos em camadas, mas pode se tornar útil alterar as políticas ao longo do tempo. Por exemplo, digamos que um conjunto de dados específico seja amplamente categorizado na camada de capacidade, mas surge uma necessidade inesperada de recursos completos de performance. A política pode ser alterada para impedir qualquer disposição em camadas adicional e para confirmar que todos os blocos de leitura de volta à medida que a IO aumenta permanecem na categoria de performance.</block>
  <block id="b1c94ca2fbc3e78fc30069c8d0f01680" category="section-title">Tudo</block>
  <block id="84826d7e23dfac7549819d5115fdcedd" category="paragraph">A<block ref="a181a603769c1f98ad927e7367c7aa51" prefix=" " category="inline-code"></block> política de disposição em categorias substitui a<block ref="402051f4be0cc3aad33bcf3ac3d6532b" prefix=" " category="inline-code"></block> política a partir do ONTAP 9.6. <block ref="402051f4be0cc3aad33bcf3ac3d6532b" prefix=" " category="inline-code"></block>A política aplicada somente a volumes de proteção de dados, o que significa um destino do SnapMirror ou do NetApp SnapVault. A<block ref="a181a603769c1f98ad927e7367c7aa51" prefix=" " category="inline-code"></block> política funciona da mesma forma, mas não se restringe a volumes de proteção de dados.</block>
  <block id="10d8500e282e8bbacd668af6f773f412" category="paragraph">Com essa política, os blocos são imediatamente considerados frios e elegíveis para serem dispostos na camada de capacidade imediatamente.</block>
  <block id="ec583de0216b95bc673c84e4ec9356e6" category="paragraph">Essa política é especialmente apropriada para backups de longo prazo. Ele também pode ser usado como uma forma de Gerenciamento de armazenamento hierárquico (HSM). No passado, o HSM era comumente usado para categorizar os blocos de dados de um arquivo em fita, mantendo o próprio arquivo visível no sistema de arquivos. Um volume FabricPool com a<block ref="a181a603769c1f98ad927e7367c7aa51" prefix=" " category="inline-code"></block> política permite armazenar arquivos em um ambiente visível e gerenciável, mas não consome praticamente espaço na camada de storage local.</block>
  <block id="7a1920d61156abc05a60135aefe8bc67" category="doc">Padrão</block>
  <block id="5ba46d288640832c345e169b04a7458a" category="paragraph">Todos os volumes do FabricPool são inicialmente definidos como<block ref="c21f969b5f03d33d43e04f8f136e7682" prefix=" " category="inline-code"></block>, o que significa que o comportamento é controlado pela política de recuperação de nuvem. "O comportamento exato depende da política de disposição em camadas usada.</block>
  <block id="d556a0d2cad80695d1d803ebb49de9cd" category="section-title">Na leitura</block>
  <block id="7c39eb141ca855e5a211b468bd67636c" category="paragraph">A configuração<block ref="d253e682212338dd6cbe577947f0511e" prefix=" " category="inline-code"></block> como On-read substitui o comportamento padrão para que uma leitura de qualquer dado em camadas resulte no retorno desses dados ao nível de desempenho.</block>
  <block id="e07df43ea07fecb178484ef278644eb2" category="paragraph">Por exemplo, um volume pode ter sido levemente usado por um longo tempo sob<block ref="9df22f196a33acd0b372fe502de51211" prefix=" " category="inline-code"></block> a política de disposição em camadas e a maioria dos blocos agora está dividida.</block>
  <block id="98c8614a9e0467f220df33a02cf7550a" category="paragraph">Se uma mudança inesperada nas necessidades de negócios exigir que alguns dos dados sejam verificados repetidamente para preparar um determinado relatório, pode ser desejável alterar o<block ref="d253e682212338dd6cbe577947f0511e" prefix=" " category="inline-code"></block> para para<block ref="0ba0dc933ac714a0bef4467360437336" prefix=" " category="inline-code"></block> para garantir que todos os dados lidos sejam devolvidos ao nível de desempenho, incluindo dados de leitura sequencial e aleatória. Isso melhoraria o desempenho de e/S sequenciais em relação ao volume.</block>
  <block id="3ea4ba4aadef21fbda74c9b242c99efa" category="section-title">Promover</block>
  <block id="cb674c0cbcbaa23bdd3c8e4f6182f865" category="paragraph">O comportamento da política promover depende da política de disposição em camadas. Se a política de disposição em categorias for<block ref="9df22f196a33acd0b372fe502de51211" prefix=" " category="inline-code"></block>, a configuração do<block ref="723c2b1883eb9949dd821267c2d1b5c7" prefix=" " category="inline-code"></block> recuperará todos os blocos da camada de capacidade na próxima verificação de disposição em categorias.</block>
  <block id="452d85cc34fd3a4cf55ac61e732239f4" category="paragraph">Se a política de disposição em categorias for<block ref="8805d416ce540c5f2df34af5b18d742b" prefix=" " category="inline-code"></block>, os únicos blocos retornados serão os blocos associados ao sistema de arquivos ativo. Normalmente, isso não teria nenhum efeito porque os únicos blocos dispostos sob<block ref="8805d416ce540c5f2df34af5b18d742b" prefix=" " category="inline-code"></block> a política seriam blocos associados exclusivamente a snapshots. Não haveria blocos em camadas no sistema de arquivos ativo.</block>
  <block id="d6269fb1a970b6c261fedbc79464b3dc" category="paragraph">No entanto, se os dados em um volume tiverem sido restaurados por uma operação de clone de arquivo ou SnapRestore de volume a partir de um snapshot, alguns dos blocos que foram dispostos em camadas por estarem associados apenas a snapshots podem agora ser exigidos pelo sistema de arquivos ativo. Pode ser desejável alterar temporariamente a<block ref="d253e682212338dd6cbe577947f0511e" prefix=" " category="inline-code"></block> política para<block ref="eeefc0add5ccd6e20ac4214923d27fbc" prefix=" " category="inline-code"></block> recuperar rapidamente todos os blocos necessários localmente.</block>
  <block id="6e7b34fa59e1bd229b207892956dc41c" category="section-title">Nunca</block>
  <block id="c45e30a0f86af155e2feb17dd7ba6e44" category="paragraph">Não recupere blocos da camada de capacidade.</block>
  <block id="ac30d4a74ecef302adab70e9669a4bf2" category="paragraph">O FabricPool é uma tecnologia em camadas que classifica os blocos como ativos ou inativos e os coloca na camada mais apropriada de storage. A camada de performance fica na maioria das vezes localizada no storage SSD e hospeda os blocos de dados ativos. A camada de capacidade fica em um armazenamento de objetos e hospeda os blocos de dados inativos. O suporte ao storage de objetos inclui NetApp StorageGRID, ONTAP S3, storage Microsoft Azure Blob, serviço de storage de objetos Alibaba Cloud, IBM Cloud Object Storage, storage do Google Cloud e Amazon AWS S3.</block>
  <block id="f9f5fe2f7456d37c955f3291744c93b6" category="paragraph">Várias políticas de disposição em camadas estão disponíveis para controlar a classificação dos blocos como ativo ou inativo. Além disso, as políticas podem ser definidas por volume e alteradas conforme necessário. Somente os blocos de dados são movidos entre as categorias de performance e capacidade. Os metadados que definem a estrutura do sistema de arquivos e LUN sempre permanecem no nível de performance. Como resultado, o gerenciamento é centralizado no ONTAP. Os arquivos e LUNs não são diferentes dos dados armazenados em qualquer outra configuração do ONTAP. O controlador NetApp AFF ou FAS aplica as políticas definidas para mover dados para o nível apropriado.</block>
  <block id="616ce0475334fe37834d13972a168ca5" category="section-title">Provedores de armazenamento de objetos</block>
  <block id="71e79501cc067e6b35ac3d3e97c940a4" category="paragraph">Os protocolos de armazenamento de objetos usam solicitações HTTP ou HTTPS simples para armazenar um grande número de objetos de dados. O acesso ao armazenamento de objetos deve ser confiável, pois o acesso aos dados do ONTAP depende do atendimento imediato das solicitações. As opções incluem as opções de acesso padrão e pouco frequentes do Amazon S3, além do Microsoft Azure Hot and Cool Blob Storage, IBM Cloud e Google Cloud. As opções de arquivamento, como o Amazon Glacier e o Amazon Archive, não são suportadas porque o tempo necessário para recuperar dados pode exceder as tolerâncias dos sistemas operacionais e aplicativos host.</block>
  <block id="e114e830308285cd9085063fad91662c" category="paragraph">O NetApp StorageGRID também é compatível e é uma solução de classe empresarial ideal. Ele é um sistema de storage de objetos de alto desempenho, dimensionável e altamente seguro que pode fornecer redundância geográfica para dados do FabricPool, bem como outras aplicações de armazenamento de objetos que provavelmente farão parte dos ambientes de aplicativos empresariais.</block>
  <block id="fb318c5cd9ed18c79e1f7a298dd96665" category="paragraph">O StorageGRID também pode reduzir custos evitando as cobranças de saída impostas por muitos fornecedores de nuvem pública pela leitura de dados de seus serviços.</block>
  <block id="119d8a1213b5b7cae4bb567153b028cf" category="section-title">Dados e metadados</block>
  <block id="b59d6123a3191bd85fe14e57b7a01e11" category="paragraph">Observe que o termo "dados" aqui se aplica aos blocos de dados reais, não aos metadados. Apenas os blocos de dados são dispostos em camadas, enquanto os metadados permanecem na camada de performance. Além disso, o status de um bloco como quente ou frio só é afetado pela leitura do bloco de dados real. A simples leitura do nome, carimbo de data/hora ou metadados de propriedade de um arquivo não afeta a localização dos blocos de dados subjacentes.</block>
  <block id="1414cdc093d39dd56d0b0d20049e17fc" category="section-title">Backups</block>
  <block id="e0b766a7a0a7633679ecddd0f78a7390" category="paragraph">Embora o FabricPool possa reduzir significativamente o espaço físico do storage, ele não é por si só uma solução de backup. Os metadados do NetApp WAFL sempre permanecem no nível de performance. Se um desastre catastrófico destruir o nível de performance, não será possível criar um novo ambiente usando os dados na categoria de capacidade porque não contém metadados do WAFL.</block>
  <block id="7a25ce12890e524732cb71784b5915ab" category="paragraph">No entanto, o FabricPool pode se tornar parte de uma estratégia de backup. Por exemplo, o FabricPool pode ser configurado com a tecnologia de replicação NetApp SnapMirror. Cada metade do espelho pode ter sua própria conexão com um destino de armazenamento de objetos. O resultado são duas cópias independentes dos dados. A cópia primária consiste em blocos na camada de performance e blocos associados na camada de capacidade, e a réplica é um segundo conjunto de blocos de performance e capacidade.</block>
  <block id="1f9367b7afff301ee24188d35050ae0a" category="doc">Eficiência de armazenamento sensível à temperatura</block>
  <block id="41c719032afe187deaf4b4b2af41aa36" category="paragraph">A eficiência de armazenamento sensível à temperatura (TSSE) está disponível no ONTAP 9.8 e posterior. Ele depende de mapas de calor de acesso a blocos para identificar blocos acessados com pouca frequência e compactá-los com maior eficiência.</block>
  <block id="8284eb5a9d9bef8f0f1ece257656d0fe" category="summary">Informações adicionais sobre a Epic no ONTAP</block>
  <block id="345245c83d2b2c4c2a5eb9f2887da627" category="paragraph">Para saber mais sobre as informações descritas neste documento, consulte os seguintes documentos e/ou sites:</block>
  <block id="bc4fe2352063642d68529f2aa0ca7ca3" category="inline-link-macro">Documentação do produto NetApp</block>
  <block id="0897605072547ea93ef25a4b355ac5f6" category="list-text"><block ref="0897605072547ea93ef25a4b355ac5f6" category="inline-link-macro-rx"></block></block>
  <block id="5358757de9216cc29d688612a3d72fe1" category="inline-link-macro">Documentação do ONTAP 9</block>
  <block id="3973235e869d719328cf4b37e59562e5" category="list-text"><block ref="3973235e869d719328cf4b37e59562e5" category="inline-link-macro-rx"></block></block>
  <block id="c9cefb6ed873a418f8c8232dca6879d2" category="inline-link-macro">Grupos de consistência</block>
  <block id="10d6aff3e86ebe3712a2616b45008fb3" category="list-text"><block ref="10d6aff3e86ebe3712a2616b45008fb3" category="inline-link-macro-rx"></block></block>
  <block id="0d3cc094235677831b5697c5bab76394" category="inline-link-macro">Recursos de documentação do Gerenciador de sistemas ONTAP e ONTAP</block>
  <block id="3b2c8ae1d985c88d539bf7851e067922" category="list-text"><block ref="3b2c8ae1d985c88d539bf7851e067922" category="inline-link-macro-rx"></block></block>
  <block id="e9bf68ed54b6d1ff63e8bda8c0b6a70f" category="inline-link-macro">TR-3930i: Diretrizes de dimensionamento de NetApp para a Epic</block>
  <block id="920aa6d447930899ad56517c79fd12fc" category="list-text"><block ref="b6ff45309a811037a92ca1e6262c74a8" category="inline-link-macro-rx"></block> (É necessário iniciar sessão no NetApp)</block>
  <block id="840f4016fe968750d45ea4545f2f1893" category="section-title">Documentos épicos de orientação para o cliente</block>
  <block id="a839c9787ec80291f4b34dc5451786a5" category="paragraph">A Epic fornece aos clientes os seguintes documentos para orientação sobre servidor, armazenamento e rede. Estes documentos são referenciados neste relatório técnico.</block>
  <block id="67bab37630accce3ea259fb1601fca2e" category="list-text">Considerações sobre a rede da área de armazenamento</block>
  <block id="0fe2c5f32f45114c27e3b7a7ca0ba0ad" category="list-text">Guia de soluções técnicas de continuidade de negócios</block>
  <block id="2163e1881d92ff554d8969998a7d618f" category="list-text">Manual de estratégia de arquitetura de referência all-flash</block>
  <block id="b332ca8d59cd86adb52c28aef982cc69" category="list-text">Produtos de armazenamento e Status da tecnologia</block>
  <block id="a0107bedc201b2df3694df573f65ae32" category="list-text">Considerações sobre a nuvem épica</block>
  <block id="0cf7d14c360e7f8755d749057b348718" category="list-text">Guia de configuração de hardware (específico do cliente)</block>
  <block id="50923dab9020d1e069418763d0bd15a3" category="list-text">Recomendações de layout de armazenamento de banco de dados (específicas do cliente)</block>
  <block id="4e1249f2da2104e56555dec5d4d51e6a" category="summary">Arquitetura épica de quatro nós</block>
  <block id="7baf69c8e83ff08e0583426d011bc650" category="paragraph">As figuras abaixo mostram o layout de storage para uma arquitetura de quatro nós: Um par de HA em produção e um par de HA na recuperação de desastres. O tamanho dos controladores e o número de discos baseiam-se na última imagem de dimensionamento.</block>
  <block id="70ccc987c3596ca363e7b8d980858220" category="paragraph">A NetApp garante um desempenho mínimo ao nível do piso, aceitando as políticas recomendadas pela SLM. A Epic é compatível com a consolidação de pools de storage no ONTAP em muito menos hardware. Para obter mais informações, consulte o documento RELATÓRIOS trimestrais da Epic. Basicamente, pool1, pool2 e NAS1 (listados no Guia de configuração de hardware da Epic) podem ser executados em um único par de HA com workloads distribuídos uniformemente entre as duas controladoras. Na recuperação de desastres, o pool 3 e as 3 da Epic também são divididos entre as duas controladoras no par de HA.</block>
  <block id="34557edb2bf88cd4f837f2384ead1830" category="paragraph">Ambientes de cópia completa de teste (como SUP, REL e PJX) são clonados da Epic Production, Epic Report ou Epic Disaster Recovery. Para obter informações sobre backup e atualização da Epic, consulte a seção intitulada "Gerenciamento de dados".</block>
  <block id="5c8423bf649a8a50f33626549581cce9" category="section-title">Arquitetura de quatro nós</block>
  <block id="f42ac2802f367c372897f3fb06218d2d" category="inline-image-macro">Arquitetura épica de 4 nós</block>
  <block id="848f13dbd455e0190684bb8052ef94d6" category="paragraph"><block ref="848f13dbd455e0190684bb8052ef94d6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="14b8013c3961c3eb9f2d01aff2c9d430" category="section-title">Disposição do workload de quatro nós</block>
  <block id="8e576f920186d1c7001b6f1da66f2359" category="inline-image-macro">Disposição épica de 4 nós</block>
  <block id="34594b0fc43be2425a0a68f14928bc8d" category="paragraph"><block ref="34594b0fc43be2425a0a68f14928bc8d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="145a177f694025424b761a3b22ca2f6b" category="summary">Arquitetura épica de seis nós</block>
  <block id="7682e26e53b5af35c13c22f5034f788a" category="paragraph">Os clientes podem querer começar com um design de seis nós ou fazer escalabilidade horizontal de quatro a seis nós de forma otimizada, com demanda crescente. Com a escalabilidade horizontal, você pode mover workloads entre nós e rebalancear de modo ininterrupto no cluster.</block>
  <block id="121ec45abd57b78d2c63e13a01970fbf" category="paragraph">Essa arquitetura oferece o melhor desempenho e equilíbrio de capacidade no cluster. Produção épica, Epic Report e Epic Test são executados no primeiro par de HA. O segundo par de HA é usado para Clarity, Hyperspace, VMware, NAS1 e os demais workloads da Epic. A recuperação de desastres é a mesma que a arquitetura de quatro nós na seção anterior.</block>
  <block id="628e6fdb5831f5144730fdfb620a1a2a" category="section-title">Arquitetura de seis nós</block>
  <block id="5d28884b83f218379ec90c789e2e382b" category="inline-image-macro">Arquitetura épica de 6 nós</block>
  <block id="a5cf77b4851a534d4e7f8cbfc10e7734" category="paragraph"><block ref="a5cf77b4851a534d4e7f8cbfc10e7734" category="inline-image-macro-rx" type="image"></block></block>
  <block id="214d949b6d12c893a63f49d862292640" category="section-title">Disposição do workload de seis nós</block>
  <block id="65ea1ebb7d9c2d858f8701fcbecd438d" category="inline-image-macro">Disposição épica de 6 nós</block>
  <block id="77e8933cdf526d7670fcd797f57f81a7" category="paragraph"><block ref="77e8933cdf526d7670fcd797f57f81a7" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a3ab98b5217808d71238c069623fa0ff" category="summary">Arquitetura épica de oito nós</block>
  <block id="ab4e8eb50674d5d1bee79a6682b49325" category="paragraph">As figuras abaixo mostram a arquitetura de oito nós com escalabilidade horizontal. Novamente, você pode começar com quatro nós e escalar para seis nós e continuar a escalar para oito nós ou mais. Essa arquitetura oferece o melhor equilíbrio de performance e capacidade entre os seis nós em produção.</block>
  <block id="0ef10ffde0c0ebd21feabe96ec890f72" category="paragraph">Os ambientes de teste são clonados do Report em vez da produção nesse projeto. Isso descarrega os ambientes de teste e as verificações de integridade da produção.</block>
  <block id="211891edb616b1a6e25c469a73cd07c9" category="section-title">Arquitetura de oito nós</block>
  <block id="3b31cb391c5fb328f6bcf768909f68a2" category="paragraph"><block ref="3b31cb391c5fb328f6bcf768909f68a2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c344a01a287e43ab2ef2793cf550435a" category="section-title">Posicionamento do workload de oito nós</block>
  <block id="80a544c0b0187e121e581e019d0902a9" category="inline-image-macro">Disposição épica de 8 nós</block>
  <block id="e374fdf5079d6709ca8206b4c77be000" category="paragraph"><block ref="e374fdf5079d6709ca8206b4c77be000" category="inline-image-macro-rx" type="image"></block></block>
  <block id="17e9ce8e967d60724d7f53d467470a10" category="summary">Arquitetura épica</block>
  <block id="b1830ae1e99adb346ce1da353cd6c089" category="paragraph">Esta seção descreve o ambiente de software da Epic e os principais componentes que exigem storage. Ele fornece considerações essenciais para ajudar a orientar o design do armazenamento.</block>
  <block id="4db273f137d059bd4ffd23818c367214" category="paragraph">A EPIC, com sede em Verona, Wisconsin, faz software para grupos médicos de médio a grande porte, hospitais e organizações de saúde integradas. Os clientes também incluem hospitais comunitários, instalações acadêmicas, organizações infantis, provedores de redes de segurança e sistemas multi-hospitalares. O software integrado ao EPIC abrange funções clínicas, de acesso e de receita e se estende para casa.</block>
  <block id="27cd823999704d6e14cdee1e83bef7f0" category="paragraph">Está além do escopo deste documento cobrir a ampla gama de funções suportadas pelo software Epic. No entanto, do ponto de vista do sistema de storage, todos os softwares da Epic compartilham um único banco de dados centrado em pacientes para cada implantação. A Epic está migrando do banco de dados InterSystems Caché para o novo banco de dados InterSystems Iris. Como os requisitos de armazenamento são os mesmos para Caché e Iris, vamos nos referir ao banco de dados como Iris em todo o resto deste documento. O Iris está disponível para os sistemas operacionais AIX e Linux.</block>
  <block id="4e25ab2bd75f003927aabf72608c3610" category="section-title">Intersistemas Iris</block>
  <block id="0af82ac784148ef3818d2fe5b04763fa" category="paragraph">InterSystems Iris é o banco de dados usado pelo aplicativo Epic. Neste banco de dados, o servidor de dados é o ponto de acesso para dados armazenados persistentemente. O servidor de aplicativos gerencia consultas de banco de dados e faz solicitações de dados para o servidor de dados. Para a maioria dos ambientes de software da Epic, o uso da arquitetura de multiprocessadores simétricos (SMP) em um único servidor de banco de dados é suficiente para atender às solicitações de banco de dados dos aplicativos da Epic. Em grandes implantações, um modelo distribuído pode ser suportado usando o Enterprise Caché Protocol (ECP) da InterSystems.</block>
  <block id="8dfea4e602a85bafff792b879b2d056b" category="paragraph">O uso de hardware em cluster habilitado para failover permite que um servidor de dados em espera acesse o mesmo armazenamento que o servidor de dados primário. Ele também permite que o servidor de dados em espera assuma responsabilidades de processamento durante uma falha de hardware.</block>
  <block id="c77ab217583518f1b67702b591baf929" category="paragraph">A InterSystems também fornece tecnologias para atender aos requisitos de replicação de dados, recuperação de desastres e alta disponibilidade (HA). A tecnologia de replicação da InterSystems é usada para replicar um banco de dados Iris de forma síncrona ou assíncrona de um servidor de dados primário para um ou mais servidores de dados secundários. O NetApp SnapMirror é usado para replicar o armazenamento WebBLOB ou para backup e recuperação de desastres.</block>
  <block id="df2e58f9c6f746010ccdd5cf07673500" category="paragraph">O banco de dados atualizado do Iris tem muitas vantagens:</block>
  <block id="f8ffd660138274e3b7b31f900153e4b6" category="list-text">Aumentou a escala e permite que organizações maiores, com várias instâncias da Epic, se consolidem em uma instância maior.</block>
  <block id="242ef58734fef1421d6cc1e1154bd041" category="list-text">Um feriado de licenciamento onde os clientes podem agora se mover entre AIX e Red Hat Enterprise Linux (RHEL) sem pagar por uma nova licença de plataforma.</block>
  <block id="08a78b85487809e2116574e4ff97dec5" category="section-title">Servidores de banco de dados Caché e uso de armazenamento</block>
  <block id="4cc33a0396ddd5a29816a3a40d01a6b5" category="list-text">*Produção* em ambientes de software da Epic, um único banco de dados centrado no paciente é implantado. Nos requisitos de hardware da Epic, o servidor físico que hospeda o servidor de dados Iris primário de leitura/gravação é chamado de servidor de banco de dados de produção. Este servidor requer armazenamento all-flash de alto desempenho para arquivos pertencentes à instância de banco de dados principal. Para alta disponibilidade, a Epic oferece suporte ao uso de um servidor de banco de dados de failover que tenha acesso aos mesmos arquivos. O Iris usa o Epic Mirror para replicação para relatórios somente leitura, recuperação de desastres e suporte a cópias somente leitura. Cada tipo de servidor de banco de dados pode ser comutado para o modo de leitura/gravação por motivos de continuidade de negócios.</block>
  <block id="cdbcd4cba3ac1d1b15d302df69df1198" category="list-text">*Report* Um servidor de banco de dados espelho de relatório fornece acesso somente leitura aos dados de produção. Ele hospeda um servidor de dados Iris configurado como um espelho de backup do servidor de dados Iris de produção. O servidor de banco de dados de relatórios tem os mesmos requisitos de capacidade de armazenamento que o servidor de banco de dados de produção. A performance de gravação do relatório é a mesma que a produção, mas as características do workload de leitura são diferentes e dimensionadas de maneira diferente.</block>
  <block id="10938a446d1d37c3afcad8aac850f514" category="list-text">*Suporta somente leitura* este servidor de banco de dados é opcional e não é mostrado a figura abaixo. Um servidor de banco de dados espelhado também pode ser implantado para dar suporte à funcionalidade Epic somente leitura, na qual o acesso é fornecido a uma cópia de produção no modo somente leitura. Este tipo de servidor de banco de dados pode ser comutado para o modo de leitura/gravação por motivos de continuidade de negócios.</block>
  <block id="32042e6794444e49e092cad346b66b28" category="list-text">*Recuperação de desastres* para atender aos objetivos de continuidade de negócios e recuperação de desastres, um servidor de banco de dados espelhado de recuperação de desastres é comumente implantado em um local geograficamente separado dos servidores de banco de dados espelhados de produção e/ou relatório. Um servidor de banco de dados espelhado de recuperação de desastres também hospeda um servidor de dados Iris configurado como um espelho de backup do servidor de dados Iris de produção. Se o local de produção ficar indisponível por um longo período de tempo, este servidor de banco de dados espelho de backup pode ser configurado para atuar como uma instância de leitura/gravação espelhada (SRW). O servidor de banco de dados espelho de backup tem os mesmos requisitos de armazenamento de arquivos que o servidor de banco de dados de produção. Em contraste, o armazenamento do banco de dados espelhado de backup é dimensionado da mesma forma que o storage de produção da perspetiva de desempenho para a continuidade dos negócios.</block>
  <block id="d05c7e253f48b314f8488aba0e85b3b4" category="inline-image-macro">EPIC IRIS ODB</block>
  <block id="90cb7e5b029ac3a1b754d9f0d75bfbb9" category="paragraph"><block ref="90cb7e5b029ac3a1b754d9f0d75bfbb9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b101ffd23847579c0cf3cb028fc314ee" category="list-text">*Test* as organizações de saúde costumam implantar ambientes de desenvolvimento, teste e teste. Servidores de dados Iris adicionais para esses ambientes também exigem armazenamento, que pode ser acomodado pelo mesmo sistema de armazenamento. A Epic tem requisitos e restrições específicos para fornecer storage adicional a partir de um sistema de storage compartilhado. Esses requisitos específicos são tratados genericamente pelas melhores práticas neste documento.</block>
  <block id="5c52f2993ead7ce33b4600c9955d9657" category="paragraph">Além dos servidores de dados do Iris ODB, os ambientes de software da Epic geralmente incluem outros componentes, como o seguinte e como mostrado na figura abaixo:</block>
  <block id="c352fde153a95627d87a161b60e9e211" category="list-text">Um servidor de banco de dados Oracle ou Microsoft SQL Server como um back-end para as ferramentas de relatório de negócios Clarity da Epic</block>
  <block id="72e364f0316ce75144d3bcbc76627977" category="admonition">O Clarity é usado para relatar dados extraídos diariamente do banco de dados Iris de relatório.</block>
  <block id="9c7d7e54119a875f7f730fac34d86939" category="list-text">Servidor WebBLOB (SMB)</block>
  <block id="7f140c68d528349ef23a9adde829618a" category="list-text">Servidor de banco de dados multiuso</block>
  <block id="db670b036ce103ccc68fe4a2f746bcbb" category="list-text">Máquinas virtuais multiúso (VMs)</block>
  <block id="46f49acf82ce78d08668061bb78e679a" category="list-text">Hiperespaço para acesso ao cliente</block>
  <block id="847ce339c80d3a544fdd1e3ea23f89ed" category="inline-image-macro">Banco de dados épico</block>
  <block id="ddc0ff60fb0cba83974547cb2fd7a40e" category="paragraph"><block ref="ddc0ff60fb0cba83974547cb2fd7a40e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="300c335aaf3a97bb6020a19be0b8ca96" category="paragraph">Os requisitos de storage de todos esses vários workloads, pools, protocolos nas e SAN podem ser consolidados e hospedados por um único cluster ONTAP. Com essa consolidação, as organizações de saúde têm uma estratégia única de gerenciamento de dados para todos os workloads da Epic e não da Epic.</block>
  <block id="4a7de8a55a290fb3a0a4efd490ec781b" category="section-title">Workloads de banco de dados operacional</block>
  <block id="a627911d38337b81dddab9711a61842c" category="paragraph">Cada servidor de banco de dados Epic executa e/S nos seguintes tipos de arquivos:</block>
  <block id="458648f675593beefe031e7b7ba9fcdd" category="list-text">Ficheiros de base de dados</block>
  <block id="07599d3aee2c26c36cae1cb305a0d120" category="list-text">Arquivos de diário</block>
  <block id="b9c807a9cbbe80f3b710d64a47334ecf" category="list-text">Ficheiros de aplicação</block>
  <block id="4b11d0da3422be079767b9c81ea967cb" category="paragraph">O workload de um servidor de banco de dados individual depende de sua função no ambiente de software da Epic. Por exemplo, arquivos de banco de dados de produção geralmente incorrem na carga de trabalho mais exigente, consistindo de 100% de solicitações de e/S aleatórias. O workload de qualquer banco de dados espelhado geralmente é menos exigente e tem menos solicitações de leitura. As cargas de trabalho de arquivo diário são principalmente sequenciais.</block>
  <block id="6908d08a516bc86d102ccafa6c2ece9d" category="paragraph">A Epic mantém um modelo de workload para benchmark de desempenho de storage e workload de clientes. Para obter mais informações sobre o modelo de workload da Epic, os resultados de benchmark e as orientações sobre o uso de ferramentas de dimensionamento do NetApp para dimensionar o storage corretamente para ambientes da Epic, consulte<block ref="81c36a9e6d224e9d42c9630dffaa9434" category="inline-link-rx"></block> (login no NetApp necessário).</block>
  <block id="f71d6b15e61746171efc106f495b60cd" category="paragraph">A Epic também fornece a cada cliente um guia de configuração de hardware personalizado que contém projeções de e/S e requisitos de capacidade de storage. Os requisitos de storage finais podem incluir ambientes de desenvolvimento, teste e/ou preparo e quaisquer outros workloads auxiliares que possam ser consolidados. Os clientes podem usar o guia de configuração de hardware para comunicar os requisitos totais de armazenamento ao NetApp. Este guia contém todos os dados necessários para dimensionar a implantação da Epic.</block>
  <block id="c7a0b1a5f7a146b9b72947b2bba045ed" category="paragraph">Durante a fase de implantação, a Epic oferece um Guia de layout de storage de banco de dados, que fornece detalhes mais granulares em nível de LUN que podem ser usados para um design avançado de storage. Observe que o Guia de layout de armazenamento de banco de dados é recomendações gerais de armazenamento e não específico do NetApp. Use este guia para determinar o melhor layout de armazenamento no NetApp.</block>
  <block id="ab3b24e1e2a3f9784a9c6cad8db20a76" category="summary">Dimensionamento épico</block>
  <block id="706a0ec5dbae849750639964dc6b852f" category="paragraph">Uma das principais considerações da arquitetura ao dimensionar um ambiente de storage Epic é o tamanho do banco de dados ODB.</block>
  <block id="abe227b9b306ed7c0527800b44a2f1d0" category="paragraph">Use o diagrama abaixo para selecionar uma arquitetura de storage da Epic para pequeno e médio porte. Esses designs incluem a execução de todas as cargas de trabalho listadas no Guia de configuração de hardware. A árvore de dimensionamento é baseada em dados de mais de 100 guias de configuração de hardware e deve ser principalmente estimativa precisa.</block>
  <block id="be0322041cc582d91f5f470df1ef2ba4" category="paragraph">É importante notar que este é apenas um ponto de partida. Você deve trabalhar com nossa equipe de aliança Epic para confirmar todos os designs da Epic. A equipe pode ser alcançada em NetApp.com. Todas as implantações precisam atender às solicitações dos clientes, aderindo às práticas recomendadas pela Epic e pela NetApp.</block>
  <block id="20e8e833e31ffb5776ac701658144bd3" category="list-text">Arquitetura pequena da Epic com um banco de dados da Epic menos de 10TB TB</block>
  <block id="5d8ee21ec144a04a8287c0171b9a8527" category="list-text">Arquitetura média da Epic com um banco de dados da Epic de 10TB a 50TB</block>
  <block id="79ac7005a81d3ad4f64a1a5f5db00c7e" category="list-text">Grande arquitetura da Epic com um banco de dados da Epic de mais de 50TB TB</block>
  <block id="650c96055e8747d8b8a4c503b32aea8d" category="inline-image-macro">Orientação épica para dimensionamento</block>
  <block id="1c2004236bc67ea5f8fcc53a967ce698" category="paragraph"><block ref="1c2004236bc67ea5f8fcc53a967ce698" category="inline-image-macro-rx" type="image"></block></block>
  <block id="431d999c23fb9c149586aa971425928e" category="summary">Requisitos de storage épicos</block>
  <block id="8afb3f2b206e0239313a484fe51999d7" category="paragraph">Em geral, recursos de storage dedicados são fornecidos para o banco de dados de produção, enquanto as instâncias espelhadas compartilham recursos de storage secundário com outros componentes relacionados ao software da Epic, como as ferramentas de geração de relatórios Clarity.</block>
  <block id="d31081e8762bd0903adf5d3f0b769e73" category="paragraph">Outros ambientes de storage de software, como os usados para arquivos de sistema e aplicações, também são fornecidos pelos recursos de storage secundário.</block>
  <block id="ed879cdc9a77683dfbe5be59441dec43" category="paragraph">Além do dimensionamento, a Epic tem as seguintes regras de layout de storage adicionais e principais considerações:</block>
  <block id="ba76cf08b10101b5fee8e2e6d0da268e" category="list-text">Desde 2020, todos os workloads de banco de dados operacional (ODB) precisam estar em all-flash arrays.</block>
  <block id="542f0f7c69fde2bd55b5a36854a84fa3" category="list-text">A Epic recomenda que cada pool de storage esteja em hardware físico separado, incluindo pool1, pool2, pool3, NAS1 e NAS2.</block>
  <block id="919d67cad73121e6af0b2b20169d947b" category="admonition">Um nó em um cluster pode ser considerado como um pool de storage. Com o ONTAP 9.4 ou posterior e o AQoS, você pode criar pools protegidos usando políticas.</block>
  <block id="4449a7b5d2b5dfb4b1bad2ed2f86b5fd" category="list-text">Nova recomendação de backup da Epic 3-2-1.</block>
  <block id="b560499317ab0447790f01d7acd5401b" category="list-text">Cópia localizada no local remoto (recuperação de desastres)</block>
  <block id="09d6c5f51239ea513e80e433549993f4" category="list-text">Uma das cópias deve estar em uma plataforma de storage diferente da cópia primária</block>
  <block id="df5be706f042b26557014aa77c608eb6" category="list-text">Cópias dos dados</block>
  <block id="47311b53e9ae798223e097c4249a0668" category="admonition">Os clientes que usam o NetApp SnapMirror para fazer backup do NetApp não atendem às recomendações do 3-2-1. O motivo é que o ONTAP to ONTAP não satisfaz o segundo requisito listado acima. Você pode usar o SnapMirror diretamente do ONTAP para o storage de objetos no local (por meio da StorageGRID, por exemplo) ou para a nuvem para atender aos requisitos da Epic.</block>
  <block id="fef74abf89ce7520dbdabb6ae983ee4b" category="paragraph">Para obter mais informações sobre mandatos de storage, consulte os seguintes guias da Epic disponíveis no Galaxy:</block>
  <block id="bed1a6db332388739ca169835c6c3425" category="list-text">Considerações sobre SAN</block>
  <block id="9080906c2106e0567c91717cc003d027" category="list-text">Produtos de armazenamento e Status da tecnologia (spats)</block>
  <block id="81b560a1124b6edc7fe2858e332661b6" category="list-text">Guia de configuração de hardware</block>
  <block id="db11e37a9250a9db4d48618851771913" category="summary">Configuração épica de snapshots de storage</block>
  <block id="4cbb03cae0c07fb5c8e5d5e6df97064e" category="doc">Configuração de eficiência de storage épica</block>
  <block id="bc9c71d0bf41f8b2c8bde032eb1d97d0" category="paragraph">Os aplicativos com armazenamento distribuído em mais de um volume com um ou mais LUNs de quantidades apropriadas para a carga de trabalho precisam do backup do conteúdo, garantindo que a proteção de dados consistente exija CGS.</block>
  <block id="d43039551f875a24f15f154306be2586" category="paragraph">Grupos de consistência (CGS para abreviação) fornecem essa capacidade e muito mais. Eles podem ser usados todas as noites para criar snapshots consistentes sob demanda ou programados usando uma política. Use isso para restaurar, clonar e até mesmo replicar dados.</block>
  <block id="b5486be95ed9ae2e4681a39cf8fe8041" category="inline-link-macro">Visão geral dos grupos de consistência</block>
  <block id="cbe00f2bdd9a3c8aaaf5f8159a8750c1" category="paragraph">Para obter informações adicionais sobre a CGS, consulte a. <block ref="acc09d7e0c59ae3310cafae5d547383a" category="inline-link-macro-rx"></block></block>
  <block id="e62f16b222adc7aecc70ff7b56e652dc" category="paragraph">Assim que os volumes e LUNs forem provisionados conforme detalhado nas seções anteriores deste documento, eles poderão ser configurados em um conjunto de CGS. A melhor prática recomendada é configurá-los como descrito na imagem abaixo:</block>
  <block id="7dd784e39903a42471f96a6d0d6ae420" category="inline-image-macro">Layout de grupo de consistência épica</block>
  <block id="909e3795441b963b86fcad387196919f" category="paragraph"><block ref="909e3795441b963b86fcad387196919f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="15cc4389a08c3f4748e98622e630ad3e" category="section-title">Instantâneos do grupo de consistência</block>
  <block id="45dbe5c870e6de731da235aab8c51046" category="paragraph">Um cronograma de instantâneos CG noturno deve ser definido em cada um dos CGS-filho associado aos volumes que fornecem armazenamento para o banco de dados de produção. Isso resultará em um novo conjunto de backups consistentes desses CGS todas as noites. Eles podem ser usados para clonar o banco de dados de produção para uso em ambientes que não sejam de produção, como desenvolvimento e teste. A NetApp desenvolveu fluxos de trabalho Ansible automatizados baseados em CG para a Epic a fim de automatizar o backup dos bancos de dados de produção, os ambientes de atualização e teste também.</block>
  <block id="a93362f9de0aff40adccba50a939a6fa" category="paragraph">Os snapshots CG podem ser usados para dar suporte às operações de restauração do banco de dados de produção da Epic.</block>
  <block id="4bf6f09e67952b918985533c270b0668" category="paragraph">Para volumes SAN, desative a política de instantâneos padrão em cada volume usado para CGS. Esses snapshots geralmente são gerenciados pela aplicação de backup usada ou pelo serviço de automação do NetApp Epic Ansible.</block>
  <block id="7082753514151e011ff039e6fe23eba2" category="paragraph">Para volumes SAN, desative a política de instantâneos padrão em cada volume. Esses snapshots geralmente são gerenciados por uma aplicação de backup ou pela automação do Epic Ansible.[NS2]</block>
  <block id="669d2da75a76d767cc8259b5f37cacc3" category="paragraph">Os conjuntos de dados WebBLOB e VMware devem ser configurados como apenas volumes, não associados ao CGS. Você pode usar o SnapMirror para manter snapshots em sistemas de storage separados da produção.</block>
  <block id="5a6fb6753e1c4f748d223c8e329133fb" category="paragraph">Quando concluída, a configuração ficaria da seguinte forma:</block>
  <block id="926ce6c3b85cb26b415b6fc7e43f2879" category="inline-image-macro">Épico com snapshots CG</block>
  <block id="a578d209aa95904cf62330de918a003d" category="paragraph"><block ref="a578d209aa95904cf62330de918a003d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="193e03aa51a18f1e5d72b6a9dd240ed7" category="paragraph">As eficiências de linha do ONTAP são ativadas por padrão e funcionam independentemente do protocolo de storage, aplicação ou camada de storage.</block>
  <block id="f900dc6292f9bf9dcf98291ad5846d4b" category="paragraph">A eficiência reduz a quantidade de dados gravados em um storage flash caro e reduz o número de unidades necessárias. O ONTAP preserva a eficiência com a replicação. Cada uma das eficiências tem pouco ou nenhum efeito na performance, mesmo para uma aplicação sensível à latência, como a Epic.</block>
  <block id="936d07f32ce5afcd55e98c4a8cbce642" category="paragraph">*A NetApp recomenda* ativar todas as configurações de eficiência para maximizar a utilização do disco. Estas definições estão ativadas por predefinição nos sistemas baseados em AFF e ASA.</block>
  <block id="d4a551eeebb2992a4ffff1ad1083479a" category="paragraph">Os recursos a seguir possibilitam essa eficiência de storage:</block>
  <block id="cc0df1dcdfa0541f9c5dde8e0b570a36" category="list-text">A deduplicação economiza espaço no storage primário ao remover cópias redundantes de blocos em um volume que hospeda LUNs. Esta opção recomendada está ativada por predefinição.</block>
  <block id="db37fd6533f852997b6ae076ae5e86e0" category="list-text">A compactação in-line reduz a quantidade de dados a serem gravados em disco, e uma economia considerável de espaço é obtida com os workloads da Epic. Esta opção recomendada está ativada por predefinição.</block>
  <block id="c8afff3d362092825c7eda5b0b6b39af" category="list-text">A compactação in-line leva 4K blocos menos da metade cheios e os combina em um único bloco. Esta opção recomendada está ativada por predefinição.</block>
  <block id="b158d6ac5a43e19d1be67d7ba849494d" category="list-text">A thin replication está no centro do portfólio de software de proteção de dados da NetApp, que inclui o software NetApp SnapMirror. O thin replication SnapMirror protege os dados essenciais aos negócios, ao mesmo tempo em que minimiza os requisitos de capacidade de storage. *A NetApp recomenda* a ativação desta opção.</block>
  <block id="13fb0a52e16b7b3839f151b0847cd0d1" category="list-text">Deduplicação de agregado. A deduplicação sempre esteve no nível do volume. Com o ONTAP 9.2, a deduplicação agregada tornou-se disponível, proporcionando economia adicional de redução de disco. A deduplicação agregada pós-processo foi adicionada com o ONTAP 9.3. *A NetApp recomenda* a ativação desta opção.</block>
  <block id="46269eefafcbb08ab4667022c6491767" category="summary">Protocolos épicos e de arquivos</block>
  <block id="73a17ad0a24141989f242b5b099eec4f" category="paragraph">A combinação de nas e SAN no mesmo array all-flash é compatível.</block>
  <block id="688ffca27fb85bfb71c8a7632a871ec1" category="paragraph">*A NetApp recomenda* usar volumes FlexGroup para compartilhamentos nas, como WebBLOB (quando disponível).</block>
  <block id="55449fd175613962d882ab450cfc5f3c" category="inline-link-macro">FabricPool</block>
  <block id="1cd6516d7f54730b868069e2db63b528" category="paragraph">WebBLOB é até 95% de dados inativos. Como opção, você pode liberar espaço em seu array all-flash, em categorias e backups e dados inativos no storage de objetos no local ou na nuvem, usando o <block ref="e722be9b80fb0aa9c356c4300710e630" category="inline-link-macro-rx"></block>recurso do ONTAP. Tudo o que pode ser realizado sem qualquer efeito de desempenho percetível. FabricPool é um recurso incluído do ONTAP. Os clientes podem gerar um relatório de dados inativos (ou inativos) para analisar quanto benefício poderia ser obtido com a ativação do FabricPool. Você pode definir a idade dos dados para categorizar por meio da política. Com esse recurso, os clientes da Epic conseguiram economias significativas.</block>
  <block id="fc3145f7fe85a0cdfffb31f4034ada3b" category="summary">EPIC em ONTAP - Utilitários de host</block>
  <block id="f2f8d65f0baeae6d15c1016784ddadbf" category="paragraph">Os utilitários de host NetApp são pacotes de software para vários sistemas operacionais que contêm utilitários de gerenciamento, como o<block ref="3a8e4afa851609127d534b04e7d29c08" prefix=" " category="inline-code"></block> binário CLI, drivers multipath e outros arquivos importantes necessários para operações de SAN adequadas.</block>
  <block id="918d32b75f0ab883abba3a8dc0c3ae8d" category="inline-link-macro">Ferramenta de Matriz de interoperabilidade</block>
  <block id="23cfb87b0ff3960aab8099cbbb63b50b" category="inline-link-macro">Anfitriões de SAN</block>
  <block id="b0a8af1d81527bdd65ec0e8fb2a4b4e0" category="paragraph">*A NetApp recomenda* a instalação dos Utilitários de host do NetApp em hosts que estejam conetados e acessando sistemas de armazenamento do NetApp. Para obter mais informações, consulte <block ref="b2445b429f9784426e3dc1158e67c70d" category="inline-link-macro-rx"></block> e <block ref="7d7a0f71ed9bf2fe94a10fa9e1aeb381" category="inline-link-macro-rx"></block> documentação.</block>
  <block id="54ed29e411552372c5b6b9e2e1617e6d" category="admonition">Com o AIX, é especialmente importante que os Utilitários de host sejam instalados antes de descobrir LUNs. Isso garante que o comportamento de multipathing LUN esteja configurado corretamente. Se a descoberta foi realizada sem os Utilitários do host, os LUNs precisarão ser desfigurados do sistema usando o<block ref="9442434081221d63eaaa2c4799062866" prefix=" " category="inline-code"></block> comando e, em seguida, redescobertos via<block ref="fe54d1c30028417038a4ffe0fc5eb503" prefix=" " category="inline-code"></block> ou uma reinicialização.</block>
  <block id="e7a8be60cff2fec7b8ed793c4d2dddfe" category="summary">Configuração épica de volume e LUN</block>
  <block id="acdbb325faec5e3e2d86b3dbbaf90c54" category="paragraph">O documento de recomendações de layout de storage do banco de dados Epic fornece orientações sobre o tamanho e o número de LUNs para cada banco de dados.</block>
  <block id="a620ecf0a73eb209a145eb913a29bc5a" category="paragraph">É importante analisar este documento com o suporte do Epic DBA e da Epic, além de finalizar o número de LUNs e tamanhos de LUN de acordo com o ajuste. Essas recomendações de armazenamento são importantes para a profundidade da fila HBA, o desempenho do armazenamento, a facilidade de operação e a facilidade de expansão.</block>
  <block id="21ebeea1f14a138dfebb1b9599a4c3dd" category="paragraph">Para maximizar a performance de um workload, como Epic ODB ou Clarity, cada layout funciona melhor também para o storage NetApp. Com o uso de oito volumes, a e/S de gravação é distribuída uniformemente entre as controladoras, maximizando a utilização da CPU. Para replicação e backup, é melhor limitar o número de volumes a oito para simplificar as operações.</block>
  <block id="90adf331b7868c7af46ad6e035e93844" category="section-title">Opções de dimensionamento</block>
  <block id="b323bb297a66afc2eea7b89dd4019798" category="section-title">Volume e layout de 8 LUN</block>
  <block id="66d125e77a6185ef5cf43b2a6bffea80" category="inline-image-macro">Layout épico de 8 LUN</block>
  <block id="99a54ac1eaa5bd57b4c4c29d6a63f1ac" category="paragraph"><block ref="99a54ac1eaa5bd57b4c4c29d6a63f1ac" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c2ffe02d76c4f089648f1647b43e4ee5" category="section-title">Práticas recomendadas</block>
  <block id="bad4d79343f04d8b64999875ad328086" category="list-text">Equilibre os workloads entre o par de HA para maximizar a performance e a eficiência.</block>
  <block id="26b591a32a8a235db7f742995589a455" category="list-text">Usar LUNs e volumes provisionados com thin Provisioning.</block>
  <block id="9fb0aaeb125238e83485971ae6b7e2fc" category="list-text">Use no mínimo oito LUNs de banco de dados, dois LUNs de diário e dois LUNs de aplicativos. Esta configuração maximiza o desempenho do armazenamento e a profundidade da fila do SO. Mais pode ser usado se necessário por capacidade ou outros motivos.</block>
  <block id="ba5e00554d1ba1b8ca0fc2eaeda44672" category="list-text">Se você precisar adicionar LUNs a grupos de volumes, adicione oito LUNs de cada vez.</block>
  <block id="08c8ec6a9fefcf9c5c7dff1258aacf67" category="list-text">Os grupos de consistência (CGS) são necessários para que o grupo de volumes e LUNs sejam copiados juntos.</block>
  <block id="f513b81222a1b44f552ae172aeb697c9" category="list-text">Não use QoS durante o Genio ou qualquer desempenho de e/S.</block>
  <block id="b77a34499937c829a2c5c5a1cdc17f05" category="list-text">Após o teste Genio ou Clarity, a NetApp recomenda excluir o armazenamento e o reprovisionamento antes de carregar os dados de produção.</block>
  <block id="186bc47646aec5e2abf40b2605a16461" category="list-text">É importante que<block ref="54645d7349dcc4fe9d7d19985a40c2c9" prefix=" " category="inline-code"></block> ativado esteja definido nos LUNs. Caso contrário, os dados excluídos nos LUNs não serão vistos pelo ONTAP e poderão causar problemas de capacidade. Para obter mais informações, consulte o Guia de Referência rápida de Configuração do Epic Storage.</block>
  <block id="153c47e1653d87804319da1fe347f29b" category="summary">Gerenciamento de performance épico</block>
  <block id="912975539030067a6f1874223cda9b75" category="paragraph">A maioria dos all-flash arrays garante a performance necessária para os workloads da Epic. O diferencial do NetApp é a capacidade de definir políticas de performance no nível básico e garantir uma performance consistente para cada aplicação.</block>
  <block id="edfc4c86589e31546a8fb2d8b085b8c9" category="section-title">Qualidade do serviço (QoS)</block>
  <block id="8080e6f80ff76b571829265ee2917e87" category="paragraph">A NetApp recomenda o uso de QoS. O benefício da QoS é a capacidade de consolidar todos os workloads da Epic. Todos os protocolos e pools de storage podem residir em menos hardware. Não é necessário separar pools de storage.</block>
  <block id="44c2f7cd7c41efaae67916780bf96079" category="list-text">A NetApp recomenda que todos os workloads no cluster sejam atribuídos a uma política de QoS para melhor gerenciar o espaço livre no cluster.</block>
  <block id="d90d7fd828646173964451dadbe758c1" category="list-text">A NetApp recomenda o balanceamento de todos os workloads uniformemente entre o par de HA.</block>
  <block id="a77412a540f86bfc443abfcef22db414" category="list-text">Não use políticas de QoS ao executar qualquer teste de e/S; caso contrário, o teste do Genio falhará. Analise os diferentes workloads de produção por 2-4 semanas antes de atribuir políticas de QoS.</block>
  <block id="c36c006dced61f1e460ff43516fa7294" category="summary">Épico em ONTAP - protocolos</block>
  <block id="0f079f7da3a6e5c8a52a3aca113fd3e6" category="paragraph">FCP é o protocolo preferido para a apresentação de LUNs.</block>
  <block id="97ec588f063ba0f25df2b93eda2639c8" category="paragraph">*A NetApp recomenda* zoneamento de iniciador único: Um iniciador por zona com todas as portas de destino necessárias no armazenamento usando nomes de portas mundiais (WWPNs). A presença de mais de um iniciador em uma única zona é suscetível de levar a interferência cruzada HBA intermitente, o que causa uma interrupção significativa.</block>
  <block id="880bc24c60e1d6eb559f57440c27f955" category="paragraph">Depois que o LUN é criado, mapeie o LUN para o grupo de iniciadores (igrop) que contém as WWPNs do host para habilitar o acesso.</block>
  <block id="d8609b6e37acaad082fff919da3c6691" category="paragraph">O NetApp também dá suporte ao uso de NVMe/FC (se você tiver versões dos sistemas operacionais AIX e RHEL capazes) e melhora a performance. FCP e NVMe/FC podem coexistir na mesma malha.</block>
  <block id="2586e87005565fe66fa19a3af50f632c" category="summary">Dimensionamento de storage para Epic</block>
  <block id="5e3e8694114d62a133f86c691b0d1d68" category="paragraph">Você deve trabalhar com nossa equipe de aliança Epic para confirmar todos os designs da Epic. A equipe pode ser alcançada em NetApp.com. Todas as implantações precisam atender às solicitações dos clientes, aderindo às práticas recomendadas pela Epic e pela NetApp.</block>
  <block id="c77c62342c6d144df81571fee8e8a4e8" category="paragraph">Para obter informações sobre como usar as ferramentas de dimensionamento do NetApp para determinar o tamanho e o número corretos de grupos RAID para as necessidades de storage do ambiente de software da Epic, consulte <block ref="b6ff45309a811037a92ca1e6262c74a8" category="inline-link-macro-rx"></block> (login no NetApp necessário).</block>
  <block id="6fff8a4d9dc5db1aefc3e3a86c26dbd7" category="admonition">O acesso ao portal de campo do NetApp é necessário.</block>
  <block id="1484157a851d4053990c9bf55fb59e58" category="summary">Implementação de exemplo épica em ONTAP - agregados</block>
  <block id="e8f3d574ecc3fdf160285a0c9a5a7046" category="paragraph">Para obter a documentação mais recente sobre o provisionamento de agregados, clique <block ref="a20b867e80db6cfd4fb8336d84c1fcc5" category="inline-link-macro-rx"></block>em .</block>
  <block id="f2871c08962452bb98a23ee83880a7dd" category="admonition">As configurações padrão otimizam o desempenho e a capacidade. Um agregado grande é criado por nó.</block>
  <block id="46b67d0e3c5baea52f318c392862983a" category="summary">EPIC em ONTAP exemplo de implementação - sistemas de arquivos</block>
  <block id="ff902a0a262960f8bf9189923c1ff7d9" category="paragraph">Para obter informações sobre a montagem de LUNs, a criação de grupos de volumes e volumes lógicos e a configuração dos sistemas de arquivos, consulte o Guia de Referência rápida da Epic Storage Configuration. Use os comandos de exemplo a seguir para configurar servidores de produção Epic para RHEL.</block>
  <block id="f54e4ad7066826fa3c18dcb8a62ddd03" category="section-title">Sistema de arquivos e opções de montagem</block>
  <block id="ca487f2e3d336dbbead8ef7ce6f1dc6c" category="paragraph">Depois que os LUNs tiverem sido criados e mapeados e o zoneamento estiver concluído, use o procedimento a seguir para anexar o armazenamento ao servidor.</block>
  <block id="232aac42537fa2491071068a6dacfe10" category="admonition">Neste exemplo, usamos 8x 1024Gb LUNs para o banco de dados, 2x 1024Gb LUNs para periódicos e 2x 1024Gb LUNs para instalações de aplicativos.</block>
  <block id="cdf658da371089bb06d8dc79b4ae2e2e" category="section-title">E/S assíncrona</block>
  <block id="86c5811d8dc490e1467aed33484d89f2" category="paragraph">Uma cópia do whitepaper sobre considerações de SAN da Epic e do documento Referência rápida de configuração de storage fornecem detalhes sobre como configurar os hosts e se conetar ao storage. Esta seção analisa como configurar um host Red Hat Enterprise Linux. Os detalhes DE AIX podem ser encontrados nos documentos referenciados.</block>
  <block id="81cba0a3715b5297330ade2beaa9dc7d" category="summary">Implantação de exemplo épica no ONTAP - LUNs</block>
  <block id="30baf86157b500051493cda4ff1be0c3" category="paragraph">&gt;&gt;&gt; marcador de posição para frase ou parágrafo descritivo</block>
  <block id="6aa18085c59b7b34360d5dff15bf6e84" category="paragraph">Criar LUN</block>
  <block id="6a761ce5c1cf1122b1aaea2aec3cfc85" category="paragraph">Para criar um LUN:<block ref="18244093c882fe4e65acdec6d61f9f95" category="inline-link-rx"></block></block>
  <block id="8ede5bcd129cb7b52add8d233c5e5867" category="paragraph">Adicione volumes ao CG</block>
  <block id="4bd3faeb169131a1ecbf00026f146a6f" category="paragraph">Para criar ou modificar grupos de consistência:<block ref="52ad8c1ba289849e0c6ebe85b916c91a" category="inline-link-rx"></block></block>
  <block id="1093fcc785c9f0e59ff32142b73ff3a5" category="paragraph">LUN de mapa</block>
  <block id="9e5dabcfb97ff08290166a6dd001c95e" category="paragraph">Para mapear o LUN:<block ref="8b5a6c46b302a4299b28e891d262657f" category="inline-link-rx"></block></block>
  <block id="73a228bbb9b14b5f966f329a201b115d" category="paragraph">Dependendo da versão do ONTAP, a configuração padrão para reserva fracional no volume pode ser de 100%. Esta configuração deve ser definida como 0.</block>
  <block id="b13aace07f0445cf1ff16be054bcc01e" category="summary">Implantação de exemplo épica no ONTAP</block>
  <block id="cca1d6e8ff542fcd4d1315f7f9033467" category="paragraph">Esta seção leva você por uma configuração avançada completa de um cluster do ONTAP, provisionamento e apresentação de storage para um servidor da Epic.</block>
  <block id="df8f0aad2b90e887efba35ecbc7e6546" category="paragraph">Com o objetivo de capturar detalhes e para facilitar a documentação, a linha de comando é usada. Se a GUI for preferida, você pode provisionar todas as configurações no System Manager.</block>
  <block id="d706ffe8745cb55ce7b7d1c7dfa458dd" category="paragraph">Historicamente, a configuração inicial em massa para projetos maiores geralmente é mais rápida usando os comandos listados Tabela 1, especialmente se você concatenar os comandos em uma Planilha. Esta lista de comandos também serve como excelente documentação de compilação.</block>
  <block id="12c8172fde8f9b3f81c3ed0d2805f3d4" category="paragraph">Outra opção de provisionamento é usar os scripts de automação do dia 0 e do dia 1 usando o Ansible. O NetApp tem centenas de playbooks existentes do Ansible disponíveis para download, incluindo a coleção do Ansible-Galaxy através do comando NetApp.ONTAP de instalação da coleção Ansible-Galaxy.</block>
  <block id="80455b40cdd7b477184d76f23f747af1" category="paragraph">A GUI também funciona muito bem com um simples LUN de página única e provisionamento compartilhado. A GUI é melhor usada para operações ao adicionar, modificar ou excluir armazenamento. Qualquer opção está bem se você aplicar as configurações de armazenamento de práticas recomendadas na Tabela 1.</block>
  <block id="d7441f24bee2c1922760ce27f5e978ec" category="paragraph">A configuração completa do cluster e o provisionamento de storage/host não devem levar mais de uma hora quando encenado.</block>
  <block id="3924c8a2656c72cc0c7d6a27f9ad08ea" category="paragraph">* Configurações de armazenamento de boas práticas*</block>
  <block id="51ac4bf63a0c6a9cefa7ba69b4154ef1" category="cell">Definição</block>
  <block id="689202409e48743b914713f96d93947c" category="cell">Valor</block>
  <block id="2ee34178bb8415b7d7234cd27b83aed6" category="cell">Agregado</block>
  <block id="ae6bd8a277455ba774ffc217a2f8a539" category="cell">Provisionamento automático padrão, um agregado ADP por nó com RAID DEP</block>
  <block id="0b7e67b6cdcf0432b624d53588d520fb" category="cell">SVM</block>
  <block id="63555da25f96be027cd722d9f281cffa" category="cell">Dois SVMs ao usar o multiprocol (Block SVM e SMB/NFS SVM). Use a convenção de nomenclatura Epic e de protocolo. Use o estilo de segurança adequado</block>
  <block id="aec0819ab194aee8aab8a5e40aad8343" category="cell">Garantia de espaço de volume</block>
  <block id="334c4a4c42fdb79d7ebc3e73b517e6f8" category="cell">nenhum</block>
  <block id="d374cbba7f603e6be8e6450a6b3feb45" category="cell">Política do Snapshot de volume</block>
  <block id="8285885018fdba6d87edc774237f0e24" category="cell">Dimensionamento automático de volume</block>
  <block id="4d200fce73a8e1cc965cfc2c43343824" category="cell">crescer</block>
  <block id="948111f101cd4e13c4a1e21775e9742d" category="cell">Dimensionamento automático máximo do volume</block>
  <block id="fde7826aacd46b7610beed2b0ef8d81e" category="cell">2T ou 2 X tamanho LUN</block>
  <block id="ca714a7089246aff7f85bbda97ba660b" category="cell">Volume snapshot Autodelete</block>
  <block id="a10311459433adf322f2590a4987c423" category="cell">ativado</block>
  <block id="6bb41960470a19d97556b9240ac0b3ff" category="cell">Tamanho do volume</block>
  <block id="9bba382221ce257d09f3f50492803815" category="cell">1,5 x tamanho de LUN</block>
  <block id="dc85eb20ed6dd71700df76a7f9acd32b" category="cell">Layout do volume</block>
  <block id="370e47099244ee43c575d91449bb7e36" category="cell">Distribuído mesmo entre controladores</block>
  <block id="ca301c828c76b7b6b1a9b621ba37f603" category="cell">tipo de grupo</block>
  <block id="d6c56de514a4a8fe23f54d6b42dd23af" category="cell">Quando usado com servidores físicos, o VMware digita quando usado com o ESX.</block>
  <block id="bbd68bf55ab562da30e73449f1b87424" category="summary">Implementação de exemplo épico no ONTAP - protocolos</block>
  <block id="589b83bd3c7696acc0086c7f233e64e3" category="doc">Implementação de exemplo épico no ONTAP - plataformas</block>
  <block id="05f72896244a448167caa4a410eb4ecf" category="paragraph">Para workloads de aplicações, periódicos e bancos de dados ODB da Epic, a Epic recomenda a apresentação de storage nos servidores como LUNs FCP.</block>
  <block id="d2ec366dff0b7a3eda35e6acf91f6898" category="paragraph">Os clientes da NetApp executam com sucesso todos os workloads da Epic na nuvem do Azure. A AWS também pode executar workloads da Epic. Com o NetApp Cloud Volumes ONTAP e o NetApp Cloud volumes Services, o NetApp oferece as funcionalidades de classe empresarial e a performance necessária para executar a Epic na nuvem com eficiência. As opções de nuvem da NetApp fornecem bloco sobre iSCSI e arquivo em NFS ou SMB.</block>
  <block id="a3a5d01a736b2f5bc994d2ff7b0da8c5" category="summary">Implantação de exemplo épica no ONTAP - protocolo FCP</block>
  <block id="dc0e595680f18844673c0930ecf1ca6b" category="paragraph">Depois que o SVM tiver sido criado, você precisará adicionar protocolos a ele.</block>
  <block id="263a628397d3f78e3b61f40863b0868f" category="paragraph">Para criar LIFs de dados FCP, clique <block ref="8f46d074b2d46f416cb36dce6f8bd76d" category="inline-link-macro-rx"></block>em .</block>
  <block id="663c2decd75c93fbad53179b6016c0d1" category="paragraph">Os grupos de iniciadores são usados para permitir o acesso do servidor a LUNs. Para criar um iGroup, clique <block ref="c6345eebd77187b1723cf47095ffbd0f" category="inline-link-macro-rx"></block>em .</block>
  <block id="93f7209bec244568b95ac2f8f50896d7" category="summary">Implementação de exemplo épico no ONTAP - SVMs</block>
  <block id="39ce7fcbb7e39843ad7e81e460901359" category="paragraph">O NetApp virtualiza o storage, e o acesso do usuário é fornecido pelo SVM.</block>
  <block id="8c22ab38f47a2a116e19714defb5f005" category="paragraph">Para a Epic, há um SVM FCP e um SVM SMB. Dependendo de como você deseja gerenciar seu storage e possivelmente alocação a vários clientes, você pode usar mais SVMs.</block>
  <block id="99889a411324e95bb7313521d10d972b" category="paragraph">Para configurar um SVM, clique em <block ref="cb8e547e3f29ee63864aeed75c724bf1" category="inline-link-macro-rx"></block></block>
  <block id="abf025601df70d9ba931fe67b1cc4a79" category="summary">Implementação de exemplo épico no ONTAP - volumes</block>
  <block id="02594c71ca915876e2512e474d8b462d" category="paragraph">Para criar volumes, consulte<block ref="b6546da834bc505016791ad9e7ec9d1e" category="inline-link-rx"></block></block>
  <block id="36e2bc00e48fbcfe5ae35a8a6056788c" category="admonition">A partir do ONTAP 9.7, a criptografia de volume e agregado é habilitada por padrão quando você tem uma licença NVE e gerenciamento de chaves externas ou integradas. Para ativar a deduplicação em nível de volume, defina o comando add -criptografar a falha para o comando criar/modificar volume (se você tiver uma licença NVE).</block>
  <block id="7a112f92e38a30129ab13d18331e21ce" category="section-title">Instantâneos a bordo</block>
  <block id="f118801694edca90b5e446d3fe39cda0" category="paragraph">Para instantâneos de funcionamento em rede:<block ref="ecea59d033fb2dad1d38e75fbdc1c820" category="inline-link-rx"></block></block>
  <block id="e324e68086bb9c9e930b9d1168f1de5d" category="summary">Disponibilidade épica em ONTAP</block>
  <block id="8339b88fddad3cfe433f684a83da04eb" category="paragraph">No centro da ONTAP estão operações ininterruptas que permitem a você evitar interrupções dispendiosas nas operações de negócios.</block>
  <block id="ca7972f1caf7a478b4f931e986112b62" category="paragraph">O NetApp oferece disponibilidade de mais de 99,99,999999% com base em dados de produção, que são chamados de casa por meio do NetApp Active IQ. Cada par de HA no cluster não tem um ponto único de falha. O ONTAP data de 1992 e é o software de gerenciamento de dados mais implantado do mundo, com um histórico excepcional de fornecimento de storage confiável. Agora, com o monitoramento proativo do Active IQ e a resolução automática de 97% dos problemas, a disponibilidade aumenta com bastante menos casos de suporte.</block>
  <block id="43a21754b069ee170b1858e00c4072df" category="paragraph">A Epic recomenda o uso de sistemas de storage de HA para reduzir a falha de componentes de hardware. Esta recomendação se estende do hardware básico (como fontes de alimentação redundantes) à rede (como rede multipath).</block>
  <block id="58992d12f27d940ad0ced78080987a44" category="paragraph">Quando você precisa atualizar o storage, fazer escalabilidade vertical, fazer escalabilidade horizontal ou rebalancear workloads no cluster, não há efeito no atendimento aos pacientes. Você pode mover dados, mas nunca mais precisa interromper o atendimento ao paciente com migrações de dados ou atualizações em massa. Passe para a tecnologia de nova geração, pronta para o futuro e evite o aprisionamento tecnológico. O NetApp ainda oferece uma garantia de disponibilidade por escrito de 100%.</block>
  <block id="071a41c2bfc6123073746c5459501089" category="inline-link-macro">Confiabilidade, disponibilidade, capacidade de manutenção e segurança da NetApp ONTAP</block>
  <block id="c38a90bcf1a9aa5905c0c4e6fbac331b" category="paragraph">Mais informações sobre confiabilidade, disponibilidade, capacidade de manutenção e recursos de segurança da NetApp podem ser encontradas no <block ref="c4f5dec030b0bd57318efbed2e25e7a7" category="inline-link-macro-rx"></block> white paper.</block>
  <block id="12a3215a6e17b2d4e547b8c9ddb4db59" category="summary">Proteção de dados épica</block>
  <block id="e2f4ffd17d85ea8c667a8fa10eaa81bd" category="doc">Clonagem épica</block>
  <block id="d777ff146845d0c5a59b451dcdd63eff" category="paragraph">A Epic reconhece que a tecnologia NetApp Snapshot baseada em nós de storage não afeta os workloads de produção em comparação com os backups tradicionais baseados em arquivo. Quando os backups Snapshot são usados como uma fonte de recuperação para o banco de dados de produção, o método de backup deve ser implementado tendo em mente a consistência do banco de dados.</block>
  <block id="7952c7481879c42a618f85cfab77dc0b" category="paragraph">Um snapshot é uma cópia de backup pontual e somente leitura de um volume. O NetApp FlexClone tira um instantâneo e o torna instantaneamente lido e gravável. Os volumes do FlexClone agregam muito valor, tirando snapshots consistentes com aplicações somente leitura e criando volumes FlexClone graváveis a partir de dados de produção. Essa funcionalidade nativa tem um impacto significativo nas funcionalidades de automação, tempo de operações e economia de storage.</block>
  <block id="dd12a5170cc960b0ed4afe4f23fd727b" category="paragraph">Para o processo de atualização, são usados volumes FlexClone.</block>
  <block id="198010d8bf8a3ff0f084ffd059a9a1da" category="section-title">Gerenciamento de dados</block>
  <block id="31949f92a027681e10fa0ae809d62bcd" category="paragraph">Como parte da solução, o NetApp oferece uma solução de backup e atualização de teste totalmente automatizada usando ferramentas nativas do ONTAP. Essa solução foi projetada para simplificar o gerenciamento de dados da Epic, especificamente para a grande comunidade de administradores de banco de dados (DBAs) da Epic:</block>
  <block id="bde282ad1e62a3d8d64bcbebfd99918c" category="list-text">O Epic Mirror é usado para replicar dados para recuperação de desastres e relatório (indicado em verde).</block>
  <block id="89c4ed523f61f9d3446182d80a53c8b6" category="list-text">Os dados diários são despejados do relatório para a clareza.</block>
  <block id="c3d37da5ec71148ab4d2292c5fc62181" category="list-text">Backups automáticos do NetApp (indicados com amarelo).</block>
  <block id="f417d841f910f45d16ac64fccd850be8" category="list-text">Atualização automática do teste NetApp do SUP, REP e outros (indicado com azul).</block>
  <block id="2a7a6372892435f5d284e730df618c35" category="list-text">Os ambientes de teste são para ambientes de cópia completa, e não para cópias squash menores.</block>
  <block id="88b2dcefc205727508d4017aacafaafd" category="paragraph">Para obter mais informações, entre em Contato com os Serviços da NetApp para aplicações da Epic.</block>
  <block id="4e3e281c19bf41f436de9fe363daa25c" category="paragraph">Grupos de consistência (CGS para abreviação) fornecem essa capacidade e muito mais. Eles podem ser usados todas as noites para criar snapshots consistentes sob demanda ou programados usando uma política. Use isso para restaurar, clonar e até mesmo replicar dados.</block>
  <block id="f5de57234e68f27cbd82acfc80f2d5cb" category="inline-link-macro">Documentação do NetApp sobre grupos de consistência</block>
  <block id="f7e43fe614bf53ff9721f7494c0caf16" category="paragraph">Para obter informações adicionais sobre a CGS, consulte <block ref="0efc681e89d66f1c589ad00a8ae67afa" category="inline-link-macro-rx"></block></block>
  <block id="9f42082fda47a6a26e6c6e6bcc14526e" category="section-title">Configurando grupos de consistência para a Epic</block>
  <block id="7d381e222258ec55bcf215684ae70097" category="inline-image-macro">Grupos épicos e consistentes</block>
  <block id="4eb8f91ee432a8e69615314961db4f88" category="paragraph"><block ref="4eb8f91ee432a8e69615314961db4f88" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4294e0bf4b67190ddcb91a01b3c4356c" category="section-title">Instantâneos do Grupo de consistência</block>
  <block id="86cfb45aaa741215d8d8d58223948dcc" category="paragraph">Os conjuntos de dados WebBLOB e VMare devem ser configurados como apenas volumes, não associados ao CGS. Você pode usar a tecnologia SnapMirror ou SnapVault para manter as cópias Snapshot em sistemas de storage separados da produção.</block>
  <block id="f5445123331a1b74a34fd1f392e9e946" category="inline-image-macro">Instantâneos CG épicos</block>
  <block id="92aabd14a16803d9fa65ca4f94488322" category="paragraph"><block ref="92aabd14a16803d9fa65ca4f94488322" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9c71026f6349a81cd2a3cfcfa8ea9ceb" category="summary">Épico na consolidação de ONTAP</block>
  <block id="569a30a99d3744f0871a7c36162f469c" category="paragraph">Um dos principais desafios da saúde é a ineficiência dos ambientes em silos.</block>
  <block id="87b522a84cee7651eb3ea5c59d4c9a35" category="paragraph">Soluções de múltiplos pontos são criadas por vários grupos que impedem o progresso. Ter uma estratégia unificada para o gerenciamento de dados traz eficiência para acelerar a transformação. Tecnologia disruptiva, como a digitalização de Registros de pacientes, ransomware e IA generativa, impulsionam a necessidade de consolidação.</block>
  <block id="882f36b3d76e4e5b9ac08850c1e7a15a" category="paragraph">Com o ONTAP, você consolida arquivo/bloco/objeto e cada um dos workloads de categoria 0/1/2/3, no local e na nuvem, todos executados no ONTAP.</block>
  <block id="0b153e0d191221abe8c325950ab9a03b" category="summary">Épica em eficiência de ONTAP</block>
  <block id="12ca553efec3e73a9120d8c050d405a9" category="paragraph">A Epic é executada em all-flash arrays em que a maior parte do custo é o disco. Portanto, a eficiência de storage é essencial para a economia de custos.</block>
  <block id="aac466a460fe672b45d2e43b476f772e" category="paragraph">A eficiência de storage in-line da NetApp alcança economias líderes do setor em storage sem afetar a performance. Além disso, oferecemos uma garantia de eficiência por escrito com os all-flash arrays.</block>
  <block id="436525ee58a117eefbde96bb2f0cae02" category="paragraph">Ao calcular a eficiência de storage, é importante medir o bruto para utilizável para capacidade efetiva.</block>
  <block id="bbf547b93564824fe00f04646269a56e" category="list-text">* Capacidade bruta* antes de qualquer RAID ser aplicado, tamanho do disco pelo número de discos.</block>
  <block id="29cabda6c17d251ab3bba7feb41646fc" category="list-text">*Capacidade utilizável* após a aplicação do RAID, quanto armazenamento utilizável está disponível.</block>
  <block id="9edb4e889ca40d3881217c9433ecb376" category="list-text">*Capacidade efetiva* quanto armazenamento é provisionado e apresentado ao host ou cliente.</block>
  <block id="21e10a177fbffc69f63f5dcdb44175f5" category="paragraph">A figura abaixo mostra um exemplo de cálculo de eficiência de uma implantação típica da Epic, incluindo todos os workloads que exigem 852TB TB de storage efetivo e com eficiência de 5,2:1, fornecendo 1,32PB TB de dados efetivos totais.</block>
  <block id="c8c2fd097c28062ec912ad0d2f9bbe11" category="admonition">Com base no número de discos, a capacidade bruta para utilizável varia ligeiramente.</block>
  <block id="f0a0c9b18011b122c315d8970dbcce49" category="inline-image-macro">Eficiência de storage épica</block>
  <block id="d145883b21ccbccb471abc3a5dac40f3" category="paragraph"><block ref="d145883b21ccbccb471abc3a5dac40f3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="bf8acecf163b9e71e2e9331bc87c5e90" category="admonition">A NetApp não usa a tecnologia NetApp Snapshot nem o thin Provisioning para calcular a eficiência no programa de garantia. Fazer isso mostraria eficiências irrealistas de 30 a 100:1, o que não significa nada ao dimensionar a capacidade de storage do mundo real.</block>
  <block id="f4f81a0ab85224d234bc465988b5b871" category="summary">Visão geral da Epic na ONTAP</block>
  <block id="35b4c598dd74c59e91d978c12210cc03" category="doc">ÉPICO em ONTAP</block>
  <block id="52aaae321a4b3f69eaf3448c22d2d55c" category="paragraph">O Epic é mais fácil com o ONTAP.</block>
  <block id="76d68daeac9b3e7a8cfb0c3d904ac7de" category="paragraph">O ONTAP é uma plataforma de gerenciamento de dados que permite consolidar workloads da Epic enquanto atende a todos os requisitos de performance, proteção de dados e gerenciamento de dados.</block>
  <block id="85e6f9f2e3539043a3a60b16af5a654f" category="paragraph">Somente na NetApp você padroniza todos os workloads do setor de saúde para SAN, nas e objetos em uma única plataforma de gerenciamento de dados de alta disponibilidade. O ONTAP é a plataforma de software de storage mais implantada no mundo e vem com quase 30 anos de inovação constante. Você pode enfrentar todos os desafios da Epic com ferramentas nativas de gerenciamento de dados da ONTAP e integração de aplicações. Não há necessidade de comprar uma infinidade de ferramentas de terceiros para preencher lacunas na solução.</block>
  <block id="54fed3d17b1233bcc7ab7b0d3f6eddca" category="paragraph">Muitos fornecedores de storage oferecem storage de bloco tradicional, confiável e rápido. Eles funcionam bem, mas normalmente são implantados em silos para executar um único workload, como produção, relatório, Clarity, VDI, VMware e nas. Cada um desses silos tem hardware diferente e ferramentas de gerenciamento diferentes, e eles geralmente são gerenciados por diferentes grupos DE TI. Esta abordagem tradicional adiciona ao maior problema com a saúde hoje em dia - complexidade.</block>
  <block id="58ad32957aed88a3c14ef81e5f254bd3" category="paragraph">Com o NetApp, o gerenciamento de dados fica mais fácil e eficiente. Em vez de gastar dinheiro com o problema com silos superdimensionados, a ONTAP usa inovação e tecnologia para permitir um SLA consistente e garantido para cada workload em uma única plataforma em qualquer protocolo com proteção de dados integrada. Esses recursos e ferramentas também se estendem para a nuvem de sua escolha, conforme ilustrado abaixo.</block>
  <block id="0d9c98d3832defc892b59655abcfacfc" category="inline-image-macro">Escala e simplicidade no setor de saúde com o ONTAP</block>
  <block id="4277ed476100dc05b0a4e0e837c3d9b9" category="paragraph"><block ref="4277ed476100dc05b0a4e0e837c3d9b9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="63cc4e5664cd9022b0fc1580682f9995" category="summary">Desempenho épico em ONTAP</block>
  <block id="6762c0b102338c245945f7d09da83fa4" category="paragraph">A ONTAP apresentou as tecnologias flash em 2009 e oferece suporte para SSDs desde 2010. Essa longa experiência com storage flash permite que a NetApp ajuste os recursos do ONTAP para otimizar o desempenho da SSD e aprimorar a resistência da Mídia flash, mantendo os recursos avançados do ONTAP.</block>
  <block id="8e0c14b7c96a8748c07c3916510ebd8b" category="paragraph">Desde o ano 2020, todos os workloads da Epic ODB precisam estar no storage all-flash. As cargas de trabalho épicas normalmente operam em aproximadamente 1.000 a 2.000 IOPs por terabyte de storage (8k bloco, 75%/25% de taxa de leitura e gravação e 100% de forma aleatória). O Epic é muito sensível à latência, e a alta latência tem um efeito visível na experiência do usuário final, bem como em tarefas operacionais, como execução de relatórios, backup, verificações de integridade e tempos de atualização do ambiente.</block>
  <block id="4a9928f04affb2a4fe321fb9e2b003fd" category="list-text">O fator limitante para all-flash arrays não são as unidades, mas sim a utilização nas controladoras.</block>
  <block id="11a9dfbe9a015ca567ecd5f77959dc1f" category="list-text">O ONTAP usa uma arquitetura ativo-ativo. Para obter performance, os dois nós do par de HA gravam nas unidades.</block>
  <block id="3a5c5db6ac361794af4c29a626c584f5" category="list-text">Isso resulta na maximização da utilização da CPU, o fator mais importante que permite que a NetApp publique a melhor performance da Epic no setor.</block>
  <block id="2f6b137b593d6a732992bc619827ee36" category="list-text">As tecnologias NetApp RAID DP, Advanced Disk Partitioning (ADP) e WAFL atendem a todos os requisitos da Epic. Todos os workloads distribuem e/S por todos os discos. Sem gargalos.</block>
  <block id="0ce3d3de991180e05a5a0818efc312ef" category="list-text">O ONTAP é otimizado para gravação; as gravações são confirmadas depois de gravadas no NVRAM espelhado antes de serem gravadas no disco na velocidade de memória inline.</block>
  <block id="ca65639a4e206f319202179e1d9a4ff4" category="list-text">O WAFL, o NVRAM e a arquitetura modular permitem que o NetApp use o software para inovar com eficiências in-line, criptografia e performance. Eles também permitem que o NetApp apresente novos recursos e funcionalidades sem afetar o desempenho.</block>
  <block id="f13349f1404495d87711104e964b1cef" category="list-text">Historicamente, com cada nova versão do ONTAP há um aumento no desempenho e eficiência na faixa de 30-50%. O desempenho é ideal quando você se mantém atualizado com o ONTAP.</block>
  <block id="70d9e3c68d42d6ec42ab792e06c44357" category="section-title">NVMe</block>
  <block id="42fa4afed0f941a60ea00e82671c421d" category="paragraph">Quando a performance é fundamental, o NetApp também oferece suporte a NVMe/FC, o protocolo FC SAN de última geração.</block>
  <block id="1e4d4890d3f90b04841095b53183f782" category="paragraph">Como pode ser visto na figura abaixo, nossos testes do Genio alcançaram um número muito maior de IOPS usando o protocolo NVMe/FC em comparação com o protocolo FC. A solução conectada NVMe/FC alcançou mais de 700k IOPS antes de superar o limite do ciclo de gravação de 45 segundos. Com a substituição de comandos SCSI pelo NVMe, você também reduz significativamente a utilização no host.</block>
  <block id="0b336e7e203efd55d17ecfaa03c134f5" category="inline-image-macro">Gráfico épico de Genio</block>
  <block id="293e47073bb00e514b986ef28fbbb2e1" category="paragraph"><block ref="293e47073bb00e514b986ef28fbbb2e1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9ff8735576a58daba5ba20974f92a584" category="summary">Escalabilidade épica para ONTAP</block>
  <block id="1027782bab261904e6adf43f2b137951" category="paragraph">O Guia de configuração de hardware da Epic representa um crescimento de cerca de 20% por ano por 3 anos. No entanto, os ambientes também podem crescer inesperadamente.</block>
  <block id="39e52e339ff39b5620d48036812e09ec" category="paragraph">O NetApp pode dimensionar a performance e a capacidade de forma otimizada até 12 nós para clusters nas, SAN e objetos. Como resultado, você pode fazer escalabilidade vertical e horizontal sem interrupções à medida que sua empresa cresce.</block>
  <block id="49c5cdfe08202e574deefaa3d26c332a" category="inline-link-macro">Arquitetura verificada da NetApp na SAN moderna</block>
  <block id="12cb4beeba752f647712c749e3076fbf" category="paragraph">O Epic Iris oferece recursos adicionais de dimensionamento. Com ele, clientes maiores que têm várias instâncias da Epic podem se consolidar em uma única instância. <block ref="5d13d58e489e8fe43bb727515c1d9ff2" category="inline-link-macro-rx"></block>O documento demonstra que a Epic pode dimensionar workloads consolidados de forma otimizada para 720K IOPS em um único HA e fazer escalabilidade horizontal para mais de 4M IOPS em um cluster. Faça a escalabilidade vertical sem interrupções atualizando controladores ou adicionando discos a clusters existentes.</block>
  <block id="196097993185ddccf60443ac3f86e89f" category="paragraph">Os dados nas, SAN e de objetos também podem ser movidos entre nós no cluster sem interrupções. Cada par de HA no cluster pode ser qualquer combinação de tipos e tamanhos de sistemas ONTAP FAS e AFF. Você pode equilibrar seus workloads em um único cluster para maximizar seu investimento em storage.</block>
  <block id="6abd4957b4615c500bd2a32425316211" category="paragraph">O ONTAP também oferece a opção de usar o storage de objetos no StorageGRID ou na nuvem como destino de backup e/ou destino automático de disposição em camadas de storage frio. Essa funcionalidade permite que você libere automaticamente discos all-flash caros, snapshots em camadas e dados inativos no Object.</block>
  <block id="8d3f76f475a5e81f188f700429c71a9e" category="paragraph">Como resultado, a Epic simplesmente funciona melhor com o portfólio de produtos da NetApp, utilizando ONTAP, vários protocolos, StorageGRID e a nuvem de sua preferência. Esses produtos oferecem opções para recuperação de desastres, arquivamento, análises, disposição em camadas e muito mais.</block>
  <block id="1e3ccee88df9552e4751ba4ad173de96" category="summary">Épico em segurança ONTAP</block>
  <block id="32e1bf49ff775c9283c882fe7f3ec873" category="paragraph">A segurança é a preocupação número um para as organizações e os executivos de saúde hoje. Nunca foi tão difícil gerenciar, e as organizações desafiam a conformidade, a governança de dados, a proteção antivírus e o ransomware.</block>
  <block id="0d6ce08690a300cb8ce00d77e1c31a5e" category="inline-link-macro">Guia de endurecimento de segurança para ONTAP</block>
  <block id="40e97866feb53c48881b34e5f97ca61f" category="paragraph">Um guia completo para a segurança de storage e da Epic está além do escopo deste documento. No entanto<block ref="471b0f2cfbad0f2ec4e54df06500d580" category="inline-link-macro-rx"></block>, detalha todos os recursos de segurança avançados e abrangentes disponíveis com o ONTAP.</block>
  <block id="1408f921f799efe0e585aeba5fa9ed58" category="inline-link-macro">TR-4569</block>
  <block id="f87d3f3c7c3e6e9ab1153c53d78b40b1" category="paragraph">O NetApp Active IQ Unified Manager monitora violações de segurança com base nas informações incluídas <block ref="1b2ca6a48e0bf52cc6351680c5ee6170" category="inline-link-macro-rx"></block> e as informa no painel para simplificar o gerenciamento de segurança. Essas ferramentas podem ajudar sua organização a atingir suas metas de segurança para proteger, detetar e corrigir ataques.</block>
  <block id="a1fbc1f9fe3c77416c96f491ba933c4a" category="inline-link-macro">Política de NetApp</block>
  <block id="96f76ddccc0adcaf0fc9a2fc6c834374" category="inline-link-macro">Autenticação de vários fatores (MFA)</block>
  <block id="a754af2f708573321f76c2d36bea9f02" category="paragraph">A NetApp também fez uma parceria com fornecedores de segurança para fornecer integração por meio <block ref="48fae993b7aeb9944f39dadc4618e2b6" category="inline-link-macro-rx"></block> de software para aprimorar sua oferta de segurança. Além disso, <block ref="b5ae90d3a2df9b77f2db834fe0dc7b7d" category="inline-link-macro-rx"></block> é possível adicionar para proteger seu ambiente Epic contra acesso não autorizado com credenciais vazadas.</block>
  <block id="91d998bab304adb0fd27858a4295dcac" category="inline-link-macro">Ciber Vault da ONTAP</block>
  <block id="e9c1c7d4ca860adb553d87c2c1d9ef35" category="inline-link-macro">A solução NetApp para ransomware</block>
  <block id="63ab8aaa1f35361bdf5c84b3d1dd4765" category="inline-link-macro">NetApp e confiança zero</block>
  <block id="a67fe844bc4d3e5cf5ebac11dea00b01" category="paragraph">Por fim, as cópias Snapshot nativas da ONTAP e as tecnologias SnapLock imutáveis com <block ref="79305a8b61b53acc892506e6bcd6f49f" category="inline-link-macro-rx"></block>o , oferecem uma capacidade única de lacuna aérea para proteger seus Registros de pacientes contra ransomware. Consulte a documentação do NetApp em <block ref="910d0617bba4ff1a9d41b4b330096d85" category="inline-link-macro-rx"></block>. Para obter uma abordagem mais estratégica para a segurança, <block ref="aaf21a490837c9b392e59c6c9110165d" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="28caba838e7a7ff7ff218bae8235208a" category="summary">Snapshots e clonagem épicas</block>
  <block id="8ad0c394ef79d2b18983fabe84f658fc" category="paragraph">Um snapshot é uma cópia pontual de um volume que é somente leitura.</block>
  <block id="568043eed0b44992a4b4a1cc21f8b633" category="paragraph">Um snapshot coloca um bloqueio lógico em todos os blocos no sistema de arquivos ativo. As cópias Snapshot do NetApp ONTAP são quase instantâneas e não usam storage adicional.</block>
  <block id="04a00b93a2db41946dc3d263cf6c294c" category="paragraph">Write Anwhere File Layout, ou WAFL, é um sistema de arquivos somente de gravação; ele não executa IO adicional, como copiar os dados em um bloco protegido por snapshot antes de ser substituído. Nenhum dado é movido. Portanto, os snapshots não afetam a capacidade ou a performance do storage. Os snapshots oferecem uma grande economia de storage enquanto aumentam a solução de backup.</block>
  <block id="a701f5d044348085ee4f97fef6636845" category="section-title">FlexClone</block>
  <block id="16f57611d3d44b74ce1c1b134cb8e798" category="paragraph">Um volume NetApp ONTAP FlexClone é um clone de um volume existente ou um snapshot de um volume existente. De outra forma, ele é um volume ONTAP como qualquer outro e pode ser clonado, protegido com snapshots e configurado com uma política de QoS.</block>
  <block id="e0c3236990160654182a79c89baab29f" category="paragraph">Tal como acontece com snapshots, um volume FlexClone não requer nenhum espaço adicional no momento da criação. Somente as alterações no clone exigem capacidade adicional.</block>
  <block id="9a9ff90c24c36543bf54b1f2136fd9e0" category="paragraph">A Epic exige de 10 a 30 cópias dos bancos de dados de produção para vários requisitos operacionais, como backups de streaming, verificações de integridade e ambientes de atualização de preparação. A necessidade de uma solução baseada no FlexClone volumes aumentou com a migração para atualizações mais frequentes.</block>
  <block id="dad816f366caa0b8cae67daaeb85deb0" category="admonition">O NetApp fornece uma solução de backup Epic totalmente automatizada e uma solução de atualização Epic como parte da solução usando o Ansible e ferramentas nativas do NetApp.</block>
  <block id="53f102b306ab1aba43e9e20701dc32f2" category="doc">Épico em ONTAP</block>
  <block id="3bfc8ddd725eed5b674d1a480bc650d2" category="paragraph">A chave da transformação digital é fazer mais com seus dados.</block>
  <block id="2b82426bc0bfa4ea3efb779d165629a4" category="admonition">Esta documentação substitui o relatório técnico publicado anteriormente _TR-3923: Melhores práticas da NetApp para a Epic_.</block>
  <block id="fdf0f3f3a2bae0d66ca5ecb45e1f3d85" category="paragraph">Os hospitais exigem grandes quantidades de dados para iniciar a jornada da transformação digital. Parte do processo de tratamento de pacientes, gerenciamento de horários de funcionários e recursos médicos é que as informações são coletadas e processadas. No entanto, muitas ações ainda são realizadas manualmente ou através de sistemas desatualizados. A única constante é que a quantidade de dados continua crescendo exponencialmente e, assim, se torna cada vez mais difícil de gerenciar.</block>
  <block id="74090662bfdb94e49dfc286a6946cc5c" category="paragraph">A principal causa desse problema é que os dados hospitalares geralmente são armazenados em silos de dados. Muito tempo é gasto em entradas manuais e atualizações que levam ao esgotamento e erros. Este documento é sobre uma parte dos dados de saúde, a Epic Electronic Health Records (EHR). No entanto, a estratégia de gerenciamento de dados aqui abordada pode e deve ser aplicada a todos os dados de saúde. A NetApp tem uma história comprovada de modernização e simplificação da infraestrutura digital. Nossa infraestrutura de dados inteligente forma a base da transformação digital.</block>
  <block id="b68a1112138fe0c0c1beafc2aea18949" category="paragraph">A NetApp oferece uma solução única de gerenciamento de dados para todas as necessidades de saúde. Além disso, podemos orientar os hospitais em sua jornada rumo à transformação digital. Construindo uma base com estrutura e soluções inteligentes, a saúde pode extrair todo o valor dessas informações preciosas. Essa estrutura pode ajudar os provedores médicos a diagnosticar doenças mais rapidamente e desenvolver planos de tratamento individualizados para melhor apoiar os processos de tomada de decisão em situações de emergência. Você também poderá criar sua própria infraestrutura de dados inteligente e permitir que seu hospital desbloqueie silos de dados, facilite a interoperabilidade dos dados e proteja informações confidenciais dos pacientes.</block>
  <block id="6b5a360f7d15046cfd935db963e3da66" category="paragraph">Use este documento como um guia para construir e implementar com sucesso EPIC EHR. Em vez de criar vários silos da Epic, crie uma única infraestrutura de dados da Epic e transforme seu hospital.</block>
  <block id="261addf78c7b2c961032b3dd08ba0b1f" category="section-title">Finalidade</block>
  <block id="b8954f46b76dae4370058c7bd9ae0c97" category="paragraph">Este documento descreve as práticas recomendadas para a integração do storage do NetApp em um ambiente de software da Epic. Ele contém as seguintes seções:</block>
  <block id="6c5022fa1197168f37c42e56f80d36aa" category="list-text">Um entendimento técnico do ambiente de software da Epic e seus requisitos de storage em várias configurações.</block>
  <block id="a9da176a5abe5a618e8ed6a88bdbf21b" category="list-text">Considerações épicas de storage, que descrevem fatores importantes para a tomada de decisões das soluções da Epic.</block>
  <block id="8b3f0902644adbb7e0435ae9c9a284e2" category="list-text">Recomendações de storage da NetApp, que descrevem as práticas recomendadas de configuração de storage da NetApp para atender aos requisitos de storage da Epic.</block>
  <block id="5d113f2038d289f391614c39043629e8" category="section-title">Âmbito de aplicação</block>
  <block id="217eb7cf1ad7503a42f61ad3cffb47fb" category="paragraph">Este documento não abrange os seguintes assuntos:</block>
  <block id="f900b8ede5ddf3a0471176dab052001d" category="list-text">Requisitos quantitativos de desempenho e orientação de dimensionamento, que são abordados em<block ref="81c36a9e6d224e9d42c9630dffaa9434" category="inline-link-rx"></block> (login NetApp necessário)</block>
  <block id="ef1e6887c579ba81dcedc3f4e3793cd2" category="section-title">Público-alvo</block>
  <block id="2f215f5ba67ae7978ce4846a4a1cdc08" category="paragraph">O NetApp assume que o leitor tem os seguintes conhecimentos:</block>
  <block id="6cfde17644914efa6d0a4d0c21a8f9db" category="list-text">Uma sólida compreensão dos conceitos de SAN e nas</block>
  <block id="c86456e4299d4b0ad43e030d0fdd0af5" category="list-text">Familiaridade técnica com os sistemas de storage da ONTAP</block>
  <block id="59eba43c04b655e21f087af920398a2a" category="list-text">Familiaridade técnica com a configuração e administração do ONTAP</block>
  <block id="30d965eef5ba25c6b9998ae38270b43e" category="doc">Avisos legais</block>
  <block id="e9c44bbfd795a5d63d74c6a77afee70d" category="paragraph">Avisos legais fornecem acesso a declarações de direitos autorais, marcas registradas, patentes e muito mais.</block>
  <block id="6016a2b341113bf496b719905398ecd2" category="section-title">Direitos de autor</block>
  <block id="52009bb7ee17227f566cd26a02caee56" category="inline-link-macro"><block ref="52009bb7ee17227f566cd26a02caee56" category="inline-link-rx"></block></block>
  <block id="a1a9afcf552a769c282769271829889a" category="paragraph"><block ref="a1a9afcf552a769c282769271829889a" category="inline-link-macro-rx"></block></block>
  <block id="126a02652da6de02962cf1b654fd6376" category="section-title">Marcas comerciais</block>
  <block id="c4ce4761e466527d26b3e3d5ed1006fd" category="paragraph">NetApp, o logotipo DA NetApp e as marcas listadas na página de marcas comerciais da NetApp são marcas comerciais da NetApp, Inc. Outros nomes de produtos e empresas podem ser marcas comerciais de seus respetivos proprietários.</block>
  <block id="f99aa604031e5049799e73b5c3748a98" category="inline-link-macro"><block ref="f99aa604031e5049799e73b5c3748a98" category="inline-link-rx"></block></block>
  <block id="5d545fe5152641e2ebe654e336e520e5" category="paragraph"><block ref="5d545fe5152641e2ebe654e336e520e5" category="inline-link-macro-rx"></block></block>
  <block id="be89498d2f8a22ce47c02ba9795fe2af" category="section-title">Patentes</block>
  <block id="d0b19d36be2c5f16e9aef46c8a452d3d" category="paragraph">Uma lista atual de patentes de propriedade da NetApp pode ser encontrada em:</block>
  <block id="88e5eabd3917048b6927c42496b98f86" category="inline-link-macro"><block ref="88e5eabd3917048b6927c42496b98f86" category="inline-link-rx"></block></block>
  <block id="dd38f906b37d412de7d1c1dcf4cbf31c" category="paragraph"><block ref="dd38f906b37d412de7d1c1dcf4cbf31c" category="inline-link-macro-rx"></block></block>
  <block id="56c34c6410dd45c5cec44149ad0ce037" category="section-title">Política de privacidade</block>
  <block id="8acb58cbd50ef1b468a020ee0bd351d3" category="inline-link-macro"><block ref="8acb58cbd50ef1b468a020ee0bd351d3" category="inline-link-rx"></block></block>
  <block id="2352c4e1f4d0024ade0869e00e6243f4" category="paragraph"><block ref="2352c4e1f4d0024ade0869e00e6243f4" category="inline-link-macro-rx"></block></block>
  <block id="c0227cef6f07a8cd2ac72f2945b031aa" category="section-title">Código aberto</block>
  <block id="9b73989307c1975dfa4d5e1581e4afe8" category="paragraph">Os arquivos de aviso fornecem informações sobre direitos autorais de terceiros e licenças usadas no software NetApp.</block>
  <block id="253b40ae359ba25b56231803430c4873" category="section-title">ONTAP</block>
  <block id="856c8958afd787f748a4a025f649154a" category="inline-link-macro">Aviso para ONTAP 9.13,1</block>
  <block id="b22b3b2970d843f99e7e6904bea05207" category="inline-link-macro">Aviso para ONTAP 9.12,1</block>
  <block id="0358f41254df2d512849db5a04b7e3d4" category="inline-link-macro">Aviso para ONTAP 9.12,0</block>
  <block id="28f1290102a277ef2fd452d558c74219" category="inline-link-macro">Aviso para ONTAP 9.11,1</block>
  <block id="57b07f14c8eb4660f94a86d29d53362d" category="inline-link-macro">Aviso para ONTAP 9.10,1</block>
  <block id="396712eb9c1644241047ac30619b2b3e" category="inline-link-macro">Aviso para ONTAP 9.10,0</block>
  <block id="1e6000d4849ef9f3e08d1d9908e9f163" category="inline-link-macro">Aviso para ONTAP 9.9,1</block>
  <block id="6f408b9c999245c7aa32bc9cb1a020f6" category="inline-link-macro">Aviso para ONTAP 9.8</block>
  <block id="04b0bd5b1b4d414fdde93f809162d36d" category="inline-link-macro">Aviso para ONTAP 9.7</block>
  <block id="0c1d7dffcba488555d5eb39b8991e822" category="inline-link-macro">Aviso para ONTAP 9.6</block>
  <block id="a11ac6880e72412c0f54ae19bea3d191" category="inline-link-macro">Aviso para ONTAP 9.5</block>
  <block id="e49c3c01b15761b5f011d0bd2a0661a3" category="inline-link-macro">Aviso para ONTAP 9.4</block>
  <block id="bf7dcf6467a8a03b05b2d37d31d6eccd" category="inline-link-macro">Aviso para ONTAP 9.3</block>
  <block id="0328352fdfda84af6968462d1a67d3a6" category="inline-link-macro">Aviso para ONTAP 9.2</block>
  <block id="83904100c7d6fe0102e8b2b5bd8ec4bb" category="inline-link-macro">Aviso para ONTAP 9.1</block>
  <block id="72a46482f366b350b6b0215baa631137" category="summary">Recursos adicionais para Microsoft Windows e Hyper-V.</block>
  <block id="4bb047f8c530785002e490ef17fa725e" category="doc">Onde encontrar informações adicionais</block>
  <block id="8762adae157b34ee542f2e614401603a" category="list-text">Conceitos de ONTAP <block ref="836022e29667128997850a15d18e8759" category="inline-link-rx"></block></block>
  <block id="e7b3912abd11fa36935a211d0189ebc2" category="list-text">Práticas recomendadas para SAN moderna <block ref="49df8abaa6163afdde37b69f7f59185c" category="inline-link-rx"></block></block>
  <block id="05c54431756e1b1a7114938bc6f4b199" category="list-text">Disponibilidade e integridade de dados de array all-SAN NetApp com o NetApp ASA <block ref="8f140ecff12b563e3c96a8cff991aedb" category="inline-link-rx"></block></block>
  <block id="d03e09c345dd723011486de3855c13b2" category="list-text">Documentação SMB <block ref="409ef354547d1e3428907ed7fdd2dc6e" category="inline-link-rx"></block></block>
  <block id="bc96f334e3988ce96701a7082c0e23b5" category="list-text">Introdução ao Nano Server <block ref="abdd6de84336a7f761fbe384605879e9" category="inline-link-rx"></block></block>
  <block id="0650b34324cf33e3bf1ba6d5db9aa14c" category="list-text">Novidades no Hyper-V no Windows Server <block ref="8508224d602483e88bde8402b5d1f2d1" category="inline-link-rx"></block></block>
  <block id="57a0eb5139789611b6b213a5f3fa5412" category="summary">Este apêndice descreve a implantação de um cluster Hyper-V de alta disponibilidade no armazenamento NetApp.</block>
  <block id="c56bd6d44fe37df3133f12e09059b492" category="doc">Implantar o cluster Hyper-V.</block>
  <block id="e286734bc8843e9f46f2812455917ea5" category="paragraph">Este apêndice descreve a implantação de um cluster Hyper-V.</block>
  <block id="ee68e5b99222bbc29a480fcb0d1d6ee2" category="section-title">Pré-requisitos</block>
  <block id="fa0edb5816386e7e049e5c77d9cdb367" category="list-text">Existem pelo menos dois servidores Hyper-V conetados entre si.</block>
  <block id="a7bad6853c4b367ee245a88ab3195af0" category="list-text">Pelo menos um switch virtual é configurado em cada servidor Hyper-V.</block>
  <block id="ebdc83ef4c8d2993b67ae667bcb0cd50" category="list-text">O recurso de cluster de failover é ativado em cada servidor Hyper-V.</block>
  <block id="65e98c7fa4c69ce7bd0d182ede13991a" category="list-text">Compartilhamentos SMB ou CSVs são usados como armazenamento compartilhado para armazenar VMs e seus discos para clustering Hyper-V.</block>
  <block id="22f4b86bcfebce25bb61ddd3ee8d6f7f" category="list-text">O storage não deve ser compartilhado entre clusters diferentes. Você deve ter apenas um compartilhamento CSV/CIFS por cluster.</block>
  <block id="c2377be670723e586c1324a4a12607a5" category="list-text">Se o compartilhamento SMB for usado como armazenamento compartilhado, as permissões no compartilhamento SMB devem ser configuradas para conceder acesso às contas de computador de todos os servidores Hyper-V no cluster.</block>
  <block id="ea355214fd4bc7c57f471bd92918879b" category="section-title">Implantação</block>
  <block id="3627e168149dcf185918371a7adb5680" category="list-text">Faça login em um dos servidores do Windows Hyper-V como membro do grupo de administradores.</block>
  <block id="0cc618f3a272a1fc35b193fc6efa1122" category="list-text">Inicie o Server Manager**.**</block>
  <block id="f30124a5c887cea53cc6397d6c9e40a6" category="list-text">Na seção Ferramentas, clique em Gerenciador de Cluster de failover.</block>
  <block id="54be8be618f1803d7fc1579e2fad9a6c" category="list-text">Clique no menu criar cluster a partir de ações.</block>
  <block id="6bcb4b141d153c7cee9fc6b2633a703c" category="list-text">Forneça detalhes para o servidor Hyper-V que faz parte deste cluster.</block>
  <block id="58ee4cb30b6b0dd4665be3c60c65e0f1" category="list-text">Valide a configuração do cluster. Selecione Sim quando solicitado para validar a configuração do cluster e selecione os testes necessários para validar se os servidores Hyper-V passam os pré-requisitos para fazer parte do cluster.</block>
  <block id="8a2ec0e7f4a4ecb848794b1aba47839b" category="list-text">Após a validação ser bem-sucedida, o assistente criar cluster é iniciado. No assistente, forneça o nome do cluster e o endereço IP do cluster para o novo cluster. Um novo cluster de failover é então criado para o servidor Hyper-V.</block>
  <block id="ce73c2e33e5d228466b28690400c8c14" category="list-text">Clique no cluster recém-criado no Gerenciador de Cluster de failover e gerencie-o.</block>
  <block id="904aa93ec80c2a5ca93ed8ace0e52220" category="list-text">Defina o armazenamento partilhado para o cluster a utilizar. Pode ser um compartilhamento SMB ou um CSV.</block>
  <block id="d69f1a0923232e84331ec6d30315124c" category="list-text">Usar um compartilhamento SMB como armazenamento compartilhado não requer etapas especiais.</block>
  <block id="72feffd29972ad4bc2fb9f5705e60864" category="inline-link-macro">Provisionamento em ambientes SMB</block>
  <block id="3b045123cc5f216c3aa18614a4cabf45" category="list-text">Configurar um compartilhamento CIFS em um controlador de storage NetApp. Para o fazer, consulte a secção "<block ref="f9d723fa339e7968f40a99719593036c" category="inline-link-macro-rx"></block>" ".</block>
  <block id="c0edb31f94845e5a1f67d2f79db4408f" category="list-text">Para usar um CSV como armazenamento compartilhado, execute as seguintes etapas:</block>
  <block id="dfd86a662700832b7931201c3abdf13f" category="list-text">Configurar LUNs em um controlador de storage NetApp. Para fazer isso, consulte a seção "provisionamento em ambientes SAN".</block>
  <block id="49873862ecc43076ac3a4de327f3efdb" category="list-text">Certifique-se de que todos os servidores Hyper-V no cluster de failover possam ver os LUNs NetApp. Para fazer isso para todos os servidores Hyper-V que fazem parte do cluster de failover, verifique se seus iniciadores são adicionados ao grupo de iniciadores no armazenamento NetApp. Certifique-se também de que seus LUNs sejam descobertos e verifique se o MPIO está habilitado.</block>
  <block id="4fe4609b22418e84ea85667368c2e742" category="list-text">Em qualquer um dos servidores Hyper-V no cluster, execute as seguintes etapas:</block>
  <block id="de824a62ee353b5481bb4eeb5c13d899" category="list-text">Leve o LUN online, inicialize o disco, crie um novo volume simples e formate-o usando NTFS ou refs.</block>
  <block id="340f3a4d7fad2c45eadfe69d5b56ce38" category="list-text">No Gerenciador de Cluster de failover, expanda o cluster, expanda armazenamento, clique com o botão direito do Mouse em discos e clique em Adicionar discos. Isso abre o assistente Adicionar discos a um cluster mostrando o LUN como um disco. Clique em OK para adicionar o LUN como um disco.</block>
  <block id="c473a447596255e12e2e772012c42b17" category="list-text">O CSV é simultaneamente visível e acessível a partir de todos os servidores Hyper-V do cluster de failover em sua localização local C: /ClusterStorage.</block>
  <block id="b735c11dd95d1b42d173adb43b3a1df2" category="list-text">Crie uma VM altamente disponível:</block>
  <block id="27f977a1c170f87899be67daf203a268" category="list-text">No Gerenciador de Cluster de failover, selecione e expanda o cluster criado anteriormente.</block>
  <block id="569f3bea800216a760ac935540b72c1e" category="list-text">Clique em funções e, em seguida, clique em máquinas virtuais em ações. Clique em Nova máquina virtual.</block>
  <block id="4380a9c5c56776fad0f4492a0d3c63f5" category="list-text">Selecione o nó no cluster onde a VM deve residir.</block>
  <block id="a8be7e73ae88a070ad15a4a6f6d515fe" category="list-text">No assistente de criação de máquinas virtuais, forneça o armazenamento compartilhado (compartilhamento SMB ou CSV) como o caminho para armazenar a VM e seus discos.</block>
  <block id="9da4e10b0da989c65844cd59ed2a0991" category="list-text">Use o Hyper-V Manager para definir o armazenamento compartilhado (compartilhamento SMB ou CSV) como o caminho padrão para armazenar a VM e seus discos para um servidor Hyper-V.</block>
  <block id="92829881718abd402c6c73b34be944da" category="inline-link-macro">Migração ao vivo em um ambiente em cluster</block>
  <block id="1dd1e97374852e1f244963d9fdb0c414" category="list-text">Testar failover planejado. Mova as VMs para outro nó usando a migração ao vivo, a migração rápida ou a migração de storage (mover). Reveja <block ref="ba8afff2d0e4662eeb47d28935e79828" category="inline-link-macro-rx"></block> para obter mais detalhes.</block>
  <block id="064cd683bf50cb65205de6b9298201b3" category="list-text">Teste failover não planejado. Pare o serviço de cluster no servidor que possui a VM.</block>
  <block id="4be45953e45cfa5fc987ba108c1e5793" category="summary">Este apêndice descreve a implantação da migração ao vivo em um ambiente em cluster.</block>
  <block id="4380100fa910735712157068aeec0575" category="doc">Implante a migração ao vivo do Hyper-V em um ambiente em cluster</block>
  <block id="36cf7806cbb55a382b64bd9b65b2939b" category="inline-link-macro">Implantar o Hyper-V Cluster</block>
  <block id="0e660b82d6e28b6935041a5223ed1aed" category="paragraph">Para implantar a migração em tempo real, você precisa ter servidores Hyper-V configurados em um cluster de failover com armazenamento compartilhado. Reveja <block ref="8a150f92c22920868769b8738759e23d" category="inline-link-macro-rx"></block> para obter mais detalhes.</block>
  <block id="388b92a1de3321595dcfbdc1c67ce749" category="paragraph">Para usar a migração em tempo real em um ambiente em cluster, execute as seguintes etapas:</block>
  <block id="b66a6c742469f1d08a2d11bcf4f211ff" category="list-text">No Gerenciador de Cluster de failover, selecione e expanda o cluster. Se o cluster não estiver visível, clique em Gerenciador de Cluster de failover, clique em conetar ao cluster e forneça o nome do cluster.</block>
  <block id="e3883376513ba0aeb2f3d190d4e0377d" category="list-text">Clique em funções, que lista todas as VMs disponíveis em um cluster.</block>
  <block id="e164db40505184b94012bbbd4aa4c1a2" category="list-text">Clique com o botão direito do rato na VM e clique em mover. Isso fornece três opções:</block>
  <block id="6a1e101231f8f4bcd4a75390cc0eddc2" category="list-text">*Migração ao vivo.* Você pode selecionar um nó manualmente ou permitir que o cluster selecione o melhor nó. Na migração em tempo real, o cluster copia a memória usada pela VM do nó atual para outro nó. Portanto, quando a VM é migrada para outro nó, as informações de memória e estado necessárias pela VM já estão em vigor para a VM. Esse método de migração é quase instantâneo, mas apenas uma VM pode ser migrada ao vivo de cada vez.</block>
  <block id="4374953843b8a5507e79ee5145fd88cd" category="list-text">*Migração rápida.* Você pode selecionar um nó manualmente ou permitir que o cluster selecione o melhor nó. Na migração rápida, o cluster copia a memória usada por uma VM para um disco no armazenamento. Portanto, quando a VM é migrada para outro nó, as informações de memória e estado necessárias pela VM podem ser lidas rapidamente do disco pelo outro nó. Com a migração rápida, várias VMs podem ser migradas simultaneamente.</block>
  <block id="f1321d73ebfb5a92e710d313fd53c21c" category="list-text">* Migração de armazenamento de máquina virtual.* Este método usa o assistente mover armazenamento de máquina virtual. Com este assistente, você pode selecionar o disco da VM juntamente com outros arquivos a serem movidos para outro local, que pode ser um CSV ou um compartilhamento SMB.</block>
  <block id="154e178d8f948264ecf34dcfd8ad3112" category="summary">Este apêndice descreve como usar a migração em tempo real do Hyper-V fora de um ambiente em cluster</block>
  <block id="67bd1e9f90c0abcd3fe89dce2e8b6307" category="doc">Implante a migração do Hyper-V Live fora de um ambiente em cluster</block>
  <block id="3a37015d23bf5b95b8aaeeb60e7149f6" category="paragraph">Esta seção descreve a implantação da migração em tempo real do Hyper-V fora de um ambiente em cluster.</block>
  <block id="34076d85579973b175bda646666488f5" category="list-text">Servidores Hyper-V autônomos com storage independente ou armazenamento SMB compartilhado.</block>
  <block id="6d3867adf71fde2bd2e28c3530f980e2" category="list-text">A função Hyper-V instalada nos servidores de origem e de destino.</block>
  <block id="860a24a5665c79d337512cf7091c1f27" category="list-text">Ambos os servidores Hyper-V pertencem ao mesmo domínio ou a domínios que confiam uns nos outros.</block>
  <block id="599b01a5eeab6af8dcd5d22203b25b3b" category="paragraph">Para executar a migração em tempo real em um ambiente não agrupado, configure os servidores Hyper-V de origem e destino para que eles possam enviar e receber operações de migração em tempo real. Em ambos os servidores Hyper-V, execute as seguintes etapas:</block>
  <block id="2771a58b129233810f1c389eedd2207f" category="list-text">Abra o Gerenciador do Hyper-V na seção Ferramentas do Gerenciador de servidores.</block>
  <block id="5c8aa736f4d71f22237d67e44338e090" category="list-text">Em ações, clique em Configurações do Hyper-V.</block>
  <block id="146cc3da35b3cb4807f19e5c342f3d0b" category="list-text">Clique em Live Migrations (migrações em tempo real) e selecione Enable Incoming (Ativar migrações em tempo real de entrada</block>
  <block id="000104d6631c201d8476c728987584e9" category="list-text">Escolha se deseja permitir tráfego de migração em tempo real em qualquer rede disponível ou apenas em redes específicas.</block>
  <block id="bbba185068a3a5aa887f5064ee5fc3de" category="list-text">Opcionalmente, você pode configurar o protocolo de autenticação e as opções de desempenho na seção Avançado de Live Migrations.</block>
  <block id="0d91ef025d958a7706b6abf25f2160a5" category="list-text">Se CredSSP for usado como protocolo de autenticação, certifique-se de fazer login no servidor Hyper-V de origem do servidor Hyper-V de destino antes de mover a VM.</block>
  <block id="4671ab6d9ed8f69134f49812ab7a7c35" category="list-text">Se o Kerberos for usado como protocolo de autenticação, configure a delegação restrita. Isso requer acesso ao controlador de domínio do ative Directory. Para configurar a delegação, execute as seguintes etapas:</block>
  <block id="3c3a519ac45fd3a37ae321645897af94" category="list-text">Faça login no controlador de domínio do ative Directory como administrador.</block>
  <block id="bb35cb72ffe2e8dd1a02cf65b86c6cd3" category="list-text">Inicie o Server Manager.</block>
  <block id="15be526c72b91c88e16f64f6c832eb6b" category="list-text">Na seção Ferramentas, clique em usuários e computadores do ative Directory.</block>
  <block id="444f95dff8ac9b4c8c6335d66d6ae4a7" category="list-text">Expanda o domínio e clique em computadores.</block>
  <block id="a07ecc7f9ab368b241540687975a30aa" category="list-text">Selecione o servidor Hyper-V de origem na lista, clique nele com o botão direito e clique em Propriedades.</block>
  <block id="a3a23c7b6ce827c11b3cdb698108c307" category="list-text">Na guia Delegação, selecione confiar neste computador somente para Delegação aos Serviços especificados.</block>
  <block id="4070350eb1a20fec8173f5ee230b8566" category="list-text">Selecione usar somente Kerberos.</block>
  <block id="36d92877123542287dffc5912e198436" category="list-text">Clique em Adicionar, que abre o assistente Adicionar serviços.</block>
  <block id="2a206fdec4cfdbdd63ff3dd2265bbb34" category="list-text">Em Adicionar Serviços, clique em usuários e computadores, que abre Select Users or Computers**</block>
  <block id="6fb0c1f70349caf1f37bdb1c7b73efe4" category="list-text">Forneça o nome do servidor Hyper-V de destino e clique em OK.</block>
  <block id="261db7be66ebd6db420e928cb4b402f7" category="list-text">Para mover o armazenamento de VM, selecione CIFS.</block>
  <block id="f4288db12d8f66e52ec2ac189f491e82" category="list-text">Para mover VMs, selecione o serviço Microsoft Virtual System Migration.</block>
  <block id="9149d965e2ccf728685f671fb1046ab9" category="list-text">Na guia Delegação, clique em OK.</block>
  <block id="9bc766cbcc4911cf673963ca303576bc" category="list-text">Na pasta computadores, selecione o servidor Hyper-V de destino na lista e repita o processo. Em Selecionar usuários ou computadores, forneça o nome do servidor Hyper-V de origem.</block>
  <block id="5868e6c6d4568bb2c1245c731ab1f681" category="list-text">Mova a VM.</block>
  <block id="43434644e024fa3073cc9c64dba551d0" category="list-text">Abra o Gerenciador do Hyper-V.</block>
  <block id="3999a6e17f16c7f048684f76a1a59e38" category="list-text">Clique com o botão direito em uma VM e clique em mover.</block>
  <block id="ab102f10122268c6b0663d464d3192da" category="list-text">Escolha mover a Máquina Virtual.</block>
  <block id="8b95cb0524fdc80c99bdf8cb976556d2" category="list-text">Especifique o servidor Hyper-V de destino para a VM.</block>
  <block id="25b70b154b120ba061f03c292637a9a4" category="list-text">Escolha as opções mover. Para migração ao vivo compartilhada, escolha mover somente a Máquina Virtual. Para Shared Nothing Live Migration, escolha qualquer uma das outras duas opções com base nas suas preferências.</block>
  <block id="8c60fc97ae35b3af22d644ab2b9186e7" category="list-text">Forneça a localização da VM no servidor Hyper-V de destino com base nas suas preferências.</block>
  <block id="dd714dbbaab89194e2aefdf439089cff" category="list-text">Revise o resumo e clique em OK para mover a VM.</block>
  <block id="e2e4ca1a6c3bcca61ed5ec3ea10c90c0" category="summary">Saiba como implantar e configurar a réplica do Hyper-V com o Cluster de failover do Windows Server.</block>
  <block id="2323e97f7cf2da464750911f1f3e1af6" category="doc">Implantar a réplica do Hyper-V em um ambiente em cluster</block>
  <block id="e651877073d877e1ee090d986eafc550" category="list-text">Você precisa ter clusters do Hyper-V localizados no mesmo local ou em locais geográficos separados, servindo como clusters primários e de réplica. Reveja <block ref="8a150f92c22920868769b8738759e23d" category="inline-link-macro-rx"></block> para obter mais detalhes.</block>
  <block id="5674fdbee301f444dd0ca3836c682957" category="list-text">Se forem usados sites separados, o firewall em cada local deve ser configurado para permitir a comunicação entre os clusters primário e de réplica.</block>
  <block id="6cc66ed27b17f9c380f924d533e633d6" category="list-text">O cluster de réplica deve ter espaço suficiente para armazenar as cargas de trabalho replicadas.</block>
  <block id="ff71768b9e039ee5012c181eb29bdc39" category="list-text">Ative regras de firewall em todos os nós de um cluster. Execute o cmdlet do PowerShell a seguir com o admin Privileges em todos os nós nos clusters primário e de réplica.</block>
  <block id="ac005fe375c3903e88ed3801a8646b0a" category="list-text">Configure o cluster de réplica.</block>
  <block id="3a57da55cdc319b0580af329b8776df6" category="list-text">Configure o corretor de réplica Hyper-V com um nome NetBIOS e endereço IP para usar como ponto de conexão para o cluster que é usado como o cluster de réplica.</block>
  <block id="643ce0b9206c6c138b36b79315a468f2" category="list-text">Abra o Gerenciador de Cluster de failover.</block>
  <block id="52243c461a19e74a8e4b64d801979142" category="list-text">Expanda o cluster, clique em funções e clique no painel Configurar função a partir de ações.</block>
  <block id="f87ee1c8e6945b31ba45ee813ea7c124" category="list-text">Selecione Hyper-V Replica Broker na página Selecionar função.</block>
  <block id="fdbea454936dca227734d3f978334254" category="list-text">Forneça o nome NetBIOS e o endereço IP a serem usados como ponto de conexão para o cluster (ponto de acesso do cliente).</block>
  <block id="bb8627cc57d25f02546b85f38d97ae04" category="list-text">Este processo cria uma função de corretor de réplica Hyper-V. Verifique se ele está online com sucesso.</block>
  <block id="9b11f91c42607554f82ca0c4a5739d14" category="list-text">Configure as definições de replicação.</block>
  <block id="662af7cfca9243c46223a416df05d774" category="list-text">Clique com o botão direito do Mouse no corretor de réplica criado nas etapas anteriores e clique em Configurações de replicação.</block>
  <block id="45375ee44c681920240b13f25bf53d9e" category="list-text">Selecione Ativar este cluster como um servidor de réplica.</block>
  <block id="23e173753ad1fc5a192335afcd91aaa2" category="list-text">Na seção Autenticação e portas, selecione o método e a porta de autenticação.</block>
  <block id="88aeceb8128e3b94092a3e66ac2236db" category="list-text">Na seção autorização e armazenamento, selecione os servidores autorizados a replicar VMs para este cluster. Além disso, especifique o local padrão onde as VMs replicadas são armazenadas.</block>
  <block id="3d9241b7079c08f25c850a7d8ac5eebd" category="inline-link-macro">Réplica fora de um ambiente em cluster</block>
  <block id="3077be518a570235f65497aa5b227e9b" category="paragraph">A replicação é semelhante ao processo descrito na <block ref="85d27647a4d4ffb042b0371e9654ea4c" category="inline-link-macro-rx"></block>seção .</block>
  <block id="1139a59d4aa15acd59f31d05c5a9d642" category="summary">Este apêndice descreve a implantação da réplica do Hyper-V fora de um ambiente em cluster.</block>
  <block id="5b6253395cb699e828a4e33bbe3ad99e" category="doc">Implantar a réplica do Hyper-V fora de um ambiente em cluster</block>
  <block id="be9cfe5b3b6e5354686be0cb736fe70d" category="list-text">Você precisa de servidores Hyper-V autônomos localizados nas mesmas localizações geográficas ou separadas, servindo como servidores primários e de réplica.</block>
  <block id="427aef80e259ae74b835c2b646e8fba8" category="list-text">Se forem usados sites separados, o firewall em cada site deve ser configurado para permitir a comunicação entre os servidores principal e de réplica.</block>
  <block id="3ac92c1d06a47463c6ea9f2c4289a625" category="list-text">O servidor de réplica deve ter espaço suficiente para armazenar as cargas de trabalho replicadas.</block>
  <block id="6db575d6d23958eefd722c2559c2ae2b" category="list-text">Configure o servidor de réplica.</block>
  <block id="f348eb2699776a23b340068fa13ba378" category="list-text">Para que as regras de firewall de entrada permitam tráfego de replicação de entrada, execute o seguinte cmdlet do PowerShell:</block>
  <block id="b3741a0bf4f272b05520af3145ce6b20" category="list-text">Clique em Configurações do Hyper-V em ações.</block>
  <block id="0b81c69f5b40344714e859c333f7e46d" category="list-text">Clique em Configuração de replicação e selecione Ativar este computador como um servidor de réplica.</block>
  <block id="c67571ac7fd00493d3ca7147b7756914" category="list-text">Na seção autorização e armazenamento, especifique o local para armazenar as VMs e arquivos replicados.</block>
  <block id="c6f470c780ac40391a73366709e36fae" category="list-text">Habilite a replicação de VM para VMs no servidor primário. A replicação da VM é ativada por VM e não para todo o servidor Hyper-V.</block>
  <block id="84f81856434a0c817bfd8ec7ba575d63" category="list-text">No Hyper-V Manager, clique com o botão direito do rato numa VM e clique em Ativar replicação para abrir o assistente Ativar replicação.</block>
  <block id="bb27dca619d145c6538ad523a5c5aec7" category="list-text">Forneça o nome do servidor de réplica em que a VM deve ser replicada.</block>
  <block id="368e47c642802a224da6a1e9196c2345" category="list-text">Forneça o tipo de autenticação e a porta do servidor de réplica que foi configurada para receber tráfego de replicação no servidor de réplica.</block>
  <block id="df839b9a847de722b03fb6f8db4abd3d" category="list-text">Selecione os VHDs a serem replicados.</block>
  <block id="7e2b2defa62bab724dad332e0efe93d4" category="list-text">Escolha a frequência (duração) em que as alterações são enviadas para o servidor de réplica.</block>
  <block id="f1358329d5a84d751f47c4d4e4882286" category="list-text">Configure os pontos de recuperação para especificar o número de pontos de recuperação a serem mantidos no servidor de réplica.</block>
  <block id="13bb9737452c217970585237bf9a3c67" category="list-text">Escolha método de replicação inicial para especificar o método para transferir a cópia inicial dos dados da VM para o servidor de réplica.</block>
  <block id="e7773df7e8bec8a84ededaaba6cc3b5c" category="list-text">Reveja o resumo e clique em concluir.</block>
  <block id="eaa408dd6135876f9368b7e9e8447340" category="list-text">Esse processo cria uma réplica de VM no servidor de réplica.</block>
  <block id="c6c9686c38a42b00345f77c5ddbe044a" category="list-text">Execute um failover de teste para garantir que a réplica VM funcione corretamente no servidor de réplica. O teste cria uma VM temporária no servidor de réplica.</block>
  <block id="4b07a5223e241d6b4d7935c2282616a5" category="list-text">Faça login no servidor de réplica.</block>
  <block id="baaaeb9b824a8922645198d46a10e27a" category="list-text">No Gerenciador do Hyper-V, clique com o botão direito em uma réplica VM, clique em replicação e clique em failover de teste.</block>
  <block id="b9950331695e861c821d48077fe8b1f1" category="list-text">Escolha o ponto de recuperação a utilizar.</block>
  <block id="b1d034cdaa7ef0d2bc761b948c78838a" category="list-text">Este processo cria uma VM com o mesmo nome anexado com -Test.</block>
  <block id="8c95c5ef4d5593fe860313c283fab784" category="list-text">Verifique a VM para se certificar de que tudo funciona bem.</block>
  <block id="e5c73308bdacf8978516ccda5462e80a" category="list-text">Após o failover, a VM de teste de réplica é excluída se você selecionar Parar failover de teste para ela.</block>
  <block id="c4eacda4a6022cafe1bfc0d735075dce" category="list-text">Execute um failover planejado para replicar as alterações mais recentes na VM principal para a VM réplica.</block>
  <block id="7c3c0f256f21e1f117a98a5afa47dd56" category="list-text">Inicie sessão no servidor principal.</block>
  <block id="2d6fd035cbd8062dcc29935ff448420e" category="list-text">Desligue a VM para falha.</block>
  <block id="582c3456f1d3f75fd04a3dfcdb20c132" category="list-text">No Gerenciador do Hyper-V, clique com o botão direito do Mouse na VM desativada, clique em replicação e clique em failover planejado.</block>
  <block id="4ed0c56504eba0632689dfc8056e3c49" category="list-text">Clique em failover para transferir as alterações mais recentes da VM para o servidor de réplica.</block>
  <block id="f490046b13ec9105a4adb8f885b5688f" category="list-text">Executar um failover não planejado no caso de falha de VM principal.</block>
  <block id="c01438bcded7cda6d1ee326fa268f93c" category="list-text">No Hyper-V Manager, clique com o botão direito do Mouse em uma réplica VM, clique em replicação e clique em failover.</block>
  <block id="94faab2d3840f3d8320e20ad4a90e6cd" category="list-text">Clique em failover para fazer failover na VM.</block>
  <block id="c9f4515194bc7b2927aa17b7d9b4aa25" category="summary">Como configurar a migração ao vivo de armazenamento Hyper-V</block>
  <block id="a49764977574be237e816e868b16bd9e" category="doc">Implante a migração ao vivo do Hyper-V Storage</block>
  <block id="587db979ac1f69c45774cb09d6d6670b" category="paragraph">Saiba como configurar a migração ao vivo de armazenamento Hyper-V</block>
  <block id="0146445d75059a401441fd65f1bae1e0" category="list-text">Você deve ter um servidor Hyper-V autônomo com armazenamento independente (DAS ou LUN) ou armazenamento SMB (local ou compartilhado entre outros servidores Hyper-V).</block>
  <block id="71c2ecf4798ba7bf00669c37826cb55b" category="inline-link-macro">Migração ao vivo fora de um ambiente em cluster</block>
  <block id="4a8052295fad176b01067c772f7c7e5d" category="list-text">O servidor Hyper-V deve ser configurado para migração em tempo real. Revise a seção sobre implantação no <block ref="0e7f526c94c2d5b9ef424b7a8a1c9587" category="inline-link-macro-rx"></block>.</block>
  <block id="1d838d1a72e03329477d7f4024eec108" category="list-text">Selecione mover o armazenamento da máquina virtual.</block>
  <block id="45d2d7245527e5e6e9be62e79d5a46d8" category="list-text">Selecione opções para mover o armazenamento de acordo com as suas preferências.</block>
  <block id="13d0ba1c0320910efd0d040f2d461527" category="list-text">Forneça o novo local para os itens da VM.</block>
  <block id="6efadc6e298c560f1699100ac97c7378" category="list-text">Revise o resumo e clique em OK para mover o armazenamento da VM.</block>
  <block id="2398ac10b8f12f8d175464af41b6cc27" category="summary">Saiba mais sobre como implantar o Microsoft Windows Nano Server</block>
  <block id="381400d1babe5b80783d5e46896d832e" category="doc">Implante o servidor Nano</block>
  <block id="751f4ae88fb7c0e83c557b594f24f467" category="paragraph">Saiba mais sobre como implantar o Microsoft Windows Nano Server.</block>
  <block id="ffd8df9c68fc3e1710ed9dc15dec9225" category="paragraph">Para implantar um Nano Server como um host Hyper-V, execute as seguintes etapas:</block>
  <block id="9eb306535570bd14746bad4f0768684f" category="list-text">Inicie sessão no Windows Server como membro do grupo de administradores.</block>
  <block id="e93afc2a7bab8945ac834e9f955ab2c8" category="list-text">Para criar um Nano Server VHD/VHDX, execute as seguintes etapas:</block>
  <block id="3b515a3daeec18784951623c4ef02332" category="list-text">Crie um VHD para o Nano Server como um host Hyper-V executando o cmdlet do PowerShell a seguir. Este comando solicita uma senha de administrador para o novo VHD.</block>
  <block id="2ef6d24f20fa6986cbd70ea844d3e16e" category="list-text">No exemplo a seguir, criamos um Nano Server VHD com o recurso Hyper-V host com cluster de failover ativado. Este exemplo cria um Nano Server VHD a partir de um ISO montado em f: '. O VHD recém-criado é colocado em uma pasta chamada NanoServer na pasta de onde o cmdlet é executado. O nome do computador é NanoServer e o VHD resultante contém a edição padrão do Windows Server.</block>
  <block id="7f165cd40e3ab8b56d69cfdf799ebb23" category="list-text">Com o cmdlet New-NanoServerImage, configure parâmetros que definem o endereço IP, a máscara de sub-rede, o gateway padrão, o servidor DNS, o nome do domínio, etc.</block>
  <block id="9ba9f17628c7c8e123a1c4d0b154e1e0" category="list-text">Use o VHD em uma VM ou host físico para implantar o Nano Server como um host Hyper-V:</block>
  <block id="7482916c1c66ae16c274920ca01eda80" category="list-text">Para implantação em uma VM, crie uma nova VM no Hyper-V Manager e use o VHD criado na Etapa 3.</block>
  <block id="8a1f197a1a3903636fe46d151b55f1a4" category="list-text">Para implantação em um host físico, copie o VHD para o computador físico e configure-o para inicializar a partir deste novo VHD. Primeiro, monte o VHD, execute o bcdboot e: Janelas (onde o VHD está montado sob e:), desmonte o VHD, reinicie o computador físico e inicialize no Nano Server.</block>
  <block id="1a2fbb26db89a11f849f5a17170449b5" category="list-text">Junte o Nano Server a um domínio (opcional):</block>
  <block id="fa966a71fb7e787a036cc8ae2df719c2" category="list-text">Faça login em qualquer computador no domínio e crie um blob de dados executando o seguinte cmdlet do PowerShell:</block>
  <block id="5e83141959914643e6e309d32cb02675" category="list-text">Copie o arquivo odjblob para o Nano Server executando os seguintes cmdlets do PowerShell em uma máquina remota:</block>
  <block id="9493ca9bfebee08582b48c95f6ad1768" category="list-text">Reinicie o Nano Server.</block>
  <block id="24d48ec9863eca883370d9e471e7dec1" category="section-title">Conete-se ao Nano Server</block>
  <block id="11e7dceca10309920a26c38df3c5f421" category="paragraph">Para se conetar ao Nano Server remotamente usando o PowerShell, execute as seguintes etapas:</block>
  <block id="08d7b9e67b4bbd447b1fa3d9103976e8" category="list-text">Adicione o Nano Server como um host confiável no computador remoto executando o seguinte cmdlet no servidor remoto:</block>
  <block id="0b1f1a420d35761f550f4a9f3b9e2ecb" category="list-text">Se o ambiente estiver seguro e se você quiser definir todos os hosts para serem adicionados como hosts confiáveis em um servidor, execute o seguinte comando:</block>
  <block id="06879aa989dffc1c877a92441f72d474" category="list-text">Inicie a sessão remota executando o cmdlet a seguir no servidor remoto. Forneça a senha para o Nano Server quando solicitado.</block>
  <block id="c5363e6f2cab660a02c04316d65097b5" category="paragraph">Para se conetar ao Nano Server remotamente usando ferramentas de gerenciamento de GUI de um Windows Server remoto, execute os seguintes comandos:</block>
  <block id="d97c0d550aa0ad1af548a89c27d9f7ea" category="list-text">Inicie sessão no Windows Server como membro do grupo de administradores.</block>
  <block id="ff621b1b3a7bcf389fc4c97a55bf9505" category="list-text">Para gerenciar um Nano Server remotamente a partir do Gerenciador de servidores, clique com o botão direito em todos os servidores, clique em Adicionar servidores, forneça as informações do Nano Server e adicione-o. Agora você pode ver o Nano Server listado na lista de servidores. Selecione o Nano Server, clique com o botão direito do Mouse nele e comece a gerenciá-lo com as várias opções fornecidas.</block>
  <block id="2343c80f9e6b008ea95cc15026c9c094" category="list-text">Para gerenciar serviços em um Nano Server remotamente, execute as seguintes etapas:</block>
  <block id="1430c8ff3134db821cc65ac53e010d4d" category="list-text">Abra Serviços na seção Ferramentas do Gerenciador de servidores.</block>
  <block id="358fe30f1157bd64dad7a3aba4e40f94" category="list-text">Clique com o botão direito em Serviços (local).</block>
  <block id="72fa515e487f796b536e03179e63e7db" category="list-text">Clique em conetar ao servidor.</block>
  <block id="50ec7cc625733992673123275ff834d6" category="list-text">Forneça os detalhes do Nano Server para visualizar e gerenciar os serviços no Nano Server.</block>
  <block id="f322fcdc841439901a45a176928f80e0" category="list-text">Se a função Hyper-V estiver ativada no Nano Server, execute as seguintes etapas para gerenciá-la remotamente a partir do Gerenciador Hyper-V:</block>
  <block id="14994643f0c569708527514d0405c1e5" category="list-text">Clique com o botão direito do rato em Gestor Hyper-V.</block>
  <block id="8e0877f5a8a5d540837664b9de1070ca" category="list-text">Clique em conetar ao servidor e forneça os detalhes do Nano Server. Agora, o Nano Server pode ser gerenciado como um servidor Hyper-V para criar e gerenciar VMs em cima dele.</block>
  <block id="b2c5e9024429f1b7f8581d1747d25fd6" category="list-text">Se a função de cluster de failover estiver ativada no Nano Server, execute as seguintes etapas para gerenciá-lo remotamente a partir do gerenciador de cluster de failover:</block>
  <block id="31b3efaeee0b35b5bde4f1353f947b93" category="list-text">Abra o Gerenciador de Cluster de failover na seção Ferramentas do Gerenciador de servidores.</block>
  <block id="2cb85a898a7a975600dcc1bea85df531" category="list-text">Execute operações relacionadas a clustering com o Nano Server.</block>
  <block id="b2d949a2d7f46bb1e39037d38eea14e4" category="summary">Eficiência de storage da ONTAP com Microsoft Hyper-V.</block>
  <block id="fd18465573ec21a6218982055981f6b1" category="doc">Eficiência de storage</block>
  <block id="bd2eab4ffe0ab602b60386dfdd3ef913" category="paragraph">O ONTAP fornece eficiência de storage líder do setor para ambientes virtualizados, incluindo o Microsoft Hyper-V. o NetApp também oferece programas de garantia de eficiência de storage.</block>
  <block id="36b10adb4505559b63b091b53614af1f" category="section-title">Deduplicação da NetApp</block>
  <block id="e957a0e8016b502f05bb1966b2ec6064" category="paragraph">A deduplicação do NetApp funciona removendo blocos duplicados no nível do volume de storage, armazenando apenas uma cópia física, independentemente de quantas cópias lógicas estejam presentes. Portanto, a deduplicação cria a ilusão de que existem inúmeras cópias desse bloco. A deduplicação remove automaticamente blocos de dados duplicados em um nível de bloco de 4KB U em todo o volume. Esse processo recupera o storage para obter economia de espaço e potencial de desempenho, reduzindo o número de gravações físicas no disco. A deduplicação pode proporcionar mais de 70% de economia de espaço em ambientes Hyper-V.</block>
  <block id="6cd880eabbec3488232c6cba3fbcf998" category="section-title">Thin Provisioning</block>
  <block id="44ee5e4157e5291ffc8bc5d1d9b5959d" category="paragraph">O thin Provisioning é uma maneira eficiente de provisionar storage porque o storage não é pré-alocado de antemão. Em outras palavras, quando um volume ou LUN é criado usando thin Provisioning, o espaço no sistema de storage não é usado. O espaço permanece não utilizado até que os dados sejam gravados no LUN ou volume e apenas o espaço necessário para armazenar os dados é usado. A NetApp recomenda ativar o provisionamento de thin Provisioning no volume e desativar a reserva de LUN.</block>
  <block id="8bc14f0cb78851f59e85c1d447c2c99f" category="section-title">Qualidade do serviço</block>
  <block id="8649c492f1adfda9b6ab44990a1a7580" category="paragraph">Em ambientes empresariais, a QoS de storage ajuda a conseguir o seguinte:</block>
  <block id="ca944817219b4a5d2cb25894ee7bac2d" category="list-text">Impede que os workloads do usuário afetem uns aos outros.</block>
  <block id="1d5819479882e9b1b8133fda618801e5" category="list-text">Protege aplicações críticas que têm tempos de resposta específicos que precisam ser atendidos em AMBIENTES DE TI como serviço (ITaaS).</block>
  <block id="b06d1116eb0db3e3c8c51d1707dfcf99" category="list-text">Impede que os inquilinos se afetem.</block>
  <block id="1d7dd784ada3e9fe62630025fa82dc80" category="list-text">Evita a degradação do desempenho com a adição de cada novo inquilino.</block>
  <block id="3c7577ceba90e087950e69f357ce949b" category="paragraph">O QoS permite limitar a quantidade de e/S enviada para um SVM, um volume flexível, um LUN ou um arquivo. A e/S pode ser limitada pelo número de operações ou pela taxa de transferência bruta.</block>
  <block id="0ac164a0cdedc812bd371348407d8df2" category="paragraph">A figura a seguir ilustra o SVM com sua própria política de QoS que impõe um limite máximo de taxa de transferência.</block>
  <block id="4cd97525569a4c4f332a1fbadea31367" category="inline-image-macro">Máquina virtual de armazenamento com sua própria política de QoS, largura de 319 mm, altura de 341 mm</block>
  <block id="11751e265ace69b487d325224006c7e5" category="paragraph"><block ref="11751e265ace69b487d325224006c7e5" category="inline-image-macro-rx" type="image"></block></block>
  <block id="42674eda4c194d913efb361684c8b8c6" category="paragraph">Para configurar um SVM com sua própria política de QoS e monitorar o grupo de políticas, execute os seguintes comandos no cluster do ONTAP:</block>
  <block id="c7bfaead2ee1aea320b1d91da7ba31d7" category="summary">Saiba mais sobre o armazenamento NetApp e o ambiente de servidor Windows</block>
  <block id="3c0fa9c86e8d92c7a146b2d71467ab2e" category="doc">Armazenamento NetApp e ambiente Windows Server</block>
  <block id="3b878279a04dc47d60932cb294d96259" category="inline-link-macro">Visão geral</block>
  <block id="5c8c98e7f403562b754941b4d0c17f65" category="paragraph">Como mencionado no <block ref="ba92ae7cf3bb4a058d2b231c16067714" category="inline-link-macro-rx"></block>, as controladoras de storage NetApp fornecem uma arquitetura realmente unificada que dá suporte aos protocolos de arquivo, bloco e objeto. Isso inclui SMB/CIFS, NFS, NVMe/TCP, NVMe/FC, iSCSI, FC (FCP) e S3, além de criar acesso unificado de cliente e host. O mesmo controlador de storage pode, ao mesmo tempo, fornecer serviço de storage de bloco na forma de LUNs SAN e serviço de arquivos como NFS e SMB/CIFS. O ONTAP também está disponível como um ASA (All SAN Array) que otimiza o acesso ao host por meio de multipathing ativo-ativo simétrico com iSCSI e FCP, enquanto os sistemas ONTAP unificados usam multipathing ativo-ativo assimétrico. Em ambos os modos, o ONTAP usa o ANA para gerenciamento de multipath NVMe sobre Fabrics (NVMe-of).</block>
  <block id="b7c45da218d2e29ec939a31cdd81f2be" category="paragraph">Uma controladora de storage NetApp executando o ONTAP pode dar suporte aos seguintes workloads em um ambiente Windows Server:</block>
  <block id="b39d47dbcb48e2064ea0978dea0793ae" category="list-text">VMs hospedadas em compartilhamentos SMB 3,0 continuamente disponíveis</block>
  <block id="be1d5dd432dd053b97f14401fc060813" category="list-text">VMs hospedadas em LUNs de volume compartilhado (CSV) de cluster executadas em iSCSI ou FC</block>
  <block id="fc27a7625c9ffb2fe9dd539f1960c978" category="list-text">Bancos de dados SQL Server em compartilhamentos SMB 3,0</block>
  <block id="658f98073361780ad39f8c0d45eca2f8" category="list-text">Bancos de dados SQL Server em NVMe-of, iSCSI ou FC</block>
  <block id="d2ed21657f98def30346884514f11cce" category="list-text">Outros workloads de aplicações</block>
  <block id="b76d8ce5a4b5758745257d0223494701" category="section-title">ONTAP data Management</block>
  <block id="37b74b1418c82d2f0f3a093c4da8e7de" category="paragraph">O ONTAP é um software de gerenciamento executado em um controlador de storage da NetApp. Referido como um nó, um controlador de armazenamento NetApp é um dispositivo de hardware com um processador, RAM e NVRAM. O nó pode ser conetado a unidades de disco SATA, SAS ou SSD ou a uma combinação dessas unidades.</block>
  <block id="4472647bb1219b68f4b76e737a20ce52" category="inline-image-macro">Implantação de armazenamento NetApp no ambiente do Windows Server, largura de 624 mm, altura de 479 mm</block>
  <block id="79ea3c938053f84aab6e3d9a963056f6" category="paragraph"><block ref="79ea3c938053f84aab6e3d9a963056f6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7df39ad25b0e96b5a09cafef15c90e83" category="paragraph">O ONTAP SVM é um servidor de storage lógico que fornece acesso a dados a LUNs e/ou namespace nas a partir de uma ou mais interfaces lógicas (LIFs). O SVM é, portanto, a unidade básica de segmentação de storage que permite a alocação segura a vários clientes no ONTAP. Cada SVM é configurado para possuir volumes de storage provisionados de um agregado físico e interfaces lógicas (LIFs) atribuídas a uma rede Ethernet física ou a portas de destino FC.</block>
  <block id="ded35f53d6a4c12f9aa23622a273290c" category="paragraph">Discos lógicos (LUNs) ou compartilhamentos CIFS são criados dentro dos volumes de uma SVM e são mapeados para hosts e clusters do Windows para fornecer espaço de storage, conforme mostrado na figura a seguir. Os SVMs são independentes de nós e baseados em cluster; eles podem usar recursos físicos, como volumes ou portas de rede em qualquer lugar do cluster.</block>
  <block id="66bfba6c82925242c27d2f07403b627e" category="inline-image-macro">Máquina virtual de armazenamento ONTAP, largura de 572mm, altura de 443mm</block>
  <block id="9bcb5e161ae4c106ccd0f2dc96989097" category="paragraph"><block ref="9bcb5e161ae4c106ccd0f2dc96989097" category="inline-image-macro-rx" type="image"></block></block>
  <block id="458ed20ed5d1729b427e233e0e52f797" category="section-title">Provisionamento de armazenamento NetApp para Windows Server</block>
  <block id="8f64c369fcdc9c990f5540ce53430671" category="paragraph">O storage pode ser provisionado para o Windows Server em ambientes SAN e nas. Em um ambiente SAN, o storage é fornecido como discos de LUNs no volume NetApp como storage de bloco. Em um ambiente nas, o storage é fornecido como compartilhamentos CIFS/SMB em volumes NetApp como storage de arquivos. Esses discos e compartilhamentos podem ser aplicados no Windows Server da seguinte forma:</block>
  <block id="8572daf67b8cf4929b8a104909d42a03" category="list-text">Storage para hosts do Windows Server para workloads de aplicativos</block>
  <block id="460622219d2e0a7fe2d7339d37894127" category="list-text">Armazenamento para Nano Server e contentores</block>
  <block id="24148b9d626dc3494e0f1a07f5ddf180" category="list-text">Armazenamento para hosts Hyper-V individuais para armazenar VMs</block>
  <block id="c9d2a95802a3dc0a7c1033928d3cfc3f" category="list-text">Armazenamento compartilhado para clusters Hyper-V na forma de CSVs para armazenar VMs</block>
  <block id="76c319d8818e93b50538dff2f4427cbc" category="list-text">Armazenamento para bancos de dados SQL Server</block>
  <block id="e648c74a53b161f90c8e915624ce6135" category="section-title">Gerenciamento do storage do NetApp</block>
  <block id="13a4fb282282699692756c149d94bbbe" category="paragraph">Para conetar, configurar e gerenciar o armazenamento do NetApp a partir do Windows Server 2016, use um dos seguintes métodos:</block>
  <block id="81ef8774b45c60d7387b0e91d9c4eb05" category="list-text">*Secure Shell (SSH).* Use qualquer cliente SSH no Windows Server para executar comandos NetApp CLI.</block>
  <block id="935df6062271011aad64300fe0f8a6c7" category="list-text">*System Manager.* Este é o produto de gerenciamento baseado em GUI da NetApp.</block>
  <block id="85c7991eb4ed1078ecb54aacffe3a3a2" category="list-text">*Kit de ferramentas do NetApp PowerShell.* Este é o Toolkit do NetApp PowerShell para automatizar e implementar scripts e fluxos de trabalho personalizados.</block>
  <block id="1fb25b443082bb79703b1237630cd9b6" category="section-title">Kit de ferramentas do NetApp</block>
  <block id="16ce478a465011bacaa6e508063c2648" category="section-title">Coisas para se lembrar</block>
  <block id="a5038d870bfecae7a8fb1fb0d8ba892b" category="list-text">O NetApp não suporta espaços de armazenamento do Windows Server. Os espaços de armazenamento são usados apenas para JBOD (apenas um monte de discos) e não funciona com qualquer tipo de RAID (armazenamento de conexão direta [DAS] ou SAN).</block>
  <block id="b37ae3efea13417cff3fdb198db41274" category="list-text">Os pools de armazenamento em cluster no Windows Server não são suportados pelo ONTAP.</block>
  <block id="436593f3429fec64588705fe44025823" category="list-text">O NetApp suporta o formato de disco rígido virtual compartilhado (VHDX) para cluster de convidados em ambientes SAN do Windows.</block>
  <block id="a3a862b96d666cb7005617313f703378" category="list-text">O Windows Server não suporta a criação de pools de armazenamento usando iSCSI ou FC LUNs.</block>
  <block id="1ba5c1747d37a3d7ae84fd1dcac77603" category="section-title">Leitura adicional</block>
  <block id="9d2169c1c2855b78a7aeaa4f42d27dc7" category="inline-link">Site de suporte da NetApp</block>
  <block id="570d38aae09bbf84ba37f9219909a7cb" category="list-text">Para obter mais informações sobre o Kit de ferramentas do NetApp PowerShell, visite o<block ref="12f72d9ce1eab5b7cd58718fecdd145c" category="inline-link-rx"></block>.</block>
  <block id="699f0a44719fb3de5404046fc6caa8af" category="inline-link">TR-4475: Guia de práticas recomendadas do kit de ferramentas do NetApp PowerShell</block>
  <block id="532d077f114744273b1a7cd2a4794077" category="list-text">Para obter informações sobre as práticas recomendadas do NetApp PowerShell Toolkit,<block ref="87b47631a9123c9d2a382039a9ba503e" category="inline-link-rx"></block> consulte .</block>
  <block id="9292ee6bce21e93911c38cd0a1c2e209" category="section-title">Melhores práticas de rede</block>
  <block id="64f3248fbae79dd41841377bf7dd37c6" category="paragraph">As redes Ethernet podem ser amplamente segregadas nos seguintes grupos:</block>
  <block id="0047d4a23ffec6d4afe912d0a2598e58" category="list-text">Uma rede cliente para as VMs</block>
  <block id="d6cf6da705ce58c7b649fea1cd43c470" category="list-text">Mais uma rede de armazenamento (iSCSI ou SMB conetando-se aos sistemas de armazenamento)</block>
  <block id="0d8658721aaab8eb43f9b6d72283b8f8" category="list-text">Uma rede de comunicação de cluster (heartbeat e outra comunicação entre os nós do cluster)</block>
  <block id="338c97ec16c135df1c972ba5b92db129" category="list-text">Uma rede de gerenciamento (para monitorar e solucionar problemas do sistema)</block>
  <block id="7b6753ef35b59e8866faf1b43b213520" category="list-text">Uma rede de migração (para migração ao vivo do host)</block>
  <block id="0f31fc2f15105bd45773e0fe5a33814a" category="list-text">Replicação de VM (uma réplica do Hyper-V)</block>
  <block id="11ef3cd9dc7173f009417493a7a51f57" category="list-text">A NetApp recomenda ter portas físicas dedicadas para cada uma das funcionalidades anteriores para isolamento e desempenho da rede.</block>
  <block id="84f729d0d6ae07e1ea7697e418337328" category="list-text">Para cada um dos requisitos de rede anteriores (exceto para os requisitos de armazenamento), várias portas de rede físicas podem ser agregadas para distribuir carga ou fornecer tolerância a falhas.</block>
  <block id="89831505b6fb0eb3bfb78852c3e8838a" category="list-text">A NetApp recomenda ter um switch virtual dedicado criado no host Hyper-V para conexão de armazenamento convidado dentro da VM.</block>
  <block id="301b0a1048a669cb6b56215ce25f83d2" category="list-text">Certifique-se de que o host Hyper-V e os caminhos de dados iSCSI Guest usam diferentes portas físicas e switches virtuais para isolamento seguro entre o convidado e o host.</block>
  <block id="38d14a6f7d54295d21bfb890bbfac145" category="list-text">A NetApp recomenda evitar o agrupamento de NIC para NICs iSCSI.</block>
  <block id="3b5eab23ccdc37978e26fa584647f2f5" category="list-text">A NetApp recomenda o uso de ONTAP multipath input/output (MPIO) configurado no host para fins de armazenamento.</block>
  <block id="6395caf6c767d5f8026b684721c1e27e" category="list-text">A NetApp recomenda o uso de MPIO em uma VM convidada se estiver usando iniciadores iSCSI convidados. O uso do MPIO deve ser evitado dentro do convidado se você usar discos pass-through. Neste caso, a instalação do MPIO no host deve ser suficiente.</block>
  <block id="55892ded4e0eac09cd2bd256ea8e4f49" category="list-text">A NetApp recomenda não aplicar políticas de QoS ao switch virtual atribuído à rede de storage.</block>
  <block id="9e33949565ff57eed3e484a27adca687" category="list-text">A NetApp recomenda não usar o endereçamento IP privado automático (APIPA) em NICs físicos porque o APIPA não é roteável e não está registrado no DNS.</block>
  <block id="b06f6cf7b5c4e8ac8117fe6238a15184" category="list-text">A NetApp recomenda a ativação de quadros jumbo para redes de migração CSV, iSCSI e Live para aumentar a taxa de transferência e reduzir os ciclos da CPU.</block>
  <block id="d34fac956ae63cd93b204c541399ec3f" category="list-text">A NetApp recomenda desmarcar a opção permitir que o sistema operacional de Gerenciamento compartilhe esta placa de rede para que o switch virtual Hyper-V crie uma rede dedicada para as VMs.</block>
  <block id="0d3e51fc3c7ecb31cb6dcf3ea104060c" category="list-text">A NetApp recomenda a criação de caminhos de rede redundantes (vários switches) para migração em tempo real e para a rede iSCSI para fornecer resiliência e QoS.</block>
  <block id="a80438f1b3354b284cf31082c45b33b3" category="summary">Infraestrutura de storage Hyper-V com ONTAP</block>
  <block id="e5f52b64058cb937fdd114369219d380" category="doc">Infraestrutura de storage Hyper-V no NetApp</block>
  <block id="cfbb26e347d5746581822f8046be20c4" category="paragraph">Uma infraestrutura de storage Hyper-V pode ser hospedada em sistemas de storage ONTAP. O armazenamento para o Hyper-V para armazenar os arquivos da VM e seus discos pode ser fornecido usando LUNs NetApp ou compartilhamentos NetApp CIFS, como mostrado na figura a seguir.</block>
  <block id="25aa60030552ee28c6e802f74d96f111" category="inline-image-macro">Infra-estrutura de armazenamento Hyper-V em NetApp, largura de 624 mm, altura de 338 mm</block>
  <block id="818a20c74e71223c5a644895a6dd4095" category="paragraph"><block ref="818a20c74e71223c5a644895a6dd4095" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a9c5672e01a7d0a8e068c2573fbdd4c2" category="section-title">Armazenamento Hyper-V em LUNs NetApp</block>
  <block id="1d9f855d005777411eca330fd3c883a1" category="inline-link-macro">Provisionamento em ambientes SAN</block>
  <block id="d02671c8f4f293bf5688d34f44e5b87b" category="list-text">Provisione um LUN NetApp na máquina do servidor Hyper-V. Para obter mais informações, consulte a seção "<block ref="9659d1fb07c4af2143cd165cb4b6822e" category="inline-link-macro-rx"></block>."</block>
  <block id="ee15a170a42b1f37e0d70bf3b367f2ee" category="list-text">Selecione o servidor Hyper-V e clique em Configurações Hyper-V.</block>
  <block id="b9cc0276ae5386d0ed5e9ed31ceb340d" category="list-text">Especifique a pasta padrão para armazenar a VM e seu disco como LUN. Isso define o caminho padrão como LUN para o armazenamento Hyper-V. Se você quiser especificar o caminho explicitamente para uma VM, então você pode fazê-lo durante a criação da VM.</block>
  <block id="02676c7c18a8d411999242a1f5731de2" category="section-title">Armazenamento Hyper-V no NetApp CIFS</block>
  <block id="ace87f7890ab6204f4ef6abd0afaf28a" category="paragraph">Antes de iniciar as etapas listadas nesta seção, revise a seção "<block ref="f9d723fa339e7968f40a99719593036c" category="inline-link-macro-rx"></block>." Para configurar o armazenamento Hyper-V no compartilhamento CIFS do NetApp, execute as seguintes etapas:</block>
  <block id="d3f9aa7fc4289533bdeb015bbd645a22" category="list-text">Especifique a pasta padrão para armazenar a VM e seu disco como o compartilhamento CIFS. Isso define o caminho padrão como o compartilhamento CIFS para o armazenamento Hyper-V. Se você quiser especificar o caminho explicitamente para uma VM, então você pode fazê-lo durante a criação da VM.</block>
  <block id="a531c67c9d6be93b7864c891efc5480a" category="paragraph">Cada VM no Hyper-V pode, por sua vez, ser fornecida com os LUNs e compartilhamentos CIFS do NetApp que foram fornecidos ao host físico. Este procedimento é o mesmo que para qualquer host físico. Os métodos a seguir podem ser usados para provisionar storage a uma VM:</block>
  <block id="b7756c6e1b92d15f0367db534aa4fdc2" category="list-text">Adicionando um LUN de storage usando o iniciador FC na VM</block>
  <block id="dda418820dd5a8b649a681b73da4ba97" category="list-text">Adicionar um LUN de armazenamento utilizando o iniciador iSCSI na VM</block>
  <block id="ee0537a6d83f8b83e99ac0b7b3d0af82" category="list-text">Adicionando um disco físico de passagem a uma VM</block>
  <block id="a842c008b079c30c444ab4c9d78524e6" category="list-text">Adicionando VHD/VHDX a uma VM do host</block>
  <block id="50fba9282607c757ab39ad110cd0fde4" category="list-text">Quando uma VM e seus dados são armazenados no storage NetApp, a NetApp recomenda a execução da deduplicação do NetApp no nível do volume em intervalos regulares. Essa prática resulta em economia significativa de espaço quando VMs idênticas são hospedadas em um compartilhamento CSV ou SMB. A deduplicação é executada no controlador de storage e não afeta o sistema host e o desempenho da VM.</block>
  <block id="6b4ecf09c5310b6b905c86b910a57012" category="list-text">A NetApp recomenda desmarcar a opção permitir que o sistema operacional de Gerenciamento compartilhe este adaptador de rede para o switch virtual Hyper-V. Isso cria uma rede dedicada para as VMs.</block>
  <block id="8f20505d01de58b8e00048581d2d7244" category="list-text">Se o sistema host for configurado com várias portas FC e apresentado à VM, o MPIO deverá ser instalado na VM para habilitar o multipathing.</block>
  <block id="e003acc3eceda748125d4c7bf41052e7" category="list-text">Os discos pass-through não podem ser provisionados para o host se o MPIO estiver sendo usado nesse host, porque os discos pass-through não suportam MPIO.</block>
  <block id="aa7c5f68a034b43fa3bafa90ea6a6c2b" category="list-text">O disco usado para arquivos VHD/VHDx deve usar a formatação 64K para alocação.</block>
  <block id="5aa08a9ab39b4ff0ad3ec476f9c0a7a9" category="inline-link">Visão geral do Hyper-V Virtual Fibre Channel</block>
  <block id="17d2fe1a1b42dbc4c914a82ff9a06cbf" category="list-text">Para obter mais informações sobre o Fibre Channel virtual, consulte a página da Microsoft<block ref="ffefda586e5fabc71f0e43393b116d4c" category="inline-link-rx"></block>.</block>
  <block id="00a66fbc09172147ac7be9c85b708a6b" category="section-title">Transferência de dados descarregada</block>
  <block id="f43e8d35e63b48bc73d5dc074df829ae" category="paragraph">O Microsoft ODX, também conhecido como descarga de cópia, permite transferências diretas de dados dentro de um dispositivo de armazenamento ou entre dispositivos de armazenamento compatíveis sem transferir os dados através do computador host. O ONTAP oferece suporte ao recurso ODX para protocolos CIFS e SAN. O ODX pode potencialmente melhorar o desempenho se as cópias estiverem dentro do mesmo volume, reduzir a utilização da CPU e da memória no cliente e reduzir a utilização da largura de banda de e/S.</block>
  <block id="6736b7040d05d12679268b13fae93377" category="paragraph">Com o ODX, é mais rápido e eficiente copiar arquivos dentro dos compartilhamentos SMB, dentro dos LUNs e entre os compartilhamentos SMB e LUNs se estiver no mesmo volume. Essa abordagem é mais útil em um cenário para o qual várias cópias da imagem dourada de um SO (VHD/VHDX) são necessárias dentro do mesmo volume. Várias cópias da mesma imagem dourada podem ser feitas em menos tempo se as cópias estiverem dentro do mesmo volume. O ODX também é aplicado na migração ao vivo de armazenamento Hyper-V para a movimentação do armazenamento de VM.</block>
  <block id="53003aec095203ae2075a8150e8ead4e" category="paragraph">Se a cópia estiver em volumes, talvez não haja ganhos significativos de desempenho em comparação com as cópias baseadas em host.</block>
  <block id="80f704dacc785527bc57a7851889f8b3" category="paragraph">Para ativar o recurso ODX no CIFS, execute os seguintes comandos CLI no controlador de armazenamento NetApp:</block>
  <block id="9c8ee5398727fdb2573f25e0535d686d" category="list-text">Ative o ODX para CIFS. defina o nível de privilégio para o grupo de diagnóstico::&gt; definir - diagnóstico de privilégios</block>
  <block id="574eac1c36a4e6832136e6cf051cc147" category="list-text">Para ativar o recurso ODX na SAN, execute os seguintes comandos CLI no controlador de armazenamento NetApp: N defina o nível de privilégio para o cluster de diagnóstico::&gt; defina o diagnóstico de privilégio</block>
  <block id="ea782640f98557c065767874aded89e7" category="list-text">Para CIFS, o ODX só está disponível quando o cliente e o servidor de armazenamento suportam SMB 3,0 e o recurso ODX.</block>
  <block id="c2dca5b1810c92e856cc04f6f2a88586" category="list-text">Para ambientes SAN, o ODX só está disponível quando o cliente e o servidor de armazenamento suportam o recurso ODX.</block>
  <block id="f41987326c80680c60b359697adfa4cc" category="inline-link">Melhorando o desempenho da cópia remota da Microsoft</block>
  <block id="fcb65106bb1fd73c88cf9528cb579ed5" category="inline-link">Transferências de dados descarregadas da Microsoft</block>
  <block id="65994fb0563b49bfe0e59359edf5513d" category="paragraph">Para obter informações sobre o ODX,<block ref="29f9e15a4017cdf9ae06e098a7a28381" category="inline-link-rx"></block> consulte e<block ref="f884f78ec6d36ebebd3d9fc57e8c3734" category="inline-link-rx"></block> .</block>
  <block id="39d0bfdf27f1fc555ae2f030e21f8818" category="section-title">Cluster Hyper-V: Alta disponibilidade e escalabilidade para máquinas virtuais</block>
  <block id="20029977789a74e480e6f8d14c07b48a" category="paragraph">Os clusters de failover fornecem alta disponibilidade e escalabilidade para servidores Hyper-V. Um cluster de failover é um grupo de servidores Hyper-V independentes que trabalham em conjunto para aumentar a disponibilidade e a escalabilidade das VMs.</block>
  <block id="1b5f8c43b61e9249f3c82e39f9649160" category="section-title">Volumes partilhados de cluster</block>
  <block id="c3e01cf065f02a4feb72ac75d534fa2e" category="paragraph">Os CSVs permitem que vários nós em um cluster de failover tenham simultaneamente acesso de leitura/gravação ao mesmo LUN NetApp que é provisionado como um volume NTFS ou refs. Com os CSVs, as funções em cluster podem fazer failover rapidamente de um nó para outro sem exigir uma alteração na propriedade da unidade ou desmontar e montar novamente um volume. Os CSVs também simplificam o gerenciamento de um número potencialmente grande de LUNs em um cluster de failover. Os CSVs fornecem um sistema de arquivos em cluster de uso geral que está em camadas acima de NTFS ou refs.</block>
  <block id="92f30d2ddb9cc7fbf92029307c6dbe98" category="inline-image-macro">Cluster de failover Hyper-V e NetApp, largura de 624 mm, altura de 271 mm</block>
  <block id="873c6f06eca771e8f918112aaf233170" category="paragraph"><block ref="873c6f06eca771e8f918112aaf233170" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7c1d777ad1068fcefc91b140eba543bf" category="list-text">A NetApp recomenda desativar a comunicação do cluster na rede iSCSI para impedir que a comunicação interna do cluster e o tráfego CSV fluam na mesma rede.</block>
  <block id="b53334a2710cb18a4e717240b312807f" category="list-text">A NetApp recomenda ter caminhos de rede redundantes (vários switches) para fornecer resiliência e QoS.</block>
  <block id="f251ad17cf6806e0e3667148cda40e43" category="list-text">Os discos usados para CSV devem ser particionados com NTFS ou refs. Os discos formatados com FAT ou FAT32 não podem ser usados para um CSV.</block>
  <block id="161432666d89990b3c1112afe633ff8e" category="list-text">Os discos usados para CSVs devem usar a formatação 64K para alocação.</block>
  <block id="390167e852a9bfc97d6ed31462a05b2f" category="paragraph">Para obter informações sobre como implantar um cluster Hyper-V, consulte o Apêndice B: <block ref="8a150f92c22920868769b8738759e23d" category="inline-link-macro-rx"></block>.</block>
  <block id="32730f5882545bbe6a81ac49049968f0" category="section-title">Migração do Hyper-V Live: Migração de VMs</block>
  <block id="d7f2f7b4116921a3d8d4b8e5892420a7" category="paragraph">Às vezes, é necessário, durante a vida útil das VMs, movê-las para um host diferente no cluster do Windows. Isso pode ser necessário se o host estiver ficando sem recursos do sistema ou se o host for necessário para reinicializar por motivos de manutenção. Da mesma forma, pode ser necessário mover uma VM para um compartilhamento de LUN ou SMB diferente. Isso pode ser necessário se o LUN ou compartilhamento atual estiver ficando sem espaço ou produzindo desempenho inferior ao esperado. A migração em tempo real do Hyper-V move VMs em execução de um servidor Hyper-V físico para outro sem efeito na disponibilidade da VM para os usuários. Você pode migrar VMs em tempo real entre servidores Hyper-V que fazem parte de um cluster de failover ou entre servidores Hyper-V independentes que não fazem parte de nenhum cluster.</block>
  <block id="10fd9c0040ca7b99a67758c3cd638746" category="section-title">Migração ao vivo em um ambiente em cluster</block>
  <block id="e8881f62af8c1495a1f4869b97e95505" category="paragraph">As VMs podem ser movidas de forma otimizada entre os nós de um cluster. A migração de VM é instantânea porque todos os nós do cluster compartilham o mesmo storage e têm acesso à VM e ao disco. A figura a seguir mostra a migração ao vivo em um ambiente em cluster.</block>
  <block id="8cda6697809dd81e112a12c43f6f89f4" category="inline-image-macro">Migração ao vivo em um ambiente em cluster, largura de 580 mm, altura de 295 mm</block>
  <block id="d668981cacbbf412643956687c03fc0d" category="paragraph"><block ref="d668981cacbbf412643956687c03fc0d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="50802d3e5a25b93d471686a10da03dd8" category="section-title">Prática recomendada</block>
  <block id="4797d6b2727c9902e114fa95ed076fc2" category="list-text">Tenha uma porta dedicada para o tráfego de migração em tempo real.</block>
  <block id="7c021f26d9ab2ec9934fc24d167ceaa4" category="list-text">Tenha uma rede de migração ao vivo de host dedicada para evitar problemas relacionados à rede durante a migração.</block>
  <block id="a725857d2338d476a409fd1fb67b1f56" category="inline-link-macro">Apêndice C: Implantar a migração do Hyper-V Live em um ambiente em cluster</block>
  <block id="45f7134e494aae2cba3b60b3fe769caa" category="paragraph">Para obter informações sobre como implantar a migração ao vivo em um ambiente em cluster, <block ref="b584c2d96a6b139fbe05976580afae94" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="ed7cd01cb26e2db33a36eaa87ac85ff1" category="section-title">Migração ao vivo fora de um ambiente em cluster</block>
  <block id="07cb5e9c694ee3a8dcc475a38371ad5c" category="paragraph">É possível migrar uma VM em tempo real entre dois servidores Hyper-V independentes e não agrupados. Esse processo pode usar migração ao vivo compartilhada ou compartilhada.</block>
  <block id="72960f8df48c0debc035454921c1b5d3" category="list-text">Na migração ao vivo compartilhada, a VM é armazenada em um compartilhamento SMB. Portanto, quando você migra uma VM ativa, o armazenamento da VM permanece no compartilhamento central de SMB para acesso instantâneo pelo outro nó, como mostrado abaixo.</block>
  <block id="87b94a12a79a6dbc08decd540810bb26" category="inline-image-macro">Migração ao vivo compartilhada em um ambiente não agrupado, largura de 331 m, altura de 271 m.</block>
  <block id="f442dd66197cc65f49ad8ec9c50e8076" category="paragraph"><block ref="f442dd66197cc65f49ad8ec9c50e8076" category="inline-image-macro-rx" type="image"></block></block>
  <block id="207d1150dff7488c7f8bfafe7036a222" category="list-text">Na migração compartilhada nada ao vivo, cada servidor Hyper-V tem seu próprio armazenamento local (pode ser um compartilhamento SMB, um LUN ou DAS), e o armazenamento da VM é local para seu servidor Hyper-V. Quando uma VM é migrada em tempo real, o armazenamento da VM é espelhado para o servidor de destino através da rede cliente e, em seguida, a VM é migrada. A VM armazenada em DAS, um LUN ou um compartilhamento SMB/CIFS pode ser movida para um compartilhamento SMB/CIFS no outro servidor Hyper-V, como mostrado na figura a seguir. Ele também pode ser movido para um LUN, como mostrado na segunda figura.</block>
  <block id="8df9231bc9de1239aa92c6a9d1116db4" category="inline-image-macro">Não compartilhou nada de migração ao vivo em um ambiente não agrupado para compartilhamentos SMB, largura de 624 mm, altura de 384 mm</block>
  <block id="c6acea552c059bcc9ccb207ad6b8cee1" category="paragraph"><block ref="c6acea552c059bcc9ccb207ad6b8cee1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="559b3e5c1d4ea7b8f3eaf8cbc0e4155e" category="inline-image-macro">Não compartilhou nada de migração ao vivo em um ambiente não agrupado para LUNs, largura de 624 mm, altura de 384 mm</block>
  <block id="3d0d53528ff4699abb6fab11a6bf756d" category="paragraph"><block ref="3d0d53528ff4699abb6fab11a6bf756d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b19cfe6ea61be3a5ed442a8a975a6406" category="inline-link-macro">Apêndice D: Implantar a migração do Hyper-V Live fora de um ambiente em cluster</block>
  <block id="b7c375b5c0ef95eecd45b0a4614c2c68" category="paragraph">Para obter informações sobre como implantar a migração ao vivo fora de um ambiente em cluster, <block ref="52490817f607e6265e62f91bb3c3799a" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="061731a1a3266df0eda8efe87e649dbb" category="section-title">Migração ao vivo do Hyper-V Storage</block>
  <block id="ecaa2ddd351a3f5a9704aaea9a13abaf" category="paragraph">Durante a vida útil de uma VM, talvez seja necessário mover o armazenamento da VM (VHD/VHDX) para um compartilhamento de LUN ou SMB diferente. Isso pode ser necessário se o LUN ou compartilhamento atual estiver ficando sem espaço ou produzindo desempenho inferior ao esperado.</block>
  <block id="1f976b42d4bb2c18a943d132252997d6" category="paragraph">O LUN ou o compartilhamento que atualmente hospeda a VM podem ficar sem espaço, ser reutilizados ou fornecer desempenho reduzido. Nessas circunstâncias, a VM pode ser movida sem tempo de inatividade para outro LUN ou compartilhar em um volume, agregado ou cluster diferente. Esse processo será mais rápido se o sistema de storage tiver funcionalidades de descarga de cópia. Os sistemas de storage NetApp são habilitados por padrão para descarga de cópia em ambientes CIFS e SAN.</block>
  <block id="bbaae8d50419225b92db654852107b29" category="paragraph">O recurso ODX executa cópias de arquivo completo ou subarquivo entre dois diretórios residentes em servidores remotos. Uma cópia é criada copiando dados entre os servidores (ou o mesmo servidor se ambos os arquivos de origem e de destino estiverem no mesmo servidor). A cópia é criada sem que o cliente leia os dados da origem ou escreva para o destino. Esse processo reduz o uso de processador e memória para o cliente ou servidor e minimiza a largura de banda de e/S de rede. A cópia é mais rápida se estiver dentro do mesmo volume. Se a cópia estiver em volumes, talvez não haja ganhos significativos de desempenho em comparação com as cópias baseadas em host. Antes de prosseguir com uma operação de cópia no host, confirme se as configurações de descarga de cópia estão configuradas no sistema de storage.</block>
  <block id="843c69ad55fb8bac002321dee51a4770" category="paragraph">Quando a migração ativa do armazenamento de VM é iniciada a partir de um host, a origem e o destino são identificados e a atividade de cópia é descarregada para o sistema de storage. Como a atividade é realizada pelo sistema de armazenamento, há um uso insignificante da CPU, memória ou rede do host.</block>
  <block id="27d2fda0da241bb37583fba1af25cd09" category="paragraph">Os controladores de armazenamento NetApp suportam os seguintes cenários diferentes de ODX:</block>
  <block id="48a53ae81ff0c821cba0e11bd2383bf3" category="list-text">*IntraSVM.* Os dados pertencem ao mesmo SVM:</block>
  <block id="ec3d44fd176b5d51f4f60dff319cea6b" category="list-text">*Intradvolume, intranode.* Os arquivos de origem e destino ou LUNs residem no mesmo volume. A cópia é realizada com a tecnologia de arquivos FlexClone, que fornece benefícios adicionais de desempenho de cópia remota.</block>
  <block id="980ca02c9855a39b86e9fbf5acd955b4" category="list-text">*Intervolume, intranode.* Os arquivos de origem e destino ou LUNs estão em volumes diferentes que estão no mesmo nó.</block>
  <block id="8a4d33d47a803a1796b431a0df5a8016" category="list-text">*Intervolume, internós.* Os arquivos de origem e destino ou LUNs estão em volumes diferentes localizados em nós diferentes.</block>
  <block id="81d5c73c98489729a8f91afe4936dbd2" category="list-text">*InterSVM.* Os dados pertencem a diferentes SVMs.</block>
  <block id="ea9799ac312b9050a36864c98be8f73f" category="list-text">*Intervolume, internós.* Os arquivos de origem e destino ou LUNs estão em volumes diferentes que estão em nós diferentes.</block>
  <block id="3693f5a47e6bfc0762c5b2c174e653be" category="list-text">*Intercluster.* A partir do ONTAP 9.0, o ODX também é compatível com transferências LUN entre clusters em ambientes SAN. O ODX é suportado apenas para protocolos SAN, não para SMB.</block>
  <block id="8e459b300b9b5f521f0cc464bc1a7137" category="paragraph">Após a conclusão da migração, as políticas de backup e replicação devem ser reconfiguradas para refletir o novo volume que contém as VMs. Quaisquer backups anteriores que foram feitos não podem ser usados.</block>
  <block id="9cabe6ff649f754acc3a863e852828e8" category="paragraph">O armazenamento de VM (VHD/VHDX) pode ser migrado entre os seguintes tipos de armazenamento:</block>
  <block id="49a63af944b72883bd718eb8c8ff01c8" category="list-text">DAS e o compartilhamento SMB</block>
  <block id="85fbd1c03217c7c62157aac97d16ecf9" category="list-text">DAS e LUN</block>
  <block id="876c6424f49d57e8be596b8caadf5a61" category="list-text">Um compartilhamento SMB e um LUN</block>
  <block id="1518cb86dc78f6083ed8b1d292b87ed8" category="list-text">Entre LUNs</block>
  <block id="7257cd316393b74da62868c27652c6c0" category="list-text">Entre compartilhamentos SMB</block>
  <block id="17785c3ef4bbda06e9db9c15908dc0c6" category="inline-image-macro">Migração ativa de armazenamento Hyper-V, largura de 339 mm, altura de 352 mm</block>
  <block id="eccf932baf8f6019c69035ea09e26c2c" category="paragraph"><block ref="eccf932baf8f6019c69035ea09e26c2c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="319572d5872182625e2834b8615517f2" category="inline-link-macro">Apêndice e: Implantar a migração ao vivo do Hyper-V Storage</block>
  <block id="04a136595cb35e5c42e3ea764e9cd259" category="paragraph">Para obter informações sobre como implantar a migração ao vivo de storage, <block ref="e0d213bcf75379722df0c1b3af5063a2" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="023196611fee49915adf49422b3289e6" category="section-title">Réplica do Hyper-V: Recuperação de desastres para máquinas virtuais</block>
  <block id="86174aa4d77b1853f72b6e1a6f32c753" category="paragraph">A réplica do Hyper-V replica as VMs do Hyper-V de um local primário para VMs de réplica em um local secundário, fornecendo, de forma assíncrona, recuperação de desastres para as VMs. O servidor Hyper-V no site principal que hospeda as VMs é conhecido como servidor primário; o servidor Hyper-V no site secundário que recebe VMs replicadas é conhecido como servidor de réplica. Um cenário de exemplo de réplica do Hyper-V é mostrado na figura a seguir. Você pode usar a réplica do Hyper-V para VMs entre servidores Hyper-V que fazem parte de um cluster de failover ou entre servidores Hyper-V independentes que não fazem parte de nenhum cluster.</block>
  <block id="28e90920ae557bd81a8056f93fb4b0ee" category="inline-image-macro">Hyper-V réplica, largura de 624 mm, altura de 201 mm</block>
  <block id="4fc821418df9e4488323cc70692d5083" category="paragraph"><block ref="4fc821418df9e4488323cc70692d5083" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b9bce4677e5b3ea1c310fddca6123c9f" category="paragraph">Depois que a réplica do Hyper-V estiver habilitada para uma VM no servidor primário, a replicação inicial cria uma VM idêntica no servidor de réplica. Após a replicação inicial, a réplica do Hyper-V mantém um arquivo de log para os VHDs da VM. O ficheiro de registo é reproduzido na ordem inversa à réplica VHD de acordo com a frequência de replicação. Esse log e o uso da ordem inversa garantem que as alterações mais recentes sejam armazenadas e replicadas assincronamente. Se a replicação não ocorrer de acordo com a frequência esperada, é emitido um alerta.</block>
  <block id="e78f6d0414a6dde66f4e12a3e218620b" category="section-title">Replicação estendida</block>
  <block id="ec9fc8b78968b1d0daadf7598a4e2ab6" category="paragraph">A réplica do Hyper-V suporta replicação estendida na qual um servidor de réplica secundário pode ser configurado para recuperação de desastres. Um servidor de réplica secundário pode ser configurado para que o servidor de réplica receba as alterações nas VMs de réplica. Em um cenário de replicação estendida, as alterações nas VMs primárias no servidor primário são replicadas para o servidor de réplica. Em seguida, as alterações são replicadas para o servidor de réplica estendido. As VMs podem ser falhadas para o servidor de réplica estendido somente quando os servidores principal e de réplica estiverem inativos.</block>
  <block id="a3f36244dba1d116dac91134dda3b9db" category="paragraph">O failover não é automático; o processo deve ser acionado manualmente. Existem três tipos de failover:</block>
  <block id="f8487dcb10cf762a4d3f28da4635bd2a" category="list-text">*Failover de teste.* Esse tipo é usado para verificar se uma VM de réplica pode ser iniciada com sucesso no servidor de réplica e é iniciada na VM de réplica. Esse processo cria uma VM de teste duplicada durante o failover e não afeta a replicação regular da produção.</block>
  <block id="09f4056fddf2108616fe7bf3194540ba" category="list-text">*Failover planejado.* Esse tipo é usado para fazer failover de VMs durante a inatividade planejada ou as interrupções esperadas. Esse processo é iniciado na VM principal, que deve ser desligado no servidor principal antes de um failover planejado ser executado. Após o failover da máquina, a réplica Hyper-V inicia a réplica VM no servidor de réplica.</block>
  <block id="0ad8df7e141c378e7ad1debc5721cecf" category="list-text">*Failover não planejado.* Este tipo é utilizado quando ocorrem interrupções inesperadas. Esse processo é iniciado na VM de réplica e deve ser usado somente se a máquina principal falhar.</block>
  <block id="d8afbc541b39d23648c823057cffe3a5" category="section-title">Recuperação</block>
  <block id="53b169078c7c6ecee01802b49b675c54" category="paragraph">Ao configurar a replicação para uma VM, você pode especificar o número de pontos de recuperação. Os pontos de recuperação representam pontos no tempo a partir dos quais os dados podem ser recuperados de uma máquina replicada.</block>
  <block id="31e96602ee944674a6ee07052bc6552a" category="inline-link-macro">Implantar a réplica do Hyper-V fora de um ambiente em cluster</block>
  <block id="fd09d6344b235cdd2863e5027a2716e8" category="list-text">Para obter informações sobre como implantar a réplica do Hyper-V fora de um ambiente em cluster, consulte a seção "<block ref="376f647d5b86bfed7dfffbd7c50e7d1e" category="inline-link-macro-rx"></block>."</block>
  <block id="23b6fa788d78e992f84931ddd3cef629" category="inline-link-macro">Implantar a réplica do Hyper-V em um ambiente em cluster</block>
  <block id="a3538f75015c27ee42ac1f1c0b535a61" category="list-text">Para obter informações sobre como implantar a réplica do Hyper-V em um ambiente em cluster, consulte a seção "<block ref="e81baea973ee37d0bb61473f872cfb84" category="inline-link-macro-rx"></block>."</block>
  <block id="8ab11353f8fda3f130084c6ff3c1f32e" category="summary">Visão geral da virtualização do Microsoft Windows e do Hyper-V com o ONTAP</block>
  <block id="e905fd86484ea1bf5b665b34fc9e24b4" category="paragraph">O Microsoft Windows Server é um sistema operacional (SO) de classe empresarial que abrange rede, segurança, virtualização, nuvem privada, nuvem híbrida, infraestrutura de desktop virtual, proteção de acesso, proteção de informações, serviços da Web, infraestrutura de plataforma de aplicativos e muito mais.</block>
  <block id="16b5970810caafa8d6f89bee6e0398f2" category="admonition">*Esta documentação substitui relatórios técnicos publicados anteriormente _TR-4568: Diretrizes de implantação do NetApp e práticas recomendadas de armazenamento para o Windows Server_*</block>
  <block id="5a002cf26db634ca1b1fff75461d2427" category="list-title">O ONTAP é executado em controladores de storage NetApp. Está disponível em vários formatos.</block>
  <block id="dbf037f8e99a1d5b52fe58af78568561" category="list-text">Uma arquitetura unificada que dá suporte a protocolos de arquivos, objetos e blocos. Isso permite que os controladores de storage atuem como dispositivos nas e SAN, bem como armazenamentos de objetos</block>
  <block id="23748de0bc860150d3c6b27a4d472042" category="list-text">Um All SAN Array (ASA) que se concentra apenas em protocolos de bloco e otimiza o tempo de retorno de I/o (IORT), adicionando multipathing ativo-ativo simétrico para hosts conectados</block>
  <block id="d0114359083804284c542907b2f8cd60" category="list-text">Uma arquitetura unificada definida por software</block>
  <block id="30063e1e8c837a5b52057909e747b2d8" category="list-text">ONTAP Select em execução no VMware vSphere ou KVM</block>
  <block id="0f76eddbf2cd8ceb8e89447591876ab9" category="list-text">Cloud Volumes ONTAP executado como uma instância nativa da nuvem</block>
  <block id="f7d26dbdc8e2b21b211abf2157e73536" category="list-text">Primeiras ofertas de fornecedores de nuvem em hiperescala</block>
  <block id="4d82a1ec1af02725042c8c785564ee7a" category="list-text">Amazon FSX para NetApp ONTAP</block>
  <block id="7450cfde7058dc5e1f7909d0280fd7ae" category="list-text">Azure NetApp Files</block>
  <block id="1215f8190533dfdf63d2224a6d88266f" category="list-text">Google Cloud NetApp volumes</block>
  <block id="538a662f2ecbeba6af56e41386484f67" category="paragraph">Juntos, o Windows Server e o ONTAP podem operar em ambientes grandes e agregar imenso valor à consolidação do data center e às implantações de nuvem privada ou híbrida. Essa combinação também fornece workloads sem interrupções com eficiência e dá suporte à escalabilidade otimizada.</block>
  <block id="f2b84afd0523a6df7547c404aa3647d8" category="section-title">Público-alvo</block>
  <block id="8f0442ea7c58fe8ab4000f5aaeac415b" category="paragraph">Este documento destina-se a arquitetos de sistemas e armazenamento que projetam soluções de armazenamento NetApp para o Windows Server.</block>
  <block id="f6f27d1607ed17a4b610676f16f68357" category="paragraph">Fazemos as seguintes suposições neste documento:</block>
  <block id="e9d690b9eb25093e460ea369baa55496" category="inline-link">Guia de administração do sistema para administradores de cluster</block>
  <block id="d54e01b4234443b582b1d0cc44ce1c19" category="list-text">O leitor tem conhecimento geral das soluções de hardware e software da NetApp. Consulte<block ref="87244016000a25428f0fcae2d3732d46" category="inline-link-rx"></block> para obter detalhes.</block>
  <block id="c501659fe58b766ec2ead9a0c974e530" category="inline-link">Gerenciamento de SAN Clustered Data ONTAP</block>
  <block id="75ac79ee68c2245f6d8b8cc32a3eae9e" category="inline-link">Gerenciamento nas</block>
  <block id="48fa880bcded409e494bd8e2e8c64a97" category="list-text">O leitor tem conhecimento geral de protocolos de acesso a bloco, como iSCSI, FC e o protocolo de acesso a arquivos SMB/CIFS. Consulte<block ref="123a6e61ead9566ba44616c8f29f1ba3" category="inline-link-rx"></block> para obter informações relacionadas com SAN. Consulte a<block ref="9933d9f07fd1633df051103d1b03340e" category="inline-link-rx"></block> para obter informações relacionadas com CIFS/SMB.</block>
  <block id="02279515531a2de57bfdffa958d40813" category="list-text">O leitor tem conhecimento geral do sistema operacional Windows Server e Hyper-V.</block>
  <block id="c9dd6bad4c7d561872f2e2d498a990bf" category="inline-link">Ferramenta de Matriz de interoperabilidade (IMT)</block>
  <block id="f8b7d7bb25e13b6b771e58da1fa078cb" category="summary">Provisione storage ONTAP para Windows e Hyper-V em ambientes SAN</block>
  <block id="1ed211700a6cc31a2b45adb662dcbb8a" category="doc">Provisionamento em ambientes SAN</block>
  <block id="24294828f9d26e2b73b5b1e0eda7a2d0" category="paragraph">As SVMs ONTAP são compatíveis com os protocolos de bloco iSCSI e FC. Quando um SVM é criado com protocolo de bloco iSCSI ou FC, o SVM obtém um nome qualificado iSCSI (IQN) ou um nome mundial FC (WWN), respetivamente. Esse identificador apresenta um destino SCSI para hosts que acessam o storage de bloco do NetApp.</block>
  <block id="7f33f1b99e752967fce41fe3dec9f051" category="section-title">Provisionamento de LUN NetApp no Windows Server</block>
  <block id="025d3d39bb1937ffe40a12b1917e28b6" category="paragraph">O uso do armazenamento NetApp em ambientes SAN no Windows Server tem os seguintes requisitos:</block>
  <block id="3e306b32d1acc6cfcca681b93d8d57cd" category="list-text">Um cluster NetApp é configurado com uma ou mais controladores de storage NetApp.</block>
  <block id="3e0ea625c6f590606b5242be6455347c" category="list-text">O cluster NetApp ou os controladores de armazenamento têm uma licença iSCSI válida.</block>
  <block id="5bf7c7c03ed76506f8822badb526f0a8" category="list-text">Estão disponíveis portas configuradas iSCSI e/ou FC.</block>
  <block id="46434438c1896350bc085c1a67785198" category="list-text">O zoneamento FC é realizado em um switch FC para FC.</block>
  <block id="2744237d602ca5ed3f1a6370ed8ebe91" category="list-text">Pelo menos um agregado é criado.</block>
  <block id="1e704db41d570618bd723b41d0db395e" category="list-text">Um SVM deve ter um LIF por rede Ethernet ou malha Fibre Channel em todas as controladoras de storage que fornecerão dados usando iSCSI ou Fibre Channel.</block>
  <block id="daa700de515c2e157d34b0e12c154478" category="list-text">Criar um novo SVM com protocolo de bloco iSCSI e/ou FC habilitado. É possível criar um novo SVM com qualquer um dos seguintes métodos:</block>
  <block id="ec642b047305fbfe6db973f313768eae" category="list-text">Comandos CLI no storage NetApp</block>
  <block id="6ad5e0a20f49ad6a370454bb3afc9a9e" category="list-text">Gerente do sistema da ONTAP</block>
  <block id="43736124eda42b8dec979b188b9d891b" category="list-text">Configurar o protocolo iSCSI e/ou FC.</block>
  <block id="bf8cf0b24d936c2fe2e3681004650bf0" category="list-text">Atribua o SVM com LIFs em cada nó de cluster.</block>
  <block id="51dbb9050f89d2c5cbfda6a46bb48963" category="list-text">Inicie o serviço iSCSI e/ou FC no SVM.</block>
  <block id="5058f1af8388633f609cadb75a75dc9d" category="paragraph">.</block>
  <block id="80967cdacf7a48c49276c07097765c46" category="list-text">Crie conjuntos de portas iSCSI e/ou FC usando os LIFs SVM.</block>
  <block id="2d59cbd9d3169fc27e47164a0bf60c42" category="list-text">Crie um grupo de iniciadores iSCSI e/ou FC para Windows usando o conjunto de portas criado.</block>
  <block id="b6efc79e22c0381d9fcc8c3f40ff674f" category="list-text">Adicione um iniciador ao grupo de iniciadores. O iniciador é o IQN para iSCSI e WWPN para FC. Eles podem ser consultados no Windows Server executando o cmdlet Get-InitiatorPort do PowerShell.</block>
  <block id="ab39c1b30c8045ee5b2419b682b64e5c" category="paragraph">O IQN para iSCSI no Windows Server também pode ser verificado na configuração das propriedades do iniciador iSCSI.</block>
  <block id="83f0120a854049de17bd46bb97e5c5fa" category="list-text">Crie um LUN usando o assistente criar LUN e associe-o ao grupo de iniciadores criado.</block>
  <block id="674b9c5bbf2379d6c48343d029972e53" category="section-title">Integração de host</block>
  <block id="186c31b1cbf72f8c54f9c6a0edca1cfe" category="paragraph">O Windows Server usa a extensão MPIO (ALUA) de acesso lógico assimétrico para determinar caminhos diretos e indiretos para LUNs. Mesmo que cada LIF de uma SVM aceite solicitações de leitura/gravação de LUNs, apenas um dos nós do cluster realmente é proprietário dos discos que suportam esse LUN em um dado momento. Isso divide os caminhos disponíveis para um LUN em dois tipos, diretos ou indiretos, como mostrado na figura a seguir.</block>
  <block id="6b08a0deb0bef5f6429e5fb7bab4da29" category="inline-image-macro">Vários caminhos no ambiente SAN, largura de 624 m, altura de 232 m.</block>
  <block id="e5106eaf1ca3b8ff0d6a4555b38845de" category="paragraph"><block ref="e5106eaf1ca3b8ff0d6a4555b38845de" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7e6c7f4878b6fa562299bd45be030c4d" category="section-title">MPIO</block>
  <block id="6011d6a859985e0b6d7c13b0907896ca" category="paragraph">O ONTAP fornece armazenamento altamente disponível no qual podem existir vários caminhos do controlador de armazenamento para o servidor Windows. Multipathing é a capacidade de ter vários caminhos de dados de um servidor para um storage array. O multipathing protege contra falhas de hardware (cortes de cabos, falha do adaptador de barramento de host e switch [HBA], etc.), e pode fornecer limites de desempenho mais altos usando o desempenho agregado de várias conexões. Quando um caminho ou conexão se torna indisponível, o software multipathing muda automaticamente a carga para um dos outros caminhos disponíveis. O recurso MPIO combina os vários caminhos físicos para o storage como um único caminho lógico usado para acesso aos dados para fornecer resiliência de storage e balanceamento de carga. Para usar esse recurso, o recurso MPIO deve estar habilitado no Windows Server.</block>
  <block id="90881f9a41c6c14a994dd6d410b5eae3" category="section-title">Ativar MPIO</block>
  <block id="1f4614ecf24e855792cb4a72e2ca4a86" category="paragraph">Para ativar o MPIO no Windows Server, execute as seguintes etapas:</block>
  <block id="d580309cd21fec5dd6a0fc9e095dacbe" category="list-text">Na seção Gerenciar, clique em Adicionar funções e recursos.</block>
  <block id="19c0c759d805032bc93817553dbc8ef9" category="list-text">Na página Selecionar recursos, selecione Multipath I/O.</block>
  <block id="63c2082592ff76eac0541130a24e7670" category="section-title">Configure o MPIO</block>
  <block id="655995aa16b525227f20b4e6b55a22cf" category="paragraph">Ao usar o protocolo iSCSI, você deve informar ao Windows Server para aplicar suporte de multipath a dispositivos iSCSI nas propriedades MPIO.</block>
  <block id="3cdb8cf9c5fe85e070ceba959169e83f" category="paragraph">Para configurar o MPIO no Windows Server, execute as seguintes etapas:</block>
  <block id="bd27f39c0a288d0682b789a806d1eec7" category="list-text">Inicie sessão no Windows Server como membro do grupo de administradores.</block>
  <block id="a267872bfc142a132ea159cb0904930f" category="list-text">Na seção Ferramentas, clique em MPIO.</block>
  <block id="46205f4b1d4b254565cae2fd6970a3a6" category="list-text">Em Propriedades de MPIO em Discover Multi-Paths, selecione Adicionar suporte para dispositivos iSCSI e clique em Adicionar. Em seguida, um prompt solicita que você reinicie o computador.</block>
  <block id="8c372bcf6ff4084f9e072d698d449b18" category="list-text">Reinicie o Windows Server para ver o dispositivo MPIO listado na seção dispositivos MPIO das Propriedades MPIO.</block>
  <block id="28f21ae88e9953ac3d80686cfb49832b" category="section-title">Configurar iSCSI</block>
  <block id="a12e2e6108a8b8cb032c190ebe798d79" category="paragraph">Para detetar armazenamento de bloco iSCSI no Windows Server, execute as seguintes etapas:</block>
  <block id="623f636e32ba5729ab907ad3eeeb5adb" category="list-text">Na seção Ferramentas, clique em Iniciador iSCSI.</block>
  <block id="d259349ad54c81b69ffb57d045a7c135" category="list-text">Na guia descoberta, clique em descobrir Portal.</block>
  <block id="9055f8c4230cf1268018d9b81d1c30e0" category="list-text">Forneça o endereço IP das LIFs associadas ao SVM criado para o protocolo NetApp storage para SAN. Clique em Avançado, configure as informações na guia Geral e clique em OK.</block>
  <block id="56fe767f1eb1a3401bb37455b6e1c804" category="list-text">O iniciador iSCSI deteta automaticamente o destino iSCSI e o lista no separador alvos.</block>
  <block id="f6357f1aad932cb8ef210a786e72e1e9" category="list-text">Selecione o destino iSCSI em destinos descobertos. Clique em Connect (ligar) para abrir a janela Connect to Target (ligar ao destino).</block>
  <block id="28d26404caba20cb28577f61c51a7e1f" category="list-text">Você deve criar várias sessões do host do Windows Server para os LIFs iSCSI de destino no cluster de armazenamento do NetApp. Para fazer isso, execute as seguintes etapas:</block>
  <block id="3aef6deb3c61c368bc66313781c8e351" category="list-text">Na janela conetar ao destino, selecione Ativar MPIO e clique em Avançado.</block>
  <block id="d754cac9ca73d1113c5fa5908ca2dc97" category="list-text">Em Configurações avançadas na guia Geral, selecione o adaptador local como o iniciador iSCSI da Microsoft e selecione o IP do Iniciador e o IP do Portal de destino.</block>
  <block id="fdcb9587e9c4d393ea337f94fb0e1f5f" category="list-text">Você também deve se conetar usando o segundo caminho. Portanto, repita os passos 5 a 8, mas desta vez selecione o IP do Iniciador e o IP do Portal de destino para o segundo caminho.</block>
  <block id="cb35c153406b8cdeb5963bd9a0ceb501" category="list-text">Selecione o destino iSCSI em destinos descobertos na janela principal Propriedades iSCSI e clique em Propriedades.</block>
  <block id="2a3977b58760a2b4c9e557175a5e494e" category="list-text">A janela Propriedades mostra que várias sessões foram detetadas. Selecione a sessão, clique em dispositivos e, em seguida, clique no MPIO para configurar a política de balanceamento de carga. Todos os caminhos configurados para o dispositivo são exibidos e todas as políticas de balanceamento de carga são suportadas. O NetApp geralmente recomenda round robin com subconjunto, e essa configuração é o padrão para arrays com ALUA habilitado. Round robin é o padrão para arrays ativo-ativo que não suportam ALUA.</block>
  <block id="e43f3be13a49d6eeab4304d80790eaa0" category="section-title">Detectar storage de bloco</block>
  <block id="7b7b8262c038321869fc17ba522bbe07" category="paragraph">Para detetar armazenamento de blocos iSCSI ou FC no Windows Server, execute as seguintes etapas:</block>
  <block id="7554b29976a023cca6089775e3a7fd73" category="list-text">Clique em Gerenciamento de computador na seção Ferramentas do Gerenciador de servidores.</block>
  <block id="b7e726cedaa814db32dbfe4395773cc4" category="list-text">Em Gerenciamento de computador, clique na seção Gerenciamento de disco no armazenamento e clique em mais ações e Rescan Disks. Ao fazê-lo, apresenta os iSCSI LUNs brutos.</block>
  <block id="8fd13d2e47a19c784864b40dc7e4621f" category="list-text">Clique no LUN descoberto e faça-o online. Em seguida, selecione Inicializar disco usando a partição MBR ou GPT. Crie um novo volume simples fornecendo o tamanho do volume e a letra da unidade e formate-o usando FAT, FAT32, NTFS ou o Resilient File System (refs).</block>
  <block id="31ef353687ab7c0fb280206b2eba67d0" category="list-text">A NetApp recomenda a ativação do thin Provisioning nos volumes que hospedam os LUNs.</block>
  <block id="de065768c0f0b724b1926b25d92fdcef" category="list-text">Para evitar problemas de multipathing, o NetApp recomenda usar todas as sessões 10Gb ou todas as sessões 1GB para um determinado LUN.</block>
  <block id="ed4eb5407c23e138e99781446b4170d8" category="list-text">A NetApp recomenda que você confirme se o ALUA está ativado no sistema de storage. O ALUA é ativado por padrão no ONTAP.</block>
  <block id="df0f70c4f2bca2f5f0216ab40982d08a" category="list-text">No host do servidor Windows para onde o LUN NetApp é mapeado, ative o Serviço iSCSI (TCP-in) para Serviço de entrada e iSCSI (TCP-out) para saída nas configurações do firewall. Essas configurações permitem que o tráfego iSCSI passe de e para o host Hyper-V e o controlador NetApp.</block>
  <block id="defe090ca065bb89790c1a0b2d533ad0" category="section-title">Provisionamento de LUNs NetApp em Nano Server</block>
  <block id="a7b1fc24d300b03d303a4e66fd5eaf19" category="inline-link-macro">Implante o Nano Server.</block>
  <block id="c56e09ae358fe6206c8e4059eb76252b" category="paragraph">Além dos pré-requisitos mencionados na seção anterior, a função de armazenamento deve ser ativada a partir do lado do Nano Server. Por exemplo, o Nano Server deve ser implantado usando a opção -Storage. Para implantar o Nano Server, consulte a seção<block ref="00a4a5119b1e43564baa188fc895d5ff" category="inline-link-macro-rx"></block> " "</block>
  <block id="152dbede177bc5347922fdc2b306adf2" category="paragraph">Para provisionar LUNs NetApp em um servidor Nano, execute as seguintes etapas:</block>
  <block id="fe02f402a046a8784957e096b11835e3" category="list-text">Conete-se remotamente ao Nano Server usando as instruções na seção "<block ref="60e7ef5a283935545371795472ceb490" category="inline-link-macro-rx"></block>."</block>
  <block id="1b3c1a51c3603283ec4f7ab199a89ad3" category="list-text">Para configurar iSCSI, execute os seguintes cmdlets do PowerShell no Nano Server:</block>
  <block id="5e885af04f617a09b29600bd064e0a82" category="list-text">Adicione um iniciador ao grupo de iniciadores.</block>
  <block id="8a73c7acbdf9fc31a87cebe8de47a176" category="list-text">Configure o MPIO.</block>
  <block id="8e08d5639ddc5bf9f71aeea2f9df6706" category="list-text">Detectar storage de bloco.</block>
  <block id="ad04ba98fa2a26c6e2a4f71314b1c4c7" category="section-title">Arranque a partir de SAN</block>
  <block id="e29512aa6180bca309f145289f08337c" category="paragraph">Um host físico (servidor) ou uma VM Hyper-V podem inicializar o sistema operacional do Windows diretamente de um LUN NetApp em vez de seu disco rígido interno. Na abordagem boot-from-SAN, a imagem do sistema operacional a ser inicializada reside em um LUN NetApp que é anexado a um host físico ou VM. Para um host físico, o HBA do host físico é configurado para usar o LUN NetApp para inicialização. Para uma VM, o LUN NetApp é conetado como um disco de passagem para inicialização.</block>
  <block id="adc95a9707f2f351740aa0d52f08981e" category="section-title">Abordagem da NetApp FlexClone</block>
  <block id="2cf07cb81d5366158ac32b0d02e3bf39" category="paragraph">Usando a tecnologia NetApp FlexClone, os LUNs de inicialização com uma imagem do sistema operacional podem ser clonados instantaneamente e conetados aos servidores e VMs para fornecer rapidamente imagens limpas do sistema operacional, como mostra a figura a seguir.</block>
  <block id="e60c0a021a1a11ca0fd66050c818b441" category="inline-image-macro">Boot LUNs usando NetApp FlexClone, largura de 561 mm, altura de 357 mm</block>
  <block id="79f4f54e05eb2f1c2084e0542e66f182" category="paragraph"><block ref="79f4f54e05eb2f1c2084e0542e66f182" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0bee1618a00f62535bd1e3f03af6a8f0" category="section-title">Arranque a partir de SAN para anfitrião físico</block>
  <block id="738e6a96e2bf795b59ac62d4827a779e" category="list-text">O host físico (servidor) tem um iSCSI ou FC HBA adequado.</block>
  <block id="7957c1b3b06b3ca5c17a05da5e59c9ec" category="list-text">Você baixou um driver de dispositivo HBA adequado para o servidor que suporta o Windows Server.</block>
  <block id="1810f78aa22a9972644e65ac2cdad107" category="list-text">O servidor tem uma unidade de CD/DVD adequada ou um suporte virtual para inserir a imagem ISO do Windows Server e o controlador do dispositivo HBA foi transferido.</block>
  <block id="0af744e0f07c6b198e478b2ba83aca3a" category="list-text">Um iSCSI NetApp ou LUN FC é provisionado no controlador de storage NetApp.</block>
  <block id="30e2bee2ccadbae82d2d5aeddd5b4078" category="paragraph">Para configurar a inicialização a partir de SAN para um host físico, execute as seguintes etapas:</block>
  <block id="7d90eb9f56cbfbfe2930a2d651f51f3a" category="list-text">Ative o BootBIOS no servidor HBA.</block>
  <block id="034cb1858f7a3762e67e18bff38aa62a" category="list-text">Para HBAs iSCSI, configure o IP do iniciador, o nome do nó iSCSI e o modo de inicialização do adaptador nas configurações do BIOS de inicialização.</block>
  <block id="aeae1f3a4453e2d3e333de58d3f28c4a" category="list-text">Ao criar um grupo de iniciadores para iSCSI e/ou FC em um controlador de storage NetApp, adicione o iniciador HBA do servidor ao grupo. O iniciador HBA do servidor é o WWPN para o nome do nó FC HBA ou iSCSI para iSCSI HBA.</block>
  <block id="1ec419dd357b1eacb28eec8cfd657908" category="list-text">Crie um LUN no controlador de armazenamento NetApp com um ID LUN de 0 e associe-o ao grupo de iniciadores criado na etapa anterior. Este LUN serve como um LUN de arranque.</block>
  <block id="52ec2612ed3c17b60d5c662122410366" category="list-text">Restrinja o HBA a um único caminho para o LUN de inicialização. Caminhos adicionais podem ser adicionados depois que o Windows Server é instalado no LUN de inicialização para explorar o recurso multipathing.</block>
  <block id="0fa69ac9076a9031393e6f5d4aa909d5" category="list-text">Use o utilitário BootBIOS do HBA para configurar o LUN como um dispositivo de inicialização.</block>
  <block id="58347d33bbc0409dce93e92c5983619a" category="list-text">Reinicie o host e insira o utilitário BIOS do host.</block>
  <block id="1b9013d7a416c62e05336b3791451d0d" category="list-text">Configure o BIOS do host para tornar o LUN de inicialização o primeiro dispositivo na ordem de inicialização.</block>
  <block id="3472e7b0e2c4389366cf3e0f09f6376d" category="list-text">A partir do ISO do Windows Server, inicie a instalação.</block>
  <block id="8423662d97649ae1012d665b6594f514" category="list-text">Quando a instalação perguntar "onde você deseja instalar o Windows?", clique em carregar driver na parte inferior da tela de instalação para iniciar a página Selecionar driver para instalar. Forneça o caminho do driver do dispositivo HBA baixado anteriormente e conclua a instalação do driver.</block>
  <block id="4d0de28cb0fe5a517374a0c7fdaaff27" category="list-text">Agora, o LUN de inicialização criado anteriormente deve estar visível na página de instalação do Windows. Selecione o LUN de inicialização para instalação do Windows Server no LUN de inicialização e conclua a instalação.</block>
  <block id="68468d5f213be162fe50260787894f8f" category="section-title">Arranque a partir de SAN para máquina virtual</block>
  <block id="0dbc8e7afe6136a3b34471c047b28f83" category="paragraph">Para configurar a inicialização a partir de SAN para uma VM, execute as seguintes etapas:</block>
  <block id="6af97eac32eef9a62687eac41262ae48" category="list-text">Ao criar um grupo de iniciadores para iSCSI ou FC em um controlador de armazenamento NetApp, adicione o IQN para iSCSI ou WWN para FC do servidor Hyper-V ao controlador.</block>
  <block id="c18de5a7c8558c6b9b749ea9d61336da" category="list-text">Crie LUNs ou clones LUN no controlador de storage NetApp e associe-os ao grupo de iniciadores criado na etapa anterior. Essas LUNs servem como LUNs de inicialização das VMs.</block>
  <block id="dac33c93e3d9b5c90a34c39aa579711a" category="list-text">Detecte os LUNs no servidor Hyper-V, coloque-os online e inicialize-os.</block>
  <block id="441d10873880501fa764914d0bf1f044" category="list-text">Coloque os LUNs offline.</block>
  <block id="0490d2908eb59e831010f6c50ebdf6ea" category="list-text">Crie VMs com a opção Anexar um disco rígido virtual mais tarde na página conetar disco rígido virtual.</block>
  <block id="2b2b3b281225dec976273bad7f4dacf0" category="list-text">Adicione um LUN como um disco de passagem a uma VM.</block>
  <block id="ab82d3a85d9187f45c1cac0bd2922647" category="list-text">Abra as definições da VM.</block>
  <block id="d2e03542bea91031de7772d6cb0b7b13" category="list-text">Clique em IDE Controller 0, selecione Hard Drive e clique em Add. Selecionar o controlador IDE 0 torna este disco o primeiro dispositivo de inicialização para a VM.</block>
  <block id="1904d13d92aac636b46007dec34eb357" category="list-text">Selecione disco rígido físico nas opções disco rígido e selecione um disco da lista como um disco de passagem. Os discos são os LUNs configurados nas etapas anteriores.</block>
  <block id="19e47f17e14687afa5f6c07833dbd7aa" category="list-text">Instale o Windows Server no disco de passagem.</block>
  <block id="30f837081d56a5f1605e52592a38d5f4" category="list-text">Certifique-se de que os LUNs estão offline. Caso contrário, o disco não pode ser adicionado como um disco de passagem a uma VM.</block>
  <block id="9865f9e3af02eaca8b480229a22515f4" category="list-text">Quando existirem vários LUNs, certifique-se de anotar o número de disco do LUN no gerenciamento de disco. Isso é necessário porque os discos listados para a VM são listados com o número do disco. Além disso, a seleção do disco como um disco de passagem para a VM é baseada neste número de disco.</block>
  <block id="15b11e66e58b25dffc74ff36f6529d4d" category="list-text">A NetApp recomenda o uso do ONTAP MPIO configurado no host para fins de armazenamento.</block>
  <block id="2810ba8ba9d5e4319af85df66ddf2286" category="summary">Segurança de armazenamento ONTAP com Hyper-V.</block>
  <block id="2fae32629d4ef4fc6341f1751b405e45" category="doc">Segurança</block>
  <block id="6ca21561032e8c064bc8514ab2e92740" category="paragraph">O ONTAP fornece um sistema de armazenamento seguro para o sistema operacional Windows.</block>
  <block id="615e826f5576798f024d7959ccefc794" category="section-title">Windows Defender Antivirus</block>
  <block id="2861d3b5f4351fd51979bf98547a050b" category="paragraph">O Windows Defender é um software antimalware instalado e ativado no Windows Server por padrão. Este software protege ativamente o Windows Server contra malware conhecido e pode atualizar regularmente definições de antimalware através do Windows Update. Os LUNs e compartilhamentos SMB do NetApp podem ser digitalizados usando o Windows Defender.</block>
  <block id="a86f08bae2bbd68aa81b64f748f3ccb8" category="inline-link">Visão geral do Windows Defender</block>
  <block id="4b51dd417e2be3fdc9a793c3290e3a63" category="paragraph">Para obter mais informações, consulte<block ref="d66127569e4d44a2d0a35bc9d20b1ea7" category="inline-link-rx"></block> .</block>
  <block id="ce71fc775b37c52dabd938808de8d0f9" category="section-title">BitLocker</block>
  <block id="8d9091beebb755bb6e68a4f04d3288f6" category="paragraph">A criptografia de unidade BitLocker é um recurso de proteção de dados continuado do Windows Server 2012. Essa criptografia protege discos físicos, LUNs e CSVs.</block>
  <block id="0494cad48bf6f5dd2105391f0426af1a" category="paragraph">Antes de ativar o BitLocker, o CSV deve ser colocado no modo de manutenção. Portanto, a NetApp recomenda que as decisões relativas à segurança baseada no BitLocker sejam tomadas antes de criar VMs no CSV para evitar o tempo de inatividade.</block>
  <block id="36397d251acf4232a7e91edc7ae649c7" category="summary">Armazenamento nas ONTAP para Hyper-V usando SMB3</block>
  <block id="41ffc5ff950f2260951b6b6150c36f6b" category="doc">Provisionamento em ambientes SMB</block>
  <block id="a06ae7fcee90c7ab1e1321d0dd8b2242" category="paragraph">O ONTAP fornece armazenamento nas resiliente e de alto desempenho para máquinas virtuais Hyper-V usando o protocolo SMB3.</block>
  <block id="2efbb65fec3bad963652820bc484fe59" category="paragraph">Quando um SVM é criado com o protocolo CIFS, um servidor CIFS é executado sobre o SVM que faz parte do domínio do Windows active Directory. Os compartilhamentos SMB podem ser usados para um diretório inicial e para hospedar cargas de trabalho Hyper-V e SQL Server. Os seguintes recursos do SMB 3,0 são suportados no ONTAP:</block>
  <block id="55339f66c60fe6973920932c368d5b51" category="list-text">Alças persistentes (compartilhamentos de arquivos disponíveis continuamente)</block>
  <block id="94713d3b3a69a2fd695bffeb252007d3" category="list-text">Protocolo de testemunhas</block>
  <block id="adb115272d11e09afdfd8702a652d626" category="list-text">Failover de cliente em cluster</block>
  <block id="f5025b9fcd1b24276af8ec2da3aa4cd7" category="list-text">Reconhecimento com escalabilidade horizontal</block>
  <block id="81abcea6e16bc538d9843e8808b2066b" category="list-text">ODX</block>
  <block id="f4ad9c4d51155dbb3fb746c7c497c145" category="list-text">VSS remoto</block>
  <block id="3ebf71fd7bd7392466a892c2228b2f58" category="section-title">Provisionamento de compartilhamentos SMB no Windows Server</block>
  <block id="56a26f5f5f602966c3a3088fc05c7383" category="paragraph">O uso do armazenamento NetApp em ambientes nas no Windows Server tem os seguintes requisitos:</block>
  <block id="5f3a2953a5f6d187ed4babba3c754b95" category="list-text">O cluster ONTAP tem uma licença CIFS válida.</block>
  <block id="89917a1bea2d5c48569d9ed0a9526f74" category="list-text">Uma interface lógica de dados (LIF) é criada e o LIF de dados deve ser configurado para CIFS.</block>
  <block id="87a2c188e55f400a5936550cc2f91148" category="list-text">Um servidor de domínio do Windows ative Directory configurado por DNS e credenciais de administrador de domínio estão presentes.</block>
  <block id="da920c4d42bb062c9dbfd877c84ef133" category="list-text">Cada nó no cluster do NetApp é sincronizado com o controlador de domínio do Windows.</block>
  <block id="f04e0c239705cd7c6e249d3ed6991627" category="section-title">Controlador de domínio do ative Directory</block>
  <block id="2e0bc40db7949b4af757ea11110ae955" category="paragraph">Um controlador de armazenamento NetApp pode ser ligado e operar dentro de um ative Directory semelhante a um servidor Windows. Durante a criação do SVM, você pode configurar o DNS fornecendo os detalhes do nome de domínio e do servidor de nomes. O SVM tenta procurar um controlador de domínio do ative Directory consultando o DNS para um servidor LDAP (Protocolo de Acesso ao ative Directory/Lightweight Directory Access Protocol) de uma forma semelhante ao Windows Server.</block>
  <block id="dee2aa3e7614e2fc47c6fbbb5cd123b5" category="paragraph">Para que a configuração CIFS funcione corretamente, os controladores de armazenamento NetApp devem ser sincronizados com o controlador de domínio do Windows. A NetApp recomenda ter um desvio de tempo entre o controlador de domínio do Windows e o controlador de armazenamento NetApp de não mais de cinco minutos. É uma prática recomendada configurar o servidor NTP (Network Time Protocol) para que o cluster ONTAP sincronize com uma fonte de tempo externa. Para configurar o controlador de domínio do Windows como servidor NTP, execute o seguinte comando no cluster do ONTAP:</block>
  <block id="2d60b04429a0c7bcf1dc0021d1c01046" category="list-text">Crie um novo SVM com o protocolo nas CIFS ativado. É possível criar um novo SVM com qualquer um dos seguintes métodos:</block>
  <block id="8bbfb9edfb90853f3f9439d77ce59441" category="list-text">Comandos CLI no ONTAP</block>
  <block id="26ed02718973e705cd69ee6e109400e0" category="list-text">System Manager</block>
  <block id="fc05c3b0a7017fa6841b856230e365bb" category="list-text">O kit de ferramentas do NetApp PowerShell</block>
  <block id="bbee3ec15cf30d6e65d6a020f6d4af1e" category="list-text">Configurar o protocolo CIFS</block>
  <block id="8de4bddcd1cd8e4614e52342eef41752" category="list-text">Forneça o nome do servidor CIFS.</block>
  <block id="a817c1f7bf7af809fd90c63b2a8e4447" category="list-text">Forneça o ative Directory ao qual o servidor CIFS deve ser conetado. Você deve ter as credenciais de administrador de domínio para ingressar no servidor CIFS ao ative Directory.</block>
  <block id="5d77fb569194f93fead7154a8d1d1bc3" category="list-text">Inicie o serviço CIFS no SVM.</block>
  <block id="547edc4d2fb156c3e495e6325eae5a4a" category="list-text">Crie um volume com o estilo de segurança NTFS a partir do agregado.</block>
  <block id="1418b945a2d25e4f6514fc52e9d6c7ef" category="list-text">Crie uma qtree no volume (opcional).</block>
  <block id="f0bbe023b40d4d11ed83d36a68894cae" category="list-text">Crie compartilhamentos que correspondam ao volume ou diretório de qtree para que possam ser acessados a partir do Windows Server. Selecione Ativar disponibilidade contínua para Hyper-V durante a criação do compartilhamento se o compartilhamento for usado para armazenamento Hyper-V. Com isso, é possível obter alta disponibilidade para compartilhamentos de arquivos.</block>
  <block id="9ef47a6b1a5d19245750aa732054173a" category="list-text">Edite o compartilhamento criado e modifique as permissões conforme necessário para acessar o compartilhamento. As permissões para o compartilhamento SMB devem ser configuradas para conceder acesso às contas de computador de todos os servidores que acessam esse compartilhamento.</block>
  <block id="e72f4a4f5fcfab964176e743af1f3196" category="paragraph">O protocolo nas CIFS é nativamente integrado ao ONTAP. Portanto, o Windows Server não requer nenhum software cliente adicional para acessar dados no ONTAP. Um controlador de armazenamento NetApp aparece na rede como um servidor de arquivos nativo e suporta autenticação do Microsoft ative Directory.</block>
  <block id="053003e418b94e54d509f16e6a5ac54f" category="paragraph">Para detetar o compartilhamento CIFS criado anteriormente com o Windows Server, execute as seguintes etapas:</block>
  <block id="4cac21133029fce3cd01fb6d42f8bedb" category="list-text">Vá para run.exe e digite o caminho completo do compartilhamento CIFS criado para acessar o compartilhamento.</block>
  <block id="cf48b5bae22bbcd1956b57470865f653" category="list-text">Para mapear permanentemente a partilha no Windows Server, clique com o botão direito do rato neste PC, clique em Map Network Drive (Mapear unidade de rede) e forneça o caminho da partilha CIFS.</block>
  <block id="ab2d1dd1b024fd7be648c22c4a43997b" category="list-text">Algumas tarefas de gerenciamento CIFS podem ser executadas usando o MMC (Console de Gerenciamento da Microsoft). Antes de executar essas tarefas, você deve conetar o MMC ao armazenamento ONTAP usando os comandos de menu do MMC.</block>
  <block id="304c9374426bb10ac275b8d050d77a72" category="list-text">Para abrir o MMC no Windows Server, clique em Gerenciamento de computador na seção Ferramentas do Gerenciador de servidores.</block>
  <block id="e731a6a9193d81f0140801ba9fb7c316" category="list-text">Clique em mais ações e conete-se a outro computador, que abre a caixa de diálogo Selecionar computador.</block>
  <block id="92b70da99a18efe7530353abe1820089" category="list-text">Digite o nome do servidor CIFS ou o endereço IP do SVM LIF para se conetar ao servidor CIFS.</block>
  <block id="2d6dbdc8809506c631cd711d19c21958" category="list-text">Expanda Ferramentas do sistema e pastas compartilhadas para exibir e gerenciar arquivos abertos, sessões e compartilhamentos.</block>
  <block id="3a38167e840fd7939f34e194afadd957" category="list-text">Para confirmar que não há tempo de inatividade quando um volume é movido de um nó para outro ou em caso de falha de nó, a NetApp recomenda que você ative a opção de disponibilidade contínua no compartilhamento de arquivos.</block>
  <block id="7a98f276625e5966a817f0783982ef86" category="list-text">Ao provisionar VMs para um ambiente Hyper-V-over-SMB, a NetApp recomenda que você ative a descarga de cópia no sistema de storage. Isso reduz o tempo de provisionamento das VMs.</block>
  <block id="8bb66ec4b6ef9437bd1c4c88328028b9" category="list-text">Se o cluster de storage hospedar vários workloads SMB, como SQL Server, Hyper-V e servidores CIFS, a NetApp recomenda hospedar diferentes workloads SMB em SVMs separadas em agregados separados. Essa configuração é benéfica porque cada uma dessas cargas de trabalho garante uma rede de storage exclusiva e layouts de volume.</block>
  <block id="1d5ba6202d85466a95188b58c37dccc8" category="list-text">A NetApp recomenda a conexão de hosts Hyper-V e o armazenamento ONTAP com uma rede 10GB, se houver um disponível. No caso da conetividade de rede 1GBG, a NetApp recomenda a criação de um grupo de interfaces composto por várias portas 1GBG.</block>
  <block id="ce424317fa59851e16cfbe4cbac13386" category="list-text">Ao migrar VMs de um compartilhamento SMB 3,0 para outro, a NetApp recomenda habilitar a funcionalidade de descarga de cópia CIFS no sistema de storage para que a migração seja mais rápida.</block>
  <block id="be7159d8a65544f2712c72dc0254f9be" category="list-text">Quando você provisiona volumes para ambientes SMB, os volumes devem ser criados com o estilo de segurança NTFS.</block>
  <block id="bb17c7edf27266c09bc64edcc1299db5" category="list-text">As configurações de tempo nos nós do cluster devem ser configuradas de acordo. Use o NTP se o servidor CIFS do NetApp tiver de participar no domínio do ative Directory do Windows.</block>
  <block id="261b72d9729025ebf489205324a048d5" category="list-text">As alças persistentes funcionam apenas entre nós em um par de HA.</block>
  <block id="e185fb0d3a49c7a3318c954d8aa25c05" category="list-text">O protocolo testemunha funciona apenas entre nós em um par de HA.</block>
  <block id="67d7fd26a92bba839041dd45a19cec56" category="list-text">Compartilhamentos de arquivo continuamente disponíveis são compatíveis apenas para cargas de trabalho Hyper-V e SQL Server.</block>
  <block id="fa2e04a9f0cdcb5ad0e9f1e5ad1ada82" category="list-text">O multicanal SMB é suportado a partir do ONTAP 9.4 em diante.</block>
  <block id="f357368b2f195de4f8b4463eed2bf004" category="list-text">RDMA não é suportado.</block>
  <block id="f55cb235b18bf3d499f9276cd235bfb6" category="list-text">Refs não é suportado.</block>
  <block id="83f04319244758f7531b398c51aa9f38" category="section-title">Provisionamento de compartilhamentos SMB no Nano Server</block>
  <block id="fb97dc994a0600d8610daca021159b33" category="paragraph">Nano servidor não requer software cliente adicional para acessar dados no compartilhamento CIFS em um controlador de armazenamento NetApp.</block>
  <block id="2be09e0be799992463b5c9542ce31dd8" category="paragraph">Para copiar arquivos do Nano Server para um compartilhamento CIFS, execute os seguintes cmdlets no servidor remoto:</block>
  <block id="2e0d4f41db110bf64a66493b31c9b168" category="list-text"><block ref="6f88c516ba3d9ab0cd23b81fc43dd697" prefix="" category="inline-code"></block> É o compartilhamento CIFS na controladora de storage do NetApp.</block>
  <block id="5e017ad7a7df43934bccc7c27031a140" category="list-text">Para copiar arquivos para o Nano Server, execute o seguinte cmdlet:</block>
  <block id="d153ba0c2e04ac16dcece009a842216e" category="paragraph">Para copiar todo o conteúdo de uma pasta, especifique o nome da pasta e use o parâmetro -Recurse no final do cmdlet.</block>
  <block id="03162932e80c8f83c1ad9e36b16c1dcf" category="summary">Configuração de CPU do Microsoft SQL Server</block>
  <block id="79d467fa842b9015f2f12ada4fa1c7fc" category="paragraph">O desempenho do SQL Server tem várias dependências na CPU e na configuração do núcleo.</block>
  <block id="4403546c5938500562a9d8677deb1c38" category="section-title">Núcleos e licenciamento</block>
  <block id="074e88cde37f7aba58ac120bbc874e77" category="paragraph">Existem duas opções para o licenciamento do SQL Server. O primeiro é conhecido como um modelo de licença de acesso de servidor e cliente (CAL); o segundo é o modelo de núcleo por processador. Embora você possa acessar todos os recursos do produto disponíveis no SQL Server com a estratégia de servidor e CAL, há um limite de hardware de 20 núcleos de CPU por soquete. Mesmo que você tenha o SQL Server Enterprise Edition para um servidor com mais de 20 núcleos de CPU por soquete, o aplicativo não pode usar todos esses núcleos de uma vez nessa instância.</block>
  <block id="c325fde2d51a1ea2ddd8c9dd51cfdf9c" category="paragraph">A imagem abaixo mostra a mensagem de log do SQL Server após a inicialização indicando a imposição do limite do núcleo.</block>
  <block id="cf0e2551e639758cc3c4d82df655eccd" category="inline-link-macro">SQL Server 2022: Sua plataforma de dados moderna</block>
  <block id="809c9e1f6ce0bc82bf42fae361c6f43e" category="paragraph">Portanto, para usar todas as CPUs, você deve usar a licença de núcleo por processador. Para obter informações detalhadas sobre o licenciamento do SQL Server, <block ref="457abfaf1083b1cbfc49f2783069c6cd" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="cb8d56a3511d402b7355db8502a54c5a" category="section-title">Afinidade de CPU</block>
  <block id="cc3873d6002920194cf7e9dd493c5863" category="paragraph">É improvável que você precise alterar os padrões de afinidade do processador a menos que você encontre problemas de desempenho, mas ainda vale a pena entender o que eles são e como eles funcionam.</block>
  <block id="74f896768ee487acfd4c42370c202bed" category="paragraph">O SQL Server suporta afinidade de processador por duas opções:</block>
  <block id="cb315fb2b62c836ba51357d46f2e8c3f" category="list-text">Máscara de afinidade da CPU</block>
  <block id="cb00a2408ea648cf85edfd7dbb23fbe0" category="list-text">Máscara de e/S de afinidade</block>
  <block id="e59dc8056170cddb696ba9bff812c325" category="paragraph">O SQL Server usa todas as CPUs disponíveis no sistema operacional (se a licença de núcleo por processador for escolhida). Ele também cria agendadores f0r cada CPU para fazer o melhor uso dos recursos para qualquer carga de trabalho. Ao multitarefa, o sistema operacional ou outros aplicativos no servidor podem alternar processos de um processador para outro. O SQL Server é um aplicativo com uso intenso de recursos e o desempenho pode ser afetado quando isso ocorre. Para minimizar o impactos, você pode configurar os processadores para que toda a carga do SQL Server seja direcionada para um grupo pré-selecionado de processadores. Isso é conseguido usando a máscara de afinidade da CPU.</block>
  <block id="e40a45aed8142e74026f5aa7a6ee1122" category="paragraph">A opção de máscara de e/S de afinidade vincula e/S de disco do SQL Server a um subconjunto de CPUs. Em ambientes OLTP do SQL Server, essa extensão pode melhorar significativamente o desempenho de threads do SQL Server que emitem operações de e/S.</block>
  <block id="49e103832576f4486179df8868372d17" category="section-title">Grau máximo de paralelismo (MAXDOP)</block>
  <block id="4317f0d20ae625ae3139762a94175cbd" category="paragraph">Por padrão, o SQL Server usa todas as CPUs disponíveis durante a execução da consulta se a licença de núcleo por processador escolhida.</block>
  <block id="16dce493fdad96fe48148f47dc552bfb" category="admonition">*A NetApp recomenda* para DSS, como data warehouses, comece com<block ref="1abedc5f6ab369ab9fcd16d6b7990638" prefix=" " category="inline-code"></block> a 50 e explore o ajuste para cima ou para baixo, se necessário. Certifique-se de medir as consultas críticas em seu aplicativo ao fazer alterações.</block>
  <block id="a99f7ebb3b0f5b0ecea93ed586b2a17d" category="section-title">Max worker threads</block>
  <block id="aff27140f50a549b1331add8d5025f7e" category="paragraph">A opção Max worker threads ajuda a otimizar o desempenho quando um grande número de clientes está conetado ao SQL Server.</block>
  <block id="0add8d6e7be42a854cd7e0161c7f9bcc" category="paragraph">Normalmente, um thread de sistema operacional separado é criado para cada consulta. Se centenas de conexões simultâneas forem feitas ao SQL Server, a configuração de um thread por consulta pode consumir recursos excessivos do sistema. A<block ref="a9233738c364090bbc418d8a0e08a79e" prefix=" " category="inline-code"></block> opção ajuda a melhorar o desempenho ao permitir que o SQL Server crie um conjunto de threads de trabalho que podem atender coletivamente um número maior de solicitações de consulta.</block>
  <block id="decd79137325e1efbc7b994f946ea24f" category="paragraph">O valor padrão é 0, o que permite que o SQL Server configure automaticamente o número de threads de trabalho na inicialização. Isso funciona para a maioria dos sistemas. Max worker threads é uma opção avançada e não deve ser alterada sem a ajuda de um administrador de banco de dados experiente (DBA).</block>
  <block id="29d04e616d2293c4c7538dd6226feac5" category="section-title">Configurando o máximo de threads de trabalho usando o SQL Server Management Studio.</block>
  <block id="29daf9697a41a463dbe76855a2053a87" category="paragraph">O exemplo a seguir mostra como configurar a opção Max Work threads usando T-SQL.</block>
  <block id="ff03ad08d7a38270e44c8c74372d0e7c" category="summary">Proteção de bancos de dados Microsoft SQL Server no ONTAP com comandos SnapCenter e T-SQL.</block>
  <block id="7039e99a0fdcc0d3ef80074ed42bf4e4" category="paragraph">As estratégias de backup de banco de dados devem ser baseadas em requisitos de negócios identificados, não em recursos teóricos. Ao combinar a tecnologia Snapshot da ONTAP e aproveitar as API do Microsoft SQL Server, você pode rapidamente fazer backup consistente de aplicativos, independentemente do tamanho dos bancos de dados do usuário. Para requisitos de gerenciamento de dados mais avançados ou com escalabilidade horizontal, a NetApp oferece SnapCenter.</block>
  <block id="5c014f8939a89da0166a347a0237cf4f" category="section-title">SnapCenter</block>
  <block id="a72812111b6cfc428e19135820c476bc" category="paragraph">O SnapCenter é o software de proteção de dados da NetApp para aplicações empresariais. Os bancos de dados do SQL Server podem ser protegidos rápida e facilmente com o plug-in do SnapCenter para SQL Server e com operações do SO gerenciadas pelo plug-in do SnapCenter para Microsoft Windows.</block>
  <block id="62c187efa0cd9f4191b84ae987d522c9" category="paragraph">A instância do SQL Server pode ser uma configuração autônoma, uma instância de cluster de failover ou pode estar sempre no grupo de disponibilidade. O resultado é que, a partir de um painel único, os bancos de dados podem ser protegidos, clonados e restaurados da cópia primária ou secundária. O SnapCenter pode gerenciar bancos de dados do SQL Server tanto no local, na nuvem e configurações híbridas. Cópias de banco de dados também podem ser criadas em poucos minutos no host original ou alternativo para desenvolvimento ou para fins de geração de relatórios.</block>
  <block id="97e73fdb42ddecb63ed519a484ff3c9b" category="paragraph">O SQL Server também requer coordenação entre o sistema operacional e o armazenamento para garantir que os dados corretos estejam presentes em snapshots no momento da criação. Na maioria dos casos, o único método seguro para fazer isso é com SnapCenter ou T-SQL. Os instantâneos criados sem essa coordenação adicional podem não ser recuperáveis de forma confiável.</block>
  <block id="1567bc0803275089d7cbc1ffc468158c" category="inline-link-macro">TR-4714: Guia de práticas recomendadas para SQL Server usando NetApp SnapCenter</block>
  <block id="17f58c1b5cb5feb5dcaf49ca87298c00" category="paragraph">Para obter mais detalhes sobre o plug-in do SQL Server para SnapCenter, <block ref="c94de7812b9bc9ed76b3c4005974958d" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="91a7baba41dc4b5f958101b261cf179b" category="section-title">Proteção de banco de dados usando snapshots T-SQL</block>
  <block id="8a3aceb6ed4b21af2f2c00ecb032f75f" category="paragraph">No SQL Server 2022, a Microsoft introduziu snapshots T-SQL que oferece um caminho para a execução de scripts e automação de operações de backups. Em vez de executar cópias de tamanho completo, você pode preparar o banco de dados para snapshots. Depois que o banco de dados estiver pronto para backup, você poderá aproveitar as APIs REST do ONTAP para criar snapshots.</block>
  <block id="02e19b2989ebddca9ad3778807bdc426" category="paragraph">O seguinte é um exemplo de fluxo de trabalho de backup:</block>
  <block id="eeeb4e610a7896c1b1f2e2ea9b3f52a0" category="list-text">Congelar um banco de dados com comando ALTER. Ele prepara o banco de dados para um snapshot consistente no storage subjacente. Após o congelamento, você pode descongelar o banco de dados e gravar o instantâneo com o comando BACKUP.</block>
  <block id="bd03301405e4dd8f2460ff1788765ac4" category="list-text">Execute snapshots de vários bancos de dados nos volumes de storage simultaneamente com os novos comandos DO GRUPO DE backup e DO SERVIDOR DE BACKUP.</block>
  <block id="a3b19be7df3ddff7295558d9934cd9b6" category="list-text">Execute backups COMPLETOS ou backups COMPLETOS Copy_ONLY. Esses backups também são gravados em msdb.</block>
  <block id="e2d06152222f63515f4b83229cb5444c" category="list-text">Execute recuperação pontual usando backups de log feitos com a abordagem de streaming normal após o backup COMPLETO do snapshot. Backups diferenciais de streaming também são suportados, se desejado.</block>
  <block id="a7a2496066febda8d325e0964e434481" category="inline-link-macro">Documentação da Microsoft para saber sobre os snapshots T-SQL</block>
  <block id="bf06f3f95c5b653499bb4ac53ba44c95" category="paragraph">Para saber mais, <block ref="2ba8392a398067f6d2e5f6e4167e9d00" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="030194212f0e1890126b205fdbcfe852" category="summary">Protegendo o Microsoft SQL Server no ONTAP</block>
  <block id="972d09960af01a5f3831f2eac1c75d12" category="summary">Recuperação de desastres do Microsoft SQL Server com o ONTAP</block>
  <block id="db78788a721b9a9a669c4935d455a593" category="paragraph">Bancos de dados empresariais e infraestruturas de aplicações geralmente exigem replicação para proteger contra desastres naturais ou interrupções inesperadas dos negócios com o mínimo de tempo de inatividade.</block>
  <block id="9d831cc4c73b8a2915ce6d8928d55915" category="paragraph">O recurso de replicação de grupo de disponibilidade contínua do SQL Server pode ser uma excelente opção, e o NetApp oferece opções para integrar a proteção de dados sempre ativa. Em alguns casos, no entanto, você pode querer considerar a tecnologia de replicação do ONTAP. Existem três opções básicas.</block>
  <block id="794cb725c5631ad99b5b7c000307f0df" category="section-title">SnapMirror</block>
  <block id="dd432f8769e4d3db8acf8bf9df94680a" category="paragraph">A tecnologia SnapMirror oferece uma solução empresarial rápida e flexível para replicação de dados em LANs e WANs. A tecnologia SnapMirror transfere apenas blocos de dados alterados para o destino após a criação do espelhamento inicial, reduzindo significativamente os requisitos de largura de banda da rede. Ele pode ser configurado em modo síncrono ou assíncrono.</block>
  <block id="0a01e6837f5c691536f0b6cbdd0232ec" category="inline-link-macro">TR-4015: Guia de práticas recomendadas e configuração do SnapMirror para ONTAP 9</block>
  <block id="fce5f84d02dbd5c9e3cfedf18e809644" category="summary">Microsoft SQL Server e NetApp MetroCluster</block>
  <block id="41900c1c2eb669e401e4abee9091b40b" category="paragraph">A implantação do Microsoft SQL Server com ambiente MetroCluster requer alguma explicação do design físico de um sistema MetroCluster.</block>
  <block id="60359402d81f6673550c3df489efb034" category="paragraph">O MetroCluster espelha de forma síncrona os dados e a configuração entre dois clusters ONTAP em locais separados ou domínios de falha. O MetroCluster fornece storage disponível continuamente para aplicações, gerenciando automaticamente dois objetivos:</block>
  <block id="abf0aedf685f58c3cf3abe3e41ca549c" category="list-text">Objetivo do ponto de restauração zero (RPO) espelhando de forma síncrona os dados gravados no cluster.</block>
  <block id="1194ac032fc54dbcf779ac23fbc73dd5" category="list-text">Objetivo de tempo de recuperação quase zero (rto) espelhando a configuração e automatizando o acesso aos dados no segundo local.</block>
  <block id="9aa45379205d52916f2958359e92c1c8" category="paragraph">O MetroCluster oferece simplicidade com o espelhamento automático de dados e a configuração entre os dois clusters independentes localizados nos dois locais. À medida que o storage é provisionado em um cluster, ele é espelhado automaticamente para o segundo cluster no segundo local. O NetApp SyncMirror fornece uma cópia completa de todos os dados com RPO zero. Isso significa que workloads de um local podem alternar a qualquer momento para o local oposto e continuar fornecendo dados sem perda de dados. O MetroCluster gerencia o processo de switchover fornecendo acesso a dados provisionados por SAN e nas no segundo local. O design do MetroCluster como uma solução validada contém dimensionamento e configuração que permitem que um switchover seja executado dentro dos períodos de tempo limite do protocolo ou antes (geralmente menos de 120 segundos). Isso resulta em um RPO quase zero e as aplicações podem continuar acessando os dados sem incorrer em falhas. O MetroCluster está disponível em várias variações definidas pela malha de storage de back-end.</block>
  <block id="5e7988aeba0e1d3c15c5c78a0db738d1" category="section-title">SyncMirror</block>
  <block id="47985b72c36de8197de21d06517f1a03" category="paragraph">A proteção do SQL Server com MetroCluster é baseada no SyncMirror, que oferece uma tecnologia de espelhamento síncrono com escalabilidade horizontal e alta performance.</block>
  <block id="96a36329b3e96b1619b1d635a806bb3f" category="summary">Microsoft SQL Server com NetApp MetroCluster</block>
  <block id="9fcf1f7a4c16b536048dc5875b61d4b1" category="paragraph">Uma opção para proteger bancos de dados SQL Server com RPO zero é o MetroCluster. O MetroCluster é uma tecnologia de replicação simples e de alta performance RPO igual a 0 que permite replicar facilmente toda uma infraestrutura nos locais.</block>
  <block id="8a7f9ca86b522c62318d9b1eb5b51625" category="paragraph">O SQL Server pode escalar até milhares de bancos de dados em um único sistema MetroCluster. Pode haver instâncias autônomas do SQL Server ou instâncias de cluster de failover, o sistema MetroCluster não necessariamente adiciona ou altera quaisquer práticas recomendadas para gerenciar um banco de dados.</block>
  <block id="43135677cc98d0d6872d9ec24bef82e4" category="paragraph">Uma explicação completa do MetroCluster está além do escopo deste documento, mas os princípios são simples. O MetroCluster pode fornecer uma solução de replicação RPO igual a 0 com failover rápido. O que você constrói sobre essa base depende de suas necessidades.</block>
  <block id="046797023ebbfe8b6dd24d4fc7cab0be" category="paragraph">Por exemplo, um procedimento básico de DR rápido após perda súbita do local pode usar as seguintes etapas básicas:</block>
  <block id="f8b79e7c0c5914411ccfda1cbaa25414" category="list-text">Forçar um switchover do MetroCluster</block>
  <block id="740d5da1ae0060ef63f290d3aed64929" category="list-text">Realizar descoberta de LUNs FC/iSCSI (somente SAN)</block>
  <block id="89c617c4ed9cac275e572a67b1c52b29" category="list-text">Montar sistemas de arquivos</block>
  <block id="f08329445e69fa49a8223bf365f09e47" category="list-text">Inicie o SQL Services</block>
  <block id="b7aabeea5e06b7371d4372fd7f698f88" category="paragraph">O principal requisito dessa abordagem é um sistema operacional em execução no local remoto. Ele deve ser pré-configurado com a configuração do SQL Server e deve ser atualizado com versão de compilação equivalente. Os bancos de dados do sistema do SQL Server também podem ser espelhados para o local remoto e montados se um desastre for declarado.</block>
  <block id="2b963bb5f627aa0ffda026b4d97b6474" category="summary">Cenários de failover do Microsoft SQL Server e SM-as</block>
  <block id="b0bb805a1ea68ad43ceacf65954b4b4b" category="paragraph">Planejar uma arquitetura completa de aplicativos de sincronização ativa do SnapMirror requer entender como o SM-as responderá em vários cenários de failover planejados e não planejados.</block>
  <block id="511d40fa1b50f901027391480dff9c67" category="paragraph">O mediador é necessário para automatizar o failover com segurança. Idealmente, ele seria colocado em um local 3rd independente, mas ainda pode funcionar para a maioria das necessidades se colocasse em um dos clusters que participam da replicação.</block>
  <block id="cef962a099d3ff2b834420d0c97f5bc1" category="summary">Microsoft SQL Server e SM-as acesso não uniforme</block>
  <block id="3ef2650b3e4d89df6ea0248f432e6c2c" category="paragraph">A rede de acesso não uniforme significa que cada host só tem acesso às portas no sistema de storage local. A SAN não é estendida entre sites (ou domínios de falha dentro do mesmo site).</block>
  <block id="7c58b14cf1e27ff24a5b6a0656848380" category="summary">Sincronização ativa do Microsoft SQL Server e do SnapMirror</block>
  <block id="64affc06244780af1f97a68438460989" category="paragraph">O SnapMirror active Sync permite que bancos de dados e aplicações individuais do SQL Server continuem as operações durante interrupções de storage e rede, com failover transparente de storage sem qualquer intervenção manual.</block>
  <block id="0a19f1ca74616d0d4972b2c02c3f7fee" category="paragraph">Iniciando o ONTAP 9.15,1, o SnapMirror ative Sync suporta arquitetura ativa-ativa simétrica, além da configuração assimétrica existente. A funcionalidade ativo-ativo simétrica fornece replicação bidirecional síncrona para continuidade dos negócios e recuperação de desastres. Ele ajuda você a proteger o acesso a dados para workloads SAN críticos com acesso de leitura e gravação simultâneos a dados em vários domínios de falha, garantindo operações ininterruptas e minimizando o tempo de inatividade durante desastres ou falhas do sistema.</block>
  <block id="d17dae030927ab027095c1e44df8fbf1" category="paragraph">Os hosts do SQL Server acessam o storage usando Fibre Channel (FC) ou iSCSI LUNs. Replicação entre cada cluster que hospeda uma cópia dos dados replicados. Como esse recurso é replicação no nível de armazenamento, as instâncias do SQL Server executadas em instâncias de cluster de host ou failover independentes podem executar operações de leitura/gravação em cluster. Para obter informações sobre as etapas de Planejamento e configuração, <block ref="44f5d8051247437425911d96f84db248" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="b2f689709f901a51858096aaf9637eb4" category="paragraph">**Replicação síncrona**</block>
  <block id="71ed2e619a97a27f6fe533714a412725" category="paragraph">Em operação normal, cada cópia é uma réplica síncrona RPO/0 em todos os momentos, com uma exceção. Se os dados não puderem ser replicados, o ONTAP cumprirá o requisito de replicar dados e retomar a distribuição de I/o em um local, enquanto os LUNs no outro local ficam offline.</block>
  <block id="331b5c7e8c01ec1e37b60de5a5efba6c" category="paragraph">**Hardware de armazenamento**</block>
  <block id="588068838f06fe39dec548e2210ddf2f" category="paragraph">O Mediador ONTAP é um aplicativo de software que é baixado do suporte do NetApp e normalmente é implantado em uma pequena máquina virtual. O Mediador ONTAP não é um tiebreaker. É um canal de comunicação alternativo para os dois clusters que participam da replicação de sincronização ativa do SnapMirror. As operações automatizadas são orientadas pelo ONTAP com base nas respostas recebidas do parceiro por meio de conexões diretas e por meio do mediador.</block>
  <block id="6fda40460e9cbbefd704b9c01ea2c18c" category="summary">Microsoft SQL Server e SM-as site preferido</block>
  <block id="ac420a2d1b21182a80148191683bc9f7" category="paragraph">O comportamento de sincronização ativa do SnapMirror é simétrico, com uma exceção importante - configuração de site preferida.</block>
  <block id="85a2564342597a065a3926228b7e9fcd" category="paragraph">O SQL Server pode ser configurado para trabalhar com a sincronização ativa do SnapMirror de várias maneiras. A resposta certa depende da conectividade de rede disponível, dos requisitos de RPO e dos requisitos de disponibilidade.</block>
  <block id="3ccf31c781c6df95109107d66199a8f6" category="section-title">Instância autônoma do SQL Server</block>
  <block id="bd53ef250bf6f7a012cc7ed01c62f8cd" category="inline-link-macro">SQL Server no ONTAP</block>
  <block id="d0d5aa4f66a3624a91ad4b11bbc2250f" category="paragraph">As práticas recomendadas para layout de arquivo e configuração de servidor são as mesmas recomendadas <block ref="c89905de54b32eb552c83786b7590df9" category="inline-link-macro-rx"></block>na documentação.</block>
  <block id="a489ffed938ef1b9e86889bc413501ee" category="inline-link-macro">uniforme</block>
  <block id="ee289d07b4c3d14dcc9cc162df065f99" category="paragraph">Com uma configuração autônoma, o SQL Server poderia estar sendo executado apenas em um site. Presumivelmente <block ref="b88135502d93a28469d0c520f73e7e7d" category="inline-link-macro-rx"></block> o acesso seria usado.</block>
  <block id="50c137c2af8db8930fd9881b4ece5d99" category="inline-image-macro">Único host com acesso uniforme</block>
  <block id="327efeeabe7ad30552ef39a61284b93b" category="paragraph">Com acesso uniforme, uma falha de armazenamento em qualquer um dos locais não interromperia as operações do banco de dados. Uma falha completa do local no site que incluía o servidor do banco de dados resultaria, naturalmente, em uma falha.</block>
  <block id="5bc465d840f8a329d264340f938ab253" category="paragraph">Alguns clientes podem configurar um sistema operacional em execução no site remoto com uma configuração pré-configurada do SQL Server, atualizada com uma versão de compilação equivalente como a da instância de produção. O failover exigiria a ativação dessa instância autônoma do SQL Server no local alternativo, a descoberta dos LUNS e a inicialização do banco de dados. O processo completo pode ser automatizado com o cmdlet do Windows PowerShell, pois não são necessárias operações do lado do storage.</block>
  <block id="ea7bbefe18f9ad7af62904dd6da19c33" category="inline-link-macro">Não uniforme</block>
  <block id="b53a3ef75c6e33a4f8945589cbe8beee" category="paragraph"><block ref="56d4a3cb11d7ad2b0e560d2cc8afde2c" category="inline-link-macro-rx"></block> o acesso também poderia ser usado, mas o resultado seria uma interrupção do banco de dados se o sistema de storage em que o servidor de banco de dados estava localizado tivesse falhado porque o banco de dados não teria caminhos disponíveis para o storage. Isso ainda pode ser aceitável em alguns casos. O SnapMirror ative Sync ainda estaria fornecendo proteção de dados RPO igual a 0 e, em caso de falha do local, a cópia sobrevivente estaria ativa e pronta para retomar as operações usando o mesmo procedimento usado com acesso uniforme, conforme descrito acima.</block>
  <block id="a2e30e760061ab42fd5030c552306712" category="paragraph">Um processo de failover simples e automatizado pode ser mais facilmente configurado com o uso de um host Virtualize. Por exemplo, se os arquivos de dados do SQL Server forem replicados sincronamente para o armazenamento secundário, juntamente com um VMDK de inicialização, em caso de desastre, o ambiente completo poderá ser ativado no local alternativo. Um administrador pode ativar manualmente o host no local sobrevivente ou automatizar o processo por meio de um serviço como o VMware HA.</block>
  <block id="f04055c72ba32a95b9830308e4508cb1" category="section-title">Instância de cluster de failover do SQL Server</block>
  <block id="21fd4631916f5c0e63ef67f98d413d6a" category="paragraph">As instâncias de failover do SQL Server também podem ser hospedadas em um cluster de failover do Windows executado em um servidor físico ou servidor virtual como sistema operacional convidado. Essa arquitetura de vários hosts oferece resiliência de armazenamento e instância do SQL Server. Essa implantação é útil em ambientes de alta demanda que buscam processos de failover robustos, mantendo o desempenho aprimorado. Em uma configuração de cluster de failover, quando um host ou storage primário é afetado, o SQL Services será failover para o host secundário e, ao mesmo tempo, o storage secundário estará disponível para servir e/S. Nenhum script de automação ou intervenção do administrador é necessário.</block>
  <block id="58daef667c5e83ded89d712a683c532b" category="summary">Microsoft SQL Server e SM-as acesso uniforme</block>
  <block id="b8c5c455d22a62b43bd58615af0a569e" category="paragraph">Rede de acesso uniforme significa que os hosts são capazes de acessar caminhos em ambos os sites (ou domínios de falha dentro do mesmo site).</block>
  <block id="fad02ab7a45b438ba1a4c024b9edb2be" category="paragraph">Veja a seguir as recomendações do SnapMirror para SQL Server:</block>
  <block id="fdbd6bb11fa9bf15b9e53c8f359e821c" category="list-text">Se o SMB for usado, o SVM de destino deve ser membro do mesmo domínio do ative Directory do qual o SVM de origem é membro, de modo que as listas de controle de acesso (ACLs) armazenadas em arquivos nas não sejam quebradas durante a recuperação de um desastre.</block>
  <block id="d5a7d81e3f495111d65621aede2e26a4" category="list-text">Não é necessário usar nomes de volume de destino iguais aos nomes de volume de origem, mas pode tornar o processo de montagem de volumes de destino no destino mais simples de gerenciar. Se o SMB for usado, você deve tornar o namespace nas de destino idêntico em caminhos e estrutura de diretório para o namespace de origem.</block>
  <block id="ff1af055b96eb7cd0f0ab71b2cc80c3d" category="list-text">Para fins de consistência, não programe atualizações do SnapMirror a partir dos controladores. Em vez disso, ative as atualizações do SnapMirror do SnapCenter para atualizar o SnapMirror após a conclusão da cópia de segurança completa ou de registo.</block>
  <block id="18c6a681ea46e1ed394e092461bb53ef" category="list-text">Distribua volumes que contêm dados do SQL Server entre diferentes nós do cluster para permitir que todos os nós do cluster compartilhem a atividade de replicação do SnapMirror. Essa distribuição otimiza o uso de recursos de nós.</block>
  <block id="4dd0779e2b7f46c37eb5ec38cdde3bb6" category="list-text">Usar a replicação síncrona, onde a demanda por recuperação rápida de dados é mais alta e soluções assíncronas para flexibilidade no RPO.</block>
  <block id="1cca1a3fad8c6dd7e2dadbd2aa08bf07" category="paragraph">Para obter mais informações sobre o SnapMirror, <block ref="64b916f792bad525a069a243c092b62e" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="a549d3d5e3e6aa1db52e782527a9664d" category="summary">Colocação do arquivo de banco de dados Microsoft SQL Server</block>
  <block id="329282f5b4d197877079b3b130756d76" category="paragraph">O posicionamento adequado do arquivo de banco de dados do SQL Server no ONTAP é fundamental durante a fase inicial de implantação. Isso garante um desempenho ideal, gerenciamento de espaço, backup e tempos de restauração que podem ser configurados para atender aos requisitos da sua empresa.</block>
  <block id="5306de2e4bff067a10c1c9b5aafe5920" category="paragraph">Em teoria, o SQL Server (64 bits) suporta 32.767 bancos de dados por instância e 524.272TB GB de tamanho de banco de dados, embora a instalação típica geralmente tenha vários bancos de dados. No entanto, o número de bancos de dados que o SQL Server pode manipular depende da carga e do hardware. Não é incomum ver instâncias do SQL Server hospedando dezenas, centenas ou até milhares de bancos de dados pequenos.</block>
  <block id="9a3f42cec243006996ab4580d3ce5d56" category="paragraph">Cada banco de dados consiste em um ou mais arquivos de dados e um ou mais arquivos de log de transações. O log de transações armazena as informações sobre transações de banco de dados e todas as modificações de dados feitas por cada sessão. Sempre que os dados são modificados, o SQL Server armazena informações suficientes no log de transações para desfazer (reverter) ou refazer (reproduzir) a ação. Um log de transações do SQL Server é parte integrante da reputação do SQL Server em relação à integridade e robustez dos dados. O log de transações é vital para os recursos de atomicidade, consistência, isolamento e durabilidade (ACID) do SQL Server. O SQL Server grava no log de transações assim que qualquer alteração na página de dados ocorrer. Cada declaração DML (Data Manipulation Language) (por exemplo, selecionar, inserir, atualizar ou excluir) é uma transação completa, e o log de transações garante que toda a operação baseada em conjunto ocorra, certificando-se da atomicidade da transação.</block>
  <block id="cbe6958e46fbab53cdbdb9deb2d75938" category="paragraph">Cada banco de dados tem um arquivo de dados primário, que, por padrão, tem a extensão .mdf. Além disso, cada banco de dados pode ter arquivos de banco de dados secundários. Esses arquivos, por padrão, têm extensões .ndf.</block>
  <block id="811b578b6dfbb4a4ca16ba0c0911e3df" category="paragraph">Todos os arquivos de banco de dados são agrupados em grupos de arquivos. Um grupo de arquivos é a unidade lógica, o que simplifica a administração do banco de dados. Eles permitem a separação entre o posicionamento lógico de objetos e arquivos de banco de dados físicos. Quando você cria as tabelas de objetos de banco de dados, você especifica em que grupo de arquivos eles devem ser colocados sem se preocupar com a configuração do arquivo de dados subjacente.</block>
  <block id="3401a9880dfc322da8a56c4d632361f6" category="paragraph"><block ref="3401a9880dfc322da8a56c4d632361f6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d8969d8106a5ac08f38277a3c0b813dc" category="paragraph">A capacidade de colocar vários arquivos de dados dentro do grupo de arquivos permite que você espalhe a carga entre diferentes dispositivos de armazenamento, o que ajuda a melhorar o desempenho de e/S do sistema. O log de transação em contraste não se beneficia dos vários arquivos porque o SQL Server grava no log de transação de forma sequencial.</block>
  <block id="829f5bea960b53b5f1e50e8288a740d4" category="paragraph">A separação entre o posicionamento lógico de objetos nos grupos de arquivos e arquivos físicos de banco de dados permite ajustar o layout do arquivo do banco de dados, obtendo o máximo do subsistema de armazenamento. O número de arquivos de dados que suportam uma determinada carga de trabalho pode ser variado conforme necessário para dar suporte aos requisitos de e/S e à capacidade esperada, sem afetar a aplicação. Essas variações no layout do banco de dados são transparentes para os desenvolvedores de aplicativos, que estão colocando os objetos do banco de dados nos grupos de arquivos em vez de arquivos do banco de dados.</block>
  <block id="3ac46c2f04dec9d215efbe44d307a020" category="admonition">*NetApp recomenda* evitar o uso do grupo de arquivos primário para qualquer coisa além de objetos do sistema. Criar um grupo de arquivos separado ou um conjunto de grupos de arquivos para os objetos do usuário simplifica a administração do banco de dados e a recuperação de desastres, especialmente no caso de bancos de dados grandes.</block>
  <block id="e3fc56c012a5d0c9f92dff9b49bcc80d" category="paragraph">Você pode especificar o tamanho inicial do arquivo e os parâmetros de crescimento automático no momento em que você cria o banco de dados ou adiciona novos arquivos a um banco de dados existente. O SQL Server usa um algoritmo de preenchimento proporcional ao escolher em qual arquivo de dados ele deve gravar dados. Ele grava uma quantidade de dados proporcionalmente ao espaço livre disponível nos arquivos. Quanto mais espaço livre no arquivo, mais escreve ele lida.</block>
  <block id="91d249de86b62102d6324849de2360fe" category="admonition">*A NetApp recomenda* que todos os arquivos no único grupo de arquivos tenham o mesmo tamanho inicial e parâmetros de crescimento automático, com o tamanho de crescimento definido em megabytes em vez de porcentagens. Isso ajuda o algoritmo de preenchimento proporcional equilibrar uniformemente as atividades de gravação em todos os arquivos de dados.</block>
  <block id="bd87ed7f70b7f9173319df18e5b5b751" category="paragraph">Toda vez que o SQL Server cresce arquivos, ele preenche o espaço recém-alocado com zeros. Esse processo bloqueia todas as sessões que precisam gravar no arquivo correspondente ou, em caso de crescimento de log de transações, gerar Registros de log de transações.</block>
  <block id="54db492ee9e4d356cc8722d1f4126f77" category="paragraph">O SQL Server sempre apaga o log de transações e esse comportamento não pode ser alterado. No entanto, você pode controlar se os arquivos de dados estão zerando para fora habilitando ou desativando a inicialização instantânea de arquivos. Ativar a inicialização instantânea de arquivos ajuda a acelerar o crescimento de arquivos de dados e reduz o tempo necessário para criar ou restaurar o banco de dados.</block>
  <block id="92208bd4d9c6fec3f7c1dedeca62e135" category="paragraph">Um pequeno risco de segurança está associado à inicialização instantânea de arquivos. Quando esta opção está ativada, partes não alocadas do arquivo de dados podem conter informações de arquivos do sistema operacional excluídos anteriormente. Os administradores de banco de dados podem examinar esses dados.</block>
  <block id="2b222ad4000e6e966783fd7bc480180e" category="paragraph">Você pode habilitar a inicialização instantânea de arquivos adicionando a permissão SA_MANAGE_VOLUME_NAME, também conhecida como "executar tarefa de manutenção de volume", à conta de inicialização do SQL Server. Você pode fazer isso sob o aplicativo de gerenciamento de políticas de segurança local (secpol.msc), como mostrado na figura a seguir. Abra as propriedades da permissão "Executar tarefa de manutenção de volume" e adicione a conta de inicialização do SQL Server à lista de usuários lá.</block>
  <block id="87f823f4f3b4258445d5af029afe5ad9" category="paragraph"><block ref="87f823f4f3b4258445d5af029afe5ad9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c622e0142ed854a10f98fcaa8b3487f8" category="paragraph">Para verificar se a permissão está ativada, você pode usar o código do exemplo a seguir. Esse código define dois sinalizadores de rastreamento que forçam o SQL Server a gravar informações adicionais no log de erros, criar um pequeno banco de dados e ler o conteúdo do log.</block>
  <block id="eba8c32bde087b29aaa1fe0d3bb32ef3" category="paragraph">Quando a inicialização instantânea do arquivo não está ativada, o log de erro do SQL Server mostra que o SQL Server está zerando o arquivo de dados do mdf, além de zerar o arquivo de log ldf, como mostrado no exemplo a seguir. Quando a inicialização instantânea do arquivo está ativada, ele exibe apenas a restauração do arquivo de log.</block>
  <block id="9213fe9d391179276ff6c03552486255" category="paragraph"><block ref="9213fe9d391179276ff6c03552486255" category="inline-image-macro-rx" type="image"></block></block>
  <block id="df42f2a843e18c9b5f6adccba2ffcbf9" category="paragraph">A tarefa realizar manutenção de volume é simplificada no SQL Server 2016 e é fornecida posteriormente como uma opção durante o processo de instalação. Esta figura exibe a opção de conceder ao serviço do mecanismo de banco de dados SQL Server o privilégio de executar a tarefa de manutenção de volume.</block>
  <block id="3105b4c0642b9710179c18edcf8e8718" category="paragraph"><block ref="3105b4c0642b9710179c18edcf8e8718" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8c0ea2438ef8ec6eede8f5ae6996c5a0" category="paragraph">Outra opção importante de banco de dados que controla os tamanhos de arquivo de banco de dados é o auto-retrátil. Quando essa opção está ativada, o SQL Server diminui regularmente os arquivos do banco de dados, reduz seu tamanho e libera espaço para o sistema operacional. Esta operação é intensiva em recursos e raramente é útil porque os arquivos de banco de dados crescem novamente após algum tempo quando novos dados entram no sistema. O Autoshink não deve ser ativado no banco de dados.</block>
  <block id="09ddfa236e0fa1173f8d86a5ad0c148f" category="summary">Diretório de log do Microsoft SQL Server</block>
  <block id="cc2c23339c0ad05c5ae1704b4a0ecb37" category="paragraph">O diretório de log é especificado no SQL Server para armazenar dados de backup de log de transação no nível do host. Se você estiver usando o SnapCenter para fazer backup de arquivos de log, cada host do SQL Server usado pelo SnapCenter deve ter um diretório de log do host configurado para executar backups de log. O SnapCenter tem um repositório de banco de dados, portanto, os metadados relacionados a operações de backup, restauração ou clonagem são armazenados em um repositório de banco de dados central.</block>
  <block id="29766ed5967263787fface0a4ad3396f" category="paragraph">Os tamanhos do diretório de log do host são calculados da seguinte forma: Tamanho do diretório de log do host ( (tamanho máximo de DB LDF x taxa de alteração diária de log %) x (retenção de snapshot) ÷ (1 - LUN overhead space %) a fórmula de dimensionamento do diretório de log do host assume um espaço de sobrecarga de LUN de 10%</block>
  <block id="31333b887781902e13c263570523ddc1" category="paragraph">Coloque o diretório de log em um volume dedicado ou LUN. A quantidade de dados no diretório de log do host depende do tamanho dos backups e do número de dias em que os backups são mantidos. O SnapCenter permite apenas um diretório de log de host por host do SQL Server. Você pode configurar os diretórios de log do host em SnapCenter --&gt; Host --&gt; Configurar Plug-in.</block>
  <block id="e815059019027c04aa969a50787d5b34" category="paragraph">*A NetApp recomenda* o seguinte para um diretório de log do host:</block>
  <block id="07ae4edb1ccfbfe1f5da6006c95ee4a9" category="list-text">Certifique-se de que o diretório de log do host não é compartilhado por nenhum outro tipo de dados que possa potencialmente corromper os dados instantâneos do backup.</block>
  <block id="991bd1f492a593453f65c2a23c1f1612" category="list-text">Não coloque bancos de dados do usuário ou bancos de dados do sistema em um LUN que hospeda pontos de montagem.</block>
  <block id="58083df92a650a52d9ea6e4d544ffbd8" category="list-text">Crie o diretório de log do host em um volume dedicado ao qual o SnapCenter copia logs de transações.</block>
  <block id="7b01578e73f5081fecdcc6dedf28aa3c" category="list-text">Use os assistentes do SnapCenter para migrar bancos de dados para o storage do NetApp, de modo que os bancos de dados sejam armazenados em locais válidos, permitindo operações de backup e restauração bem-sucedidas do SnapCenter. Tenha em mente que o processo de migração é disruptivo e pode fazer com que os bancos de dados fiquem offline enquanto a migração está em andamento.</block>
  <block id="b2d0e2f60ee139155b728ef6933efe7c" category="list-text">As seguintes condições devem estar em vigor para instâncias de cluster de failover (FCIs) do SQL Server:</block>
  <block id="863fda0972208e1e15d0c4a16d6915af" category="list-text">Se você estiver usando uma instância de cluster de failover, o LUN do diretório de log do host deve ser um recurso de disco de cluster no mesmo grupo de cluster que a instância do SQL Server que está sendo feita backup do SnapCenter.</block>
  <block id="ddb1104e1e71caabad3e7639c7675af8" category="list-text">Se você estiver usando uma instância de cluster de failover, os bancos de dados de usuário devem ser colocados em LUNs compartilhados que são recursos de cluster de disco físico atribuídos ao grupo de cluster associado à instância do SQL Server.</block>
  <block id="bca5f9a18696e080113088282fe481de" category="summary">Configuração de memória do Microsoft SQL Server</block>
  <block id="42ad46ab967ef7af8287ca8a5c12f2d1" category="paragraph">A seção a seguir explica as configurações de memória do SQL Server necessárias para otimizar o desempenho do banco de dados.</block>
  <block id="02578ec0e8ce2fbef37ca792fd20c289" category="section-title">Memória máx. Do servidor</block>
  <block id="4e6b5a65dde214f8e25b7adbac9c9583" category="paragraph">A opção Max Server Memory (memória máxima do servidor) define a quantidade máxima de memória que a instância do SQL Server pode usar. Geralmente é usado se vários aplicativos estiverem sendo executados no mesmo servidor em que o SQL Server está sendo executado e você deseja garantir que esses aplicativos tenham memória suficiente para funcionar corretamente.</block>
  <block id="fb182faf8ee092092118e8cbb568ae0d" category="paragraph">Algumas aplicações utilizam apenas qualquer memória disponível quando iniciam e não solicitam memória adicional, mesmo que estejam sob pressão de memória. É aí que entra em jogo a configuração de memória máxima do servidor.</block>
  <block id="6e345f11e9b2856a7ac40d6cf283606b" category="paragraph">Em um cluster do SQL Server com várias instâncias do SQL Server, cada instância pode estar competindo por recursos. Definir um limite de memória para cada instância do SQL Server pode ajudar a garantir o melhor desempenho para cada instância.</block>
  <block id="318b34a3511a1be6d179a73303da2077" category="admonition">*A NetApp recomenda* deixando pelo menos 4GB GB a 6GB GB de RAM para o sistema operacional para evitar problemas de desempenho.</block>
  <block id="5a656ddcc72bacc3a5900c23edf7a08e" category="paragraph"><block ref="5a656ddcc72bacc3a5900c23edf7a08e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="cd151dbdf946ad6bd27e1d55ea1cd029" category="section-title">Ajustando a memória mínima e máxima do servidor usando o SQL Server Management Studio.</block>
  <block id="c7af956e7765f16c090e0eab836fb42a" category="paragraph">Usar o SQL Server Management Studio para ajustar a memória mínima ou máxima do servidor requer uma reinicialização do serviço SQL Server. Você também pode ajustar a memória do servidor usando Transact SQL (T-SQL) usando este código:</block>
  <block id="998c5e632fa0f987c20c182fc9322f67" category="section-title">Acesso à memória não uniforme</block>
  <block id="0abaf38d5c4f997a2507fe6e57682b0b" category="paragraph">O Acesso à memória não uniforme (NUMA) é uma tecnologia de otimização de acesso à memória que ajuda a evitar a carga extra no barramento do processador.</block>
  <block id="87dfe44a851d25873ee6bd0691ac0c6e" category="paragraph">Se O NUMA estiver configurado num servidor onde o SQL Server está instalado, não é necessária nenhuma configuração adicional porque o SQL Server tem UMA consciência NUMA e tem um bom desempenho no hardware NUMA.</block>
  <block id="b3b5cd113ed637ebe6cb28eab322307a" category="section-title">Index criar memória</block>
  <block id="7cf384150f5c5317f48125af9bf68c31" category="paragraph">A opção index create memory (criar memória) é outra opção avançada que normalmente não deve ser alterada a partir dos padrões.</block>
  <block id="631c6718cc62ad33b6e3b3b48d754569" category="paragraph">Ele controla a quantidade máxima de RAM inicialmente alocada para a criação de índices. O valor padrão para essa opção é 0, o que significa que ela é gerenciada automaticamente pelo SQL Server. No entanto, se você encontrar dificuldades para criar índices, considere aumentar o valor dessa opção.</block>
  <block id="8c91aa3f5264c57bd2d2e66bd70f2ad1" category="section-title">Memória mínima por consulta</block>
  <block id="a2f15f0d2a5091a4b232a8fa89bb43f8" category="paragraph">Quando uma consulta é executada, o SQL Server tenta alocar a quantidade ideal de memória para ser executado com eficiência.</block>
  <block id="64e199b7fb089ffb63f4c4396bac2cd1" category="paragraph">Por padrão, a configuração de memória mínima por consulta aloca &gt; 1024KB para cada consulta ser executada. É uma prática recomendada é deixar essa configuração no valor padrão para permitir que o SQL Server gerencie dinamicamente a quantidade de memória alocada para operações de criação de índice. No entanto, se o SQL Server tiver mais RAM do que precisa para ser executado de forma eficiente, o desempenho de algumas consultas pode ser aumentado se você aumentar essa configuração. Portanto, desde que a memória esteja disponível no servidor que não está sendo usado pelo SQL Server, por quaisquer outros aplicativos ou pelo sistema operacional, então aumentar essa configuração pode ajudar o desempenho geral do SQL Server. Se não houver memória livre disponível, aumentar essa configuração pode prejudicar o desempenho geral.</block>
  <block id="073ce0a0568adc64d52dd9b1d8c02c54" category="paragraph"><block ref="073ce0a0568adc64d52dd9b1d8c02c54" category="inline-image-macro-rx" type="image"></block></block>
  <block id="beb3ca55ed0a53a38a2b97540b05d6e4" category="summary">Microsoft SQL Server no ONTAP</block>
  <block id="59412263456ecc0573b76fe1c40d55fb" category="paragraph">O ONTAP oferece uma solução de desempenho e segurança de nível empresarial para seus bancos de dados Microsoft SQL Server, além de fornecer ferramentas de classe mundial para gerenciar seu ambiente.</block>
  <block id="959e8f746f4ff03f6225b95cf646e65f" category="admonition">Esta documentação substitui o relatório técnico publicado anteriormente _TR-4590: Guia de práticas recomendadas para Microsoft SQL Server com ONTAP_</block>
  <block id="e8b13d430655a3ab009ba8e90e51ce5a" category="paragraph">NetApp assume que o leitor tem conhecimento prático do seguinte:</block>
  <block id="a6d698a68f555339f6e91957f636ad69" category="list-text">Arquitetura e administração do Microsoft SQL Server</block>
  <block id="3b5b2ca12603a36517ce602ffe47361c" category="list-text">NetApp SnapCenter como software de backup, que inclui:</block>
  <block id="36a92a010308100e1efc10d9eb98c369" category="list-text">Plug-in do SnapCenter para Microsoft Windows</block>
  <block id="ec51578d7d8f930329548bf3d00d7038" category="list-text">Plug-in do SnapCenter para SQL Server</block>
  <block id="95a3a11e77f5071b2a97b611548b866c" category="paragraph">O escopo desta seção de práticas recomendadas está limitado ao design técnico com base nos princípios e padrões preferenciais recomendados pela NetApp para a infraestrutura de storage. A implementação de ponta a ponta está fora do escopo.</block>
  <block id="697ea025ecb303d4f40d1bf3a8b4bde0" category="inline-link-macro">Ferramenta de Matriz de interoperabilidade NetApp (IMT)</block>
  <block id="133dcf168b09b98ab4e6c6f77a743a14" category="paragraph">Para obter informações sobre compatibilidade entre os produtos NetApp, consulte <block ref="18e7fcfe606d6d0912191de7fd9eb56a" category="inline-link-macro-rx"></block>.</block>
  <block id="450eb6d84ec721a20f17b7778b24b457" category="section-title">Cargas de trabalho do Microsoft SQL Server</block>
  <block id="961963c19132b001c6c7289519292be5" category="paragraph">Antes de implantar o SQL Server, você deve entender os requisitos de carga de trabalho dos aplicativos suportados pelas instâncias de banco de dados do SQL Server. Cada aplicativo tem requisitos diferentes de capacidade, desempenho e disponibilidade, e, portanto, cada banco de dados deve ser projetado para oferecer suporte ideal a esses requisitos. Muitas organizações classificam os bancos de dados em várias camadas de gerenciamento, usando os requisitos da aplicação para definir SLAs. As cargas de trabalho do SQL Server são frequentemente categorizadas como descrito abaixo:</block>
  <block id="d748a2050ea9de15020c9f22e1c8a802" category="list-text">OLTP, que geralmente são os bancos de dados mais críticos de uma organização. Esses bancos de dados geralmente apoiam aplicativos voltados para o cliente e são considerados essenciais para as operações principais da empresa. Os bancos de dados OLTP de missão crítica e as aplicações com suporte geralmente têm SLAs que exigem alta performance, são sensíveis à degradação da performance e exigem disponibilidade máxima. Eles também podem ser candidatos para clusters de failover sempre em ou grupos de disponibilidade sempre em disponibilidade. A mistura de e/S nesses tipos de bancos de dados é geralmente caraterizada por 75% a 90% de leitura aleatória e 25% a 10% de gravação.</block>
  <block id="542d0aad1735dc536565c8a1ec4b579f" category="list-text">Bancos de dados do sistema de suporte à decisão (DSS), às vezes chamados de data warehouses. Esses bancos de dados são essenciais para muitas organizações que dependem de análises para seus negócios. Esses bancos de dados são sensíveis à utilização da CPU e operações de leitura do disco quando as consultas estão sendo executadas. Em muitas organizações, os bancos de dados DSS são os mais críticos durante o mês, trimestre e fim do ano Em geral, esse workload tem uma combinação de I/o de leitura de quase 100% e a taxa de transferência de e/S geralmente é mais importante do que o IOPS.</block>
  <block id="bdebc59bb8c11012c00a4be61b8bdb5d" category="summary">Implantação de instância do Microsoft SQL Server</block>
  <block id="af2a7a153f6f4904cc7384604809cf3c" category="paragraph">O SQL Server pode ser configurado como uma única instância por servidor ou como várias instâncias. A decisão certa geralmente depende de fatores como se o servidor deve ser usado para produção ou desenvolvimento, se a instância é considerada crítica para as operações de negócios e metas de desempenho.</block>
  <block id="8f66f557400d1222f6352dbc8811ec03" category="paragraph">Configurações de instâncias compartilhadas podem ser inicialmente mais fáceis de configurar, mas podem levar a problemas nos quais os recursos ficam divididos ou bloqueados, o que, por sua vez, causa problemas de desempenho para outros aplicativos que têm bancos de dados hospedados na instância compartilhada do SQL Server.</block>
  <block id="37fbf1be337695452699ab9df948aa25" category="paragraph">A solução de problemas de desempenho pode ser complicada porque você precisa descobrir qual instância é a causa principal. Esta questão é ponderada em relação aos custos das licenças do sistema operacional e das licenças do SQL Server. Se o desempenho do aplicativo for primordial, uma instância dedicada é altamente recomendada.</block>
  <block id="c840abede1d1bcf78e7b3e30048c08b1" category="paragraph">A Microsoft licencia o SQL Server por núcleo no nível do servidor e não por instância. Por esse motivo, os administradores de banco de dados são tentados a instalar quantas instâncias do SQL Server o servidor pode lidar para economizar nos custos de licenciamento, o que pode levar a grandes problemas de desempenho posteriormente.</block>
  <block id="8a77155b45f0f2313c8ebf3d755463e5" category="admonition">*A NetApp recomenda* escolher instâncias dedicadas do SQL Server sempre que possível para obter o desempenho ideal.</block>
  <block id="60654048dbcae98cde53dc0449c8e47b" category="summary">Consideração de armazenamento do Microsoft SQL Server</block>
  <block id="fbd4c4f9516af91c6c3cb5fa35fb5720" category="doc">Considerações sobre o armazenamento do Microsoft SQL Server</block>
  <block id="40d6bdd2be551c4046e5ad632c4dfe71" category="paragraph">A combinação de soluções de storage ONTAP e Microsoft SQL Server permite designs de storage de banco de dados de nível empresarial que podem atender aos requisitos de aplicativos mais exigentes dos dias de hoje.</block>
  <block id="9e020f08745f560c049f43a1b5ead190" category="paragraph">A otimização de uma solução SQL Server no ONTAP requer a compreensão do padrão e/S do SQL Server. Um layout de armazenamento bem projetado para um banco de dados do SQL Server deve suportar os requisitos de desempenho do SQL Server, além de fornecer o máximo de gerenciamento da infraestrutura como um todo. Um bom layout de storage também permite que a implantação inicial seja bem-sucedida e o ambiente cresça suavemente ao longo do tempo à medida que a empresa cresce.</block>
  <block id="3da07c62fca4dd242f7ffcfcf72998be" category="section-title">Design de storage de dados</block>
  <block id="9e45010900186b3cbbe04f954a6f3562" category="paragraph">Para bancos de dados do SQL Server que não usam o SnapCenter para executar backups, a Microsoft recomenda colocar os dados e arquivos de log em unidades separadas. Para aplicativos que simultaneamente atualizam e solicitam dados, o arquivo de log é intenso de gravação e o arquivo de dados (dependendo do aplicativo) é intenso de leitura/gravação. Para a recuperação de dados, o ficheiro de registo não é necessário. Portanto, as solicitações de dados podem ser satisfeitas a partir do arquivo de dados colocado em sua própria unidade.</block>
  <block id="df018ea4abdb71f91802ea1d4fb0fb37" category="inline-link-macro">Coloque dados e arquivos de log em unidades separadas</block>
  <block id="f2f25c68d67c561be1926b4b06e676b0" category="paragraph">Ao criar um novo banco de dados, a Microsoft recomenda especificar unidades separadas para os dados e logs. Para mover arquivos após a criação do banco de dados, o banco de dados deve ser offline. Para obter mais recomendações da Microsoft, <block ref="04fab8828edf0d2e95eff3c4f124b372" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="d5350d8759b1ec84607e47908809058e" category="section-title">Agregados</block>
  <block id="71cc52562b241f23c0f5c74c589fc56c" category="paragraph">Agregados são os contêineres de storage de nível mais baixo para configurações de storage NetApp. Alguma documentação legada existe na internet que recomenda separar o IO em diferentes conjuntos de unidades subjacentes. Isso não é recomendado com o ONTAP. A NetApp realizou vários testes de caraterização de carga de trabalho de e/S usando agregados compartilhados e dedicados com arquivos de dados e arquivos de log de transações separados. Os testes mostram que um agregado grande com mais grupos RAID e unidades otimiza e melhora o desempenho do armazenamento, além de ser mais fácil para os administradores gerenciarem por dois motivos:</block>
  <block id="994dbcbb2492daba25572c539cc12968" category="list-text">Um agregado grande torna os recursos de e/S de todas as unidades disponíveis para todos os arquivos.</block>
  <block id="77f1d6b9cbcaf3663f6bdd19a821e773" category="list-text">Um agregado grande permite o uso mais eficiente do espaço em disco.</block>
  <block id="63d9962fabe500361986d05317bd65a5" category="paragraph">Para alta disponibilidade (HA), coloque a réplica síncrona secundária do SQL Server Always On Availability Group em uma máquina virtual de storage (SVM) separada no agregado. Para fins de recuperação de desastre, coloque a réplica assíncrona em um agregado que faça parte de um cluster de storage separado no local de DR, com conteúdo replicado pelo uso da tecnologia NetApp SnapMirror. A NetApp recomenda ter pelo menos 10% de espaço livre disponível em um agregado para obter um desempenho ideal de storage.</block>
  <block id="9eb2f26da39e165d9e3a1c48b5798690" category="paragraph">os volumes são criados e residem dentro de agregados. Este termo às vezes causa confusão porque um volume ONTAP não é um LUN. Um volume de ONTAP é um contêiner de gerenciamento para os dados. Um volume pode conter arquivos, LUNs ou até mesmo objetos S3D. Um volume não ocupa espaço, é usado apenas para o gerenciamento dos dados contidos.</block>
  <block id="17fce39141e6fa457c789ce2c3239b0c" category="section-title">Considerações sobre design de volume</block>
  <block id="d1c9fdbcdbb8521971decf35c6d1c0c8" category="paragraph">Antes de criar um design de volume de banco de dados, é importante entender como o padrão e as caraterísticas de e/S do SQL Server variam dependendo da carga de trabalho e dos requisitos de backup e recuperação. Consulte as seguintes recomendações da NetApp para volumes flexíveis:</block>
  <block id="674343739e297abb52c536a453ebaad0" category="list-text">Use pontos de montagem NTFS em vez de letras de unidade para superar a limitação de 26 unidades no Windows. Ao usar pontos de montagem de volume, é uma recomendação geral dar ao rótulo de volume o mesmo nome que o ponto de montagem.</block>
  <block id="64999620676d7bc615f88fabe256272f" category="list-text">Se você instalar o SQL Server em um compartilhamento SMB, verifique se o Unicode está habilitado nos volumes SMB para criar pastas.</block>
  <block id="900188651b4134e36897865047c3fb5b" category="list-text">Defina o valor da reserva do snapshot no volume para zero para facilitar o monitoramento do ponto de vista operacional.</block>
  <block id="27d9533edb3ad60370502d101cd38d2b" category="list-text">Desative as programações de snapshot e as políticas de retenção. Em vez disso, use o SnapCenter para coordenar cópias Snapshot dos volumes de dados do SQL Server.</block>
  <block id="a09a2d9023a555d2d5a72621bf3395b3" category="list-text">Coloque os bancos de dados do sistema do SQL Server em um volume dedicado.</block>
  <block id="4176288dbc134524f79476ba4e57e3aa" category="list-text">Tempdb é um banco de dados de sistema usado pelo SQL Server como um espaço de trabalho temporário, especialmente para operações de e/S intensivas DBCC CHECKDB. Portanto, coloque esse banco de dados em um volume dedicado com um conjunto separado de fusos. Em ambientes grandes em que a contagem de volume é um desafio, você pode consolidar tempdb em menos volumes e armazená-lo no mesmo volume que outros bancos de dados do sistema após um Planejamento cuidadoso. A proteção de dados para tempdb não é uma prioridade alta porque este banco de dados é recriado sempre que o SQL Server é reiniciado.</block>
  <block id="b0874893f6e3e7030833ec488dc9da90" category="list-text">Coloque os arquivos de dados do usuário <block ref="937f38432beb92fdba3d47780720bdf7" prefix="(" category="inline-code"></block>) em volumes separados porque eles são cargas de trabalho de leitura/gravação aleatórias. É comum criar backups de log de transações com mais frequência do que backups de banco de dados. Por esse motivo, coloque arquivos de log de transações <block ref="cb15b9539ae0d984ff8740c68b52561c" prefix="(" category="inline-code"></block>) em um volume separado ou VMDK dos arquivos de dados para que programações de backup independentes possam ser criadas para cada um. Essa separação também isola a e/S de gravação sequencial dos arquivos de log da e/S de leitura/gravação aleatória de arquivos de dados e melhora significativamente o desempenho do SQL Server.</block>
  <block id="7b3c6a2d089eb1b6f8959e7e61a50c07" category="section-title">LUNs</block>
  <block id="b703a2ceaabee81dd9dfcfb3a4b738ee" category="list-text">Certifique-se de que os arquivos do banco de dados do usuário e o diretório de log para armazenar o backup de log estejam em volumes separados para impedir que a política de retenção substitua os snapshots quando eles forem usados com a tecnologia SnapVault.</block>
  <block id="f7f1cb17ab4960f1a8e4c28a7fbccb0d" category="list-text">Não misture arquivos de banco de dados e não de banco de dados, como arquivos relacionados à pesquisa de texto completo, no mesmo LUN.</block>
  <block id="ae72f885471636cbfd0dbe902ddf24e1" category="list-text">Se você criar LUNs com o DiskManager ou outras ferramentas, certifique-se de que o tamanho da unidade de alocação está definido como 64K para partições ao formatar os LUNs.</block>
  <block id="ac4782a9243acaaff52164f9e47417d5" category="inline-link-macro">Microsoft Windows e MPIO nativo sob as práticas recomendadas do ONTAP para SAN moderna</block>
  <block id="934e206705ddafc720e4a8f25a4acded" category="list-text">Consulte <block ref="95506eaa4fca841adc20747ae4650d10" category="inline-link-macro-rx"></block>para aplicar suporte multipathing no Windows a dispositivos iSCSI nas propriedades MPIO.</block>
  <block id="7a64f7e9c9b5737a434bdcc8f935c5ce" category="summary">Eficiência de storage do Microsoft SQL Server e do ONTAP</block>
  <block id="58ccb3e2006ffa82c78944061df94b30" category="paragraph">A eficiência de storage do ONTAP é otimizada para armazenar e gerenciar dados do SQL Server de uma forma que consome a menor quantidade de espaço de storage sem afetar a performance.</block>
  <block id="834873443aaaf2c09b851c8b0f7b2497" category="section-title">Compactação de banco de dados</block>
  <block id="9df29e7c756637e30b37f014d02117ef" category="paragraph">O próprio SQL Server também tem recursos para compactar e gerenciar dados de forma eficiente. O SQL Server atualmente suporta dois tipos de compactação de dados: Compactação de linha e compactação de página.</block>
  <block id="181341700086c5e2f2259774b2aaa59c" category="inline-link-macro">Implementação da compressão de páginas</block>
  <block id="46c6aaf21d639d23d4f297a1f6922d9a" category="paragraph">A compressão de linha altera o formato de armazenamento de dados. Por exemplo, ele muda inteiros e decimais para o formato de comprimento variável em vez de seu formato de comprimento fixo nativo. Ele também muda strings de carateres de comprimento fixo para o formato de comprimento variável, eliminando espaços em branco. A compressão de página implementa a compressão de linha e duas outras estratégias de compressão (compressão de prefixo e compressão de dicionário). Pode encontrar mais detalhes sobre a compressão de páginas <block ref="88eab602b149fe360da37498ad5cdeae" category="inline-link-macro-rx"></block>no .</block>
  <block id="0d629ff07f9214182fa91977089ff029" category="paragraph">Atualmente, a compactação de dados é suportada nas edições Enterprise, Developer e Evaluation do SQL Server 2008 e posterior. Embora a compactação possa ser executada pelo próprio banco de dados, isso raramente é observado em um ambiente SQL Server.</block>
  <block id="c6757fbc56df4ba20f0ef165aeb214d0" category="paragraph">Aqui estão a recomendação para gerenciar espaço para arquivos de dados do SQL Server</block>
  <block id="46344e63db1ea2128cc47543b10a0f96" category="list-text">Use thin Provisioning em ambientes SQL Server para melhorar a utilização de espaço e reduzir os requisitos gerais de armazenamento quando a funcionalidade de garantia de espaço é usada.</block>
  <block id="924e1b131d6b3a2846efd1a81de8eac1" category="list-text">Use o crescimento automático para as configurações de implantação mais comuns porque o administrador de storage precisa monitorar o uso de espaço no agregado.</block>
  <block id="752d71c042ef775879f6db705ccf6b31" category="section-title">Exigência de espaço</block>
  <block id="89f8656e4e33094d6011ef9aaa8fa8de" category="paragraph">A recuperação de espaço pode ser iniciada periodicamente para recuperar espaço não utilizado em um LUN. Com o SnapCenter, você pode usar o seguinte comando do PowerShell para iniciar a recuperação de espaço.</block>
  <block id="aa864feb1e600aa376e91ac119da387b" category="paragraph">Se você precisar executar a recuperação de espaço, esse processo deve ser executado durante períodos de baixa atividade, pois inicialmente consome ciclos no host.</block>
  <block id="c7f2945182947499933dea6fafeb22d3" category="summary">Colocação de tempdb no ONTAP</block>
  <block id="6f80e9146e2184b9ec3c46b6d7dd903f" category="paragraph">A contenção de páginas pode ocorrer nas páginas mapa de alocação global (GAM), mapa de alocação global compartilhado (SGAM) ou espaço livre de páginas (PFS) quando o SQL Server deve gravar em páginas especiais do sistema para alocar novos objetos. Os trincos bloqueiam estas páginas na memória. Em uma instância ocupada do SQL Server, pode levar muito tempo para obter uma trava em uma página do sistema no tempdb. Isso resulta em tempos de execução de consulta mais lentos e é conhecido como contenção de trava. Veja as práticas recomendadas a seguir para criar arquivos de dados tempdb:</block>
  <block id="44dbc82801d84781083ed9e23b63be00" category="list-text">Para 8 núcleos: Arquivos de dados tempdb: Número de núcleos</block>
  <block id="6203fcdbdad10bb603fd00edd2f0fcf5" category="list-text">Para &gt; 8 núcleos: 8 arquivos de dados tempdb</block>
  <block id="0424163d6b24f29436021dfd7072863b" category="paragraph">A partir do SQL Server 2016, o número de núcleos de CPU visíveis para o sistema operacional é detetado automaticamente durante a instalação e, com base nesse número, o SQL Server calcula e configura o número de arquivos tempdb necessários para um desempenho ideal.</block>
  <block id="0445195555faac96ebff962dbff126ea" category="summary">Parâmetros de configuração do MySQL</block>
  <block id="c0b7708ffcd66fd65a9d2a4801091563" category="paragraph">O NetApp recomenda alguns parâmetros de configuração importantes do MySQL para obter um desempenho ideal.</block>
  <block id="3225a10b07f1580f10dee4abc3779e6c" category="cell">Parâmetros</block>
  <block id="c82a6100dace2b41087ba6cf99a5976a" category="cell">Valores</block>
  <block id="2f09ac000b4a1808cb795b7bdbb20ecc" category="cell">innodb_log_file_size</block>
  <block id="b10db909b8fda84e70bf9b308d0938d9" category="cell">256M</block>
  <block id="395ec860c9530814e94538b7121a8319" category="cell">innodb_flush_log_at_trx_commit</block>
  <block id="c81e728d9d4c2f636f067f89cc14862c" category="cell">2</block>
  <block id="7ccc31934ae8244d8263d3c09bcee186" category="cell">innodb_doublewrite</block>
  <block id="cfcd208495d565ef66e7dff9f98764da" category="cell">0</block>
  <block id="35701e1bcd40c8e1a520fc33d0e14842" category="cell">innodb_flush_method</block>
  <block id="e590322920bebc1156ab585bd6597d76" category="cell">fsync</block>
  <block id="62812b938ba1113b81bd7f612ad0e6f8" category="cell">innodb_buffer_pool_size</block>
  <block id="adb0c1ec32461889a5093441599260eb" category="cell">11G</block>
  <block id="2199371f8380c97ad11a03fba3b501c9" category="cell">innodb_io_capacity</block>
  <block id="774412967f19ea61d448977ad9749078" category="cell">8192</block>
  <block id="311887a53ec7390fc383fa2ad813f012" category="cell">innodb_buffer_pool_instances</block>
  <block id="c9f0f895fb98ab9159f51fd0297e236d" category="cell">8</block>
  <block id="3ee58d04a0dc9b2551698643e0421005" category="cell">innodb_lru_scan_depth</block>
  <block id="1006f82d8df7d2325439b28ea691737c" category="cell">open_file_limit</block>
  <block id="3c9b5f1cd6a030bcb7bed9eac80589fb" category="cell">65535</block>
  <block id="c9f5a4d3ede4d084dda0a788ed06783c" category="paragraph">Para definir os parâmetros descritos nesta seção, você deve alterá-los no arquivo de configuração do MySQL (my.cnf). As melhores práticas da NetApp são resultado de testes realizados internamente.</block>
  <block id="df657260453f6ef228ee0ca22dd7a415" category="summary">Conteinerização MySQL</block>
  <block id="6a554ff1dc93539a626e576bf0d28a02" category="paragraph">Conteinerização de bancos de dados MySQL está se tornando mais prevalente.</block>
  <block id="bcc002a9f2e2ade112438f50a6630498" category="paragraph">O gerenciamento de contentores de baixo nível é quase sempre realizado através do Docker. As plataformas de gerenciamento de contêineres, como OpenShift e Kubernetes, simplificam ainda mais o gerenciamento de ambientes de contêineres grandes. Os benefícios da Conteinerização incluem custos mais baixos, porque não há necessidade de licenciar um hypervisor. Além disso, os containers permitem que vários bancos de dados sejam executados isolados uns dos outros enquanto compartilham o mesmo kernel subjacente e sistema operacional. Os contêineres podem ser provisionados em microssegundos.</block>
  <block id="14d9b10c6196045941347a9e85704b50" category="inline-link-macro">Documentação do Astra Trident</block>
  <block id="2828450fc6669c8df75f937e227996f1" category="doc">Descritores de arquivo MySQL</block>
  <block id="9420010a756fb6d3ddeadfa63d2170f6" category="paragraph">Para executar, o servidor MySQL precisa de descritores de arquivo e os valores padrão não são suficientes.</block>
  <block id="8e222c68dd214db9f8a1b5b572ee6267" category="paragraph">Ele os usa para abrir novas conexões, armazenar tabelas no cache, criar tabelas temporárias para resolver consultas complicadas e acessar as persistentes. Se o mysqld não for capaz de abrir novos arquivos quando necessário, ele pode parar de funcionar corretamente. Um sintoma comum deste problema é o erro 24, "muitos arquivos abertos". O número de descritores de arquivo que o mysqld pode abrir simultaneamente é definido pela<block ref="3d39e9c5aa2f78830dd6993cec18e93e" prefix=" " category="inline-code"></block> opção definida no arquivo de configuração <block ref="86d0d007043d911697753b35e2c18f35" prefix="(" category="inline-code"></block>). Mas<block ref="3d39e9c5aa2f78830dd6993cec18e93e" prefix=" " category="inline-code"></block> também depende dos limites do sistema operacional. Essa dependência torna a configuração da variável mais complicada.</block>
  <block id="07561a91f81dfe3c8e4364aac8bdbea4" category="paragraph">O MySQL não pode definir sua<block ref="3d39e9c5aa2f78830dd6993cec18e93e" prefix=" " category="inline-code"></block> opção mais alta do que a especificada em<block ref="dd1c6d8164dfd1cee0afa39b177e843b" prefix=" " category="inline-code"></block>. Portanto, você precisa definir explicitamente esses limites no nível do sistema operacional para permitir que o MySQL abra arquivos conforme necessário. Existem duas maneiras de verificar o limite de arquivos no Linux:</block>
  <block id="84e705ac120a887df441f4161dc29409" category="list-text">O<block ref="2eabb4efed7dffb32ea1170eab71b798" prefix=" " category="inline-code"></block> comando fornece rapidamente uma descrição detalhada dos parâmetros que estão sendo permitidos ou bloqueados. As alterações feitas ao executar este comando não são permanentes e serão apagadas após uma reinicialização do sistema.</block>
  <block id="a4c404dc92855948bc4c007a86091dbe" category="list-text">As alterações ao<block ref="b803f460349bd101b1de260021ef0e60" prefix=" " category="inline-code"></block> ficheiro são permanentes e não são afetadas pela reinicialização do sistema.</block>
  <block id="cbcab8220d4ffddbdc44f9936125d83d" category="paragraph">Certifique-se de alterar os limites físicos e macios para o usuário mysql. Os seguintes trechos são da configuração:</block>
  <block id="97dc47f90c600a96fac6642560ffaceb" category="paragraph">Em paralelo, atualize a mesma configuração no<block ref="90f16be5b82ca0aa94088c89fe00b3dd" prefix=" " category="inline-code"></block> para usar totalmente os limites de arquivos abertos.</block>
  <block id="b8c3891a902a70c4f7f774363652f4b4" category="summary">Estrutura de arquivos MySQL</block>
  <block id="4955922857da5499a2f1be602a96b0ff" category="paragraph">InnoDB atua como a camada intermediária entre o armazenamento e o servidor MySQL, ele armazena os dados nas unidades.</block>
  <block id="5d416cf65dd1e2c908bf430f957c89f8" category="paragraph">MySQL I/o é categorizado em dois tipos:</block>
  <block id="e8a320970c929abda9ae744b0b9e8f5f" category="list-text">E/S de arquivo aleatório</block>
  <block id="85430c0aa096ec282f2a14156baa312e" category="list-text">E/S de arquivo sequencial</block>
  <block id="b7b9a4c6983139a2673988826094a3cf" category="paragraph">Os arquivos de dados são lidos e substituídos aleatoriamente, o que resulta em IOPS alto. Portanto, o armazenamento SSD é recomendado.</block>
  <block id="322f79fd77365edecd173807cb429ca2" category="paragraph">Os arquivos de log de refazer e os arquivos de log binários são logs transacionais. Eles são escritos sequencialmente, para que você possa obter um bom desempenho em HDD com o cache de gravação. Uma leitura sequencial acontece na recuperação, mas raramente causa um problema de desempenho, porque o tamanho do arquivo de log geralmente é menor do que os arquivos de dados, e as leituras sequenciais são mais rápidas do que as leituras aleatórias (que ocorrem em arquivos de dados).</block>
  <block id="a898d206a27508975fea2e241af2f04e" category="paragraph">O buffer de gravação dupla é um recurso especial do InnoDB. O InnoDB primeiro grava páginas apagadas no buffer de gravação dupla e, em seguida, grava as páginas em suas posições corretas nos arquivos de dados. Este processo impede a corrupção de página. Sem o buffer de gravação dupla, a página pode ficar corrompida se ocorrer uma falha de energia durante o processo de gravação em unidades. Como a gravação no buffer de gravação dupla é sequencial, ele é altamente otimizado para HDDs. Leituras sequenciais ocorrem na recuperação.</block>
  <block id="363512900e45bc17bdd6edfa50582862" category="paragraph">Como o ONTAP NVRAM já fornece proteção contra gravação, o buffer de gravação dupla não é necessário. O MySQL tem um parâmetro,<block ref="02d3c518a4019ea00e34e16491d826b4" prefix=" " category="inline-code"></block>, para desativar o buffer de gravação dupla. Esse recurso pode melhorar substancialmente o desempenho.</block>
  <block id="49a7df723922bddb4df4002b51087a1c" category="paragraph">O buffer de inserção também é um recurso especial do InnoDB. Se blocos de índice secundários não exclusivos não estiverem na memória, o InnoDB insere entradas no buffer de inserção para evitar operações de e/S aleatórias. Periodicamente, o buffer de inserção é mesclado nas árvores de índice secundárias no banco de dados. O buffer de inserção reduz o número de operações de e/S mesclando solicitações de e/S para o mesmo bloco; operações de e/S aleatórias podem ser sequenciais. O buffer de inserção também é altamente otimizado para HDDs. As gravações e leituras sequenciais ocorrem durante operações normais.</block>
  <block id="6a0190340f27f29279bbfd319800289d" category="paragraph">Os segmentos de desfazer são orientados por e/S aleatórias. Para garantir a simultaneidade de múltiplas versões (MVCC), o InnoDB deve Registrar imagens antigas nos segmentos de desfazer. A leitura de imagens anteriores dos segmentos de desfazer requer leituras aleatórias. Se você executar uma transação longa com leituras repetíveis (como mysqldump - transação única) ou executar uma consulta longa, leituras aleatórias podem ocorrer. Portanto, armazenar segmentos de desfazer em SSDs é melhor nessa instância. Se você executar apenas transações curtas ou consultas, as leituras aleatórias não são um problema.</block>
  <block id="a27e0d4b650aa6db30fdd95b54c94b27" category="paragraph">*A NetApp recomenda* o seguinte layout de design de armazenamento devido às caraterísticas de e/S do InnoDB.</block>
  <block id="defc1bfda928f419df5e4af79c98343e" category="list-text">Um volume para armazenar arquivos aleatórios e sequenciais orientados por e/S do MySQL</block>
  <block id="7fd750411093ebd1faa0d99dd2608514" category="list-text">Outro volume para armazenar arquivos puramente sequenciais orientados por e/S do MySQL</block>
  <block id="0561a3b014eef0e5125fa63e1626cf57" category="paragraph">Esse layout também ajuda a projetar políticas e estratégias de proteção de dados.</block>
  <block id="c1c4e722764621d56a075e42ce48d0c0" category="summary">MySQL e innodb_buffer_pool_size</block>
  <block id="d7a8b502d05f5e477158eb80c1fb8dae" category="paragraph">O pool de buffers InnoDB é a parte mais importante de qualquer atividade de ajuste.</block>
  <block id="5cb6c45d18482180f34ae727b53379fb" category="paragraph">O InnoDB depende muito do pool de buffers para armazenar em cache índices e remendar os dados, o índice de hash adaptativo, o buffer de inserção e muitas outras estruturas de dados usadas internamente. O pool de buffers também armazena alterações nos dados para que as operações de gravação não precisem ser executadas imediatamente no armazenamento, melhorando assim o desempenho. O buffer pool é parte integrante do InnoDB e seu tamanho deve ser ajustado em conformidade. Considere os seguintes fatores ao definir o tamanho do pool de buffers:</block>
  <block id="03f07291794c3b9cb00d04cb9f30be81" category="list-text">Para uma máquina exclusiva InnoDB dedicada, defina o tamanho do pool de buffers para 80% ou mais da RAM disponível.</block>
  <block id="7b0119b7fa59f87d23d5c65da456b226" category="list-text">Se não for um servidor dedicado MySQL, defina o tamanho para 50% da RAM.</block>
  <block id="ae14ab6d1e5edd0e782d8897d1721eb4" category="summary">MySQL e innodb_doublewrite</block>
  <block id="14bdf3569ec0024259b2b02c5a668eae" category="paragraph"><block ref="7ccc31934ae8244d8263d3c09bcee186" prefix=" " category="inline-code"></block>Quando está ativado (o padrão), o InnoDB armazena todos os dados duas vezes: Primeiro para o buffer de gravação dupla e depois para os arquivos de dados reais.</block>
  <block id="9166d970028a28a614af39e6286371b7" category="paragraph">Você pode desativar esse parâmetro com<block ref="8cafbd8d9096941261e87f4f9152ab92" prefix=" " category="inline-code"></block> para benchmarks ou quando estiver mais preocupado com o desempenho superior do que com a integridade de dados ou possíveis falhas. InnoDB usa uma técnica de flush de arquivo chamada double-write. Antes de gravar páginas nos arquivos de dados, o InnoDB as grava em uma área contígua chamada buffer de gravação dupla. Depois que a gravação e o flush para o buffer de gravação dupla estiverem completos, o InnoDB grava as páginas em suas posições apropriadas no arquivo de dados. Se o sistema operacional ou um processo mysqld falhar durante uma gravação de página, o InnoDB poderá encontrar uma boa cópia da página do buffer de gravação dupla durante a recuperação de falhas.</block>
  <block id="3dfd4b9a526f8a8cf17021e34638b375" category="admonition">*A NetApp recomenda* a desativação do buffer de gravação dupla. O ONTAP NVRAM serve a mesma função. O buffer duplo danificará desnecessariamente o desempenho.</block>
  <block id="689c52e3f5db5d2dafccd7d93cf1abc4" category="summary">MySQL e innodb_flush_log_at_trx_commi</block>
  <block id="2f2c7742844f13de59d435b9099c78cc" category="paragraph">Quando há uma alteração nos dados, a alteração não é imediatamente gravada no armazenamento.</block>
  <block id="0b36b8f791a48c7b4692e7df069dabc8" category="paragraph">Em vez disso, os dados são gravados em um buffer de log, que é uma parte da memória que o InnoDB atribui a alterações de buffer que são registradas no arquivo de log. O InnoDB limpa o buffer para o arquivo de log quando uma transação é confirmada, quando o buffer fica cheio, ou uma vez por segundo, qualquer evento acontece primeiro. A variável de configuração que controla este processo é innodb_flush_log_at_trx_commit. As opções de valor incluem:</block>
  <block id="280a38864b81c14ba3db52801e087ed0" category="list-text">Quando você define<block ref="cab9a35054c49f0ba619a6e6943f461b" prefix=" " category="inline-code"></block>, o InnoDB grava os dados modificados (no pool de buffers do InnoDB) no arquivo de log (ib_logfile) e limpa o arquivo de log (gravação no armazenamento) a cada segundo. No entanto, não faz nada quando a transação é cometida. Se houver uma falha de energia ou falha do sistema, nenhum dos dados não lavados é recuperável porque não é gravado no arquivo de log ou nas unidades.</block>
  <block id="5967bb5566cb7cd8bdb0b372ceb21565" category="list-text">Quando você define<block ref="1ab7a7611b59147e84a38b6f3e7d9d09" prefix=" " category="inline-code"></block>o , o InnoDB grava o buffer de log no log de transações e passa para o armazenamento durável para cada transação. Por exemplo, para todos os commits de transação, o InnoDB grava no log e depois grava no armazenamento. O armazenamento mais lento afeta negativamente o desempenho; por exemplo, o número de transações InnoDB por segundo é reduzido.</block>
  <block id="9e9b3a43cb7a1b13c5ee3f6519d7f60e" category="list-text">Quando você define<block ref="44d4dfee9b1c95f8768bec989cd3baf5" prefix=" " category="inline-code"></block>, o InnoDB grava o buffer de log no arquivo de log em cada commit; no entanto, ele não grava dados no armazenamento. O InnoDB limpa os dados uma vez a cada segundo. Mesmo que haja uma falha de energia ou falha do sistema, os dados da opção 2 estão disponíveis no arquivo de log e são recuperáveis.</block>
  <block id="14f3e0328e25aa02b37bd6817a442a58" category="paragraph">Se o desempenho for o objetivo principal, defina o valor como 2. Como o InnoDB grava nas unidades uma vez por segundo, não para cada commit de transação, o desempenho melhora drasticamente. Se ocorrer uma falha de energia ou falha, os dados podem ser recuperados do log de transações.</block>
  <block id="4a34cbb1957909093a2e216fc1cd0962" category="paragraph">Se a segurança de dados for o objetivo principal, defina o valor como 1 para que, para cada commit de transação, o InnoDB seja enviado para as unidades. No entanto, o desempenho pode ser afetado.</block>
  <block id="53be3047aa6f8a62c640cc8b4d6089c6" category="admonition">*NetApp recomenda* defina o valor innodb_flush_log_trx_commit como 2 para um melhor desempenho.</block>
  <block id="6219c45bc8c26437c0b7e1a69d4cbe58" category="summary">MySQL e innodb_flush_Method</block>
  <block id="138738e11d5fda5c496edaa92e32e158" category="paragraph">O parâmetro innodb_flush_method especifica como o InnoDB abre e limpa os arquivos de log e dados.</block>
  <block id="c262c8cd82b96f69fbbc058d7a35683b" category="section-title">Otimizações</block>
  <block id="d1e67ebe6122765789852eb430c42c75" category="paragraph">Na otimização InnoDB, a configuração desse parâmetro ajusta o desempenho do banco de dados quando aplicável.</block>
  <block id="51ca63a7fb332d4d18e7139ea5787c50" category="paragraph">As seguintes opções são para limpar os arquivos através do InnoDB:</block>
  <block id="a9b8d4c72b58a9554274cba7904d47e2" category="list-text"><block ref="e590322920bebc1156ab585bd6597d76" prefix="" category="inline-code"></block>. O InnoDB usa a<block ref="4d0b2ade287f8f35e993511729bc75a1" prefix=" " category="inline-code"></block> chamada do sistema para liberar os arquivos de dados e log. Esta opção é a predefinição.</block>
  <block id="8198b1fd4bf2fafa4f4e8ffb4a8ac900" category="list-text"><block ref="a48be70a21bca2cf4b3e481efed66ae4" prefix="" category="inline-code"></block>. InnoDB usa a<block ref="a48be70a21bca2cf4b3e481efed66ae4" prefix=" " category="inline-code"></block> opção para abrir e lavar os arquivos de log e fsync() para lavar os arquivos de dados. InnoDB não usa<block ref="a48be70a21bca2cf4b3e481efed66ae4" prefix=" " category="inline-code"></block> diretamente, porque houve problemas com ele em muitas variedades de UNIX.</block>
  <block id="f89f9147df5dde99a7944d2028b59e7e" category="list-text"><block ref="6a334fd488ef92b18584207148410cc4" prefix="" category="inline-code"></block>. O InnoDB usa a<block ref="6a334fd488ef92b18584207148410cc4" prefix=" " category="inline-code"></block> opção (ou<block ref="42d27f470f62deaad644fef8618b59bb" prefix=" " category="inline-code"></block> no Solaris) para abrir os arquivos de dados e usa<block ref="4d0b2ade287f8f35e993511729bc75a1" prefix=" " category="inline-code"></block> para limpar os arquivos de dados e log. Esta opção está disponível em algumas versões GNU/Linux, FreeBSD e Solaris.</block>
  <block id="5e90100e134d805a66f8cda2e73f5298" category="list-text"><block ref="d66655d6d13113f23421f282ed1eaeb7" prefix="" category="inline-code"></block>. O InnoDB usa a<block ref="6a334fd488ef92b18584207148410cc4" prefix=" " category="inline-code"></block> opção durante a lavagem de e/S; no entanto, ele ignora a<block ref="4d0b2ade287f8f35e993511729bc75a1" prefix=" " category="inline-code"></block> chamada do sistema depois. Essa opção não é adequada para alguns tipos de sistemas de arquivos (por exemplo, XFS). Se você não tiver certeza se o sistema de arquivos requer uma<block ref="4d0b2ade287f8f35e993511729bc75a1" prefix=" " category="inline-code"></block> chamada de sistema, por exemplo, para preservar todos os metadados do arquivo, use a<block ref="6a334fd488ef92b18584207148410cc4" prefix=" " category="inline-code"></block> opção.</block>
  <block id="c680d437163cc6bab4f9bdb35c3073d0" category="section-title">Observação</block>
  <block id="907dee0040812e8e7d1fd00b870b5063" category="paragraph">Nos testes de laboratório do NetApp, a<block ref="e590322920bebc1156ab585bd6597d76" prefix=" " category="inline-code"></block> opção padrão foi usada em NFS e SAN, e foi um ótimo improvisador de desempenho em comparação com<block ref="6a334fd488ef92b18584207148410cc4" prefix=" " category="inline-code"></block>. Ao usar o método flush como<block ref="6a334fd488ef92b18584207148410cc4" prefix=" " category="inline-code"></block> no ONTAP, observamos que o cliente escreve muitas gravações de byte único na borda do bloco 4096 em modo serial. Essas gravações aumentam a latência na rede e degradam o desempenho.</block>
  <block id="62414a5a9c0e2fc12a8d028ad29164b8" category="summary">MySQL e innodb_io_Capacity</block>
  <block id="ac165f23bb7435219b226ed6e76c5fa4" category="paragraph">No plug-in InnoDB, um novo parâmetro chamado innodb_io_Capacity foi adicionado a partir do MySQL 5,7.</block>
  <block id="b4f38c42ef968074288f239b42e92b7f" category="paragraph">Ele controla o número máximo de IOPS que o InnoDB executa (que inclui a taxa de limpeza de páginas sujas, bem como o tamanho do lote do buffer de inserção [ibuf]). O parâmetro innodb_io_Capacity define um limite superior em IOPS por tarefas de fundo do InnoDB, como limpar páginas do pool de buffers e mesclar dados do buffer de mudança.</block>
  <block id="9679a08c293f29d9546c42207b09d418" category="paragraph">Defina o parâmetro innodb_io_Capacity para o número aproximado de operações de e/S que o sistema pode executar por segundo. Idealmente, mantenha a configuração o mais baixa possível, mas não tão baixa que as atividades de fundo desacelerem. Se a configuração for muito alta, os dados serão removidos do pool de buffers e inserirão o buffer muito rapidamente para que o armazenamento em cache forneça um benefício significativo.</block>
  <block id="668b6acc98c3469094062ed50b43e43a" category="admonition">*A NetApp recomenda* que, se estiver usando essa configuração em NFS, analise o resultado do teste de IOPS (SysBench/fio) e defina o parâmetro de acordo. Use o menor valor possível para flushing e purging para manter-se a menos que você veja mais páginas modificadas ou sujas do que você deseja no pool de buffers InnoDB.</block>
  <block id="038b11d42ee14bd77b6370c575c63b16" category="admonition">Não use valores extremos como 20.000 ou mais, a menos que você tenha provado que valores mais baixos não são suficientes para sua carga de trabalho.</block>
  <block id="62385f5ceb285bca676cb0561555d719" category="paragraph">O parâmetro InnoDB_io_Capacity regula as taxas de lavagem e e/S relacionadas</block>
  <block id="1339877637a3f7f59745a00e04f304fd" category="summary">MySQL e innodb_log_file_size</block>
  <block id="b8674b2897b288ca55b74328df4780b3" category="paragraph">Selecionar o tamanho certo para o tamanho do arquivo de log InnoDB é importante para as operações de gravação e para ter um tempo de recuperação decente após uma falha do servidor.</block>
  <block id="b61bad6f7bf48bf9abda0c86c9beed79" category="paragraph">Como muitas transações são registradas no arquivo, o tamanho do arquivo de log é importante para operações de gravação. Quando os Registros são modificados, a alteração não é imediatamente gravada de volta para o espaço da tabela. Em vez disso, a alteração é gravada no final do arquivo de log e a página é marcada como suja. InnoDB usa seu log para converter a e/S aleatória em e/S sequencial</block>
  <block id="e87d83a3c0af4df83efb4784b5182f8f" category="paragraph">Quando o log está cheio, a página suja é escrita para a tablespace em sequência para liberar espaço no arquivo de log. Por exemplo, suponha que um servidor trava no meio de uma transação, e as operações de gravação são registradas apenas no arquivo de log. Antes que o servidor possa voltar ao vivo, ele deve passar por uma fase de recuperação na qual as alterações registradas no arquivo de log são reproduzidas. Quanto mais entradas estiverem no arquivo de log, mais tempo leva para que o servidor se recupere.</block>
  <block id="8321756b7fedf72543a1b0917bf92613" category="paragraph">Neste exemplo, o tamanho do arquivo de log afeta tanto o tempo de recuperação quanto o desempenho de gravação. Ao escolher o número certo para o tamanho do arquivo de log, equilibre o tempo de recuperação em relação ao desempenho de gravação. Normalmente, qualquer coisa entre 128M e 512M é um bom valor.</block>
  <block id="d5ef0a45fe252b03f538bfd134b168db" category="summary">MySQL e innodb_lru_Scan_Depth</block>
  <block id="29d0f4f8b383d39e73abd11ac73ca28a" category="paragraph">O<block ref="3ee58d04a0dc9b2551698643e0421005" prefix=" " category="inline-code"></block> parâmetro influencia os algoritmos e heurísticas da operação de flush para o pool de buffers InnoDB.</block>
  <block id="eeb16232629bd788f0d29c104105bba2" category="paragraph">Esse parâmetro é do interesse principal dos especialistas em performance que ajustam workloads com uso intenso de e/S. Para cada instância de pool de buffer, este parâmetro especifica o quão abaixo na lista de páginas menos usadas recentemente (LRU) o thread de limpeza de páginas deve continuar a digitalizar, procurando páginas sujas para serem flush. Esta operação em segundo plano é executada uma vez por segundo.</block>
  <block id="39359bf2914e4e1cf84a9dea580fd20a" category="paragraph">Você pode ajustar o valor para cima ou para baixo para minimizar o número de páginas livres. Não defina o valor muito maior do que o necessário, porque as digitalizações podem ter um custo de desempenho significativo. Além disso, considere ajustar esse parâmetro ao alterar o número de instâncias do pool de buffers,<block ref="f2c8312d381c16c6c95a727c3f61a4c7" prefix=" " category="inline-code"></block> porque define a quantidade de trabalho executada pelo thread de limpeza de páginas a cada segundo.</block>
  <block id="513a275422fae2456617321a2f3fc0af" category="paragraph">Uma configuração menor do que o padrão é adequada para a maioria das cargas de trabalho. Considere aumentar o valor somente se você tiver capacidade de e/S sobressalente em uma carga de trabalho típica. Por outro lado, se uma carga de trabalho com uso intenso de gravação saturar a capacidade de e/S, diminua o valor, especialmente se você tiver um grande pool de buffers.</block>
  <block id="10eb8b7e75da1815860da31490513841" category="summary">MySQL com NFS</block>
  <block id="0e5e83102103fcdd25af430bf7327034" category="paragraph">A documentação do MySQL recomenda que você use o NFSv4 para implantações nas.</block>
  <block id="ca0d9fdc80b88e73b548638af421788f" category="section-title">Tamanhos de transferência de NFS do ONTAP</block>
  <block id="efcd0ba3fcbee9896a25804677e70b4b" category="paragraph">Por padrão, o ONTAP limitará os tamanhos de e/S NFS a 64K. Random IO com um banco de dados MySQL usa um tamanho de bloco muito menor que está bem abaixo do máximo de 64KMB. O IO de bloco grande geralmente é paralelizado, portanto o máximo de 64K também não é uma limitação.</block>
  <block id="4655f686de75b23f16d530ed7351c447" category="paragraph">Existem algumas cargas de trabalho em que o máximo 64K cria uma limitação. Em particular, operações de um único processo, como operações de backup de verificação de tabela completa, serão executadas de forma mais rápida e eficiente se o banco de dados puder executar menos, mas maiores. O tamanho ideal de manuseio de e/S para ONTAP com cargas de trabalho de banco de dados é 256K. As opções de montagem NFS listadas para sistemas operacionais específicos abaixo foram atualizadas de 64K para 256K em conformidade.</block>
  <block id="3ab93db30f3dded2c8d71859afbb53f6" category="admonition">Nunca diminua o tamanho máximo de transferência permitido no ONTAP abaixo do valor de rsize/wsize dos sistemas de arquivos NFS atualmente instalados. Isso pode criar pendências ou até mesmo corrupção de dados com alguns sistemas operacionais. Por exemplo, se os clientes NFS estiverem atualmente definidos em um rsize/wsize de 65536, o tamanho máximo de transferência do ONTAP poderá ser ajustado entre 65536 e 1048576 sem efeito, porque os próprios clientes são limitados. Reduzir o tamanho máximo de transferência abaixo de 65536 pode danificar a disponibilidade ou os dados.</block>
  <block id="5ea0bb5d4dab46d7971fef94ccde9369" category="paragraph">*A NetApp recomenda*</block>
  <block id="09c6aa928c90ba68a4e03deadfeaa644" category="paragraph">Configurando a seguinte configuração NFSv4 fstab (/etc/fstab):</block>
  <block id="0ae3c9648bc2d8c33fa57415604da370" category="paragraph"><block ref="a63a3dc825ff52908de7c9dfcb29ffa5" prefix="" category="inline-code"></block></block>
  <block id="3e0b2c100b093560f63ad57c6849bc8a" category="admonition">Um problema comum com o NFSv3 foi os arquivos de log do InnoDB bloqueados após uma falha de energia. Usar o tempo ou trocar arquivos de log resolveu esse problema. No entanto, o NFSv4 tem operações de bloqueio e mantém o controle de arquivos abertos e delegações.</block>
  <block id="72985ac51e91797345b2437088a4362e" category="summary">MySQL com SAN</block>
  <block id="58d94bb6e53e154e2f4b16efa09f4c0d" category="paragraph">Bancos de dados menores podem ser colocados em um par de LUNs padrão, desde que as demandas de e/S e capacidade estejam dentro dos limites de um único sistema de arquivos LUN. Por exemplo, um banco de dados que requer aproximadamente 2K IOPS aleatório pode ser hospedado em um único sistema de arquivos em um único LUN. Da mesma forma, um banco de dados com apenas 100GB MB de tamanho caberia em um único LUN sem criar um problema de gerenciamento.</block>
  <block id="c33bcb4f520265bb106616e844397ffb" category="paragraph">Bancos de dados maiores exigem vários LUNs. Por exemplo, um banco de dados que requer 100K IOPS provavelmente precisará de pelo menos oito LUNs. Um único LUN se tornaria um gargalo devido ao número inadequado de canais SCSI para unidades. Um banco de dados 10TB seria igualmente difícil de gerenciar em um único LUN 10TB. Os gerenciadores lógicos de volume são projetados para unir os recursos de desempenho e capacidade de vários LUNs para melhorar o desempenho e a capacidade de gerenciamento.</block>
  <block id="428e88a1415b00f5eb396829b4bd9a2c" category="paragraph">Em ambos os casos, um par de volumes ONTAP deve ser suficiente. Com uma configuração simples, o LUN do arquivo de dados seria colocado em um volume dedicado, assim como o LUN de log. Com uma configuração lógica do gerenciador de volumes, todos os LUNs no grupo de volumes de arquivos de dados estariam em um volume dedicado e os LUNs do grupo de volumes de log estariam em um segundo volume dedicado.</block>
  <block id="e8c31916b755be39cb0a66804a1d8f8b" category="paragraph">*A NetApp recomenda* usando dois sistemas de arquivos para implantações MySQL na SAN:</block>
  <block id="fe9d8ca2c46747e16ed31f64638e66e6" category="list-text">O primeiro sistema de arquivos armazena todos os dados MySQL, incluindo tablespace, dados e índice.</block>
  <block id="04d82ed32fa1eeaa6df117c178062441" category="list-text">O segundo sistema de arquivos armazena todos os logs (logs binários, logs lentos e logs de transações).</block>
  <block id="15bcb76b7e8b441c0d2a6e723f70c20c" category="paragraph">Existem várias razões para separar dados dessa maneira, incluindo:</block>
  <block id="02774797d31a8f1c6d805860038c32a3" category="list-text">Os padrões de e/S de arquivos de dados e arquivos de log diferem. Separá-los permitiria mais opções com controles de QoS.</block>
  <block id="6cab2c793e807e2d0c57f5b0d96505c1" category="list-text">O uso ideal da tecnologia Snapshot requer a capacidade de restaurar os arquivos de dados de forma independente. Commingling arquivos de dados com arquivos de log interfere com a restauração de arquivos de dados.</block>
  <block id="553ad1f7b6f5cfee021e5cf56e56a289" category="list-text">A tecnologia NetApp SnapMirror pode ser usada para fornecer uma funcionalidade de recuperação de desastres simples e de baixo RPO para um banco de dados. No entanto, ela requer diferentes programações de replicação para arquivos e logs de dados.</block>
  <block id="ff5f52a69a35dd41da3e3c4b810e4f94" category="admonition">Use esse layout básico de dois volumes para preparar a solução para o futuro, de modo que todos os recursos do ONTAP possam ser usados, se necessário.</block>
  <block id="7b755794e9de5716b2d6305bd10bee1b" category="paragraph">*A NetApp recomenda* a formatação da sua unidade com o sistema de arquivos ext4 devido aos seguintes recursos:</block>
  <block id="fa92f58d5035dec5e24a787f76504783" category="list-text">Abordagem estendida aos recursos de gerenciamento de blocos usados no sistema de arquivos de journaling (JFS) e recursos de alocação atrasada do sistema de arquivos estendido (XFS).</block>
  <block id="a72d73cde02c10703b72dcae6bc7c812" category="list-text">EXT4 permite sistemas de arquivos de até 1 exbibyte (2 60 bytes) e arquivos de até 16 tebibytes (16 * 2 40 bytes). Em contraste, o sistema de arquivos ext3 suporta apenas um tamanho máximo de sistema de arquivos de 16TB e um tamanho máximo de arquivo de 2TB.</block>
  <block id="56b4168424fa999bc383d24daf2da4eb" category="list-text">Em sistemas de arquivos ext4, a alocação de vários blocos (mballoc) aloca vários blocos para um arquivo em uma única operação, em vez de alocá-los um por um, como em ext3. Essa configuração reduz a sobrecarga de chamar o alocador de bloco várias vezes e otimiza a alocação de memória.</block>
  <block id="632635d22b347f0140fb15d0eb0ed09e" category="list-text">Embora o XFS seja o padrão para muitas distribuições Linux, ele gerencia metadados de forma diferente e não é adequado para algumas configurações do MySQL.</block>
  <block id="aff8b2ed0a4719f014e5baeb861ea7d4" category="paragraph">*A NetApp recomenda* usar opções de tamanho de bloco 4K com o utilitário mkfs para alinhar com o tamanho de LUN de bloco existente.</block>
  <block id="0a24d0336b7b0b29a9daa97f88499884" category="paragraph"><block ref="018d13c1d8b9abcae080b8abbc7c2d8b" prefix="" category="inline-code"></block></block>
  <block id="86fc8cb3bf2cae621315896a94b35f67" category="paragraph">Os LUNs NetApp armazenam dados em 4KB blocos físicos, o que rende oito blocos lógicos de 512 bytes.</block>
  <block id="5f441ceabc94de2a9cced94d9f53a2d0" category="paragraph">Se você não configurar o mesmo tamanho de bloco, a e/S não será alinhada com os blocos físicos corretamente e poderá gravar em duas unidades diferentes em um grupo RAID, resultando em latência.</block>
  <block id="236ac851d05b8822524001920948f23d" category="admonition">É importante alinhar a e/S para operações de leitura/gravação suaves. No entanto, quando a e/S começa em um bloco lógico que não está no início de um bloco físico, a e/S está desalinhada. As operações de e/S são alinhadas somente quando começam em um bloco lógico, o primeiro bloco lógico em um bloco físico.</block>
  <block id="35d1a5d7b12999ec27f5233dccba043f" category="summary">MySQL e open_file_limits</block>
  <block id="2f0b9319cf6d59e07ea4b1ef65a12be1" category="doc">open_file_limits</block>
  <block id="11e52b21a9795b7dcf947027b0ec5d01" category="paragraph">O<block ref="2f0b9319cf6d59e07ea4b1ef65a12be1" prefix=" " category="inline-code"></block> parâmetro determina o número de arquivos que o sistema operacional permite que o mysqld abra.</block>
  <block id="e0732f22b2900006e8fcb6367fd162f7" category="paragraph">O valor deste parâmetro em tempo de execução é o valor real permitido pelo sistema e pode ser diferente do valor especificado na inicialização do servidor. O valor é 0 em sistemas onde o MySQL não pode alterar o número de arquivos abertos. O valor efetivo<block ref="3d39e9c5aa2f78830dd6993cec18e93e" prefix=" " category="inline-code"></block> é baseado no valor especificado na inicialização do sistema (se houver) e nos valores de<block ref="0bc91339c0d774f560a9a38fc9dfac30" prefix=" " category="inline-code"></block> e<block ref="023a3b50ddf424c9a1d51984190a0c92" prefix=" " category="inline-code"></block> usando estas fórmulas:</block>
  <block id="6b840ff0a7667f4642a0844269657fc4" category="list-text">10<block ref="0bc91339c0d774f560a9a38fc9dfac30" prefix=" " category="inline-code"></block> <block ref="023a3b50ddf424c9a1d51984190a0c92" prefix="(" category="inline-code"></block>x 2)</block>
  <block id="d3de183489c20b8efa2947eeff3028d7" category="list-text"><block ref="0bc91339c0d774f560a9a38fc9dfac30" prefix="" category="inline-code"></block> x 5</block>
  <block id="2c08922fbaba089e7c2982df43fd352a" category="list-text">Limite do sistema operacional se positivo</block>
  <block id="8ca153937fcbdf56497ad779a91f31d1" category="list-text">Se o limite do sistema operacional for infinito:<block ref="3d39e9c5aa2f78830dd6993cec18e93e" prefix=" " category="inline-code"></block> O valor é especificado na inicialização; 5.000 se nenhum</block>
  <block id="98038bb4026a70f5ee4041522c6eebe4" category="paragraph">O servidor tenta obter o número de descritores de arquivo usando o máximo desses quatro valores. Se muitos descritores não puderem ser obtidos, o servidor tentará obter o máximo que o sistema permitir.</block>
  <block id="1bc6cee680286aae1b12889369b7f18a" category="summary">MySQL no ONTAP</block>
  <block id="598132a821e8cc696fbbae934047d991" category="paragraph">MySQL e suas variantes, incluindo MariaDB e Percona MySQL, é o banco de dados mais popular do mundo.</block>
  <block id="fd95362fecccbbb7b017317e8bede3b5" category="admonition">Esta documentação sobre o ONTAP e o banco de dados MySQL substitui o banco de dados _TR-4722: MySQL publicado anteriormente sobre as melhores práticas do ONTAP._</block>
  <block id="bf2bdc980948fb9084a63963398846b2" category="paragraph">ONTAP é uma plataforma ideal para banco de dados MySQL porque o ONTAP é literalmente projetado para bancos de dados. Vários recursos, como otimizações aleatórias de latência de e/S para qualidade avançada de serviço (QoS) e funcionalidade básica do FlexClone, foram criados especificamente para atender às necessidades dos workloads de banco de dados.</block>
  <block id="1429a98a71e16287326edd7fc1f999fd" category="paragraph">Recursos adicionais, como atualizações sem interrupções, (incluindo substituição de storage) garantem que seus bancos de dados essenciais permaneçam disponíveis. Você também pode ter recuperação instantânea de desastres para ambientes grandes por meio do MetroCluster ou selecionar bancos de dados usando o SnapMirror active Sync.</block>
  <block id="1b3804b7e2292e18f5e66d54f7a9fafc" category="paragraph">Mais importante ainda, o ONTAP oferece desempenho incomparável com a capacidade de dimensionar a solução para suas necessidades exclusivas. Nossos sistemas high-end podem fornecer mais de 1M IOPS com latências medidas em microssegundos. No entanto, se você só precisa de 100K IOPS, é possível dimensionar corretamente sua solução de storage com uma controladora menor que ainda executa o mesmo sistema operacional de storage.</block>
  <block id="639600080c225673dfdfa012fdbd6146" category="summary">Agendadores MySQL e IO</block>
  <block id="215dca219378b291ae287eb076489fdd" category="paragraph">O kernel Linux permite um controle de baixo nível sobre a maneira como e/S para bloquear dispositivos é agendada.</block>
  <block id="dc36d23ef487690f1698c69d9e49cee2" category="paragraph">Os padrões em várias distribuições do Linux variam consideravelmente. O MySQL recomenda que você use<block ref="722d122e81cbbe543bd5520bb8678c0e" prefix=" " category="inline-code"></block> ou um<block ref="30e482a8ab57cfc19075dece53b0a56b" prefix=" " category="inline-code"></block> agendador de e/S com e/S assíncrona nativa (AIO) no Linux. Em geral, os clientes da NetApp e os testes internos mostram melhores resultados com NoOps.</block>
  <block id="6def78482bd1915cb81f0f5c19ee8fe6" category="paragraph">O mecanismo de armazenamento InnoDB do MySQL usa o subsistema de e/S assíncrono (AIO nativo) no Linux para executar solicitações de leitura e gravação para páginas de arquivos de dados. Esse comportamento é controlado pela<block ref="2c03186a22d036ce7dad84be5de2f2ce" prefix=" " category="inline-code"></block> opção de configuração, que é ativada por padrão. Com AIO nativo, o tipo de agendador de e/S tem maior influência no desempenho de e/S. Realize benchmarks para determinar qual agendador de e/S fornece os melhores resultados para sua carga de trabalho e ambiente.</block>
  <block id="e7b09beaf26efc7d8bee91786cf794b5" category="paragraph">Consulte a documentação relevante do Linux e MySQL para obter instruções sobre como configurar o agendador de e/S.</block>
  <block id="5249e05857621fbfae51371a73006c44" category="summary">MySQL e NFSv3 tabelas de slots</block>
  <block id="d058f95e3a8d4b7b46802139d6b95982" category="paragraph">O desempenho do NFSv3 no Linux depende de um parâmetro<block ref="453f2cc2326f82af1053f4aa4b75400b" prefix=" " category="inline-code"></block> chamado .</block>
  <block id="454ff7e5f4a8d37cf6b16b804deca2b6" category="summary">Tamanhos de bloco de banco de dados Oracle</block>
  <block id="f8b42f9efd1a05ede10b0e0c11dfa8b0" category="paragraph">O ONTAP usa internamente um tamanho de bloco variável, o que significa que os bancos de dados Oracle podem ser configurados com qualquer tamanho de bloco desejado. No entanto, os tamanhos de bloco de sistema de arquivos podem afetar o desempenho e, em alguns casos, um tamanho maior de bloco de refazer pode melhorar o desempenho.</block>
  <block id="0944aedb4703c4a5e94fb90de9d7a22f" category="section-title">Tamanhos de blocos de arquivos de dados</block>
  <block id="cc4662c047050e0082701ce6f052dcb7" category="paragraph">Alguns sistemas operacionais oferecem uma escolha de tamanhos de bloco de sistema de arquivos. Para sistemas de arquivos que suportam datafiles Oracle, o tamanho do bloco deve ser 8KB quando a compactação é usada. Quando a compressão não é necessária, um tamanho de bloco de 8KB ou 4KB pode ser usado.</block>
  <block id="e1a001cf8c7e2072c7a44ee65e8fee11" category="paragraph">Se um arquivo de dados for colocado em um sistema de arquivos com um bloco de 512 bytes, arquivos desalinhados são possíveis. O LUN e o sistema de arquivos podem estar alinhados adequadamente com base nas recomendações do NetApp, mas a e/S do arquivo estaria desalinhada. Tal desalinhamento causaria graves problemas de desempenho.</block>
  <block id="9514c8638f798f68108498dd218ec793" category="paragraph">Os sistemas de arquivos que suportam os logs de refazer devem usar um tamanho de bloco que seja um múltiplo do tamanho do bloco de refazer. Isso geralmente requer que o sistema de arquivos de log refazer e o log refazer usem um tamanho de bloco de 512 bytes.</block>
  <block id="cac7d87a1164763b666ca7d02109d153" category="section-title">Refazer tamanhos de bloco</block>
  <block id="fa06b9584ea36af182742c07894220f0" category="paragraph">Com taxas de recozimento muito altas, é possível que 4KB tamanhos de bloco tenham um melhor desempenho, pois altas taxas de recozimento permitem que a e/S seja executada em operações cada vez menores e mais eficientes. Se as taxas de refazer forem maiores que 50Mbps, considere testar um tamanho de bloco 4KB.</block>
  <block id="781000593b4913b5625dd5ed9eebe87e" category="paragraph">Alguns problemas de clientes foram identificados com bancos de dados usando logs de refazer com um tamanho de bloco de 512 bytes em um sistema de arquivos com um tamanho de bloco de 4KB e muitas transações muito pequenas. A sobrecarga envolvida na aplicação de várias alterações de 512 bytes a um único bloco de sistema de arquivos 4KB levou a problemas de desempenho que foram resolvidos alterando o sistema de arquivos para usar um tamanho de bloco de 512 bytes.</block>
  <block id="a02416fde36b174cf1196213fcf1bef6" category="admonition">*A NetApp recomenda* que você não altere o tamanho do bloco refazer, a menos que seja aconselhado por uma organização de suporte ao cliente ou serviços profissionais relevante ou que a alteração seja baseada na documentação oficial do produto.</block>
  <block id="50ae143b75fc238e91c09c750cf211c1" category="summary">Parâmetros do banco de dados Oracle - filestimio_options</block>
  <block id="a3f7c31b8d967e0ac9f9dd30fc81c061" category="paragraph">O parâmetro de inicialização do Oracle<block ref="f1110589be196c2310808482067fce1b" prefix=" " category="inline-code"></block> controla o uso de e/S assíncrona e direta</block>
  <block id="d1fa3441fd96418a75a509ac2907d644" category="paragraph">Ao contrário da crença comum, a e/S assíncrona e direta não são mutuamente exclusivas. A NetApp observou que esse parâmetro é frequentemente mal configurado em ambientes de clientes, e essa configuração incorreta é diretamente responsável por muitos problemas de desempenho.</block>
  <block id="0775b72ddf51e2a16e466ee2df8f75ab" category="paragraph">E/S assíncrona significa que as operações de e/S Oracle podem ser paralelizadas. Antes da disponibilidade de e/S assíncrona em vários sistemas operacionais, os usuários configuraram vários processos dbwriter e alteraram a configuração do processo do servidor. Com e/S assíncrona, o próprio sistema operacional executa e/S em nome do software de banco de dados de maneira altamente eficiente e paralela. Esse processo não coloca os dados em risco, e operações críticas, como o Oracle refazer o log, ainda são executadas de forma síncrona.</block>
  <block id="6b72950206966c1983e559eb6886ec69" category="paragraph">A e/S direta ignora o cache do buffer do sistema operacional. E/S em um sistema UNIX normalmente flui através do cache de buffer do sistema operacional. Isso é útil para aplicativos que não mantêm um cache interno, mas o Oracle tem seu próprio cache de buffer dentro do SGA. Em quase todos os casos, é melhor habilitar e/S direta e alocar RAM do servidor para o SGA em vez de confiar no cache de buffer do sistema operacional. O Oracle SGA usa a memória de forma mais eficiente. Além disso, quando a e/S flui pelo buffer do sistema operacional, ela está sujeita a processamento adicional, o que aumenta as latências. As latências aumentadas são especialmente percetíveis com e/S de gravação intensa quando a baixa latência é um requisito essencial.</block>
  <block id="d8590a940a5bb30d8a845f4359f3c779" category="paragraph">As opções para<block ref="f1110589be196c2310808482067fce1b" prefix=" " category="inline-code"></block> são:</block>
  <block id="0aea10c6719256027228a859db38f291" category="list-text">*assíncrono.* A Oracle envia solicitações de e/S para o sistema operacional para processamento. Esse processo permite que a Oracle execute outro trabalho em vez de esperar pela conclusão de e/S e, assim, aumenta a paralelização de e/S.</block>
  <block id="00cb0cc309682c42b3b936a19a042434" category="list-text">*directio.* A Oracle executa e/S diretamente contra arquivos físicos em vez de rotear e/S pelo cache do sistema operacional do host.</block>
  <block id="f9941e1b6cc84711e95db0e757efc36a" category="list-text">*nenhum.* A Oracle usa e/S síncrona e em buffer Nesta configuração, a escolha entre processos de servidor compartilhado e dedicado e o número de dbwriters são mais importantes.</block>
  <block id="f0939ff6231565c83c5c8c9ce1eddc9d" category="list-text">* setall.* A Oracle usa e/S assíncrona e direta Em quase todos os casos, o uso de<block ref="aef8f91b1e026cc1bb55e8b08c491d35" prefix=" " category="inline-code"></block> é ideal.</block>
  <block id="8647b2eaf101a9425f69e6f2e67aeb9d" category="admonition">O<block ref="f1110589be196c2310808482067fce1b" prefix=" " category="inline-code"></block> parâmetro não tem efeito em ambientes DNFS e ASM. O uso de DNFS ou ASM resulta automaticamente no uso de e/S assíncrona e direta</block>
  <block id="6dd5604aa0be2956f8b1b41c74fa648e" category="paragraph">Alguns clientes encontraram problemas assíncronos de I/o no passado, especialmente com versões anteriores do Red Hat Enterprise Linux 4 (RHEL4). Alguns conselhos desatualizados na internet ainda sugerem evitar IO assíncrono por causa de informações desatualizadas. E/S assíncrona é estável em todos os sistemas operacionais atuais. Não há razão para desativá-lo, ausente um bug conhecido com o sistema operacional.</block>
  <block id="1ea377466376b194b2d1bfc3ab2fa4c4" category="paragraph">Se um banco de dados tiver usado e/S em buffer, um switch para direcionar e/S também pode garantir uma alteração no tamanho do SGA. A desativação da e/S armazenada em buffer elimina o benefício de desempenho que o cache do sistema operacional do host fornece para o banco de dados. Adicionar RAM de volta ao SGA repara este problema. O resultado líquido deve ser uma melhoria no desempenho de e/S.</block>
  <block id="787b3d8b62af05ac3efd1c9ca7a8fc7e" category="paragraph">Embora seja quase sempre melhor usar RAM para o Oracle SGA do que para cache de buffer do SO, pode ser impossível determinar o melhor valor. Por exemplo, pode ser preferível usar e/S em buffer com tamanhos SGA muito pequenos em um servidor de banco de dados com muitas instâncias Oracle ativas intermitentemente. Este arranjo permite o uso flexível da RAM livre restante no sistema operacional por todas as instâncias de banco de dados em execução. Esta é uma situação altamente incomum, mas tem sido observada em alguns sites de clientes.</block>
  <block id="d4157ab77eb31459bd406aa0f873e20c" category="admonition">*A NetApp recomenda* a configuração<block ref="f1110589be196c2310808482067fce1b" prefix=" " category="inline-code"></block> para<block ref="aef8f91b1e026cc1bb55e8b08c491d35" prefix=" " category="inline-code"></block>, mas esteja ciente de que, em algumas circunstâncias, a perda do cache de buffer do host pode exigir um aumento no SGA Oracle.</block>
  <block id="ba5a23e78f51c1bcb1b82efbe1797502" category="summary">Parâmetros do banco de dados Oracle - dB_file_multiblock_read_count</block>
  <block id="32faf0a922da10425f2be9f86a5f5e18" category="paragraph">O<block ref="d3cc759510a3aba837fc8efeb2e24b91" prefix=" " category="inline-code"></block> parâmetro controla o número máximo de blocos de banco de dados Oracle que o Oracle lê como uma única operação durante a e/S sequencial</block>
  <block id="36cb03af3dc688208e0e94fda31ca7a4" category="paragraph">Este parâmetro não afeta, no entanto, o número de blocos que o Oracle lê durante todas e quaisquer operações de leitura, nem afeta e/S aleatórias Apenas o tamanho de bloco de e/S sequenciais é afetado.</block>
  <block id="2565c992b3732464484104f4c846d9b4" category="paragraph">A Oracle recomenda que o usuário deixe esse parâmetro desconfigurado. Isso permite que o software de banco de dados defina automaticamente o valor ideal. Isso geralmente significa que esse parâmetro é definido para um valor que produz um tamanho de e/S de 1MB. Por exemplo, uma leitura 1MB de 8KB blocos exigiria que 128 blocos fossem lidos, e o valor padrão para este parâmetro seria, portanto, 128.</block>
  <block id="0fd26e725a6c1a81508e013094776e2c" category="paragraph">A maioria dos problemas de desempenho do banco de dados observados pelo NetApp nas instalações dos clientes envolve uma configuração incorreta para este parâmetro. Houve razões válidas para alterar esse valor com as versões 8 e 9 do Oracle. Como resultado, o parâmetro pode estar inconscientemente presente em<block ref="b6bd7c570605affc5b50bbd3e436f0c0" prefix=" " category="inline-code"></block> arquivos porque o banco de dados foi atualizado para o Oracle 10 e posterior. Uma configuração legada de 8 ou 16, comparada a um valor padrão de 128, danifica significativamente o desempenho de e/S sequenciais.</block>
  <block id="3f594bb922365c7a9f095f44822fa22e" category="admonition">*NetApp recomenda* a configuração<block ref="d3cc759510a3aba837fc8efeb2e24b91" prefix=" " category="inline-code"></block> do parâmetro não deve estar presente no<block ref="b6bd7c570605affc5b50bbd3e436f0c0" prefix=" " category="inline-code"></block> arquivo. O NetApp nunca encontrou uma situação em que a alteração desse parâmetro melhorou o desempenho, mas há muitos casos em que causou danos claros ao throughput sequencial de e/S.</block>
  <block id="35ebaedc3385b350dff13e0cfa869c9f" category="summary">Tempos limite do Oracle RAC</block>
  <block id="0eec903bb9d87349e379892ca99ef9ec" category="paragraph">O Oracle RAC é um produto exclusivo com vários tipos de processos internos de heartbeat que monitoram a integridade do cluster.</block>
  <block id="7c13d022c9fda6e792c4349a043a6c74" category="inline-link-macro">número de identificação</block>
  <block id="bab4ae46619fcbbb84e3375ef205e61c" category="admonition">As informações na <block ref="9cd17d807316d35ef47b12cbecab4ec8" category="inline-link-macro-rx"></block> seção incluem informações críticas para ambientes Oracle RAC que usam armazenamento em rede e, em muitos casos, as configurações padrão do Oracle RAC precisarão ser alteradas para garantir que o cluster RAC sobreviva às alterações do caminho da rede e às operações de failover/switchover de armazenamento.</block>
  <block id="0494651671c3dc7f1ccdf99a4368a2cf" category="section-title">disktimeout</block>
  <block id="1973cfff3b7c6d828ede9d420b8481b5" category="paragraph">O parâmetro RAC principal relacionado ao armazenamento é<block ref="0494651671c3dc7f1ccdf99a4368a2cf" prefix=" " category="inline-code"></block>. Este parâmetro controla o limite dentro do qual a e/S do arquivo de votação deve ser concluída. Se o<block ref="0494651671c3dc7f1ccdf99a4368a2cf" prefix=" " category="inline-code"></block> parâmetro for excedido, o nó RAC será despejado do cluster. O padrão para este parâmetro é 200. Este valor deve ser suficiente para os procedimentos normais de aquisição de armazenamento e de giveback.</block>
  <block id="4aa33fc988e36b9531d36da80d35ec2f" category="paragraph">A NetApp recomenda fortemente testar cuidadosamente as configurações do RAC antes de colocá-las em produção, pois muitos fatores afetam uma aquisição ou a giveback. Além do tempo necessário para a conclusão do failover de armazenamento, também é necessário tempo adicional para que as alterações do protocolo de controle de agregação de link (LACP) se propaguem. Além disso, o software de multipathing SAN deve detetar um tempo limite de e/S e tentar novamente em um caminho alternativo. Se um banco de dados estiver extremamente ativo, uma grande quantidade de e/S deve ser enfileirada e tentada novamente antes de o disco de votação ser processado.</block>
  <block id="655a10764a0781d26dca3bfb939457b7" category="paragraph">Se não for possível executar uma aquisição de armazenamento real ou giveback, o efeito poderá ser simulado com testes de pull de cabo no servidor de banco de dados.</block>
  <block id="b2a9e8dd67b2d9a7333cb2c2495c2aa5" category="list-text">Deixando o<block ref="0494651671c3dc7f1ccdf99a4368a2cf" prefix=" " category="inline-code"></block> parâmetro no valor padrão de 200.</block>
  <block id="971a52f4b805c654dd133cf142457c53" category="list-text">Sempre teste uma configuração RAC completamente.</block>
  <block id="cd7a91511dbfbe5c79de12fa7d394dc0" category="paragraph">O<block ref="7c13d022c9fda6e792c4349a043a6c74" prefix=" " category="inline-code"></block> parâmetro normalmente afeta apenas o batimento cardíaco da rede entre nós RAC. O padrão é 30 segundos. Se os binários de grade estiverem em um storage array ou a unidade de inicialização do sistema operacional não for local, esse parâmetro pode se tornar importante. Isso inclui hosts com unidades de inicialização localizadas em uma SAN FC, sistemas operacionais iniciados por NFS e unidades de inicialização localizados em datastores de virtualização, como um arquivo VMDK.</block>
  <block id="9c1fd24d7d8e04847dadb944a6643121" category="paragraph">Se o acesso a uma unidade de inicialização for interrompido por uma aquisição de armazenamento ou giveback, é possível que a localização binária da grade ou todo o sistema operacional fique temporariamente suspenso. O tempo necessário para o ONTAP concluir a operação de storage e para o sistema operacional alterar caminhos e retomar e/S pode exceder o<block ref="7c13d022c9fda6e792c4349a043a6c74" prefix=" " category="inline-code"></block> limite. Como resultado, um nó é despejado imediatamente após a conetividade com o LUN de inicialização ou binários de grade ser restaurada. Na maioria dos casos, o despejo e a reinicialização subsequente ocorrem sem mensagens de Registro para indicar o motivo da reinicialização. Nem todas as configurações são afetadas, portanto, teste qualquer host baseado em SAN-boot, NFS-boot ou datastore em um ambiente RAC para que o RAC permaneça estável se a comunicação com a unidade de inicialização for interrompida.</block>
  <block id="2b875dbca82565f3d7e2fa51633bc2c9" category="paragraph">No caso de unidades de inicialização não locais ou binários de hospedagem de sistemas de arquivos não locais<block ref="ff4a008470319a22d9cf3d14af485977" prefix=" " category="inline-code"></block>, o<block ref="7c13d022c9fda6e792c4349a043a6c74" prefix=" " category="inline-code"></block> precisará ser alterado para corresponder<block ref="0494651671c3dc7f1ccdf99a4368a2cf" prefix=" " category="inline-code"></block>ao . Se esse parâmetro for alterado, realize testes adicionais para identificar também quaisquer efeitos no comportamento do RAC, como o tempo de failover do nó.</block>
  <block id="08d7a86ed9292993deaa28bee18d5ce5" category="list-text">Deixe o<block ref="7c13d022c9fda6e792c4349a043a6c74" prefix=" " category="inline-code"></block> parâmetro no valor padrão de 30, a menos que uma das seguintes condições se aplique:</block>
  <block id="5b46e861366ffd98cd94c26abf2bf550" category="list-text"><block ref="ff4a008470319a22d9cf3d14af485977" prefix="" category="inline-code"></block> Os binários estão localizados em uma unidade conetada à rede, incluindo unidades baseadas em NFS, iSCSI, FC e datastore.</block>
  <block id="7ace6d79e63cb29c86093526fbddf845" category="list-text">O sistema operacional é inicializado pela SAN.</block>
  <block id="985511d6258bbf659d35bd76e0b0cea1" category="list-text">Nesses casos, avalie o efeito das interrupções da rede que afetam o acesso ao sistema operacional ou<block ref="9599929f8663b5e2093f7bc5cb20b0c2" prefix=" " category="inline-code"></block> aos sistemas de arquivos. Em alguns casos, tais interrupções fazem com que os daemons do Oracle RAC parem, o que pode levar a um<block ref="7c13d022c9fda6e792c4349a043a6c74" prefix=" " category="inline-code"></block> tempo limite e despejo baseado em -. O tempo limite padrão é 27 segundos, que é o valor de<block ref="7c13d022c9fda6e792c4349a043a6c74" prefix=" " category="inline-code"></block> menos<block ref="c9333b0a26b9f9e9fd808e6238d613b0" prefix=" " category="inline-code"></block>. Nesses casos, aumente<block ref="7c13d022c9fda6e792c4349a043a6c74" prefix=" " category="inline-code"></block> para 200 para corresponder<block ref="0494651671c3dc7f1ccdf99a4368a2cf" prefix=" " category="inline-code"></block>.</block>
  <block id="0af83eb081b1a831789867d7f0867610" category="summary">Ferramentas de automação e gerenciamento de banco de dados Oracle</block>
  <block id="7c58d5a62a9c29d2a846b210deea95f2" category="paragraph">O principal valor do ONTAP em um ambiente de banco de dados Oracle vem das principais tecnologias da ONTAP, como cópias Snapshot instantâneas, replicação simples do SnapMirror e criação eficiente de volumes do FlexClone.</block>
  <block id="5459c1727c923baa303ff472498dbe97" category="paragraph">Em alguns casos, a configuração simples desses principais recursos diretamente no ONTAP atende aos requisitos, mas as necessidades mais complicadas exigem uma camada de orquestração.</block>
  <block id="aeeb3212c35c26d321183e81d4926e57" category="paragraph">O SnapCenter é o principal produto de proteção de dados da NetApp. Em um nível muito baixo, ele é semelhante aos produtos SnapManager em termos de como executa backups de bancos de dados. No entanto, ele foi criado do zero para fornecer um painel único para gerenciamento de proteção de dados em sistemas de storage da NetApp.</block>
  <block id="0c4e214451012c456ece194f5465deb2" category="paragraph">O SnapCenter inclui funções básicas, como backups e restaurações baseados em snapshot, replicação SnapMirror e SnapVault e outros recursos necessários para operar em escala para empresas de grande porte. Esses recursos avançados incluem funcionalidade de controle de acesso baseado em funções (RBAC) expandida, APIs RESTful para integração com produtos de orquestração de terceiros, gerenciamento central sem interrupções de plug-ins do SnapCenter em hosts de banco de dados e uma interface de usuário projetada para ambientes de escala de nuvem.</block>
  <block id="50780f47f6839d47d60bc4555ee00c3f" category="section-title">DESCANSO</block>
  <block id="a0bac638f30c704da8e03aba136da86d" category="paragraph">O ONTAP também contém um conjunto de APIs RESTful. Isso permite que fornecedores terceirizados de 3rd criem proteção de dados e outros aplicativos de gerenciamento com profunda integração com o ONTAP. Além disso, a API RESTful é fácil de consumir por clientes que desejam criar seus próprios fluxos de trabalho e utilitários de automação.</block>
  <block id="795da6575a33e265d7d9a5774cd10e6f" category="summary">Backups de grupos de consistência para bancos de dados Oracle no ONTAP</block>
  <block id="33c729820ffa60f55745fa3c259e273c" category="doc">Backups de grupos de consistência de banco de dados Oracle</block>
  <block id="56abf0735f338713ce53e8cdecd6994e" category="paragraph">Para o backup mais simples possível, basta colocar todo o banco de dados Oracle em um único volume ONTAP</block>
  <block id="2a4fa9d9434561574119e3086112023f" category="paragraph">Proteger os arquivos de dados, Registros de arquivamento, logs de refazer e controlfiles com um único snapshot é um método válido de backup, restauração e replicação. No entanto, o RPO está limitado ao ponto do próprio backup. Ele é adequado para RPO de uma hora ou mais. Se um banco de dados abranger volumes, os instantâneos cg são necessários usando uma das ferramentas discutidas anteriormente.</block>
  <block id="93310f4cebc752304c164f00d67e0bca" category="paragraph">Como exemplo, todo o banco de dados pode estar em um único volume com o seguinte agendamento de snapshot:</block>
  <block id="a33821be4b3522d65daed1ec317299f6" category="list-text">72 instantâneos por hora</block>
  <block id="0eea0679ac7bf43c19d603cd78e81de9" category="list-text">30 instantâneos todas as noites</block>
  <block id="c4546c401776d279c5577011584577fa" category="list-text">12 instantâneos mensais</block>
  <block id="b63db1b650d128c342617b377baf928a" category="paragraph">Ele fornece um RPO de uma hora durante o período contínuo das 72 horas anteriores, além de backups adicionais todos os dias e mensais. Vários bancos de dados ou arquivos de aplicações também podem ser incluídos no único volume ou no conjunto de snapshots cg para fornecer backups consistentes em um ambiente maior.</block>
  <block id="ede2d3fcaec1bb9dcda5a75c90f37368" category="summary">Maximizar a disponibilidade com o banco de dados Oracle no ONTAP</block>
  <block id="9688c9c1c1d15e2f91a3a5b8e5f14bd4" category="doc">Disponibilidade de banco de dados Oracle com ONTAP</block>
  <block id="686540783626106489734a1990d4930d" category="paragraph">O ONTAP foi projetado para oferecer a máxima disponibilidade de banco de dados Oracle. Uma descrição completa dos recursos de alta disponibilidade do ONTAP está além do escopo deste documento. No entanto, assim como na proteção de dados, uma compreensão básica dessa funcionalidade é importante ao projetar uma infraestrutura de banco de dados.</block>
  <block id="b049fcbe8198301adc6bf87634a02845" category="section-title">Pares HA</block>
  <block id="1a7c11d1e2d03d3d1b57cff284ebd761" category="paragraph">A unidade básica de alta disponibilidade é o par de HA. Cada par contém links redundantes para suportar a replicação de dados para o NVRAM. NVRAM não é um cache de gravação. A RAM dentro do controlador serve como cache de gravação. O objetivo do NVRAM é registrar temporariamente os dados como uma salvaguarda contra falhas inesperadas do sistema. A este respeito, é semelhante a um log refazer banco de dados.</block>
  <block id="cd2e54027dfcfeddd07ddd580db527c0" category="paragraph">Tanto o NVRAM quanto o log refazer de banco de dados são usados para armazenar dados rapidamente, permitindo que as alterações aos dados sejam confirmadas o mais rápido possível. A atualização para os dados persistentes em unidades (ou datafiles) não ocorre até mais tarde durante um processo chamado ponto de verificação em plataformas ONTAP e na maioria dos bancos de dados. Nem os dados do NVRAM nem os logs de refazer do banco de dados são lidos durante operações normais.</block>
  <block id="4e044ec0c36e513506c77c0a97d53539" category="paragraph">Se um controlador falhar abruptamente, é provável que haja alterações pendentes armazenadas no NVRAM que ainda não foram gravadas nas unidades. O controlador do parceiro deteta a falha, controla as unidades e aplica as alterações necessárias que foram armazenadas no NVRAM.</block>
  <block id="310e46747ebab6a43d5a15998f6e2b33" category="section-title">Takeover e giveback</block>
  <block id="1d739263e44469ad28f77fe7329fa78d" category="paragraph">Takeover e giveback refere-se ao processo de transferência de responsabilidade por recursos de storage entre nós em um par de HA. Há dois aspetos para a aquisição e a giveback:</block>
  <block id="f2d43d90397aa8140414437eda14febb" category="list-text">Gestão da conetividade de rede que permite o acesso às unidades</block>
  <block id="6e1c794c81468e3286a23138460bb3fb" category="list-text">Gestão das próprias unidades</block>
  <block id="89d3f6c60c53a11e16a6756bde03ca00" category="paragraph">As interfaces de rede que suportam o tráfego CIFS e NFS são configuradas com um local de origem e failover. Uma aquisição inclui mover as interfaces de rede para sua casa temporária em uma interface física localizada na(s) mesma(s) sub-rede(s) do local original. A giveback inclui mover as interfaces de rede de volta para seus locais originais. O comportamento exato pode ser ajustado conforme necessário.</block>
  <block id="108018656caf59cc565f1172047dab38" category="paragraph">As interfaces de rede que suportam protocolos de bloco SAN, como iSCSI e FC, não são relocadas durante a aquisição e a giveback. Em vez disso, os LUNs devem ser provisionados com caminhos que incluam um par de HA completo, o que resulta em um caminho primário e um caminho secundário.</block>
  <block id="80795d5dd590e432b4f5945aba47caf4" category="admonition">Caminhos adicionais para controladores adicionais também podem ser configurados para dar suporte à realocação de dados entre nós em um cluster maior, mas isso não faz parte do processo de HA.</block>
  <block id="aae63904d16fd1c522dc5ff53eb695b5" category="paragraph">O segundo aspeto da aquisição e da giveback é a transferência da propriedade do disco. O processo exato depende de vários fatores, incluindo o motivo da aquisição/giveback e as opções de linha de comando emitidas. O objetivo é realizar a operação da forma mais eficiente possível. Embora o processo geral possa parecer exigir vários minutos, o momento real em que a propriedade da unidade é transferida de nó para nó geralmente pode ser medido em segundos.</block>
  <block id="61775b9e8f759f26eafd6b03448d1f30" category="section-title">Tempo de takeover</block>
  <block id="3224b51e62790c4ce988d8c1876fb36e" category="paragraph">A e/S do host tem uma pequena pausa na e/S durante as operações de takeover e giveback, mas não deve haver interrupção do aplicativo em um ambiente configurado corretamente. O processo de transição real no qual a e/S é atrasada geralmente é medido em segundos, mas o host pode exigir tempo adicional para reconhecer a alteração nos caminhos de dados e reenviar operações de e/S.</block>
  <block id="40f291752a9848bfecb7264cfd9aa8ee" category="paragraph">A natureza da interrupção depende do protocolo:</block>
  <block id="cb44db7841f8fb68230a260c4c68bfe0" category="list-text">Uma interface de rede que suporta tráfego NFS e CIFS emite uma solicitação ARP (Address Resolution Protocol) para a rede após a transição para um novo local físico. Isso faz com que os switches de rede atualizem suas tabelas de endereços de controle de acesso de Mídia (MAC) e retomem a e/S de processamento A interrupção no caso de aquisição planejada e a giveback geralmente é medida em segundos e, em muitos casos, não é detetável. Algumas redes podem ser mais lentas para reconhecer completamente a mudança no caminho da rede, e alguns sistemas operacionais podem colocar em fila muita e/S em um tempo muito curto que deve ser tentado novamente. Isto pode prolongar o tempo necessário para retomar a I/O.</block>
  <block id="6a410522094e0b0f874dab5784e81ab8" category="list-text">Uma interface de rede que suporte protocolos SAN não faz a transição para um novo local. Um sistema operacional do host deve alterar o caminho ou os caminhos em uso. A pausa em I/o observada pelo host depende de vários fatores. Do ponto de vista do sistema de armazenamento, o período em que a e/S não pode ser atendida é de apenas alguns segundos. No entanto, diferentes sistemas operacionais de host podem exigir tempo adicional para permitir que uma e/S termine o tempo limite antes de tentar novamente. Os sistemas operacionais mais novos são mais capazes de reconhecer uma mudança de caminho muito mais rapidamente, mas os sistemas operacionais mais antigos geralmente exigem até 30 segundos para reconhecer uma mudança.</block>
  <block id="cabc4f9cda7d4bfb99181166c863a374" category="paragraph">Os tempos de aquisição esperados durante os quais o sistema de storage não pode fornecer dados a um ambiente de aplicativo são mostrados na tabela abaixo. Não deve haver erros em qualquer ambiente de aplicativo, o controle deve aparecer como uma pequena pausa no processamento de e/S.</block>
  <block id="ed3467fac861f6a32cd66093ac415805" category="cell">Takeover planejado</block>
  <block id="57a915dfa0e8469b25c1b8b947f7ee2c" category="cell">15 seg</block>
  <block id="cd5dce62294e9a79e9c2165ee0903f5f" category="cell">6-10 seg</block>
  <block id="cbfdbb11fd5eab0d9fdd078ae66a1c69" category="cell">2-3 seg</block>
  <block id="1a066f0304c1d3a279466c70359c5103" category="cell">Takeover não planejado</block>
  <block id="0f4a6e109a34d3483995e427b6581130" category="cell">30 seg</block>
  <block id="591b3149d6cb247a04883c411dab3e24" category="summary">Somas de verificação e integridade do banco de dados Oracle</block>
  <block id="56f014c6fc8fac3e242c9d2e42c654c0" category="paragraph">O ONTAP e seus protocolos compatíveis incluem vários recursos que protegem a integridade do banco de dados Oracle, incluindo dados em repouso e dados transmitidos pela rede de rede.</block>
  <block id="dbfb054670bc82c6e08a7e101c0f0ef4" category="paragraph">A proteção de dados lógicos no ONTAP consiste em três requisitos principais:</block>
  <block id="b6cc6762545d78ab663e39c37d172bd2" category="list-text">Os dados devem estar protegidos contra corrupção de dados.</block>
  <block id="e7c7e14f4b6ca1b3ae32b2279243dba6" category="list-text">Os dados devem estar protegidos contra falha da unidade.</block>
  <block id="1168469b387027a850496f6cac9f3529" category="list-text">As alterações nos dados devem ser protegidas contra perda.</block>
  <block id="864a6ca5da4b36656beba11c90f4c4e5" category="paragraph">Essas três necessidades são discutidas nas seções a seguir.</block>
  <block id="a05b54004946aa523bfe7c1e92a52f52" category="section-title">Corrupção de rede: Somas de verificação</block>
  <block id="ed95581a613a4f19be367c10cd063cc2" category="paragraph">O nível mais básico de proteção de dados é a soma de verificação, que é um código especial de deteção de erros armazenado junto com os dados. A corrupção de dados durante a transmissão da rede é detetada com o uso de uma soma de verificação e, em alguns casos, várias somas de verificação.</block>
  <block id="c1343e51090396cf011509389bc0adab" category="paragraph">Por exemplo, um quadro FC inclui uma forma de checksum chamada de verificação de redundância cíclica (CRC) para garantir que a carga útil não esteja corrompida em trânsito. O transmissor envia os dados e o CRC dos dados. O recetor de um quadro FC recalcula o CRC dos dados recebidos para garantir que ele corresponda ao CRC transmitido. Se o CRC recém-calculado não corresponder ao CRC anexado ao quadro, os dados estarão corrompidos e o quadro FC será descartado ou rejeitado. Uma operação de e/S iSCSI inclui somas de verificação nas camadas TCP/IP e Ethernet e, para proteção adicional, também pode incluir proteção CRC opcional na camada SCSI. Qualquer corrupção de bits no fio é detetada pela camada TCP ou camada IP, o que resulta na retransmissão do pacote. Assim como no FC, erros no CRC SCSI resultam em uma rejeição ou rejeição da operação.</block>
  <block id="1f08639c540e47068c16c3ac48ea7bbe" category="section-title">Drive corruption: Somas de verificação</block>
  <block id="c5d50bc8d916a4b26166bbda091cd6d4" category="paragraph">As somas de verificação também são usadas para verificar a integridade dos dados armazenados nas unidades. Os blocos de dados gravados nas unidades são armazenados com uma função de checksum que produz um número imprevisível vinculado aos dados originais. Quando os dados são lidos a partir da unidade, a soma de verificação é recalculada e comparada com a soma de verificação armazenada. Se não corresponder, os dados ficaram corrompidos e devem ser recuperados pela camada RAID.</block>
  <block id="8edc44db01815f20f6508db8b5630cfe" category="section-title">Corrupção de dados: Gravações perdidas</block>
  <block id="972eab86b2aecd693914feabc5a3b65c" category="paragraph">Um dos tipos mais difíceis de detetar é uma gravação perdida ou extraviada. Quando uma escrita é reconhecida, ela deve ser escrita para a Mídia no local correto. A corrupção de dados no local é relativamente fácil de detetar usando uma soma de verificação simples armazenada com os dados. No entanto, se a gravação é simplesmente perdida, então a versão anterior dos dados ainda pode existir e a soma de verificação estaria correta. Se a gravação for colocada no local físico errado, a soma de verificação associada seria mais uma vez válida para os dados armazenados, mesmo que a gravação tenha destruído outros dados.</block>
  <block id="53830741c46fbc560962b086f582e79a" category="paragraph">A solução para este desafio é a seguinte:</block>
  <block id="656d064400822ca2ffb25f52c9fc95db" category="list-text">Uma operação de gravação deve incluir metadados que indicam o local onde a gravação deve ser encontrada.</block>
  <block id="37a60b1c7392a26270880a361f85db55" category="list-text">Uma operação de gravação deve incluir algum tipo de identificador de versão.</block>
  <block id="4275b2e68761baa23b112833facf4ca1" category="paragraph">Quando o ONTAP grava um bloco, ele inclui dados sobre a localização do bloco. Se uma leitura subsequente identificar um bloco, mas os metadados indicarem que ele pertence ao local 123 quando foi encontrado no local 456, então a gravação foi extraviada.</block>
  <block id="009b13bf07c7db21c1e4769526e60694" category="paragraph">Detetar uma escrita totalmente perdida é mais difícil. A explicação é muito complicada, mas essencialmente o ONTAP está armazenando metadados de uma forma que uma operação de gravação resulta em atualizações para dois locais diferentes nas unidades. Se uma gravação for perdida, uma leitura posterior dos dados e metadados associados mostrará duas identidades de versão diferentes. Isso indica que a gravação não foi concluída pela unidade.</block>
  <block id="3b04a99c209a31ad69e7865ea94e5c94" category="paragraph">A corrupção de gravação perdida e extraviada é extremamente rara, mas, à medida que as unidades continuam a crescer e os conjuntos de dados aumentam a escala de exabytes, o risco aumenta. A detecção de gravações perdidas deve ser incluída em qualquer sistema de storage que suporte workloads de banco de dados.</block>
  <block id="e978ccc010ec4d37148d52e2fbf439dd" category="section-title">Falhas de unidade: RAID, RAID DP e RAID-teC</block>
  <block id="a9fffaaf2b1b518afb56ef273736c0c2" category="paragraph">Se um bloco de dados em uma unidade for descoberto como corrompido ou toda a unidade falhar e estiver totalmente indisponível, os dados devem ser reconstituídos. Isso é feito no ONTAP usando unidades de paridade. Os dados são distribuídos em várias unidades de dados e, em seguida, os dados de paridade são gerados. Este é armazenado separadamente dos dados originais.</block>
  <block id="54abdf00b7122c16619266482eb09f43" category="paragraph">O ONTAP usou originalmente o RAID 4, que usa uma única unidade de paridade para cada grupo de unidades de dados. O resultado foi que qualquer unidade do grupo poderia falhar sem resultar em perda de dados. Se a unidade de paridade falhar, nenhum dado será danificado e uma nova unidade de paridade poderá ser construída. Se uma única unidade de dados falhar, as unidades restantes poderão ser usadas com a unidade de paridade para regenerar os dados em falta.</block>
  <block id="6d1ccb512ce2b25e53d90e6d8d459e18" category="paragraph">Quando as unidades eram pequenas, a chance estatística de duas unidades falharem simultaneamente foi insignificante. À medida que as capacidades da unidade crescem, também tem o tempo necessário para reconstruir os dados após uma falha de unidade. Isso aumentou a janela na qual uma segunda falha da unidade resultaria em perda de dados. Além disso, o processo de reconstrução cria muitas e/S adicionais nas unidades sobreviventes. À medida que as unidades envelhecem, o risco de carga adicional que leva a uma segunda falha da unidade também aumenta. Finalmente, mesmo que o risco de perda de dados não tenha aumentado com o uso continuado do RAID 4, as consequências da perda de dados se tornariam mais graves. Quanto mais dados forem perdidos no caso de uma falha do grupo RAID, mais tempo levaria para recuperar os dados, estendendo a interrupção dos negócios.</block>
  <block id="caef9e75bcd55d5a9a4ec855b5a6385c" category="paragraph">Esses problemas levaram a NetApp a desenvolver a tecnologia NetApp RAID DP, uma variante do RAID 6. Essa solução inclui duas unidades de paridade, o que significa que todas as duas unidades em um grupo RAID podem falhar sem criar perda de dados. As unidades continuaram a crescer em tamanho, o que levou a NetApp a desenvolver a tecnologia NetApp RAID-teC, que introduz uma terceira unidade de paridade.</block>
  <block id="704c2697ee323569003b7b7ea203ae0f" category="paragraph">Algumas práticas recomendadas de banco de dados históricos recomendam o uso do RAID-10, também conhecido como espelhamento distribuído. Isso oferece menos proteção de dados do que até mesmo o RAID DP porque há vários cenários de falha de dois discos, enquanto que no RAID DP não há nenhum.</block>
  <block id="3d0147402d7506d1d3a5227fe447427a" category="paragraph">Há também algumas práticas recomendadas de banco de dados históricos que indicam que RAID-10 é preferível às opções RAID-4/5/6 devido a problemas de desempenho. Essas recomendações às vezes se referem a uma penalidade de RAID. Embora essas recomendações geralmente estejam corretas, elas não são aplicáveis às implementações de RAID no ONTAP. O problema de desempenho está relacionado com a regeneração de paridade. Com as implementações tradicionais de RAID, o processamento das gravações aleatórias de rotina executadas por um banco de dados requer várias leituras de disco para regenerar os dados de paridade e concluir a gravação. A penalidade é definida como o IOPS de leitura adicional necessário para executar operações de gravação.</block>
  <block id="84ff015d2df40fc0ebb34485173f39e4" category="paragraph">O ONTAP não incorre em uma penalidade de RAID porque as gravações são encenadas na memória em que a paridade é gerada e, em seguida, gravadas no disco como um único stripe RAID. Não são necessárias leituras para concluir a operação de gravação.</block>
  <block id="b7fe11ecbd8b434a231195335b4894ac" category="paragraph">Em resumo, quando comparado ao RAID 10, o RAID DP e o RAID-teC oferecem muito mais capacidade utilizável, melhor proteção contra falha de unidade e nenhum sacrifício de performance.</block>
  <block id="e5e0dc0629a299f8e56ebe7de38f49f9" category="section-title">Proteção contra falhas de hardware: NVRAM</block>
  <block id="1db5fde40e489d805029f9d5be6375e7" category="paragraph">Qualquer storage array que atenda a um workload de banco de dados precisa atender às operações de gravação o mais rápido possível. Além disso, uma operação de gravação deve ser protegida contra perda de um evento inesperado, como uma falha de energia. Isso significa que qualquer operação de gravação deve ser armazenada com segurança em pelo menos dois locais.</block>
  <block id="ff540b857af868ec85f8f53ddc1f1bd1" category="paragraph">Os sistemas AFF e FAS contam com a NVRAM para atender a esses requisitos. O processo de escrita funciona da seguinte forma:</block>
  <block id="049f2df0de743a6be8d3ec69864f234a" category="list-text">Os dados de gravação de entrada são armazenados na RAM.</block>
  <block id="976be2293c2f4499d079224003644acf" category="list-text">As alterações que devem ser feitas nos dados no disco são registradas no NVRAM no nó local e no nó parceiro. O NVRAM não é um cache de gravação; em vez disso, é um diário semelhante a um log de refazer de banco de dados. Em condições normais, não é lido. Ele é usado apenas para recuperação, como após uma falha de energia durante o processamento de e/S.</block>
  <block id="8ae87ed4a421bec56e020cd0e83bd748" category="list-text">A gravação é então reconhecida para o host.</block>
  <block id="3a7682bcbb490353074b5ee69e18f01c" category="paragraph">O processo de gravação nesta fase é concluído do ponto de vista da aplicação, e os dados são protegidos contra perda porque são armazenados em dois locais diferentes. Eventualmente, as alterações são gravadas no disco, mas esse processo está fora da banda do ponto de vista do aplicativo, porque ocorre depois que a gravação é reconhecida e, portanto, não afeta a latência. Este processo é mais uma vez semelhante ao log de banco de dados. Uma alteração ao banco de dados é registrada nos logs de refazer o mais rápido possível, e a alteração é então reconhecida como comprometida. As atualizações para os datafiles ocorrem muito mais tarde e não afetam diretamente a velocidade de processamento.</block>
  <block id="c17f09622da5f1e0064f7b6a65cb8b01" category="paragraph">No caso de uma falha do controlador, o controlador do parceiro assume a propriedade dos discos necessários e replica os dados registados no NVRAM para recuperar quaisquer operações de e/S que estivessem em trânsito quando a falha ocorreu.</block>
  <block id="24e6592d53b3bd56ed8827d2f51bb1ab" category="section-title">Proteção contra falhas de hardware: NVFAIL</block>
  <block id="7965eb54acae120d25d0c77b012b8f90" category="paragraph">Como discutido anteriormente, uma gravação não é reconhecida até que ela tenha sido registrada no NVRAM local e no NVRAM em pelo menos um outro controlador. Essa abordagem garante que uma falha de hardware ou falha de energia não resulte na perda de e/S em trânsito Se o NVRAM local falhar ou a conectividade com o parceiro de HA falhar, esses dados em trânsito não serão mais espelhados.</block>
  <block id="307b6d3e63c12ada7fbcf75cdda0b574" category="paragraph">Se o NVRAM local relatar um erro, o nó será encerrado. Esse desligamento resulta em failover para uma controladora de parceiro de HA. Nenhum dado é perdido porque o controlador que sofre a falha não reconheceu a operação de gravação.</block>
  <block id="6e0c6c8fe69a50581a4ac18acb2c04dd" category="paragraph">O ONTAP não permite um failover quando os dados estão fora de sincronia, a menos que o failover seja forçado. Forçar uma alteração de condições desta forma reconhece que os dados podem ser deixados para trás no controlador original e que a perda de dados é aceitável.</block>
  <block id="a3961862ed464a06ef6fa4e23935fef2" category="paragraph">Os bancos de dados são especialmente vulneráveis à corrupção se um failover for forçado porque os bancos de dados mantêm grandes caches internos de dados no disco. Se ocorrer um failover forçado, as alterações anteriormente confirmadas serão efetivamente descartadas. O conteúdo da matriz de armazenamento salta efetivamente para trás no tempo, e o estado do cache do banco de dados não reflete mais o estado dos dados no disco.</block>
  <block id="b46ce3019d702ee3ece327e5df990be0" category="paragraph">Para proteger os dados contra essa situação, o ONTAP permite que os volumes sejam configurados para proteção especial contra falhas do NVRAM. Quando acionado, esse mecanismo de proteção resulta em um volume entrando em um estado chamado NVFAIL. Esse estado resulta em erros de e/S que causam o desligamento de um aplicativo para que eles não usem dados obsoletos. Os dados não devem ser perdidos porque qualquer gravação reconhecida deve estar presente no storage array.</block>
  <block id="322e1f85910dfc206274f8bd58a54a9d" category="list-text">Cada conjunto de unidades em um determinado local é configurado automaticamente como um ou mais grupos RAID-DP ou RAID-teC totalmente redundantes, independentemente do uso do espelhamento. Isso fornece proteção contínua de dados, mesmo após a perda de um site.</block>
  <block id="dee2dfce5ab0c47301b3c12970a57aa6" category="paragraph">A figura acima ilustra um exemplo de configuração do SyncMirror. Um agregado de 24 unidades foi criado na controladora com 12 unidades de um compartimento alocado no local A e 12 unidades de um compartimento alocado no local B. as unidades foram agrupadas em dois grupos RAID espelhados. RAID Group 0 inclui um Plex de 6 unidades no local Um espelhado para um Plex de 6 unidades no local B. da mesma forma, RAID Group 1 inclui um Plex de 6 unidades no local Um espelhado para um Plex de 6 unidades no local B.</block>
  <block id="4fbc0abe91c0c1381d0a742f58b4e537" category="paragraph">O SyncMirror normalmente é usado para fornecer espelhamento remoto com sistemas MetroCluster, com uma cópia dos dados em cada local. Ocasionalmente, ele tem sido usado para fornecer um nível extra de redundância em um único sistema. Em particular, ele fornece redundância em nível de prateleira. Um compartimento de unidades já contém fontes de alimentação duplas e controladores e é, no geral, pouco mais do que chapas metálicas, mas em alguns casos, a proteção extra pode ser garantida. Por exemplo, um cliente da NetApp implantou o SyncMirror para uma plataforma móvel de análise em tempo real usada durante testes automotivos. O sistema foi separado em dois racks físicos fornecidos por alimentações de energia independentes de sistemas UPS independentes.</block>
  <block id="0cac56685de94a3ef0e1fd2bfca0c112" category="paragraph">O tópico de checksums é de particular interesse para DBAs que estão acostumados a usar backups de streaming Oracle RMAN migram para backups baseados em snapshot. Um recurso do RMAN é que ele executa verificações de integridade durante operações de backup. Embora esse recurso tenha algum valor, seu principal benefício é para um banco de dados que não é usado em um storage array moderno. Quando as unidades físicas são usadas para um banco de dados Oracle, é quase certo que a corrupção eventualmente ocorre à medida que as unidades envelhecem, um problema que é resolvido por somas de verificação baseadas em array em arrays de armazenamento reais.</block>
  <block id="8b7b33533c2b36c157a0a482bdd52a8e" category="paragraph">A arquitetura Oracle datafile e refazer log também foi projetada para fornecer o mais alto nível possível de integridade de dados, mesmo em circunstâncias extremas. No nível mais básico, os blocos Oracle incluem checksum e verificações lógicas básicas com quase todas as I/O. Se o Oracle não travou ou uma tablespace off-line, então os dados estão intactos. O grau de verificação da integridade dos dados é ajustável, e o Oracle também pode ser configurado para confirmar gravações. Como resultado, quase todos os cenários de falha e falha podem ser recuperados e, no caso extremamente raro de uma situação irrecuperável, a corrupção é imediatamente detetada.</block>
  <block id="4066c36b811913c85aa86346e30cee4d" category="paragraph">A maioria dos clientes NetApp que usam bancos de dados Oracle descontinuam o uso de RMAN e outros produtos de backup após a migração para backups baseados em snapshot. Ainda existem opções nas quais o RMAN pode ser usado para executar a recuperação em nível de bloco com o SnapCenter. No entanto, no dia a dia, o RMAN, o NetBackup e outros produtos só são usados ocasionalmente para criar cópias de arquivamento mensais ou trimestrais.</block>
  <block id="d0cf0e689669c61d564607d2ef7deb79" category="paragraph">Alguns clientes optam por executar<block ref="d308cbfce7e270e5b41a84d84385645f" prefix=" " category="inline-code"></block> periodicamente para realizar verificações de integridade em seus bancos de dados existentes. NetApp desencoraja essa prática porque cria carga de e/S desnecessária. Como discutido acima, se o banco de dados não estava enfrentando problemas anteriormente, a chance de<block ref="d308cbfce7e270e5b41a84d84385645f" prefix=" " category="inline-code"></block> detetar um problema é perto de zero, e este utilitário cria uma carga de e/S sequencial muito alta na rede e no sistema de armazenamento. A menos que haja razão para acreditar que existe corrupção, como a exposição a um bug conhecido da Oracle, não há razão para ser executado<block ref="d308cbfce7e270e5b41a84d84385645f" prefix=" " category="inline-code"></block>.</block>
  <block id="4182200437c090276a01ad8ca54076b0" category="summary">Configurando o NVFAIL para proteger bancos de dados Oracle</block>
  <block id="57d15767e9302dbb67058ed0bd9eebac" category="doc">Bancos de dados Oracle e NVFAIL</block>
  <block id="370bdf5dd39278264774ea595054e243" category="paragraph">O NVFAIL é um recurso do ONTAP que garante a integridade durante cenários de failover catastróficos.</block>
  <block id="80250c1f1d70fc693877be6f22cc134e" category="paragraph">Os bancos de dados estão vulneráveis a corrupção durante eventos de failover de storage porque mantêm grandes caches internos. Se um evento catastrófico exigir forçar um failover de ONTAP ou forçar o switchover de MetroCluster, independentemente da integridade da configuração geral, o resultado será confirmado anteriormente que as alterações podem ser efetivamente descartadas. O conteúdo da matriz de armazenamento salta para trás no tempo, e o estado do cache do banco de dados não reflete mais o estado dos dados no disco. Essa inconsistência resulta em corrupção de dados.</block>
  <block id="68114defc717054e7e3b02df438cdbe1" category="paragraph">O cache pode ocorrer na camada de aplicativo ou servidor. Por exemplo, uma configuração do Oracle Real Application Cluster (RAC) com servidores ativos em um site primário e remoto armazena dados em cache no Oracle SGA. Uma operação de comutação forçada que resultou em dados perdidos colocaria o banco de dados em risco de corrupção porque os blocos armazenados no SGA podem não corresponder aos blocos no disco.</block>
  <block id="162de6d405c04ce8f152f1d246ed9187" category="paragraph">Um uso menos óbvio do cache está na camada do sistema de arquivos do sistema operacional. Blocos de um sistema de arquivos NFS montado podem ser armazenados em cache no sistema operacional. Como alternativa, um sistema de arquivos em cluster baseado em LUNs localizados no site principal pode ser montado em servidores no local remoto e, mais uma vez, os dados podem ser armazenados em cache. Uma falha do NVRAM ou de uma tomada forçada ou comutação forçada nessas situações pode resultar em corrupção do sistema de arquivos.</block>
  <block id="04ca8d9ad570a3bdf1d76e23bc108ae5" category="paragraph">O ONTAP protege bancos de dados e sistemas operacionais desse cenário com o NVFAIL e suas configurações associadas.</block>
  <block id="f0a36f02b824ef55cbd63aa2700a4ec9" category="summary">Recuperação e backups baseados em snapshot do banco de dados Oracle</block>
  <block id="77243afc69ab08d8277d0e23dda813d9" category="doc">Backups online de bancos de dados Oracle</block>
  <block id="a3b43ae3d4028e3c7ccac3d5720e9fb0" category="paragraph">Dois conjuntos de dados são necessários para proteger e recuperar um banco de dados Oracle no modo de backup. Note que esta não é a única opção de backup Oracle, mas é a mais comum.</block>
  <block id="8e523970ff7c41dba74e723511d14717" category="list-text">Um instantâneo dos arquivos de dados no modo de backup</block>
  <block id="deeddf207b1a29c63ae7c1943f90f3d9" category="list-text">Os logs de arquivo criados enquanto os datafiles estavam no modo de backup</block>
  <block id="fa1229103a2e02a4ed8790098c98f71f" category="paragraph">Se a recuperação completa, incluindo todas as transações confirmadas, é necessário um terceiro item:</block>
  <block id="7c11b244c2549a2cc477c134ec4c5635" category="list-text">Um conjunto de registos de refazer atuais</block>
  <block id="8522faf14bc9d4ab497945bb48adc870" category="paragraph">Existem várias maneiras de impulsionar a recuperação de um backup on-line. Muitos clientes restauram snapshots usando a CLI do ONTAP e, em seguida, usando o Oracle RMAN ou sqlplus para concluir a recuperação. Isso é especialmente comum com grandes ambientes de produção em que a probabilidade e a frequência de restaurações de banco de dados são extremamente baixas e qualquer procedimento de restauração é Tratado por um DBA qualificado. Para automação completa, soluções como o NetApp SnapCenter incluem um plug-in Oracle com interfaces gráficas e de linha de comando.</block>
  <block id="f88f41d4801183a5d53a4b71f383d144" category="paragraph">Alguns clientes de grande escala adotaram uma abordagem mais simples, configurando scripts básicos nos hosts para colocar os bancos de dados no modo de backup em um momento específico, em preparação para um snapshot agendado. Por exemplo, programe o comando<block ref="56f72994c4cc84b13a4c20dab49fea35" prefix=" " category="inline-code"></block> às 23:58,<block ref="84c8391d82cbfe300a9615844e0a167f" prefix=" " category="inline-code"></block> às 00:02 e, em seguida, programe instantâneos diretamente no sistema de armazenamento à meia-noite. O resultado é uma estratégia de backup simples e altamente dimensionável que não requer software ou licenças externos.</block>
  <block id="d22a890163762fcf7a4cb7605c29b7e6" category="section-title">Layout de dados</block>
  <block id="719fbeb74939b8c065321f175de3d222" category="paragraph">O layout mais simples é isolar datafiles em um ou mais volumes dedicados. Eles devem ser não contaminados por qualquer outro tipo de arquivo. Isso é para garantir que os volumes de arquivo de dados possam ser restaurados rapidamente através de uma operação SnapRestore sem destruir um log refazer importante, controlfile ou log de arquivo.</block>
  <block id="19156bdcbf322e8e3189909bbb7a69e8" category="paragraph">A SAN tem requisitos semelhantes para isolamento de arquivos de dados dentro de volumes dedicados. Com um sistema operacional como o Microsoft Windows, um único volume pode conter vários LUNs de arquivo de dados, cada um com um sistema de arquivos NTFS. Com outros sistemas operacionais, geralmente há um gerenciador de volumes lógico. Por exemplo, com o Oracle ASM, a opção mais simples seria limitar os LUNs de um grupo de discos ASM a um único volume que pode ser feito backup e restaurado como uma unidade. Se forem necessários volumes adicionais por motivos de gerenciamento de performance ou capacidade, a criação de um grupo de discos adicional no novo volume resultará em um gerenciamento mais simples.</block>
  <block id="993afa8643b7200c5c9e527c24c1d8b2" category="paragraph">Se essas diretrizes forem seguidas, os snapshots poderão ser agendados diretamente no sistema de storage sem a necessidade de realizar um snapshot de grupo de consistência. A razão é que os backups Oracle não exigem que os datafiles sejam copiados ao mesmo tempo. O procedimento de backup on-line foi projetado para permitir que os arquivos de dados continuem sendo atualizados, pois são transmitidos lentamente para a fita ao longo de horas.</block>
  <block id="a2ea5ea024e4a68e4d7f4abeca3441a1" category="paragraph">Uma complicação surge em situações como o uso de um grupo de discos ASM que é distribuído entre volumes. Nesses casos, um cg-snapshot deve ser executado para garantir que os metadados ASM sejam consistentes em todos os volumes constituintes.</block>
  <block id="0a3ecb97c1b7c97e5075bae0daaa45aa" category="paragraph">*Atenção:* Verifique se o ASM<block ref="1737629d60b511cf45957529a8f046e2" prefix=" " category="inline-code"></block> e<block ref="76a2173be6393254e72ffa4d6df1030a" prefix=" " category="inline-code"></block> os arquivos não estão no grupo de discos que hospeda os arquivos de dados. Isso interfere na capacidade de restaurar seletivamente datafiles e apenas datafiles.</block>
  <block id="12eb3ceede91a01c74368e0fab03dbe4" category="section-title">Procedimento de recuperação local – NFS</block>
  <block id="e1a03fcc478ae212f07b5044b11ff369" category="paragraph">Este procedimento pode ser conduzido manualmente ou através de uma aplicação como o SnapCenter. O procedimento básico é o seguinte:</block>
  <block id="b273f8d4284bd1f58cfbafe8065af9fa" category="list-text">Encerre o banco de dados.</block>
  <block id="abb0083d6ab87bbe9d906632fea121ae" category="list-text">Recupere o(s) volume(s) de arquivo de dados para o instantâneo imediatamente antes do ponto de restauração desejado.</block>
  <block id="312007510a0f0dc7878d4ed6a7a01554" category="list-text">Reproduza registos de arquivo até ao ponto pretendido.</block>
  <block id="e54b793d8bfa83bbb1bd965992c3474e" category="list-text">Repita os logs atuais de refazer se a recuperação completa for desejada.</block>
  <block id="2f8a5e254c86a42ebcc8b7d3c84cd22e" category="paragraph">Este procedimento pressupõe que os registos de arquivo desejados ainda estão presentes no sistema de ficheiros ativo. Se não estiverem, os logs do arquivo devem ser restaurados ou rman/sqlplus podem ser direcionados para os dados no diretório instantâneo.</block>
  <block id="a67a69f712a877950e94edd27310b40e" category="paragraph">Além disso, para bancos de dados menores, os arquivos de dados podem ser recuperados por um usuário final diretamente<block ref="a15da8cecb1f1192c4d913b8ba676121" prefix=" " category="inline-code"></block> do diretório sem a ajuda de ferramentas de automação ou administradores de armazenamento para executar um<block ref="a4c0ce4da6fb04943b499690fb3afd6e" prefix=" " category="inline-code"></block> comando.</block>
  <block id="097230f6ad5345abbe261eabbf533a68" category="section-title">Procedimento de recuperação local – SAN</block>
  <block id="6da8ebf3245e4fbe4654e7f92f0330d7" category="list-text">Quiesce o(s) grupo(s) de discos que hospedam os arquivos de dados. O procedimento varia consoante o gestor de volume lógico escolhido. Com ASM, o processo requer a desmontagem do grupo de discos. Com o Linux, os sistemas de arquivos devem ser desmontados e os volumes lógicos e grupos de volumes devem ser desativados. O objetivo é parar todas as atualizações no grupo de volume alvo a serem restauradas.</block>
  <block id="1d0ecd206531f96737f8e8002be4a047" category="list-text">Restaure os grupos de discos de arquivo de dados para o instantâneo imediatamente antes do ponto de restauração desejado.</block>
  <block id="946fe41f610ab658e270a1844c992bcc" category="list-text">Reative os grupos de discos recentemente restaurados.</block>
  <block id="931ab211ac6773d20c03a998f9f921ce" category="list-text">Repita todos os logs de refazer se a recuperação completa for desejada.</block>
  <block id="b6575c3fca5eaaa56eeb8e9ce8867f05" category="paragraph">Este procedimento pressupõe que os registos de arquivo desejados ainda estão presentes no sistema de ficheiros ativo. Se não estiverem, os registos de arquivo devem ser restaurados colocando os LUNs de registo de arquivo offline e executando uma restauração. Este também é um exemplo no qual dividir os logs de arquivo em volumes dedicados é útil. Se os logs de arquivo compartilharem um grupo de volumes com os logs de refazer, os logs de refazer devem ser copiados em outro lugar antes da restauração do conjunto geral de LUNs. Esta etapa impede a perda dessas transações finais registradas.</block>
  <block id="acce752526553bfa73c92799accd9cb8" category="summary">Visão geral da proteção de dados Oracle</block>
  <block id="9e19caeb431a5e29a1a63e3cee4b36c9" category="doc">Proteção de dados Oracle com ONTAP</block>
  <block id="44e95a6c3878f189a550b4c0314d3b33" category="paragraph">O NetApp sabe que os dados mais críticos são encontrados em bancos de dados.</block>
  <block id="848aab87f65bfade12f80d4e864ec046" category="paragraph">Uma empresa não pode operar sem acesso a seus dados e, às vezes, os dados definem o negócio. No entanto, a proteção de dados é mais do que apenas garantir um backup utilizável. No entanto, é preciso realizar os backups de maneira rápida e confiável, além de armazená-los em segurança.</block>
  <block id="28a0304f97f876b27cf541f4ad9a30d7" category="paragraph">O outro lado da proteção de dados é a recuperação de dados. Quando os dados estão inacessíveis, a empresa é afetada e pode estar inoperante até que os dados sejam restaurados. Este processo deve ser rápido e confiável. Finalmente, a maioria dos bancos de dados deve ser protegida contra desastres, o que significa manter uma réplica do banco de dados. A réplica deve estar suficientemente atualizada. Também deve ser rápido e simples tornar a réplica um banco de dados totalmente operacional.</block>
  <block id="3d601b26d05eac41fc6a7eba92fdc8b9" category="admonition">Esta documentação substitui o relatório técnico publicado anteriormente _TR-4591: Proteção de dados Oracle: Backup, recuperação e replicação._</block>
  <block id="21d28aa03f67eb242b1c95a6a0594ff5" category="section-title">Planejamento</block>
  <block id="45c46768a1cb073f0d13245a0dc816f2" category="paragraph">A arquitetura de proteção de dados empresariais certa depende dos requisitos de negócios relacionados à retenção de dados, capacidade de recuperação e tolerância de interrupções durante vários eventos.</block>
  <block id="46e1b2893bdb002c0ede448cbfe1cb14" category="paragraph">Por exemplo, considere o número de aplicações, bancos de dados e conjuntos de dados importantes no escopo. Criar uma estratégia de backup para um único conjunto de dados que garanta a conformidade com SLAs típicos é bastante simples, pois não há muitos objetos para gerenciar. À medida que o número de conjuntos de dados aumenta, o monitoramento se torna mais complicado e os administradores podem ser forçados a gastar um tempo cada vez maior lidando com falhas de backup. À medida que um ambiente atinge a nuvem e o provedor de serviços dimensiona, é necessária uma abordagem totalmente diferente.</block>
  <block id="b70d233428e03d072b1134a97d853ab2" category="paragraph">O tamanho do conjunto de dados também afeta a estratégia. Por exemplo, existem muitas opções para backup e recuperação com um banco de dados 100GB porque o conjunto de dados é tão pequeno. A simples cópia de dados de Mídia de backup com ferramentas tradicionais normalmente fornece um rto suficiente para recuperação. Um banco de dados 100TB normalmente precisa de uma estratégia completamente diferente, a menos que o rto permita uma interrupção de vários dias, caso em que um procedimento tradicional de backup e recuperação baseado em cópia pode ser aceitável.</block>
  <block id="64848fee9c168231f5d0f13322ed0a87" category="paragraph">Finalmente, existem fatores fora do próprio processo de backup e recuperação. Por exemplo, existem bancos de dados que suportam atividades críticas de produção, tornando a recuperação um evento raro que só é realizado por DBAs qualificados? Alternativamente, os bancos de dados fazem parte de um grande ambiente de desenvolvimento em que a recuperação é uma ocorrência frequente e gerenciada por uma EQUIPE DE TI generalista?</block>
  <block id="1cede70bc6077ecbac9a77b03d1bc6e1" category="summary">Planejamento de proteção de dados para bancos de dados Oracle</block>
  <block id="e2bc0913921cafeb725765069883b685" category="paragraph">A arquitetura certa de proteção de dados do banco de dados Oracle depende dos requisitos de negócios relacionados à retenção de dados, capacidade de recuperação e tolerância a interrupções durante vários eventos.</block>
  <block id="e26b57887de9a65c0316a87d49bf6c44" category="section-title">Um instantâneo é um backup?</block>
  <block id="c3fd105ab426caff0a0ade2e93476543" category="paragraph">Uma objeção comumente levantada ao uso de snapshots como estratégia de proteção de dados é o fato de que os dados "reais" e os dados instantâneos estão localizados nas mesmas unidades. A perda dessas unidades resultaria na perda dos dados primários e do backup.</block>
  <block id="12d1adb01d24027626b2a47660fb5b81" category="paragraph">Este é um problema válido. Os snapshots locais são usados para necessidades diárias de backup e recuperação e, nesse aspeto, o snapshot é um backup. Cerca de 99% de todos os cenários de recuperação em ambientes NetApp dependem de snapshots para atender até aos requisitos mais agressivos de rto.</block>
  <block id="fc34c9966c8ecb7307468637d9e79933" category="paragraph">No entanto, os snapshots locais nunca devem ser a única estratégia de backup. É por isso que a NetApp oferece tecnologia como replicação SnapMirror para replicar snapshots para um conjunto independente de unidades de maneira rápida e eficiente. Em uma solução de arquitetura adequada com snapshots e replicação de snapshot, o uso da fita pode ser minimizado para talvez um arquivamento trimestral ou eliminado totalmente.</block>
  <block id="1ea948130a9dbbc02e3a80648a99ff57" category="section-title">Backups de grupos de consistência</block>
  <block id="9b234a126e57777ab83807827d4e7078" category="paragraph">Um backup de grupo de consistência envolve a captura do estado de um conjunto de dados (ou vários conjuntos de dados) em um único ponto atômico no tempo. Como exemplo de banco de dados, isso inclui todos os componentes do banco de dados, como datafiles, arquivos de log e outros arquivos diretamente associados ao banco de dados. Isso funciona com quase todos os produtos de banco de dados relacionais, incluindo Oracle RDBMS, Microsoft SQL Server, SAP HANA, PostgreSQL, MySQL e MariaDB. Proteger uma configuração VMware com um backup de grupo de consistência seria semelhante - capturar todos os datastores e, potencialmente, os LUNs de inicialização do ESX em um único ponto atômico no tempo.</block>
  <block id="5a1f7038c74e54c08669efa6722f1091" category="paragraph">A criação de um snapshot desse grupo de consistência basicamente simula uma falha, e é por isso que esses backups são frequentemente chamados de backups consistentes com falhas. Às vezes há preocupações com o suporte para cenários de recuperação, mas é importante entender que nenhum procedimento de recuperação é geralmente necessário. Quando o aplicativo é iniciado depois de restaurar um backup de grupo de consistência, ele executa os processos de recuperação de log usuais, replays de diário do sistema de arquivos e outras tarefas para reproduzir qualquer e/S que estava em andamento no ponto do backup. O aplicativo então começa como de costume.</block>
  <block id="aebdbddec25f7eba6434244a989fb659" category="paragraph">Essencialmente, qualquer aplicativo que possa suportar uma falha de energia ou falha do servidor sem corrupção de dados pode ser protegido dessa maneira. O fato de que isso funciona também pode ser demonstrado pelo grande número de aplicativos protegidos com produtos de espelhamento síncrono e assíncrono de muitos fornecedores diferentes. Se um desastre de repente atinge o local principal, o site de réplica contém uma imagem consistente do ambiente original no momento em que o desastre ocorreu. Mais uma vez, nenhum procedimento especial de recuperação é necessário.</block>
  <block id="e085ffefd89f8fb66260a9720e3fb6f8" category="paragraph">O RPO para essa abordagem geralmente é limitado ao ponto do backup. Como regra geral, o RPO mínimo para snapshots de volume único é de uma hora. Por exemplo, 48 snapshots por hora mais outros 30 dias de snapshots noturnos são razoáveis e não exigiriam a retenção de um número excessivo de snapshots. Torna-se mais difícil alcançar um RPO inferior a uma hora. Não é recomendável primeiro consultar os Serviços profissionais da NetApp para entender os requisitos de ambiente, escala e proteção de dados.</block>
  <block id="1fe119a790b393b7dd7e79b63f15f52b" category="paragraph">Normalmente, o rto pode ser medido em segundos. Um aplicativo é desligado, os volumes são restaurados e o aplicativo é reiniciado.</block>
  <block id="444cd304758b7607c8f7a3f627a5bc1f" category="paragraph">A abordagem mais simples é colocar todos os arquivos ou LUNs em um único grupo de consistência de volume, o que permite que uma criação de snapshot seja agendada diretamente no ONTAP. Quando um conjunto de dados deve abranger volumes, é necessário um snapshot de grupo de consistência (cg-snapshot). Isso pode ser configurado usando chamadas de API RESTful ou Gerenciador de sistema. Além disso, o SnapCenter é capaz de criar um snapshot de grupo de consistência simples em uma lista definida de volumes.</block>
  <block id="689b0155b42a554594a44cddc736eb67" category="section-title">Arquitetura de replicação e recuperação de desastres</block>
  <block id="1749d12df3df2319d3eee218a277ff83" category="inline-link-macro">MetroCluster</block>
  <block id="c0b79db5f258f0c991a383cbdbf001dd" category="inline-link-macro">Sincronização ativa do SnapMirror</block>
  <block id="255bd5c00b8de4b2f998369f766b2b5e" category="paragraph">Esta seção aborda a proteção de dados remota, para a qual os dados são replicados para um local remoto para fins de armazenamento externo seguro e recuperação de desastres. Observe que essas tabelas não abordam a proteção de dados de espelhamento síncrono. Para este requisito, consulte a documentação do NetApp MetroCluster, <block ref="06d0604733fc7f7e3f9befaa1239278d" category="inline-link-macro-rx"></block> incluindo e. <block ref="87f167af2516b222ddeec7405581e8b8" category="inline-link-macro-rx"></block></block>
  <block id="f443592081a2b3ddc55b94abe49ba128" category="paragraph">O DR RPO é limitado pela largura de banda da rede disponível e pelo tamanho total dos dados protegidos. Depois que a transferência inicial da linha de base é criada, as atualizações são baseadas apenas nos dados alterados, o que geralmente é uma porcentagem baixa do espaço físico total dos dados, embora existam exceções.</block>
  <block id="89e87a831dae60244ba34496d70fd45d" category="paragraph">Por exemplo, um banco de dados 10TB com uma taxa de mudança semanal de 10% é de aproximadamente 6GB por hora do total de alterações. Com 10Gb GB de conetividade, esse banco de dados requer aproximadamente seis minutos para ser transferido. A taxa de alteração varia de acordo com a variação na taxa de alteração do banco de dados, mas, no geral, um intervalo de atualização de 15 minutos e, portanto, um RPO de 15 minutos deve ser alcançado. Se houver 100 desses bancos de dados, então 600 minutos serão necessários para transferir os dados. Portanto, um RPO de uma hora não é possível. Da mesma forma, uma réplica de um único banco de dados de tamanho 100TB com uma taxa de alteração semanal de 10% não pode ser atualizada de forma confiável em uma hora.</block>
  <block id="3c886a803aef21f5ac9f7bcea7408cbb" category="paragraph">Fatores adicionais podem afetar a replicação, como sobrecarga de replicação e limitações no número de operações de replicação simultâneas. No entanto, o Planejamento geral para uma estratégia de replicação de volume único pode ser baseado na largura de banda disponível, e um RPO de replicação de uma hora geralmente é possível. Torna-se mais difícil alcançar um RPO inferior a uma hora, e só deve ser realizado após consulta aos Serviços profissionais da NetApp. Em alguns casos, 15 minutos é viável com uma conetividade de rede local-a-local muito boa. No entanto, no geral, quando um RPO abaixo de uma hora é necessário, a arquitetura de repetição de logs em vários volumes produz melhores resultados.</block>
  <block id="5e2cbdd214e7a73bca1af8ed5cc04626" category="paragraph">O rto com replicação de grupo de consistência em um cenário de recuperação de desastres é excelente, normalmente medido em segundos do ponto de vista de storage. A abordagem mais simples é simplesmente quebrar o espelho, e o banco de dados está pronto para ser iniciado. O tempo de inicialização do banco de dados geralmente é de cerca de 10 segundos, mas bancos de dados muito grandes com muitas transações registradas podem levar alguns minutos.</block>
  <block id="1c18c939e73ddb1ceee34e8a33079d1a" category="paragraph">O fator mais importante para determinar o rto não é o sistema de storage, mas sim a aplicação e o sistema operacional host no qual ele é executado. Por exemplo, os dados replicados podem ser disponibilizados em um segundo ou dois, mas isso representa apenas os dados. Também deve haver um sistema operacional corretamente configurado com binários de aplicativos que esteja disponível para usar os dados.</block>
  <block id="6fab898feea25b9d7fd4477911b90b31" category="paragraph">Em alguns casos, os clientes prepararam instâncias de recuperação de desastres com antecedência com o storage pré-descoberto em sistemas operacionais. Nesses casos, ativar o cenário de recuperação de desastres não pode exigir nada mais do que quebrar um espelho e iniciar o aplicativo. Em outros casos, o sistema operacional e os aplicativos associados podem ser espelhados ao lado do banco de dados como um disco de máquina virtual ESX (VMDK). Nesses casos, o RPO é determinado pelo quanto um cliente investiu na automação para inicializar rapidamente o VMDK para que os aplicativos possam ser iniciados.</block>
  <block id="c7d5d755b896edf43189fbb020202913" category="paragraph">O tempo de retenção é controlado em parte pelo limite do instantâneo. Por exemplo, os volumes no ONTAP têm um limite de 1024 snapshots. Em alguns casos, os clientes multiplexaram a replicação para aumentar o limite. Por exemplo, se forem necessários 2000 dias de backups, uma fonte pode ser replicada para dois volumes com atualizações ocorrendo em dias alternados. Isso requer um aumento no espaço inicial necessário, mas ainda representa uma abordagem muito mais eficiente do que um sistema de backup tradicional, que envolve vários backups completos.</block>
  <block id="7ec0f114b69016879106b5018cdf10b9" category="section-title">Grupo de consistência de volume único</block>
  <block id="cd70f3e596e275fe80fbbe5d7858ce1a" category="paragraph">A abordagem mais simples é colocar todos os arquivos ou LUNs em um único grupo de consistência de volume, o que permite que as atualizações do SnapMirror e do SnapVault sejam agendadas diretamente no sistema de storage. Nenhum software externo é necessário.</block>
  <block id="909e8df57072d0b3c6d7d64b11acb571" category="section-title">Grupo de consistência de vários volumes</block>
  <block id="c7371eded617935ace6c71a33cfbf3fd" category="paragraph">Quando um banco de dados precisa abranger volumes, é necessário um snapshot de grupo de consistência (cg-snapshot). Como mencionado acima, isso pode ser configurado usando chamadas do Gerenciador de sistema ou API RESTful, além de o SnapCenter ser capaz de criar um snapshot de grupo de consistência simples em uma lista definida de volumes.</block>
  <block id="9c991b38c054d7bec0632efd6667540c" category="paragraph">Há também uma consideração adicional sobre o uso de snapshots consistentes e multivolumes para fins de recuperação de desastres. Ao executar uma atualização de vários volumes, é possível que um desastre possa ocorrer enquanto uma transferência ainda estiver em andamento. O resultado seria um conjunto de volumes que não são consistentes uns com os outros. Se isso aconteceu, alguns dos volumes devem ser restaurados para um estado de snapshot anterior para entregar uma imagem de banco de dados consistente com falhas e pronta para uso.</block>
  <block id="fad8a5f46ebd89f74383b461e32dd6b9" category="section-title">Recuperação de desastres: Ativação</block>
  <block id="5ac319591298468b0af89c2c469201f8" category="paragraph">O processo de ativação da cópia de recuperação de desastres depende do tipo de armazenamento. Com o NFS, os sistemas de arquivos podem ser pré-montados no servidor de recuperação de desastres. Eles estão em um estado somente leitura e se tornam leitura-escrita quando o espelho é quebrado. Isso fornece um RPO extremamente baixo, e o processo geral de recuperação de desastres é mais confiável porque há menos peças para gerenciar.</block>
  <block id="62a0282d39568be094470486eaf70c4f" category="section-title">SAN</block>
  <block id="b829fc11ff11b57af8d4632d38d7d7e8" category="paragraph">Ativar configurações SAN em caso de recuperação de desastres se torna mais complicado. A opção mais simples geralmente é quebrar temporariamente os espelhos e montar os recursos SAN, incluindo etapas como descobrir a configuração do LVM (incluindo recursos específicos do aplicativo, como o Oracle Automatic Storage Management [ASM]) e adicionar entradas ao /etc/fstab.</block>
  <block id="335a5796fb106a877544d121062534be" category="paragraph">O resultado é que os caminhos do dispositivo LUN, os nomes dos grupos de volume e outros caminhos do dispositivo são conhecidos pelo servidor de destino. Esses recursos podem então ser desligados e, depois, os espelhos podem ser restaurados. O resultado é um servidor que está em um estado que pode rapidamente colocar o aplicativo on-line. As etapas para ativar grupos de volumes, montar sistemas de arquivos ou iniciar bancos de dados e aplicativos são facilmente automatizadas.</block>
  <block id="b1a175c5f42da29f6c27f4ea29684b63" category="paragraph">É preciso ter cuidado para garantir que o ambiente de recuperação de desastres esteja atualizado. Por exemplo, é provável que novos LUNs sejam adicionados ao servidor de origem, o que significa que os novos LUNs devem ser pré-descobertos no destino para garantir que o plano de recuperação de desastres funcione conforme o esperado.</block>
  <block id="fd0d4a1100bcbce28e8252537f7c4ef4" category="summary">SLAs de proteção de dados de banco de dados Oracle</block>
  <block id="48130805e35d0c7ab5afbcb71abb1ad0" category="doc">Planejamento de rto, RPO e SLA</block>
  <block id="f359cd007fda575e70269cac76fab4af" category="paragraph">O ONTAP permite que você personalize facilmente uma estratégia de proteção de dados de banco de dados Oracle de acordo com suas necessidades de negócios.</block>
  <block id="65fd6f7f97414140b4d6060b743dc645" category="paragraph">Esses requisitos incluem fatores como a velocidade de recuperação, a perda máxima de dados permitida e as necessidades de retenção de backup. O plano de proteção de dados também deve levar em consideração vários requisitos regulatórios para retenção e restauração de dados. Finalmente, diferentes cenários de recuperação de dados devem ser considerados, desde a recuperação típica e previsível resultante de erros de usuário ou aplicativo até cenários de recuperação de desastres que incluem a perda completa de um site.</block>
  <block id="2bd1d35ff88de136066c33905c0fd677" category="paragraph">Pequenas alterações nas políticas de proteção e recuperação de dados podem ter um efeito significativo na arquitetura geral de storage, backup e recuperação. É fundamental definir e documentar padrões antes de iniciar o trabalho de design para evitar complicar uma arquitetura de proteção de dados. Recursos desnecessários ou níveis de proteção levam a custos desnecessários e sobrecarga de gerenciamento, e um requisito inicialmente negligenciado pode levar um projeto na direção errada ou exigir alterações de design de última hora.</block>
  <block id="a60e6b87ede45aef49d8d095435db22b" category="section-title">Objetivo de tempo de recuperação</block>
  <block id="3d3b341e14c584d1edcea9fe13619ee1" category="paragraph">O objetivo de tempo de recuperação (rto) define o tempo máximo permitido para a recuperação de um serviço. Por exemplo, um banco de dados de recursos humanos pode ter um rto de 24 horas porque, embora seja muito inconveniente perder o acesso a esses dados durante o dia de trabalho, a empresa ainda pode operar. Em contraste, um banco de dados que suporta o Registro geral de um banco teria um rto medido em minutos ou mesmo segundos. Um rto de zero não é possível, porque deve haver uma maneira de diferenciar entre uma interrupção de serviço real e um evento de rotina, como um pacote de rede perdido. No entanto, um rto quase zero é um requisito típico.</block>
  <block id="5a27873285a0397cc06f9f47280c9426" category="section-title">Objetivo do ponto de restauração</block>
  <block id="f3ae061e139f47d793058ee596a5243f" category="paragraph">O objetivo do ponto de restauração (RPO) define a perda máxima de dados tolerável. Em muitos casos, o RPO é determinado exclusivamente pela frequência de snapshots ou atualizações do SnapMirror.</block>
  <block id="2d68fbd3cefeb34bfd64c8f89caba64d" category="paragraph">Em alguns casos, o RPO pode ser tornado mais agressivo, protegendo determinados dados de forma seletiva com mais frequência. Em um contexto de banco de dados, o RPO geralmente é uma questão de quanto dados de log podem ser perdidos em uma situação específica. Em um cenário típico de recuperação em que um banco de dados é danificado devido a um bug de produto ou erro de usuário, o RPO deve ser zero, o que significa que não deve haver perda de dados. O procedimento de recuperação envolve restaurar uma cópia anterior dos arquivos de banco de dados e, em seguida, rereproduzir os arquivos de log para trazer o estado do banco de dados até o ponto desejado no tempo. Os ficheiros de registo necessários para esta operação já devem estar no local original.</block>
  <block id="57df8b025934bcd0f7e96bae19cf0688" category="paragraph">Em cenários incomuns, os dados de log podem ser perdidos. Por exemplo, um acidental ou malicioso<block ref="4609acba202877f99742342f4195d95e" prefix=" " category="inline-code"></block> de arquivos de banco de dados pode resultar na exclusão de todos os dados. A única opção seria restaurar do backup, incluindo arquivos de log, e alguns dados seriam inevitavelmente perdidos. A única opção para melhorar o RPO em um ambiente de backup tradicional seria executar backups repetidos dos dados de log. Isso tem limitações, no entanto, devido à constante movimentação de dados e à dificuldade de manter um sistema de backup como um serviço em constante execução. Um dos benefícios dos sistemas avançados de storage é a capacidade de proteger dados de danos acidentais ou mal-intencionados nos arquivos, além de fornecer um RPO melhor sem movimentação de dados.</block>
  <block id="645a84975202e30700b572b49a5ee29d" category="section-title">Recuperação de desastres</block>
  <block id="3d08c71e26ac92e34925e02570c4bd22" category="paragraph">A recuperação de desastres inclui a arquitetura, as políticas e os procedimentos DE TI necessários para recuperar um serviço em caso de desastre físico. Isso pode incluir inundações, incêndios ou pessoas agindo com intenção maliciosa ou negligente.</block>
  <block id="78f4e749ec0c6bb2627abbbc00bce296" category="paragraph">A recuperação de desastres é mais do que apenas um conjunto de procedimentos de recuperação. É o processo completo de identificar os vários riscos, definir os requisitos de recuperação de dados e continuidade do serviço e fornecer a arquitetura certa com os procedimentos associados.</block>
  <block id="75bcd60b234aba82b5827cd7a5171563" category="paragraph">Ao estabelecer os requisitos de proteção de dados, é essencial diferenciar entre os requisitos típicos de RPO e rto e os requisitos de RPO e rto necessários para a recuperação de desastres. Alguns ambientes de aplicações exigem um RPO de zero e um rto quase zero para situações de perda de dados que vão desde um erro de usuário relativamente normal até um incêndio que destrói um data center. No entanto, existem consequências administrativas e de custos para estes elevados níveis de proteçãoão.</block>
  <block id="756651fea87d05811d7a42451d074b60" category="paragraph">Em geral, os requisitos de recuperação de dados que não sejam de desastres devem ser rigorosos por dois motivos. Primeiro, erros de aplicativos e erros de usuário que danificam dados são previsíveis ao ponto de serem quase inevitáveis. Em segundo lugar, não é difícil projetar uma estratégia de backup que possa fornecer um RPO de zero e um rto baixo, contanto que o sistema de storage não seja destruído. Não há motivo para não solucionar um risco significativo que seja facilmente remediado, e é por isso que os destinos RPO e rto para recuperação local devem ser agressivos.</block>
  <block id="cb6faee28dd34d25f06bd0b33abe1c2f" category="paragraph">Os requisitos de rto e RPO para recuperação de desastres variam mais amplamente com base na probabilidade de um desastre e nas consequências da perda ou interrupção de dados associada a uma empresa. Os requisitos de RPO e rto devem ser baseados nas necessidades reais dos negócios e não em princípios gerais. Eles devem levar em conta vários cenários de desastre lógico e físico.</block>
  <block id="68f31611fc8a5e6a20793905280a7001" category="section-title">Desastres lógicos</block>
  <block id="07f5727077caaf8dedf895542181d26b" category="paragraph">Os desastres lógicos incluem corrupção de dados causada por usuários, erros de aplicativos ou sistemas operacionais e falhas de software. Os desastres lógicos também podem incluir ataques maliciosos de terceiros com vírus ou worms ou explorando vulnerabilidades de aplicativos. Nesses casos, a infraestrutura física não está danificada, mas os dados subjacentes não são mais válidos.</block>
  <block id="3cb5ee5f24e42f56ba6dac48b7b046d2" category="paragraph">Um tipo cada vez mais comum de desastre lógico é conhecido como ransomware, no qual um vetor de ataque é usado para criptografar dados. A criptografia não danifica os dados, mas torna-os indisponíveis até que o pagamento seja feito a terceiros. Um número cada vez maior de empresas está sendo alvo específico de hacks de ransomware. Para essa ameaça, o NetApp oferece snapshots à prova de violações, onde nem mesmo o administrador de storage pode alterar os dados protegidos antes da data de expiração configurada.</block>
  <block id="91c87f53ce0a1f416308a67ce119c623" category="section-title">Desastres físicos</block>
  <block id="79055ca11f54a97d22617a656eab8b9b" category="paragraph">Os desastres físicos incluem a falha de componentes de uma infraestrutura que excede seus recursos de redundância e resultam em perda de dados ou perda estendida de serviço. Por exemplo, a proteção RAID fornece redundância de unidade de disco e o uso de HBAs fornece redundância de porta FC e cabo FC. Falhas de hardware de tais componentes são previsíveis e não afetam a disponibilidade.</block>
  <block id="3f7c55fe5f35f94cd2c4bd73b9cbb11b" category="paragraph">Em um ambiente corporativo, geralmente é possível proteger a infraestrutura de um local inteiro com componentes redundantes até o ponto em que o único cenário de desastre físico previsível é a perda completa do local. O Planejamento de recuperação de desastre depende da replicação local a local.</block>
  <block id="7f3dd7bdd41f7af6853732a383bbd7e2" category="section-title">Proteção de dados síncrona e assíncrona</block>
  <block id="c5ac17d5693914368f39b40a07af23d4" category="paragraph">Em um mundo ideal, todos os dados seriam replicados de forma síncrona em locais geograficamente dispersos. Essa replicação nem sempre é viável ou até possível por várias razões:</block>
  <block id="28c59a675d03e1f62a48958bb53ae523" category="list-text">A replicação síncrona aumenta inevitavelmente a latência de gravação porque todas as alterações devem ser replicadas em ambos os locais antes que a aplicação/banco de dados possa prosseguir com o processamento. O efeito de desempenho resultante às vezes é inaceitável, descartando o uso do espelhamento síncrono.</block>
  <block id="50a05ceeb998c4dac7e8b5d706fe2029" category="list-text">O aumento da adoção do storage SSD de 100% significa que a latência de gravação adicional provavelmente será notada porque as expectativas de desempenho incluem centenas de milhares de IOPS e latência inferior a milissegundos. Aproveitar todos os benefícios do uso de SSDs de 100% pode exigir uma nova visita à estratégia de recuperação de desastres.</block>
  <block id="04d90fe6288ce6cceba54a2b71e55727" category="list-text">Os conjuntos de dados continuam a crescer em termos de bytes, criando desafios com a garantia de largura de banda suficiente para sustentar a replicação síncrona.</block>
  <block id="d3aaae220bd5b3d68dd4ccec3bf78197" category="list-text">Os conjuntos de dados também crescem em termos de complexidade, criando desafios com o gerenciamento da replicação síncrona de grande escala.</block>
  <block id="c3a841e0bfc640f91b0a00c4af8c6f5c" category="list-text">Estratégias baseadas na nuvem frequentemente envolvem maiores distâncias de replicação e latência, o que impede o uso do espelhamento síncrono.</block>
  <block id="7df1515e247dfa2063c433b9339c2d4a" category="paragraph">A NetApp oferece soluções que incluem replicação síncrona para as demandas mais exigentes de recuperação de dados e soluções assíncronas que proporcionam melhor desempenho e flexibilidade. Além disso, a tecnologia NetApp se integra perfeitamente a muitas soluções de replicação de terceiros, como o Oracle DataGuard</block>
  <block id="4d2c802af835583121763e1a6acc3f9b" category="section-title">Tempo de retenção</block>
  <block id="123dbb4c09a5c8fb993a856cf65c9d25" category="paragraph">O último aspeto de uma estratégia de proteção de dados é o tempo de retenção de dados, que pode variar muito.</block>
  <block id="d3a424909a8559a2d076e5d9a28d834f" category="list-text">Um requisito típico é de 14 dias de backups noturnos no local principal e 90 dias de backups armazenados em um local secundário.</block>
  <block id="1d7c2d97c3bfd5ca9489e0ffeb06b150" category="list-text">Muitos clientes criam arquivos trimestrais autônomos armazenados em Mídias diferentes.</block>
  <block id="61ae175e4a0c88c4624184a0cb9b04d2" category="list-text">Um banco de dados constantemente atualizado pode não ter necessidade de dados históricos, e os backups precisam ser mantidos apenas por alguns dias.</block>
  <block id="8bb85c2149e1e808032e7025b0a27b80" category="list-text">Os requisitos regulatórios podem exigir recuperação até o ponto de qualquer transação arbitrária em uma janela de 365 dias.</block>
  <block id="8dbb58cb7fbd4c7db3f14b9674e7d4e6" category="summary">Recuperação rápida de banco de dados Oracle com o SnapRestore</block>
  <block id="863696626734d6591db8be57b41c7eec" category="paragraph">A restauração rápida de dados no ONTAP a partir de um snapshot é fornecida pela tecnologia NetApp SnapRestore.</block>
  <block id="9099b669f87419bc03914f11f5779c60" category="paragraph">Quando um conjunto de dados essencial não está disponível, as operações de negócios essenciais estão inativas. As fitas podem quebrar, e até mesmo as restaurações de backups baseados em disco podem ser lentas para serem transferidas pela rede. O SnapRestore evita esses problemas fornecendo restauração quase instantânea de conjuntos de dados. Mesmo os bancos de dados em escala de petabyte podem ser completamente restaurados com apenas alguns minutos de esforço.</block>
  <block id="b02fb7dec22d0e276ca01cc60b9efb48" category="paragraph">Existem duas formas de SnapRestore - baseado em arquivo/LUN e baseado em volume.</block>
  <block id="520e4b70b10aa2755a82b77e438a510f" category="list-text">Arquivos individuais ou LUNs podem ser restaurados em segundos, seja um arquivo 2TB LUN ou 4KB.</block>
  <block id="45e8a84fe4ac58c8b30a7bdaf17c0b7f" category="list-text">O volume de arquivos ou LUNs pode ser restaurado em segundos, seja 10GB ou 100TB TB de dados.</block>
  <block id="4be4677be8cd434956b9b9af515b971a" category="paragraph">Um "contentor de arquivos ou LUNs" normalmente se referiria a um FlexVol volume. Por exemplo, você pode ter 10 LUNs que compõem um grupo de discos LVM em um único volume ou um volume pode armazenar os diretórios base NFS de usuários do 1000. Em vez de executar uma operação de restauração para cada arquivo individual ou LUN, você pode restaurar todo o volume como uma única operação. Esse processo também funciona com contêineres com escalabilidade horizontal que incluem vários volumes, como um FlexGroup ou um Grupo de consistência do ONTAP.</block>
  <block id="887757e2405372a0b9e17cc054ab38f3" category="paragraph">O motivo pelo qual o SnapRestore funciona tão rápido e eficientemente é devido à natureza de um snapshot, que é essencialmente uma visualização paralela somente leitura do conteúdo de um volume em um determinado momento. Os blocos ativos são os blocos reais que podem ser alterados, enquanto o snapshot é uma visualização somente leitura no estado dos blocos que constituem os arquivos e LUNs no momento em que o snapshot foi criado.</block>
  <block id="55abea92d64d6738f9e0ed48799696e7" category="paragraph">O ONTAP só permite acesso somente leitura a dados instantâneos, mas os dados podem ser reativados com o SnapRestore. O instantâneo é reativado como uma visualização de leitura e gravação dos dados, retornando os dados ao seu estado anterior. O SnapRestore pode operar no volume ou no nível do arquivo. A tecnologia é essencialmente a mesma com algumas pequenas diferenças de comportamento.</block>
  <block id="f10f2af75e2770a8ed3c2fde594e986d" category="section-title">Volume SnapRestore</block>
  <block id="ca9846346bc3b03cdec10f9fff456866" category="paragraph">O SnapRestore baseado em volume retorna todo o volume de dados para um estado anterior. Essa operação não requer movimentação de dados, o que significa que o processo de restauração é essencialmente instantâneo, embora a operação de API ou CLI possa levar alguns segundos para ser processada. Restaurar 1GB TB de dados não é mais complicado ou demorado do que restaurar 1PB TB de dados. Essa funcionalidade é a principal razão pela qual muitos clientes empresariais migram para os sistemas de storage da ONTAP. Ele fornece um rto medido em segundos, até mesmo para os maiores conjuntos de dados.</block>
  <block id="627436e77bb011a6a312ae87b12f98ea" category="paragraph">Uma desvantagem para o SnapRestore baseado em volume é causada pelo fato de que as alterações dentro de um volume são cumulativas ao longo do tempo. Portanto, cada snapshot e os dados de arquivo ativos dependem das alterações que levam a esse ponto. Reverter um volume para um estado anterior significa descartar todas as alterações subsequentes que foram feitas aos dados. O que é menos óbvio, no entanto, é que isso inclui instantâneos criados posteriormente. Isso nem sempre é desejável.</block>
  <block id="5c956f2c1cfc5b9e5bac32ad1acba314" category="paragraph">Por exemplo, um SLA de retenção de dados pode especificar 30 dias de backups noturnos. Restaurar um conjunto de dados para um instantâneo criado há cinco dias com o volume SnapRestore descartaria todos os snapshots criados nos cinco dias anteriores, violando o SLA.</block>
  <block id="8bf9e697004f47ed6133aef724a8a42c" category="paragraph">Existem várias opções disponíveis para resolver esta limitação:</block>
  <block id="ad3b75456e625de5fe347fb918f59a22" category="list-text">Os dados podem ser copiados de um snapshot anterior, em vez de executar um SnapRestore de todo o volume. Esse método funciona melhor com conjuntos de dados menores.</block>
  <block id="90541eb74c7c56cadc2f90ec6fb6f0c0" category="list-text">Um snapshot pode ser clonado em vez de restaurado. A limitação a essa abordagem é que o snapshot de origem é uma dependência do clone. Portanto, ele não pode ser excluído a menos que o clone também seja excluído ou seja dividido em um volume independente.</block>
  <block id="ab6045d3463c0f68ce2fa405dce9d554" category="list-text">Uso de SnapRestore baseado em arquivos.</block>
  <block id="7f7599a8b92846b691484dc91e090164" category="section-title">File SnapRestore (ficheiro)</block>
  <block id="f03eebe4f07d362dbfe4c1d4e76c724d" category="paragraph">O SnapRestore baseado em arquivo é um processo de restauração mais granular baseado em snapshot. Em vez de reverter o estado de um volume inteiro, o estado de um arquivo individual ou LUN é revertido. Não é necessário eliminar instantâneos, nem esta operação cria qualquer dependência de um instantâneo anterior. O ficheiro ou LUN fica imediatamente disponível no volume ativo.</block>
  <block id="e432fdcc277fc74a1b2b94cfeec8a7d2" category="paragraph">Nenhuma movimentação de dados é necessária durante uma restauração do SnapRestore de um arquivo ou LUN. No entanto, algumas atualizações internas de metadados são necessárias para refletir o fato de que os blocos subjacentes em um arquivo ou LUN agora existem em um snapshot e no volume ativo. Não deve haver efeito no desempenho, mas esse processo bloqueia a criação de snapshots até que ele esteja concluído. A taxa de processamento é de aproximadamente 5Gbps (18TBMB/hora) com base no tamanho total dos arquivos restaurados.</block>
  <block id="206960915d76763c590449d5ef03639a" category="summary">Bancos de dados Oracle no ONTAP e a função de snapshots</block>
  <block id="4bc550014af4fefad8f4cc8f0827c4b5" category="doc">Bancos de dados Oracle e backups baseados em snapshot</block>
  <block id="cf5bc9d838fb937caa7978b4a9b0f98a" category="paragraph">A base da proteção de dados de banco de dados Oracle no ONTAP é a tecnologia NetApp Snapshot.</block>
  <block id="a4c2aeedbfeeda21f232cbf45be91693" category="paragraph">Os valores-chave são os seguintes:</block>
  <block id="d06c89cff665ecdde6eded3c9d44cd2b" category="list-text">*Simplicidade.* Um snapshot é uma cópia somente leitura do conteúdo de um contentor de dados em um determinado momento.</block>
  <block id="175888ba89c31a851f719bdd271cae9c" category="list-text">*Eficiência.* Os instantâneos não requerem espaço no momento da criação. O espaço só é consumido quando os dados são alterados.</block>
  <block id="d853e9e275a6e58b3a9a56fa641cbb9f" category="list-text">*Capacidade de gerenciamento.* Uma estratégia de backup baseada em snapshots é fácil de configurar e gerenciar, pois os snapshots são uma parte nativa do sistema operacional de storage. Se o sistema de armazenamento estiver ligado, ele estará pronto para criar backups.</block>
  <block id="b564e5fbab71af776ed54a19d09b268c" category="list-text">*Escalabilidade.* É possível preservar até 1024 backups de um único contêiner de arquivos e LUNs. Para conjuntos de dados complexos, vários contêineres de dados podem ser protegidos por um único conjunto consistente de snapshots.</block>
  <block id="7159872a568b97a971b9ea182fb23b7c" category="list-text">O desempenho não é afetado, independentemente de um volume conter 1024 snapshots ou nenhum.</block>
  <block id="1a54f7e14e6e652bb32b12df22faf387" category="paragraph">Embora muitos fornecedores de storage ofereçam tecnologia Snapshot, a tecnologia Snapshot no ONTAP é única e oferece benefícios significativos para ambientes de aplicações e bancos de dados empresariais:</block>
  <block id="d77b23e355dc2f65b90fb52ed9a90f9c" category="list-text">As cópias snapshot fazem parte do layout de arquivo em qualquer lugar (WAFL) subjacente. Eles não são uma tecnologia adicional ou externa. Isso simplifica o gerenciamento porque o sistema de storage é o sistema de backup.</block>
  <block id="8b888e6a2d883c0111428c101532294a" category="list-text">As cópias snapshot não afetam a performance, exceto em alguns casos de borda, como quando muitos dados são armazenados em snapshots que o sistema de storage subjacente preenche.</block>
  <block id="2283ea50a243a5d1ad551f7d21f39895" category="list-text">O termo "grupo de consistência" é frequentemente usado para se referir a um agrupamento de objetos de armazenamento que são gerenciados como uma coleta consistente de dados. Um snapshot de um determinado volume ONTAP constitui um backup de grupo de consistência.</block>
  <block id="ac72c83a8204d600d567261b41c5488c" category="paragraph">Os snapshots do ONTAP também são mais dimensionados do que a tecnologia da concorrência. Os clientes podem armazenar snapshots 5, 50 ou 500 sem afetar a performance. O número máximo de instantâneos atualmente permitido em um volume é 1024. Se a retenção adicional de snapshot for necessária, há opções para colocar os snapshots em cascata em volumes adicionais.</block>
  <block id="3b7ff39ba50f1bc3f56d38c41ba51855" category="paragraph">Como resultado, proteger um conjunto de dados hospedado no ONTAP é simples e altamente dimensionável. Os backups não exigem movimentação de dados, portanto, uma estratégia de backup pode ser adaptada às necessidades da empresa, em vez das limitações de taxas de transferência de rede, grande número de unidades de fita ou áreas de preparo de disco.</block>
  <block id="55c5bbb3aad88266600eaa1a526406d4" category="paragraph">Uma pergunta comumente feita sobre o uso de snapshots como estratégia de proteção de dados é o fato de que os dados "reais" e os dados instantâneos estão localizados nas mesmas unidades. A perda dessas unidades resultaria na perda dos dados primários e do backup.</block>
  <block id="68870deb35eeb53373325a314030bd11" category="paragraph">No entanto, os snapshots locais nunca devem ser a única estratégia de backup. É por isso que a NetApp oferece tecnologia como replicação SnapMirror e SnapVault para replicar snapshots para um conjunto independente de unidades com rapidez e eficiência. Em uma solução de arquitetura adequada com snapshots e replicação de snapshot, o uso da fita pode ser minimizado para talvez um arquivamento trimestral ou eliminado totalmente.</block>
  <block id="05280349760feacdd6227fb8012e39d7" category="section-title">Backups baseados em snapshot</block>
  <block id="73d3fd255835ca3dc926f59d50223f91" category="paragraph">Há muitas opções para o uso de cópias ONTAP Snapshot para proteger seus dados. Além disso, os snapshots são a base de muitos outros recursos da ONTAP, incluindo replicação, recuperação de desastres e clonagem. Uma descrição completa da tecnologia de instantâneos está além do escopo deste documento, mas as seções a seguir fornecem uma visão geral.</block>
  <block id="7441577327d1d49b71cc2f6403e17e7b" category="paragraph">Existem duas abordagens principais para criar um instantâneo de um conjunto de dados:</block>
  <block id="b38ba43128207852ef5149e6c578ba89" category="list-text">Backups consistentes com falhas</block>
  <block id="dc64a2f6075820724476e435a1ebd7fa" category="list-text">Backups consistentes com aplicativos</block>
  <block id="ad8d77efdce72d372a83929b50a127d1" category="paragraph">Um backup consistente com falhas de um conjunto de dados refere-se à captura de toda a estrutura do conjunto de dados em um único ponto no tempo. Se o conjunto de dados for armazenado em um único volume, o processo será simples. É possível criar um Snapshot a qualquer momento. Se um conjunto de dados abranger volumes, é necessário criar um instantâneo de grupo de consistência (CG). Existem várias opções para criar snapshots CG, incluindo o software NetApp SnapCenter, recursos nativos do grupo de consistência do ONTAP e scripts mantidos pelo usuário.</block>
  <block id="32561979f55bc68c4f028fd26a9975f6" category="paragraph">Backups consistentes com falhas são usados principalmente quando a recuperação do ponto de backup é suficiente. Quando uma recuperação mais granular é necessária, backups consistentes com aplicações geralmente são necessários.</block>
  <block id="367735591e5e6e04c17b7930acb29b7d" category="paragraph">A palavra "consistente" em "consistente com aplicativos" é muitas vezes um erro. Por exemplo, colocar um banco de dados Oracle no modo de backup é referido como um backup consistente com aplicativos, mas os dados não são consistentes ou silenciosos de forma alguma. Os dados continuam a mudar durante todo o backup. Em contraste, a maioria dos backups MySQL e Microsoft SQL Server realmente silenciam os dados antes de executar o backup. A VMware pode ou não tornar certos arquivos consistentes.</block>
  <block id="6165c4352e1504dbaeef34d0cc50c187" category="section-title">Grupos de consistência</block>
  <block id="ebf90723e7659cb5381545104b618612" category="paragraph">O termo "grupo de consistência" refere-se à capacidade de um storage array gerenciar vários recursos de armazenamento como uma única imagem. Por exemplo, um banco de dados pode consistir em 10 LUNs. O array deve ser capaz de fazer backup, restaurar e replicar esses 10 LUNs de maneira consistente. A restauração não é possível se as imagens dos LUNs não forem consistentes no ponto de backup. A replicação desses 10 LUNs requer que todas as réplicas sejam perfeitamente sincronizadas umas com as outras.</block>
  <block id="3f8a43f1defaa984435092f616876545" category="paragraph">O termo "grupo de consistência" não é frequentemente usado quando se discute ONTAP porque consistência sempre foi uma função básica da arquitetura de volume e agregado dentro do ONTAP. Muitos outros storage arrays gerenciam LUNs ou sistemas de arquivos como unidades individuais. Eles poderiam, então, ser opcionalmente configurados como um "grupo de consistência" para fins de proteção de dados, mas esta é uma etapa extra na configuração.</block>
  <block id="74e816c3c784f5c30c79dca4590d7f59" category="paragraph">O ONTAP sempre foi capaz de capturar imagens de dados locais e replicados consistentes. Embora os vários volumes em um sistema ONTAP não sejam geralmente formalmente descritos como um grupo de consistência, é isso que eles são. Um snapshot desse volume é uma imagem de grupo de consistência, a restauração para esse snapshot é uma restauração de grupo de consistência, e o SnapMirror e o SnapVault oferecem replicação de grupo de consistência.</block>
  <block id="d286b747757ef3d8d3abac27bfae65f9" category="paragraph">Os snapshots de grupos de consistência (snapshots cg) são uma extensão da tecnologia básica do ONTAP Snapshot. Uma operação de snapshot padrão cria uma imagem consistente de todos os dados em um único volume, mas às vezes é necessário criar um conjunto consistente de snapshots em vários volumes e até mesmo em vários sistemas de storage. O resultado é um conjunto de instantâneos que podem ser usados da mesma forma que um instantâneo de apenas um volume individual. Eles podem ser usados para recuperação de dados local, replicados para fins de recuperação de desastres ou clonados como uma única unidade consistente.</block>
  <block id="7c199465bc6344e648e2f73c88131605" category="paragraph">O maior uso conhecido de snapshots cg é para um ambiente de banco de dados de aproximadamente 1PB TB de tamanho abrangendo 12 controladoras. Os snapshots cg criados neste sistema foram usados para backup, recuperação e clonagem.</block>
  <block id="e5c199b4a97409f33d5caae984957744" category="paragraph">Na maioria das vezes, quando um conjunto de dados abrange volumes e ordem de gravação deve ser preservado, um cg-snapshot é usado automaticamente pelo software de gerenciamento escolhido. Nesses casos, não há necessidade de entender os detalhes técnicos dos instantâneos cg. No entanto, há situações em que requisitos complicados de proteção de dados exigem controle detalhado sobre o processo de replicação e proteção de dados. Fluxos de trabalho de automação ou o uso de scripts personalizados para chamar APIs cg-snapshot são algumas das opções. Compreender a melhor opção e o papel do cg-snapshot requer uma explicação mais detalhada da tecnologia.</block>
  <block id="cf3c30ea5c240a8aef02d240f42cdff7" category="paragraph">A criação de um conjunto de instantâneos cg é um processo de duas etapas:</block>
  <block id="f30455406a91bd776afbc88e60b9697e" category="list-text">Estabeleça cercas de gravação em todos os volumes de destino.</block>
  <block id="c7afe45d94f2fd172a01e851d7f92a2f" category="list-text">Crie instantâneos desses volumes enquanto estiver no estado cercado.</block>
  <block id="c464d4671e489eaad9a8cbf0a8086ea9" category="paragraph">A esgrima de escrita é estabelecida em série. Isso significa que, à medida que o processo de esgrima é configurado em vários volumes, a e/S de gravação é congelada no primeiro volume da sequência, uma vez que continua a ser comprometida com volumes que aparecem mais tarde. Isso pode inicialmente parecer violar o requisito para que a ordem de gravação seja preservada, mas isso só se aplica a e/S que é emitida assincronamente no host e não depende de outras gravações.</block>
  <block id="688656b1f8644ee299edf7be87a8fc75" category="paragraph">Por exemplo, um banco de dados pode emitir muitas atualizações assíncronas de arquivos de dados e permitir que o sistema operacional reordene a e/S e as complete de acordo com sua própria configuração de agendador. A ordem deste tipo de e/S não pode ser garantida porque a aplicação e o sistema operativo já lançaram a exigência de preservar a ordem de escrita.</block>
  <block id="599ce07d1bae0fa6169959e2bdb97ada" category="paragraph">Como um exemplo de contador, a maioria das atividades de Registro de banco de dados é síncrona. O banco de dados não prossegue com outras gravações de log até que a e/S seja reconhecida, e a ordem dessas gravações deve ser preservada. Se uma e/S de log chegar em um volume cercado, ela não será reconhecida e a aplicação será bloqueada em outras gravações. Da mesma forma, a e/S de metadados do sistema de arquivos geralmente é síncrona. Por exemplo, uma operação de exclusão de arquivos não deve ser perdida. Se um sistema operacional com um sistema de arquivos xfs excluísse um arquivo e a e/S que atualizasse os metadados do sistema de arquivos xfs para remover a referência a esse arquivo aterrado em um volume cercado, a atividade do sistema de arquivos pausará. Isso garante a integridade do sistema de arquivos durante operações cg-snapshot.</block>
  <block id="0f0c0f05310f9cf257d65bfd936f15c5" category="paragraph">Depois que o grima de gravação é configurado nos volumes de destino, eles estão prontos para a criação de snapshot. Os instantâneos não precisam ser criados exatamente ao mesmo tempo porque o estado dos volumes é congelado de um ponto de vista de gravação dependente. Para se proteger contra uma falha na aplicação criando os instantâneos cg, a esgrima de gravação inicial inclui um tempo limite configurável no qual o ONTAP libera automaticamente a esgrima e retoma o processamento de gravação após um número definido de segundos. Se todos os instantâneos forem criados antes do período de tempo limite expirar, o conjunto de instantâneos resultante será um grupo de consistência válido.</block>
  <block id="df4925d1c6c3f3258e80ff35ce62b17d" category="section-title">Ordem de escrita dependente</block>
  <block id="6c78ee478b93fbb573157b85fb1114db" category="paragraph">Do ponto de vista técnico, a chave para um grupo de consistência é preservar a ordem de gravação e, especificamente, a ordem de gravação dependente. Por exemplo, um banco de dados gravando em 10 LUNs grava simultaneamente em todos eles. Muitas gravações são emitidas assincronamente, o que significa que a ordem em que são concluídas não é importante e a ordem real que são concluídas varia de acordo com o sistema operacional e o comportamento da rede.</block>
  <block id="69d87c00869001f3f06ad4a1494eac21" category="paragraph">Algumas operações de gravação devem estar presentes no disco antes que o banco de dados possa continuar com gravações adicionais. Essas operações críticas de gravação são chamadas de gravações dependentes. A e/S de gravação subsequente depende da presença dessas gravações no disco. Qualquer snapshot, recuperação ou replicação desses 10 LUNs deve garantir que a ordem de gravação dependente seja garantida. As atualizações do sistema de arquivos são outro exemplo de gravações dependentes da ordem de gravação. A ordem em que as alterações do sistema de arquivos são feitas deve ser preservada ou todo o sistema de arquivos pode ficar corrompido.</block>
  <block id="74fbae5d0b3c16e1774c5f4dce2c1c36" category="section-title">Estratégias</block>
  <block id="53e858edb9bd9ff3f9ead52cebf5731d" category="paragraph">Há duas abordagens principais para backups baseados em snapshot:</block>
  <block id="f87f61f625a005bd32c53f808d235eea" category="list-text">Backups ativos protegidos por snapshot</block>
  <block id="3c27a8d13352bda1e272615270d5faba" category="paragraph">Um backup consistente com falhas de um banco de dados refere-se à captura de toda a estrutura do banco de dados, incluindo datafiles, logs de refazer e arquivos de controle, em um único ponto no tempo. Se o banco de dados for armazenado em um único volume, o processo será simples; uma captura Instantânea pode ser criada a qualquer momento. Se um banco de dados abranger volumes, um snapshot de grupo de consistência (CG) deve ser criado. Existem várias opções para criar snapshots CG, incluindo o software NetApp SnapCenter, recursos nativos do grupo de consistência do ONTAP e scripts mantidos pelo usuário.</block>
  <block id="c32eba270db95747b471fd53e203a47b" category="paragraph">Os backups Snapshot consistentes com falhas são usados principalmente quando a recuperação do ponto de backup é suficiente. Registros de arquivo podem ser aplicados em algumas circunstâncias, mas quando uma recuperação pontual mais granular é necessária, um backup on-line é preferível.</block>
  <block id="82cc23cd5dc667cc9fb78ff6e76ac15b" category="paragraph">O procedimento básico para um backup on-line baseado em snapshot é o seguinte:</block>
  <block id="dbaf4855045e45fbcf678fa4cd1ab2db" category="list-text">Coloque a base de dados<block ref="402051f4be0cc3aad33bcf3ac3d6532b" prefix=" " category="inline-code"></block> no modo.</block>
  <block id="c3e07fb8aef84ef3d94e3f9d5376c091" category="list-text">Crie um instantâneo de todos os volumes que hospedam datafiles.</block>
  <block id="2d0e58ff1a25bd9fd8a85ad8ce6f2665" category="list-text">Sair<block ref="402051f4be0cc3aad33bcf3ac3d6532b" prefix=" " category="inline-code"></block> do modo.</block>
  <block id="4196c5674aaa9e4317b2b4c54f94a905" category="list-text">Execute o comando<block ref="9d2840394bc37850da4e360dbf60c0dc" prefix=" " category="inline-code"></block> para forçar o arquivamento de logs.</block>
  <block id="f2736e795871e2fc2d36addb9436f337" category="list-text">Crie instantâneos de todos os volumes que hospedam os logs do arquivo.</block>
  <block id="f24880a3fe8b242fdd1aba5a2d11196f" category="paragraph">Este procedimento produz um conjunto de instantâneos contendo datafiles no modo de backup e os logs críticos de arquivo gerados no modo de backup. Estes são os dois requisitos para recuperar um banco de dados. Arquivos como arquivos de controle também devem ser protegidos por conveniência, mas o único requisito absoluto é a proteção para arquivos de dados e logs de arquivo.</block>
  <block id="0c32649da44277db19fcfa3fe4dac28f" category="paragraph">Embora clientes diferentes possam ter estratégias muito diferentes, quase todas essas estratégias são baseadas nos mesmos princípios descritos abaixo.</block>
  <block id="88f451afed04f47352987f617f805826" category="section-title">Recuperação baseada em Snapshot</block>
  <block id="c092a9763068c8382be82f9c77bb9658" category="paragraph">Ao projetar layouts de volume para bancos de dados Oracle, a primeira decisão é se usar a tecnologia NetApp SnapRestore baseada em volume (VBSR).</block>
  <block id="15a0b8dc4d1b340d403bf6515f7e61b8" category="paragraph">O SnapRestore baseado em volume permite que um volume seja revertido quase instantaneamente para um ponto anterior no tempo. Como todos os dados no volume são revertidos, o VBSR pode não ser apropriado para todos os casos de uso. Por exemplo, se um banco de dados inteiro, incluindo datafiles, refazer logs e Registros de arquivamento, for armazenado em um único volume e esse volume for restaurado com VBSR, os dados serão perdidos porque o Registro de arquivo mais recente e os dados de refazer são descartados.</block>
  <block id="e63c0ca12b07a654ccadd92527a95c47" category="paragraph">VBSR não é necessário para restaurar. Muitos bancos de dados podem ser restaurados usando o SnapRestore de arquivo único (SFSR) baseado em arquivo ou simplesmente copiando arquivos do snapshot de volta para o sistema de arquivos ativo.</block>
  <block id="7589d3d0b42e170fc0a459aba0b87fd6" category="paragraph">O VBSR é preferido quando um banco de dados é muito grande ou quando ele deve ser recuperado o mais rápido possível, e o uso do VBSR requer isolamento dos arquivos de dados. Em um ambiente NFS, os arquivos de dados de um determinado banco de dados devem ser armazenados em volumes dedicados que não estejam contaminados por qualquer outro tipo de arquivo. Em um ambiente SAN, os arquivos de dados devem ser armazenados em LUNs dedicados em volumes dedicados. Se um gerenciador de volumes for usado (incluindo Oracle Automatic Storage Management [ASM]), o grupo de discos também deve ser dedicado a arquivos de dados.</block>
  <block id="b38bd603a952c93872eae2ea858cb15f" category="paragraph">Isolar datafiles desta maneira permite que eles sejam revertidos para um estado anterior sem danificar outros sistemas de arquivos.</block>
  <block id="5755a6275c3ecd99e8159efc58a8ff6c" category="section-title">Reserva do Snapshot</block>
  <block id="957abb72f2db3a20e0b570a5fa3a1dcc" category="paragraph">Para cada volume com dados Oracle em um ambiente SAN, o<block ref="9ca25b30dcc119f9115aad6d85fd12ce" prefix=" " category="inline-code"></block> deve ser definido como zero porque reservar espaço para um snapshot em um ambiente LUN não é útil. Se a reserva fracionária estiver definida como 100, um instantâneo de um volume com LUNs requer espaço livre suficiente no volume, excluindo a reserva instantânea, para absorver 100% de rotatividade de todos os dados. Se a reserva fracionária for definida para um valor mais baixo, uma quantidade correspondente menor de espaço livre será necessária, mas sempre exclui a reserva instantânea. Isso significa que o espaço de reserva do snapshot em um ambiente LUN é desperdiçado.</block>
  <block id="d5a06adf11e69f265f3ee3277212764e" category="paragraph">Em um ambiente NFS, há duas opções:</block>
  <block id="7631336a8e2e03f6ac500c145445b2d7" category="list-text">Defina o<block ref="9ca25b30dcc119f9115aad6d85fd12ce" prefix=" " category="inline-code"></block> com base no consumo de espaço esperado do instantâneo.</block>
  <block id="acc4c5d06fc4a9ac93880c9c2d0a6e76" category="list-text">Defina o<block ref="9ca25b30dcc119f9115aad6d85fd12ce" prefix=" " category="inline-code"></block> como zero e gerencie o consumo de espaço ativo e instantâneo coletivamente.</block>
  <block id="44806986c5abfcd6261803f4f75a7b56" category="paragraph">Com a primeira opção,<block ref="9ca25b30dcc119f9115aad6d85fd12ce" prefix=" " category="inline-code"></block> é definido para um valor diferente de zero, normalmente em torno de 20%. Este espaço é então escondido do usuário. Esse valor não cria, no entanto, um limite de utilização. Se um banco de dados com uma reserva de 20% sofrer 30% de rotatividade, o espaço instantâneo pode crescer além dos limites da reserva de 20% e ocupar espaço não reservado.</block>
  <block id="c8910acb0bfa30f82b423ff09a9710ca" category="paragraph">O principal benefício de definir uma reserva para um valor como 20% é verificar se algum espaço está sempre disponível para instantâneos. Por exemplo, um volume 1TB com uma reserva de 20% permitiria apenas que um administrador de banco de dados (DBA) armazenasse 800GB TB de dados. Essa configuração garante pelo menos 200GBMB de espaço para consumo de snapshot.</block>
  <block id="be233226a8cb890c0a8bbf041c06ac6b" category="paragraph"><block ref="9ca25b30dcc119f9115aad6d85fd12ce" prefix=" " category="inline-code"></block>Quando está definido como zero, todo o espaço no volume está disponível para o usuário final, o que proporciona melhor visibilidade. O DBA deve entender que, se ele ou ela vir um volume de 1TB TB que aproveita snapshots, esse 1TB TB de espaço será compartilhado entre dados ativos e a rotatividade do Snapshot.</block>
  <block id="b10efee713968b90d211d08ec8345d20" category="paragraph">Não há preferência clara entre a opção um e a opção dois entre os usuários finais.</block>
  <block id="8112d08173571f2d01372cadea3ea76d" category="section-title">ONTAP e snapshots de terceiros</block>
  <block id="0cc082f7cc7618a904f6cde556295cbd" category="paragraph">O Oracle Doc ID 604683,1 explica os requisitos para suporte a instantâneos de terceiros e as várias opções disponíveis para operações de backup e restauração.</block>
  <block id="130a02f8381e6c54b2ea07d2bdaf6f0b" category="paragraph">O fornecedor terceirizado deve garantir que os snapshots da empresa estejam em conformidade com os seguintes requisitos:</block>
  <block id="97eb59a0f249226523b31dd52d557e00" category="list-text">Os snapshots devem ser integrados às operações de restauração e recuperação recomendadas pela Oracle.</block>
  <block id="083e9332dc2b6bf064139ac2e670eee9" category="list-text">Os snapshots devem ser consistentes com falhas de banco de dados no ponto do snapshot.</block>
  <block id="9dae8634b638a6949dab0f7eaf7988bd" category="list-text">A ordenação de gravação é preservada para cada arquivo dentro de um snapshot.</block>
  <block id="7bc868657652757ca8505ddcd297456f" category="paragraph">Os produtos de gerenciamento ONTAP e NetApp da Oracle atendem a esses requisitos.</block>
  <block id="431bbcf828b8d3513280cb1207824991" category="summary">Backups otimizados para Oracle Storage Snapshot</block>
  <block id="5bbdf1e19bb3f7b70de51a3764fc5f19" category="doc">Backups otimizados para o Oracle Database Storage Snapshot</block>
  <block id="a962af081661ee46d4ef879de33c841e" category="paragraph">Backup e recuperação baseados em snapshot se tornaram ainda mais simples quando o Oracle 12c foi lançado porque não há necessidade de colocar um banco de dados no modo hot backup. O resultado é a capacidade de agendar backups baseados em snapshot diretamente em um sistema de storage e ainda preservar a capacidade de executar recuperação completa ou pontual.</block>
  <block id="c9447fe684870cf68e9cb4f23f44db43" category="paragraph">Embora o procedimento de recuperação de hot backup seja mais familiar aos DBAs, há muito tempo foi possível usar snapshots que não foram criados enquanto o banco de dados estava no modo hot backup. Etapas manuais extras foram necessárias com o Oracle 10gi e 11gi durante a recuperação para tornar o banco de dados consistente. Com o Oracle 12ci,<block ref="a84f4f3da79386c29ab6dfa560af786e" prefix=" " category="inline-code"></block> e<block ref="075b7d3bd3bbe7767f7ef62f430bc22b" prefix=" " category="inline-code"></block> conter a lógica extra para reproduzir logs de arquivo em backups de arquivos de dados que não estavam no modo de backup ativo.</block>
  <block id="5c7dba68615d3fa5c4c90a36dab57bcb" category="paragraph">Como discutido anteriormente, a recuperação de um hot backup baseado em snapshot requer dois conjuntos de dados:</block>
  <block id="50a7086972cada154c8164dc1c6b3539" category="list-text">Um instantâneo dos arquivos de dados criados no modo de backup</block>
  <block id="c72d009669a638aab75c21a28a2101de" category="list-text">Os logs de arquivo gerados enquanto os datafiles estavam no modo hot backup</block>
  <block id="b8de4b1201e5595bc3de878f2bf59d9b" category="paragraph">Durante a recuperação, o banco de dados lê metadados dos arquivos de dados para selecionar os logs de arquivo necessários para recuperação.</block>
  <block id="66ee0a6fd90f3cfab8320e1de1341cbd" category="paragraph">A recuperação otimizada para snapshot de storage requer conjuntos de dados ligeiramente diferentes para alcançar os mesmos resultados:</block>
  <block id="6030a1d9761fca3806ef0a0329438071" category="list-text">Um instantâneo dos arquivos de dados, além de um método para identificar a hora em que o snapshot foi criado</block>
  <block id="4e822d4c19600b654f176d335c158829" category="list-text">Arquive logs do tempo do ponto de verificação mais recente do arquivo de dados até a hora exata do instantâneo</block>
  <block id="604432b50055c69f34df17a8ed5befb5" category="paragraph">Durante a recuperação, o banco de dados lê metadados dos arquivos de dados para identificar o Registro de arquivo mais antigo necessário. A recuperação completa ou pontual pode ser realizada. Ao executar uma recuperação pontual, é fundamental saber o tempo do snapshot dos arquivos de dados. O ponto de recuperação especificado deve ser após o tempo de criação dos instantâneos. A NetApp recomenda adicionar pelo menos alguns minutos à hora do instantâneo para contabilizar a variação do relógio.</block>
  <block id="08bfe39c49a2dc07b08bd2ccd77d8281" category="paragraph">Para obter detalhes completos, consulte a documentação da Oracle sobre o tópico "recuperação usando Otimização de Snapshot de armazenamento" disponível em várias versões da documentação do Oracle 12c. Além disso, consulte Oracle Document ID Doc ID 604683,1 sobre o suporte a snapshots de terceiros da Oracle.</block>
  <block id="6a7fc1f74262f6973420f4fc849ba7f7" category="paragraph">O layout mais simples é isolar os arquivos de dados em um ou mais volumes dedicados. Eles devem ser não contaminados por qualquer outro tipo de arquivo. Isso é para garantir que os volumes de arquivo de dados possam ser restaurados rapidamente com uma operação SnapRestore sem destruir um log de refazer importante, controlfile ou log de arquivo.</block>
  <block id="ff6fb5d2136ab516e182f4b23f45886d" category="paragraph">A SAN tem requisitos semelhantes para isolamento de arquivos de dados dentro de volumes dedicados. Com um sistema operacional como o Microsoft Windows, um único volume pode conter vários LUNs de arquivo de dados, cada um com um sistema de arquivos NTFS. Com outros sistemas operacionais, geralmente há um gerenciador de volume lógico também. Por exemplo, com o Oracle ASM, a opção mais simples seria limitar grupos de discos a um único volume que pode ser feito backup e restaurado como uma unidade. Se forem necessários volumes adicionais por motivos de gerenciamento de performance ou capacidade, criar um grupo de discos adicional no novo volume resulta em gerenciamento mais fácil.</block>
  <block id="a06956ba6de69aec2dc2b015074e5821" category="paragraph">Se essas diretrizes forem seguidas, os snapshots poderão ser agendados diretamente no ONTAP sem a necessidade de realizar um snapshot de grupo de consistência. O motivo é que backups otimizados para snapshot não exigem que sejam feitos backup de dados ao mesmo tempo.</block>
  <block id="9e422c12420f1bd8c73e3c0f63da55e9" category="paragraph">Uma complicação surge em situações como um grupo de discos ASM que é distribuído entre volumes. Nesses casos, um cg-snapshot deve ser executado para garantir que os metadados ASM sejam consistentes em todos os volumes constituintes.</block>
  <block id="7a7969d6a47ed242c25f6a38f2da0e36" category="paragraph">[Nota]Verifique se os arquivos ASM spfile e passwd não estão no grupo de discos que hospeda os arquivos de dados. Isso interfere na capacidade de restaurar seletivamente datafiles e apenas datafiles.</block>
  <block id="3450fe1e1eea00fa55cfb5cb835a3d80" category="paragraph">Este procedimento pressupõe que os registos de arquivo desejados ainda estão presentes no sistema de ficheiros ativo. Se não estiverem, os registos de arquivo têm de ser restaurados ou<block ref="075b7d3bd3bbe7767f7ef62f430bc22b" prefix=" " category="inline-code"></block><block ref="a84f4f3da79386c29ab6dfa560af786e" prefix=" " category="inline-code"></block> podem ser direcionados para os dados no<block ref="a15da8cecb1f1192c4d913b8ba676121" prefix=" " category="inline-code"></block> diretório.</block>
  <block id="e43e33171833b26f6b024d28cb8b1afd" category="paragraph">Além disso, para bancos de dados menores, os arquivos de dados podem ser recuperados por um usuário final diretamente<block ref="a15da8cecb1f1192c4d913b8ba676121" prefix=" " category="inline-code"></block> do diretório sem a ajuda de ferramentas de automação ou um administrador de armazenamento para executar um comando SnapRestore.</block>
  <block id="4e3110543ebf2a771c16b3b2101f1f88" category="list-text">Quiesce o(s) grupo(s) de discos que hospedam os arquivos de dados. O procedimento varia consoante o gestor de volume lógico escolhido. Com ASM, o processo requer a desmontagem do grupo de discos. Com o Linux, os sistemas de arquivos devem ser desmontados e os volumes lógicos e grupos de volumes são desativados. O objetivo é parar todas as atualizações no grupo de volume alvo a serem restauradas.</block>
  <block id="c21d8f41541fc2a0259e7ea5e51edac3" category="paragraph">Este procedimento pressupõe que os registos de arquivo desejados ainda estão presentes no sistema de ficheiros ativo. Se não estiverem, os registos de arquivo devem ser restaurados colocando os LUNs de registo de arquivo offline e executando uma restauração. Este também é um exemplo no qual dividir os logs de arquivo em volumes dedicados é útil. Se os logs do arquivo compartilharem um grupo de volumes com os logs de refazer, os logs de refazer devem ser copiados em outro lugar antes da restauração do conjunto geral de LUNs para evitar perder as transações registradas finais.</block>
  <block id="3fd5b2a08b3d7c4db29da8590ef6013f" category="section-title">Exemplo de recuperação completa</block>
  <block id="31679daa394b7091acfd728d940b7322" category="paragraph">Suponha que os arquivos de dados foram corrompidos ou destruídos e a recuperação completa é necessária. O procedimento para o fazer é o seguinte:</block>
  <block id="aa09ca247daac25fc18c2633124ca9b6" category="section-title">Exemplo de recuperação pontual</block>
  <block id="935ff627038d1f5001220c8df7f0e1b9" category="paragraph">Todo o procedimento de recuperação é um único comando:<block ref="3df448f0a5ec82cac76d91ba14c0fa1d" prefix=" " category="inline-code"></block>.</block>
  <block id="dcd27cf8b8ceae2cd84c898d3c1b9fdb" category="paragraph">Se a recuperação pontual for necessária, o carimbo de data/hora do(s) instantâneo(s) deve(m) ser conhecido(s) e pode(m) ser identificado(s) da seguinte forma:</block>
  <block id="17108ef3ad2e1e613b844beb5f2c6d29" category="paragraph">A hora de criação do instantâneo é listada como 9th de Março e 10:10:06. Para estar seguro, um minuto é adicionado à hora do instantâneo:</block>
  <block id="904b0a17b003c70e398ea85996f0f9ba" category="paragraph">A recuperação agora é iniciada. Ele especificou um tempo instantâneo de 10:11:00, um minuto após o tempo gravado para contabilizar a possível variação do relógio e um tempo de recuperação alvo de 10:44. Em seguida, sqlplus solicita os logs de arquivo necessários para alcançar o tempo de recuperação desejado de 10:44.</block>
  <block id="91f99c5ad04365fb4d00e509963e2a0c" category="admonition">A recuperação completa de um banco de dados usando snapshots usando o<block ref="3df448f0a5ec82cac76d91ba14c0fa1d" prefix=" " category="inline-code"></block> comando não requer licenciamento específico, mas a recuperação pontual usando<block ref="72104026d9850e8c478c23b2e2e4e8e9" prefix=" " category="inline-code"></block> requer a licença Oracle Advanced Compression.</block>
  <block id="5a7f49be424e282d22b4c3889f5cd341" category="paragraph">O MetroCluster é um recurso ONTAP que pode proteger seus bancos de dados Oracle com espelhamento síncrono de 0 RPO entre locais e escala para oferecer suporte a centenas de bancos de dados em um único sistema MetroCluster.</block>
  <block id="30160293c6cf2d26d13cbd294af7fb4c" category="paragraph">Também é simples de usar. O uso do MetroCluster não necessariamente adiciona ou altera quaisquer melhores pistas para operar aplicativos e bancos de dados empresariais.</block>
  <block id="a4feacea8b05d0f24e5a4612a164a055" category="paragraph">As práticas recomendadas usuais ainda se aplicam. E, se suas necessidades exigirem apenas proteção de dados RPO de 0, essa necessidade será atendida com o MetroCluster. No entanto, a maioria dos clientes usa o MetroCluster não apenas para proteção de dados RPO igual a 0, mas também para aprimorar o rto durante cenários de desastre, bem como para fornecer failover transparente como parte das atividades de manutenção do local.</block>
  <block id="2702e101c97ce9a58738b1a4089319df" category="summary">Arquitetura lógica MetroCluster e bancos de dados Oracle</block>
  <block id="37fa92fc2662529308c62c84eb1b38ea" category="paragraph">Entender como os bancos de dados Oracle operam em um ambiente MetroCluster o alsop requer alguma explicação da funcionalidade lógica de um sistema MetroCluster.</block>
  <block id="d84d0eea463e72a6e15018c70a45af46" category="summary">Oracle, MetroCluster e NVFAIL</block>
  <block id="31b3368edcb737b712ee02926409c837" category="doc">Bancos de dados Oracle, MetroCluster e NVFAIL</block>
  <block id="490e2f530e53cf85f8ce9b052a8336ec" category="paragraph">O NVFAIL é um recurso de integridade de dados geral do ONTAP projetado para maximizar a proteção da integridade de dados com bancos de dados.</block>
  <block id="b1b3f70e4333a9dbda75a98ceb78db39" category="summary">Arquitetura física do MetroCluster e bancos de dados Oracle</block>
  <block id="d12be40db836559c628e8024f5d6ff56" category="paragraph">Entender como os bancos de dados Oracle operam em um ambiente MetroCluster requer alguma explicação do design físico de um sistema MetroCluster.</block>
  <block id="5e33c0d8a2417ce5fb6e7a211ad063bb" category="admonition">Esta documentação substitui o relatório técnico publicado anteriormente _TR-4592: Oracle no MetroCluster._</block>
  <block id="9028b52caaa7bdbfb9be779eeb1fe00e" category="summary">RAC estendido Oracle com MetroCluster</block>
  <block id="4d4d8a609e5b2ac58e622eb1e90f9e39" category="paragraph">Muitos clientes otimizam seu rto alongando um cluster do Oracle RAC entre locais, gerando uma configuração totalmente ativo-ativo. O projeto geral se torna mais complicado porque deve incluir o gerenciamento de quórum do Oracle RAC. Além disso, os dados são acessados de ambos os sites, o que significa que uma mudança forçada pode levar ao uso de uma cópia desatualizada dos dados.</block>
  <block id="89ffaa1a7d089080e9a1ce912bb8c2d3" category="paragraph">Embora uma cópia dos dados esteja presente em ambos os sites, apenas o controlador que atualmente possui um agregado pode fornecer dados. Portanto, com clusters RAC estendidos, os nós remotos devem executar e/S em uma conexão local a local. O resultado é uma latência de e/S adicionada, mas essa latência geralmente não é um problema. A rede de interconexão RAC também deve ser estendida entre locais, o que significa que uma rede de alta velocidade e baixa latência é necessária de qualquer maneira. Se a latência adicionada causar um problema, o cluster pode ser operado de forma ativo-passivo. As operações com uso intenso de e/S precisariam então ser direcionadas para os nós RAC que são locais para a controladora que possui os agregados. Os nós remotos executam então operações de e/S mais leves ou são usados puramente como servidores de espera quentes.</block>
  <block id="d8c4de538bee7abe14d3527c343afee7" category="paragraph">Se o RAC estendido ativo-ativo for necessário, a sincronização ativa do SnapMirror deve ser considerada no lugar do MetroCluster. A replicação SM-as permite que uma réplica específica dos dados seja preferida. Portanto, um cluster RAC estendido pode ser construído no qual todas as leituras ocorrem localmente. A I/o de leitura nunca cruza sites, o que proporciona a menor latência possível. Todas as atividades de gravação ainda devem transitar a conexão entre locais, mas esse tráfego é inevitável com qualquer solução de espelhamento síncrono.</block>
  <block id="f441d5fdc388f3419fb87e071534f3ce" category="inline-link-macro">Oracle RAC com ONTAP</block>
  <block id="be6001fc2ab5bfaacf123c0267e58a0a" category="admonition">Se os LUNs de inicialização, incluindo discos de inicialização virtualizados, forem usados com o Oracle RAC, o<block ref="7c13d022c9fda6e792c4349a043a6c74" prefix=" " category="inline-code"></block> parâmetro pode precisar ser alterado. Para obter mais informações sobre os parâmetros de tempo limite do RAC, <block ref="1d616ba7dc3776fc2ecabd1cd20f420f" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="58285fb769eb7fb05ab12d9e0efb3e50" category="section-title">Configuração de dois locais</block>
  <block id="af1184f29d838fbfec8d5b5bf5225f66" category="paragraph">Uma configuração RAC estendida de dois locais pode fornecer serviços de banco de dados ativo-ativo que podem sobreviver a muitos, mas não todos, cenários de desastre sem interrupções.</block>
  <block id="7544489c7854fcae445508015240a865" category="section-title">Ficheiros de votação RAC</block>
  <block id="8b6e46422f88dab6ea82f2dbcadfc76b" category="paragraph">A primeira consideração ao implantar o RAC estendido no MetroCluster deve ser o gerenciamento de quórum. O Oracle RAC tem dois mecanismos para gerenciar quórum: O batimento cardíaco do disco e o batimento cardíaco da rede. O heartbeat do disco monitora o acesso ao armazenamento usando os arquivos de votação. Com uma configuração RAC de local único, um único recurso de votação é suficiente, desde que o sistema de armazenamento subjacente ofereça recursos de HA.</block>
  <block id="fafd618b82d1827eeb8197e1c38722bc" category="paragraph">Em versões anteriores do Oracle, os arquivos de votação foram colocados em dispositivos de armazenamento físico, mas nas versões atuais do Oracle os arquivos de votação são armazenados em grupos de discos ASM.</block>
  <block id="aeab2391a07321ac474989b9c9047226" category="admonition">O Oracle RAC é compatível com NFS. Durante o processo de instalação da grade, um conjunto de processos ASM é criado para apresentar o local NFS usado para arquivos de grade como um grupo de discos ASM. O processo é quase transparente para o usuário final e não requer gerenciamento contínuo do ASM após a conclusão da instalação.</block>
  <block id="42aca4aae768d5ec1cb0c50d41b7b8b7" category="paragraph">O primeiro requisito em uma configuração de dois locais é garantir que cada local possa sempre acessar mais da metade dos arquivos de votação de forma que garanta um processo de recuperação de desastres sem interrupções. Essa tarefa era simples antes que os arquivos de votação fossem armazenados em grupos de discos ASM, mas hoje os administradores precisam entender os princípios básicos da redundância ASM.</block>
  <block id="60a723853bb2c173648452baf2199e73" category="paragraph">Os grupos de discos ASM têm três opções para redundância<block ref="6a21b6995a068148bbb65c8f949b3fb2" prefix=" " category="inline-code"></block>,<block ref="fea087517c26fadd409bd4b9dc642555" prefix=" " category="inline-code"></block> e<block ref="8d966b2253a917086c8604959e152243" prefix=" " category="inline-code"></block>. Em outras palavras, sem espelhamento, espelhado e espelhado de 3 vias. Uma opção mais recente chamada<block ref="09d2bd168181f1e64c2b1651a80a8aa8" prefix=" " category="inline-code"></block> também está disponível, mas raramente usada. O nível de redundância e o posicionamento dos dispositivos redundantes controlam o que acontece em cenários de falha. Por exemplo:</block>
  <block id="32cdeb2c0245b51a0b590e6054f03c21" category="list-text">Colocar os arquivos de votação em um<block ref="d4f266c5956ee60df748738c483f3dc0" prefix=" " category="inline-code"></block> recurso com<block ref="6a21b6995a068148bbb65c8f949b3fb2" prefix=" " category="inline-code"></block> redundância garante despejo de um site se a conetividade entre sites for perdida.</block>
  <block id="a549b4f1fc0c2d14bc333c70bbde73dc" category="list-text">Colocar os arquivos de votação em um<block ref="d4f266c5956ee60df748738c483f3dc0" prefix=" " category="inline-code"></block> com<block ref="fea087517c26fadd409bd4b9dc642555" prefix=" " category="inline-code"></block> redundância com apenas um disco ASM por site garante despejo de nó em ambos os sites se a conetividade entre sites for perdida porque nenhum dos sites teria quórum de maioria.</block>
  <block id="c15f1c43a368db0ab3dde90eca52582d" category="list-text">Colocar os arquivos de votação em um<block ref="d4f266c5956ee60df748738c483f3dc0" prefix=" " category="inline-code"></block><block ref="8d966b2253a917086c8604959e152243" prefix=" " category="inline-code"></block> com redundância com dois discos em um local e um único disco no outro local permite operações ativas-ativas quando ambos os sites estão operacionais e mutuamente acessíveis. No entanto, se o site de disco único for isolado da rede, então esse site é despejado.</block>
  <block id="478ced47a1ea1d6f0db02af749bfdaec" category="section-title">Batimento cardíaco da rede RAC</block>
  <block id="2432333dc52d6150fb3d58051bc8b0c2" category="paragraph">O batimento cardíaco da rede do Oracle RAC monitora a acessibilidade dos nós na interconexão de cluster. Para permanecer no cluster, um nó deve ser capaz de entrar em Contato com mais da metade dos outros nós. Em uma arquitetura de dois locais, esse requisito cria as seguintes opções para a contagem de nós RAC:</block>
  <block id="3e36a59c8a51ee9cc2cba0e7051ed35f" category="list-text">O posicionamento de um número igual de nós por local resulta em despejo em um local caso a conetividade de rede seja perdida.</block>
  <block id="4955aede919912b3c62fadbc1039671b" category="list-text">O posicionamento de nós N em um local e nós N-1 no outro local garante que a perda de conetividade entre locais resulta no local com o maior número de nós restantes no quórum de rede e o local com menos nós despejando.</block>
  <block id="80bd651a66488201c928634689e2e5cc" category="paragraph">Antes do Oracle 12cR2, não era viável controlar qual lado experimentaria um despejo durante a perda do local. Quando cada local tem um número igual de nós, o despejo é controlado pelo nó principal, que em geral é o primeiro nó RAC a inicializar.</block>
  <block id="d128c05245b2e633856a5061db176b7e" category="paragraph">O Oracle 12cR2 introduz a capacidade de ponderação de nós. Essa capacidade dá a um administrador mais controle sobre como a Oracle resolve condições de split-brain. Como um exemplo simples, o comando a seguir define a preferência de um nó específico em um RAC:</block>
  <block id="104c5747f0d9dbb47b0d09953c709a8d" category="paragraph">Após reiniciar o Oracle High-Availability Services, a configuração será a seguinte:</block>
  <block id="693cce334ab6658c73ea67674775156b" category="paragraph">O nó<block ref="a31853cdea7badfc68b560e70cbbeb02" prefix=" " category="inline-code"></block> agora é designado como o servidor crítico. Se os dois nós RAC estiverem isolados,<block ref="a31853cdea7badfc68b560e70cbbeb02" prefix=" " category="inline-code"></block> sobrevive e<block ref="bf38e7432ba60433c4c8967fc8da0258" prefix=" " category="inline-code"></block> é despejado.</block>
  <block id="386839b09451962d03e26b7bbfabce74" category="admonition">Para obter detalhes completos, consulte o white paper da Oracle "Visão geral técnica do Oracle Clusterware 12c versão 2. "</block>
  <block id="11f65689342acc8f71c8014eeb7945ee" category="paragraph">Para versões do Oracle RAC anteriores ao 12cR2, o nó principal pode ser identificado verificando os logs do CRS da seguinte forma:</block>
  <block id="c8b8cd80b31dac17fb85459c341042bd" category="paragraph">Este log indica que o nó principal é<block ref="c81e728d9d4c2f636f067f89cc14862c" prefix=" " category="inline-code"></block> e o nó<block ref="a31853cdea7badfc68b560e70cbbeb02" prefix=" " category="inline-code"></block> tem uma ID de<block ref="c4ca4238a0b923820dcc509a6f75849b" prefix=" " category="inline-code"></block>. Esse fato significa que<block ref="a31853cdea7badfc68b560e70cbbeb02" prefix=" " category="inline-code"></block> não é o nó principal. A identidade do nó principal pode ser confirmada com o comando<block ref="08e7c60bbf8289a563b25cc033d431f7" prefix=" " category="inline-code"></block>.</block>
  <block id="fdf6179b59d3f4873b042609a5f09bc4" category="paragraph">O nó com uma ID de<block ref="c81e728d9d4c2f636f067f89cc14862c" prefix=" " category="inline-code"></block> é<block ref="bf38e7432ba60433c4c8967fc8da0258" prefix=" " category="inline-code"></block>, que é o nó principal. Em uma configuração com números iguais de nós em cada site, o site com<block ref="bf38e7432ba60433c4c8967fc8da0258" prefix=" " category="inline-code"></block> é o site que sobrevive se os dois conjuntos perderem a conetividade de rede por qualquer motivo.</block>
  <block id="f2932b43ad604fa01d57212558608ed6" category="paragraph">É possível que a entrada de log que identifica o nó mestre possa ficar fora do sistema. Nesta situação, os carimbos de data/hora dos backups do Oracle Cluster Registry (OCR) podem ser usados.</block>
  <block id="50cd29958db0c1dcb6505d470f553e54" category="paragraph">Este exemplo mostra que o nó principal é<block ref="bf38e7432ba60433c4c8967fc8da0258" prefix=" " category="inline-code"></block>. Ele também indica uma mudança no nó mestre de<block ref="a31853cdea7badfc68b560e70cbbeb02" prefix=" " category="inline-code"></block> para<block ref="bf38e7432ba60433c4c8967fc8da0258" prefix=" " category="inline-code"></block> algum lugar entre 2:05 e 21:39 em 4 de maio. Este método de identificação do nó principal só é seguro se os logs do CRS também tiverem sido verificados porque é possível que o nó principal tenha sido alterado desde o backup OCR anterior. Se essa alteração tiver ocorrido, ela deverá estar visível nos logs do OCR.</block>
  <block id="df044a3c3d7f7f244db7c42b347b9a90" category="paragraph">A maioria dos clientes escolhe um único grupo de discos de votação que atende todo o ambiente e um número igual de nós RAC em cada local. O grupo de discos deve ser colocado no site que contém o banco de dados. O resultado é que a perda de conetividade resulta em despejo no local remoto. O site remoto não teria mais quórum, nem teria acesso aos arquivos do banco de dados, mas o site local continua sendo executado como de costume. Quando a conetividade é restaurada, a instância remota pode ser colocada online novamente.</block>
  <block id="84a24276bfdfbe485b9d961c1a57a830" category="paragraph">Em caso de desastre, é necessário um switchover para colocar os arquivos do banco de dados e o grupo de discos de votação on-line no local sobrevivente. Se o desastre permitir que o AUSO acione o switchover, o NVFAIL não será acionado porque o cluster é conhecido por estar em sincronia e os recursos de storage ficam online normalmente. AUSO é uma operação muito rápida e deve ser concluída antes que o<block ref="0494651671c3dc7f1ccdf99a4368a2cf" prefix=" " category="inline-code"></block> período expire.</block>
  <block id="6244ee13e435dcc768edbc9b0b38b73e" category="paragraph">Como existem apenas dois locais, não é possível usar qualquer tipo de software de quebra de informações externo automatizado, o que significa que o switchover forçado deve ser uma operação manual.</block>
  <block id="568c8c12fdb7c74f65125732ee717ad3" category="section-title">Configurações de três locais</block>
  <block id="2c7696fb04f52eb5687d059415066fa7" category="paragraph">Um cluster RAC estendido é muito mais fácil de arquitetar com três locais. Os dois sites que hospedam cada metade do sistema MetroCluster também dão suporte aos workloads de banco de dados, enquanto o terceiro local serve como desempate para o banco de dados e para o sistema MetroCluster. A configuração do Oracle tiebreaker pode ser tão simples quanto colocar um membro do grupo de discos ASM usado para votar em um site 3rd e também pode incluir uma instância operacional no site 3rd para garantir que haja um número ímpar de nós no cluster RAC.</block>
  <block id="6265611ca77e9ad52249c5fdd4780da9" category="admonition">Consulte a documentação da Oracle sobre "grupo de falha de quórum" para obter informações importantes sobre o uso do NFS em uma configuração RAC estendida. Em resumo, as opções de montagem NFS podem precisar ser modificadas para incluir a opção de software para garantir que a perda de conetividade com os recursos de quórum de hospedagem de sites 3rd não pendure os servidores Oracle primários ou os processos Oracle RAC.</block>
  <block id="9dc6a9986107298da2a22e7c5a3efb00" category="summary">Instância única Oracle no MetroCluster</block>
  <block id="f2cf6b943d224a732c92223538580ee9" category="doc">Oracle instância única no MetroCluster</block>
  <block id="f8b28e31633ae72c2971ee8b815ed4af" category="paragraph">Como dito anteriormente, a presença de um sistema MetroCluster não necessariamente adiciona ou altera quaisquer práticas recomendadas para operar um banco de dados. A maioria dos bancos de dados atualmente em execução em sistemas MetroCluster cliente é uma instância única e segue as recomendações na documentação do Oracle On ONTAP.</block>
  <block id="3ff8bcf18c694581aa25b0a347508e0f" category="section-title">Failover com um SO pré-configurado</block>
  <block id="f4872c843923dd8d8731ef66462b5a99" category="paragraph">O SyncMirror fornece uma cópia síncrona dos dados no local de recuperação de desastre, mas disponibilizar esses dados requer um sistema operacional e as aplicações associadas. A automação básica pode melhorar significativamente o tempo de failover do ambiente geral. Os produtos Clusterware, como o Veritas Cluster Server (VCS), são frequentemente usados para criar um cluster nos sites e, em muitos casos, o processo de failover pode ser conduzido com scripts simples.</block>
  <block id="c50820a41eb4f23d0a3acc1eeddb391b" category="paragraph">Se os nós primários forem perdidos, o clusterware (ou scripts) é configurado para colocar os bancos de dados on-line no site alternativo. Uma opção é criar servidores de reserva pré-configurados para os recursos NFS ou SAN que compõem o banco de dados. Se o site principal falhar, a alternativa clusterware ou scripted executa uma sequência de ações semelhantes às seguintes:</block>
  <block id="442f34633164f1be348a442b2c62d29d" category="list-text">Forçar um switchover do MetroCluster</block>
  <block id="e081e79ea1b1040c51d4a452e46de76d" category="list-text">Realizando a descoberta de FC LUNs (somente SAN)</block>
  <block id="2a6f458321ddf666cb0c876ee39255f3" category="list-text">Montagem de sistemas de arquivos e/ou montagem de grupos de discos ASM</block>
  <block id="3dee93bd9bc9b8b50dcdd2066a86009f" category="list-text">Iniciando o banco de dados</block>
  <block id="620515885465a26daea6cc6441403e34" category="paragraph">O principal requisito dessa abordagem é um sistema operacional em execução no local remoto. Ele deve ser pré-configurado com binários Oracle, o que também significa que tarefas como patches Oracle devem ser executadas no site primário e em espera. Como alternativa, os binários Oracle podem ser espelhados para o local remoto e montados se um desastre for declarado.</block>
  <block id="e60946bf73021e18706a6ac33386b376" category="paragraph">O procedimento de ativação real é simples. Comandos como o reconhecimento LUN requerem apenas alguns comandos por porta FC. A montagem do sistema de arquivos não é mais do que um<block ref="19822b1b15d9eefc54c07ab49f87b100" prefix=" " category="inline-code"></block> comando, e os bancos de dados e ASM podem ser iniciados e parados na CLI com um único comando. Se os volumes e os sistemas de arquivos não estiverem em uso no local de recuperação de desastres antes do switchover, não há requisito de definir<block ref="3b93661df04b698b1340ff2da3238d16" prefix=" " category="inline-code"></block> os volumes.</block>
  <block id="486eed21f55b6fb544db5504294592e6" category="section-title">Failover com um sistema operacional virtualizado</block>
  <block id="bf65e943f86f26b49698bfdac9b95f81" category="paragraph">O failover de ambientes de banco de dados pode ser estendido para incluir o próprio sistema operacional. Em teoria, esse failover pode ser feito com LUNs de inicialização, mas na maioria das vezes é feito com um sistema operacional virtualizado. O procedimento é semelhante aos seguintes passos:</block>
  <block id="7c37589384e83d2b43bba430c18a45aa" category="list-text">Montagem dos armazenamentos de dados que hospedam as máquinas virtuais do servidor de banco de dados</block>
  <block id="3d4d04d6cdab90b7ca0deb0344f04eec" category="list-text">Iniciar as máquinas virtuais</block>
  <block id="edb5332feef69c0aa60ea10ed5d31a9f" category="list-text">Iniciando bancos de dados manualmente ou configurando as máquinas virtuais para iniciar automaticamente os bancos de dados, por exemplo, um cluster ESX pode abranger sites. Em caso de desastre, as máquinas virtuais podem ser colocadas on-line no local de recuperação de desastres após o switchover. Desde que os armazenamentos de dados que hospedam os servidores de banco de dados virtualizados não estejam em uso no momento do desastre, não há nenhum requisito para definir<block ref="3b93661df04b698b1340ff2da3238d16" prefix=" " category="inline-code"></block> os volumes associados.</block>
  <block id="4a3f422632f7d08bf0e6c05affea24e4" category="summary">Bancos de dados Oracle com SyncMirror</block>
  <block id="c702c387f07bcb4f18482e68d69a155a" category="paragraph">A base da proteção de dados Oracle com um sistema MetroCluster é o SyncMirror, uma tecnologia de espelhamento síncrono com escalabilidade horizontal e alta performance.</block>
  <block id="0c5284e14535835121effc8afb702b28" category="summary">Recuperação de desastres de banco de dados Oracle com o ONTAP</block>
  <block id="65a6ece62f52a5e2ff74baaae821ae86" category="paragraph">Recuperação de desastres refere-se à restauração de serviços de dados após um evento catastrófico, como um incêndio que destrói um sistema de storage ou até mesmo um local inteiro.</block>
  <block id="e168b3b0b2f075f39012df52c5ea3c0a" category="admonition">Esta documentação substitui os relatórios técnicos publicados anteriormente _TR-4591: Oracle Data Protection_ e _TR-4592: Oracle no MetroCluster._</block>
  <block id="a91982f09e6a0341a90dae002865ea11" category="paragraph">A recuperação de desastres pode ser realizada por replicação simples de dados usando o SnapMirror, é claro, com muitos clientes atualizando réplicas espelhadas quantas vezes por hora.</block>
  <block id="2ba21d57ee7f1d78a405b9e80c6aaf6b" category="paragraph">Para a maioria dos clientes, a recuperação de desastres requer mais do que apenas a posse de uma cópia remota de dados. Isso exige a capacidade de usar esses dados rapidamente. A NetApp oferece duas tecnologias que atendem a essa necessidade: MetroCluster e SnapMirror ative Sync</block>
  <block id="ad2c5e9521f13e89cd84fdd65ec96c7d" category="paragraph">O MetroCluster se refere ao ONTAP em uma configuração de hardware que inclui armazenamento de baixo nível espelhado e vários recursos adicionais. Soluções integradas, como o MetroCluster, simplificam as infraestruturas de virtualização, aplicações e banco de dados complicadas e com escalabilidade horizontal atuais. Ele substitui vários produtos e estratégias de proteção de dados externos por um storage array simples e central. Ele também fornece backup integrado, recuperação, recuperação de desastres e alta disponibilidade (HA) em um único sistema de storage em cluster.</block>
  <block id="107bcc34799abe752a088be24869419c" category="paragraph">A sincronização ativa do SnapMirror é baseada no SnapMirror síncrono. Com o MetroCluster, cada controlador ONTAP é responsável por replicar os dados da unidade para um local remoto. Com o SnapMirror active Sync, você tem essencialmente dois sistemas ONTAP diferentes que mantêm cópias independentes dos seus dados LUN, mas cooperam para apresentar uma única instância desse LUN. Do ponto de vista do host, é uma única entidade LUN.</block>
  <block id="2bd32004298994cdcbc5a1672f2b8c95" category="summary">Instância única Oracle com sincronização ativa do SnapMirror</block>
  <block id="b704207e8ec8f6bbae1764da78cb5232" category="doc">Oracle com SnapMirror ative Sync</block>
  <block id="93c480a0b6f335159bf44fcf2e2bec93" category="paragraph">O uso da sincronização ativa do SnapMirror não necessariamente adiciona ou altera quaisquer práticas recomendadas para operar um banco de dados.</block>
  <block id="30bca7463d8c7b2108be553aabb70549" category="paragraph">A melhor arquitetura depende dos requisitos de negócios. Por exemplo, se o objetivo é ter proteção RPO igual a 0 contra a perda de dados, mas o rto estiver relaxado, o uso de bancos de dados de Instância única Oracle e a replicação dos LUNs com SM-as pode ser suficiente e menos caro de um padrão de licenciamento Oracle. A falha do local remoto não interromperia as operações e a perda do local principal resultaria em LUNs no local sobrevivente que estão on-line e prontos para serem usados.</block>
  <block id="34ff499afe445b877410a8ae3527a84f" category="paragraph">Se o rto fosse mais rigoroso, a automação ativo-passivo básica por meio de scripts ou clusterware, como pacemaker ou Ansible, melhoraria o tempo de failover. Por exemplo, o VMware HA pode ser configurado para detetar falha de VM no local principal e ativar a VM no local remoto.</block>
  <block id="63cededd737a118049828e08a2a7e8c7" category="paragraph">Finalmente, para um failover extremamente rápido, o Oracle RAC poderia ser implantado em todos os locais. O rto seria essencialmente zero porque o banco de dados estaria online e disponível em ambos os sites em todos os momentos.</block>
  <block id="5d0f4a1c768b6f8fc0a38580e17ef62b" category="summary">RAC estendido com sincronização ativa do SnapMirror</block>
  <block id="596d088e9c01a0ceec54de24c763f7c4" category="paragraph">Muitos clientes otimizam seu rto alongando um cluster do Oracle RAC entre locais, gerando uma configuração totalmente ativo-ativo. O projeto geral se torna mais complicado porque deve incluir o gerenciamento de quórum do Oracle RAC.</block>
  <block id="c128a5dcb6cee18ff198d2c48937cea1" category="paragraph">O RAC estendido tradicional em cluster contou com o espelhamento ASM para fornecer proteção de dados. Essa abordagem funciona, mas também requer muitas etapas de configuração manual e impõe sobrecarga na infraestrutura de rede. Em contraste, permitir que o SnapMirror ative Sync assuma a responsabilidade pela replicação de dados simplifica significativamente a solução. Operações como sincronização, ressincronização após interrupções, failovers e gerenciamento de quórum são mais fáceis, e a SAN não precisa ser distribuída entre locais, o que simplifica o design e o gerenciamento da SAN.</block>
  <block id="74f82d1e2ecf05353775ddaeb38bcddd" category="paragraph">A chave para entender a funcionalidade RAC no SnapMirror ative Sync é visualizar o armazenamento como um único conjunto de LUNs hospedados no armazenamento espelhado. Por exemplo:</block>
  <block id="68dcade92edf97d052fd54be2dc6b60c" category="inline-image-macro">Acesso lógico Oracle</block>
  <block id="9c4d005ebe3fb148615bd62837da8194" category="paragraph"><block ref="9c4d005ebe3fb148615bd62837da8194" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b88e2c412773438221951df1b45aa00c" category="paragraph">Não há cópia primária ou cópia espelhada. Logicamente, há apenas uma única cópia de cada LUN e esse LUN está disponível em caminhos SAN localizados em dois sistemas de armazenamento diferentes. Do ponto de vista do host, não há failovers de storage; em vez disso, há alterações de caminho. Vários eventos de falha podem levar à perda de certos caminhos para o LUN, enquanto outros caminhos permanecem on-line. A sincronização ativa do SnapMirror garante que os mesmos dados estejam disponíveis em todos os caminhos operacionais.</block>
  <block id="6e8775bd755a8835ce86806d669677ea" category="section-title">Configuração de armazenamento</block>
  <block id="31c1d5c6e07b5b3d11e0585af763dc13" category="paragraph">Neste exemplo de configuração, os discos ASM são configurados da mesma forma que seriam em qualquer configuração RAC de local único no storage empresarial. Como o sistema de armazenamento fornece proteção de dados, a redundância externa ASM seria usada.</block>
  <block id="f016e2bef75fc762898fb65f21fb9836" category="section-title">Uniforme vs acesso não ininformado</block>
  <block id="c70bc2caf8d25b4a91254d72909c7e75" category="paragraph">A consideração mais importante com o Oracle RAC na sincronização ativa do SnapMirror é usar acesso uniforme ou não uniforme.</block>
  <block id="7cb7fcd446ee1d35aa27d2af5532e2ea" category="paragraph">O acesso uniforme significa que cada host pode ver caminhos em ambos os clusters. O acesso não uniforme significa que os hosts só podem ver caminhos para o cluster local.</block>
  <block id="53934f78a11bd68da05d52b4f83ec9fc" category="paragraph">Nenhuma das opções é especificamente recomendada ou desencorajada. Alguns clientes têm fibra escura prontamente disponível para conetar sites, outros não têm essa conetividade ou sua infraestrutura de SAN não oferece suporte a um ISL de longa distância.</block>
  <block id="53772793c4bb5f4dac1c6c0eade7403c" category="section-title">Acesso não uniforme</block>
  <block id="68f708ec0a3f5091f6e432be351bf3cc" category="paragraph">O acesso não uniforme é mais simples de configurar do ponto de vista da SAN.</block>
  <block id="b923541ce3d0d3feae5be9fb6199f770" category="inline-image-macro">Acesso não uniforme do Oracle RAC</block>
  <block id="b7d64dea0436c64fbd1652575479aa68" category="paragraph"><block ref="b7d64dea0436c64fbd1652575479aa68" category="inline-image-macro-rx" type="image"></block></block>
  <block id="58dcba3041e7c7c3352e2c7f9f497eb5" category="inline-link-macro">acesso não uniforme</block>
  <block id="52aa3a00cda7a8077552683f88c13e20" category="paragraph">A principal desvantagem <block ref="56ad9440d84c5145567c05e340b22f93" category="inline-link-macro-rx"></block>da abordagem é que a perda de conetividade ONTAP site a site ou a perda de um sistema de storage resultará na perda de instâncias de banco de dados em um local. Isso obviamente não é desejável, mas pode ser um risco aceitável em troca de uma configuração SAN mais simples.</block>
  <block id="4f7fff29e362cc56706e5fe5d34884b6" category="section-title">Acesso uniforme</block>
  <block id="df51b4c411cdf825abbf60c345b2886c" category="paragraph">O acesso uniforme requer a extensão da SAN entre os locais. O principal benefício é que a perda de um sistema de storage não resultará na perda de uma instância de banco de dados. Em vez disso, isso resultaria em uma mudança multipathing em que os caminhos estão atualmente em uso.</block>
  <block id="bb79831252d74e631b0f64224932d6e6" category="paragraph">Existem várias maneiras de configurar o acesso não uniforme.</block>
  <block id="8ce82023c8f26832db1e79b32f2f7171" category="admonition">Nos diagramas abaixo, há também caminhos ativos, mas não otimizados, que seriam usados durante falhas simples do controlador, mas esses caminhos não são mostrados no interesse de simplificar os diagramas.</block>
  <block id="15670c5b41a372b781730d1a2677ed57" category="section-title">AFF com definições de proximidade</block>
  <block id="e2b2f6d768064f58804cd8cb2f295266" category="paragraph">Se houver latência significativa entre sites, os sistemas AFF podem ser configurados com configurações de proximidade do host. Isso permite que cada sistema de armazenamento esteja ciente de quais hosts são locais e quais são remotos e atribua prioridades de caminho adequadamente.</block>
  <block id="5ffb901a29d38d4d4f7c462ffbd0ad7f" category="inline-image-macro">RAC com acesso uniforme</block>
  <block id="efdefb56bfdac6f3b9194f8ce94b9ae9" category="paragraph"><block ref="efdefb56bfdac6f3b9194f8ce94b9ae9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e106da7d1088531e38324a9d76b9a988" category="paragraph">Na operação normal, cada instância do Oracle usaria preferencialmente os caminhos ativos/otimizados locais. O resultado é que todas as leituras seriam atendidas pela cópia local dos blocos. Isso produz a menor latência possível. O write IO é enviado de forma semelhante para o controlador local. O IO ainda deve ser replicado antes de ser reconhecido e, portanto, ainda incorreria na latência adicional de cruzar a rede local a local, mas isso não pode ser evitado em uma solução de replicação síncrona.</block>
  <block id="889ea87800d5947e36cda77f7d1b16b4" category="section-title">ASA / AFF sem definições de proximidade</block>
  <block id="a92e6cf0c610f6072564d047ffa516be" category="paragraph">Se não houver latência significativa entre sites, os sistemas AFF podem ser configurados sem configurações de proximidade do host ou ASA podem ser usados.</block>
  <block id="7760495be1250342ca752bb9cdc684ee" category="paragraph"><block ref="7760495be1250342ca752bb9cdc684ee" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6bad71277bac94b02b8ad4267095b9e1" category="paragraph">Cada host poderá usar todos os caminhos operacionais em ambos os sistemas de storage. Isso potencialmente melhora o desempenho de maneira significativa, permitindo que cada host aproveite o potencial de desempenho de dois clusters, e não apenas um.</block>
  <block id="56473d7f95c121dd938752e3ee76807e" category="paragraph">Com o ASA, não só todos os caminhos para ambos os clusters seriam considerados ativos e otimizados, como também os caminhos nos controladores do parceiro estariam ativos. O resultado seria caminhos SAN all-ativos em todo o cluster, o tempo todo.</block>
  <block id="22ede275964a6c559bc3f8f6d60e47ff" category="admonition">Os sistemas ASA também podem ser usados em uma configuração de acesso não uniforme. Uma vez que não existem caminhos entre locais, não haveria impactos no desempenho resultante do IO cruzando o ISL.</block>
  <block id="263e6bb36868a481a8831ae728712452" category="summary">Sincronização ativa do Oracle SnapMirror</block>
  <block id="d1864442faf9b87db487ba86c72892a9" category="paragraph">Os exemplos explicados abaixo mostram algumas das muitas opções para implantar bancos de dados de Instância única Oracle com replicação de sincronização ativa do SnapMirror.</block>
  <block id="1bd45bc28deaa95af95dd782d94963fa" category="inline-image-macro">Oracle si com acesso não uniforme</block>
  <block id="c94bc93663b0f709f6a6885553fe9153" category="paragraph"><block ref="c94bc93663b0f709f6a6885553fe9153" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b29b2b92ebd168fbb013ea878c5c1075" category="paragraph">O SnapMirror active Sync fornece uma cópia síncrona dos dados no local de recuperação de desastres, mas disponibilizar esses dados requer um sistema operacional e as aplicações associadas. A automação básica pode melhorar significativamente o tempo de failover do ambiente geral. Os produtos Clusterware, como o pacemaker, costumam ser usados para criar um cluster nos sites e, em muitos casos, o processo de failover pode ser conduzido com scripts simples.</block>
  <block id="1e953e50c45ead229eae67ed609a3a1e" category="paragraph">Se os nós primários forem perdidos, o clusterware (ou scripts) colocará os bancos de dados on-line no site alternativo. Uma opção é criar servidores em espera pré-configurados para os recursos SAN que compõem o banco de dados. Se o site principal falhar, a alternativa clusterware ou scripted executa uma sequência de ações semelhantes às seguintes:</block>
  <block id="861373097ad1daff7221c81f1ffb8bd2" category="list-text">Detectar falha do local principal</block>
  <block id="471eb645214523a67e69f308fd203df5" category="list-text">Realize a descoberta de LUNs FC ou iSCSI</block>
  <block id="aaae9cdb1dc3caf850c21cbae6cb7dd9" category="paragraph">O procedimento de ativação real é simples. Comandos como o reconhecimento LUN requerem apenas alguns comandos por porta FC. A montagem do sistema de arquivos não é mais do que um<block ref="19822b1b15d9eefc54c07ab49f87b100" prefix=" " category="inline-code"></block> comando, e os bancos de dados e ASM podem ser iniciados e parados na CLI com um único comando.</block>
  <block id="81760e5cf8ff0457c9927339fe0d7987" category="list-text">Iniciando bancos de dados manualmente ou configurando as máquinas virtuais para iniciar automaticamente os bancos de dados.</block>
  <block id="17ad404af9b36204bcadadd073042e1c" category="paragraph">Por exemplo, um cluster ESX pode abranger locais. Em caso de desastre, as máquinas virtuais podem ser colocadas on-line no local de recuperação de desastres após o switchover.</block>
  <block id="06c019e625f0595de8528ac88cab1815" category="section-title">Proteção contra falha de storage</block>
  <block id="0559887c95614fe388b0dc7f8914a2db" category="paragraph">O diagrama acima mostra o uso <block ref="56ad9440d84c5145567c05e340b22f93" category="inline-link-macro-rx"></block>do , em que a SAN não é estendida nos locais. Isso pode ser mais simples de configurar e, em alguns casos, pode ser a única opção, dada a capacidade de SAN atual, mas também significa que a falha do sistema de storage primário causaria uma interrupção do banco de dados até que o aplicativo fosse failover.</block>
  <block id="5cbfe7798787ccd0e92fcaceca503314" category="inline-link-macro">acesso uniforme</block>
  <block id="38a1b98129ec5892c90cdda2967b957c" category="paragraph">Para obter resiliência adicional, a solução poderia ser implantada com <block ref="8c3bdda17267bf34dafd546406201d13" category="inline-link-macro-rx"></block>o . Isso permitiria que os aplicativos continuassem operando usando os caminhos anunciados a partir do site oposto.</block>
  <block id="d77ca8b041bbb54326491bb1aeb6fadf" category="doc">Sincronização ativa do Oracle e do SnapMirror - RAC tiebreaker</block>
  <block id="084a4c8d8d6223c9b3c0749a4097bf8f" category="paragraph">Embora o RAC estendido usando o SnapMirror ative Sync seja uma arquitetura simétrica com relação ao IO, há uma exceção que está conetada ao gerenciamento de split-brain.</block>
  <block id="f0dd83fae83b5ba13b4e8c760578f47f" category="paragraph">O que acontece se o link de replicação for perdido e nenhum dos sites tiver quórum? O que deve acontecer? Esta pergunta se aplica ao comportamento do Oracle RAC e do ONTAP. Se as alterações não puderem ser replicadas nos sites e você quiser retomar as operações, um dos sites terá que sobreviver e o outro site terá que ficar indisponível.</block>
  <block id="58dc7db50a2e11a9de9e6cc092c59d4d" category="inline-link-macro">ONTAP Mediador</block>
  <block id="406abe933a832eefeb56c0390b824200" category="paragraph">O <block ref="6663df057ff17bcadb83516e8fd742b7" category="inline-link-macro-rx"></block> atende a esse requisito na camada ONTAP. Existem várias opções para quebra de binário RAC.</block>
  <block id="1a7cedbe5066c42f7f901bffc7905f59" category="section-title">Tiebreakers Oracle</block>
  <block id="236ca78f8e5b54033dbbd133abe79e60" category="paragraph">O melhor método para gerenciar os riscos do Oracle RAC dividido é usar um número ímpar de nós RAC, de preferência pelo uso de um desempate de site 3rd. Se um site 3rd não estiver disponível, a instância tiebreaker pode ser colocada em um local dos dois sites, designando-o efetivamente um local sobrevivente preferido.</block>
  <block id="af70ccf0217a2356d2bcebb6fab5a25b" category="section-title">Oracle e CSS_critical</block>
  <block id="e7c7cde013ca0177a945b339ca49fe1d" category="paragraph">Com um número par de nós, o comportamento padrão do Oracle RAC é que um dos nós no cluster será considerado mais importante do que os outros nós. O local com esse nó de maior prioridade sobreviverá ao isolamento do local, enquanto os nós do outro local serão despejados. A priorização é baseada em vários fatores, mas você também pode controlar esse comportamento usando a<block ref="6124b1cbe711d49d95a1c41d4e2701b4" prefix=" " category="inline-code"></block> configuração.</block>
  <block id="1a79a4d60de6718e8e5b326e338ae533" category="inline-link-macro">exemplo</block>
  <block id="6ae35dd8ffe888ab910de0d5d5e3a45a" category="paragraph">Na <block ref="0a286933b98d5160dd3059338d9fd4c7" category="inline-link-macro-rx"></block> arquitetura, os nomes de host para os nós RAC são jfs12 e jfs13. As definições atuais para<block ref="6124b1cbe711d49d95a1c41d4e2701b4" prefix=" " category="inline-code"></block> são as seguintes:</block>
  <block id="d05ceaa3e91a5aa94cbe7a8ac83ad048" category="paragraph">Se você quiser que o site com jfs12 seja o site preferido, altere esse valor para sim em um nó De site e reinicie os serviços.</block>
  <block id="d7e25fc2f6769b17d752bc3cde6d0266" category="summary">Failover de sincronização ativa do Oracle e do SnapMirror</block>
  <block id="f0972b46fa5671c4841c63750ccdebb9" category="doc">SnapMirror ative Sync - perda da replicação do Oracle RAC</block>
  <block id="8a6c7e7b423c27776aad808ff121ced3" category="paragraph">A perda do link de replicação do Oracle RAC produzirá um resultado semelhante à perda de conetividade do SnapMirror, exceto que os tempos limite serão menores por padrão. Sob as configurações padrão, um nó Oracle RAC aguardará 200 segundos após a perda de conetividade de armazenamento antes de despejar, mas só aguardará 30 segundos após a perda do batimento cardíaco da rede RAC.</block>
  <block id="488bd272072f6a962dc0b8f69fc362b8" category="paragraph">As mensagens CRS são semelhantes às mostradas abaixo. Você pode ver o intervalo de tempo limite de 30 segundos. Uma vez que CSS_critical foi definido em jfs12, localizado no local A, que será o local para sobreviver e jfs13 no local B será despejado.</block>
  <block id="80f8fcffb7c608c6d25e68111eb38b2d" category="summary">Sincronização ativa Oracle e SnapMirror - failover manual</block>
  <block id="0d97f4e7841f881ee429033c005d63ef" category="paragraph">O termo "failover" não se refere à direção da replicação com a sincronização ativa do SnapMirror porque é uma tecnologia de replicação bidirecional. Em vez disso, "failover" refere-se a qual sistema de armazenamento será o local preferido em caso de falha.</block>
  <block id="669420d9776c5672f6a1edf3bbf41604" category="paragraph">Por exemplo, você pode querer executar um failover para alterar o local preferido antes de encerrar um local para manutenção ou antes de executar um teste de DR.</block>
  <block id="1a5cda38e5f45bb47ad55cae28a62d58" category="paragraph">Exemplo de GUI:</block>
  <block id="dd8c4d4a8c7db09b331d019e9ba3a643" category="inline-image-macro">Clipe SystemManager do site preferido SM-as</block>
  <block id="50925d08482582f6a3178736557a9d6c" category="paragraph"><block ref="50925d08482582f6a3178736557a9d6c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="beecd91de8185d21ecef9d430e18d4dc" category="paragraph">Exemplo de alterá-lo de volta através da CLI:</block>
  <block id="3877a64f9dbc63cfbdca7e30e66c42a2" category="summary">Sincronização ativa Oracle e SnapMirror - falha do mediador</block>
  <block id="9daff60ceba391d4160d5e54f14037d8" category="paragraph">O serviço mediador não controla diretamente as operações de storage. Ele funciona como um caminho de controle alternativo entre clusters. Ele existe principalmente para automatizar o failover sem o risco de um cenário de divisão cerebral.</block>
  <block id="13ce4a149213a3a389210201d2850f7c" category="paragraph">Em operação normal, cada cluster replica alterações em seu parceiro, e cada cluster pode verificar se o cluster do parceiro está on-line e fornecendo dados. Se o link de replicação falhar, a replicação cessaria.</block>
  <block id="381c63e25d0de40f5be6677aa1346b0e" category="paragraph">O motivo pelo qual um mediador é necessário para operações automatizadas seguras é porque, de outra forma, seria impossível que os clusters de storage pudessem determinar se a perda de comunicação bidirecional foi o resultado de uma interrupção da rede ou falha real do storage.</block>
  <block id="e51e3b7c6dff02b4ab76ceab7b000eb8" category="list-text">A falha dos serviços de replicação por qualquer motivo resultará no lançamento do estado RPO 0 e no reinício do processamento de e/S de leitura e gravação. O site não preferencial tomará seus caminhos off-line.</block>
  <block id="957e90f10d8268ba74dc866bec3ed2fa" category="doc">SnapMirror ative Sync - perda total de conetividade</block>
  <block id="4470e5dd55a8a6253ccfd5dca462e193" category="paragraph">Se o link de replicação entre sites for completamente perdido, a sincronização ativa do SnapMirror e a conetividade do Oracle RAC serão interrompidas.</block>
  <block id="cd48b65842aa3ca6718bf9d05c82a272" category="paragraph">A deteção de split-brain do Oracle RAC tem uma dependência do batimento cardíaco do armazenamento do Oracle RAC. Se a perda de conetividade local a local resultar na perda simultânea dos serviços de replicação de armazenamento e batimento cardíaco da rede RAC, o resultado será que os sites RAC não poderão se comunicar entre locais através da interconexão RAC ou dos discos de votação RAC. O resultado em um conjunto de nós com dormência uniforme pode ser despejo de ambos os sites sob configurações padrão. O comportamento exato dependerá da sequência de eventos e do tempo das pesquisas de batimento cardíaco da rede RAC e do disco.</block>
  <block id="d76ecbc1eb83c7a69064a5bb857c85c9" category="inline-link-macro">desempate</block>
  <block id="acef32b29f0767a38d288d2517fd82e4" category="paragraph">O risco de uma interrupção no 2 local pode ser resolvido de duas maneiras. Primeiro, uma <block ref="5eea39840e87052aa3c632ea60116716" category="inline-link-macro-rx"></block> configuração pode ser usada.</block>
  <block id="f52f16ab0735aaefebdd18f6be0a1d9a" category="paragraph">Se um site 3rd não estiver disponível, esse risco pode ser resolvido ajustando o parâmetro misscount no cluster RAC. Sob os padrões, o tempo limite do batimento cardíaco da rede RAC é de 30 segundos. Isso normalmente é usado pelo RAC para identificar os nós RAC com falha e removê-los do cluster. Ele também tem uma conexão com o heartbeat do disco de votação.</block>
  <block id="c2b5462b64e9fc5a5b57a31b233c8857" category="paragraph">Se, por exemplo, o canal que transporta tráfego intersite para Oracle RAC e serviços de replicação de armazenamento for cortado por uma retroescavadeira, a contagem regressiva de 30 segundos de misscount começará. Se o nó do local preferencial RAC não puder restabelecer o Contato com o local oposto dentro de 30 segundos, e ele também não puder usar os discos de votação para confirmar que o local oposto está para baixo dentro dessa mesma janela de 30 segundos, os nós do local preferido também serão despejados. O resultado é uma interrupção completa do banco de dados.</block>
  <block id="db651e89ed200f74c11c1ae1c5d2b32d" category="paragraph">Dependendo de quando a polling do misscount ocorre, 30 segundos podem não ser tempo suficiente para que a sincronização ativa do SnapMirror expire e permita que o armazenamento no site preferido retome os serviços antes que a janela de 30 segundos expire. Esta janela de 30 segundos pode ser aumentada.</block>
  <block id="dbdaf8435bc0aa414eca4876e6c308d2" category="paragraph">Esse valor permite que o sistema de armazenamento no site preferido retome as operações antes que o tempo limite de contagem de erros expire. O resultado será, então, despejo apenas dos nós no local onde os caminhos LUN foram removidos. Exemplo abaixo:</block>
  <block id="c2e2fce3a995f59900d7afbbe58683f5" category="inline-link-macro">este link</block>
  <block id="e231fb490ed068ec9b23beb7dd95220e" category="paragraph">O Oracle Support desencoraja fortemente a alteração com os parâmetros misscount ou disktimeout para resolver problemas de configuração. A alteração desses parâmetros pode, no entanto, ser garantida e inevitável em muitos casos, incluindo configurações de inicialização por SAN, virtualizadas e replicação de armazenamento. Se, por exemplo, você tiver problemas de estabilidade com uma rede SAN ou IP que resultasse em despejos RAC, você deve corrigir o problema subjacente e não cobrar os valores do misscount ou disktimeout. Alterar tempos limite para resolver erros de configuração está mascarando um problema, não resolvendo um problema. Alterar esses parâmetros para configurar adequadamente um ambiente RAC com base em aspetos de design da infraestrutura subjacente é diferente e é consistente com as declarações de suporte Oracle. Com a inicialização SAN, é comum ajustar o misscount até 200 para corresponder ao disktimeout. <block ref="ba774c2123df7855b7691ef15a557a8c" category="inline-link-macro-rx"></block>Consulte para obter informações adicionais.</block>
  <block id="cb5f127f654db8aa1847f5e9e6c5118e" category="summary">Sincronização ativa Oracle e SnapMirror - restauração de serviço</block>
  <block id="894265e54aece56ce813211a980cdfe2" category="paragraph">SnapMirror é auto-cura. O SnapMirror active Sync detetará automaticamente a presença de uma relação de replicação com defeito e o levará de volta ao estado RPO igual a 0. Uma vez que a replicação síncrona for restabelecida, os caminhos ficarão online novamente.</block>
  <block id="c512ae64a9e9927a6314fdd926760a72" category="paragraph">Em muitos casos, os aplicativos em cluster detetarão automaticamente o retorno de caminhos com falha, e esses aplicativos também voltarão online. Em outros casos, pode ser necessária uma análise SAN no nível do host ou os aplicativos podem precisar ser colocados online manualmente.</block>
  <block id="c83e8f0dcd2a1773693ac06c752f2ddd" category="paragraph">Depende do aplicativo e de como ele é configurado e, em geral, essas tarefas podem ser facilmente automatizadas. O SnapMirror active Sync em si é auto-consertado e não deve exigir a intervenção do usuário para retomar as operações de storage RPO 0 depois que a energia e a conectividade forem restauradas.</block>
  <block id="b55bb91b49684d644a2314af260f5584" category="doc">Oracle com arquitetura de amostra de sincronização ativa do SnapMirror</block>
  <block id="8ba2bb4ebd97f28e7d98a180d8b06c1a" category="paragraph">Os exemplos de falha detalhados mostrados nestas seções são baseados na arquitetura mostrada abaixo.</block>
  <block id="5d10516d162cd9f09cf5dc249d499836" category="admonition">Esta é apenas uma das muitas opções para bancos de dados Oracle na sincronização ativa do SnapMirror. Este design foi escolhido porque ilustra alguns dos cenários mais complicados.</block>
  <block id="ce2a1d07c1660eb99608e2aeb9ffda20" category="inline-link-macro">site preferido</block>
  <block id="93d235b3b3adb1fcc631cc9720911156" category="paragraph">Neste design, suponha que o local A esteja definido no <block ref="0a07e9e6141ed78f0b7013768c76c4a9" category="inline-link-macro-rx"></block>.</block>
  <block id="3f35d87b783da3d0c6ab04c2222e88cc" category="inline-image-macro">Exemplo de Oracle no projeto SM-as</block>
  <block id="65d5312cbb5d7497db9571af7d19e76d" category="paragraph"><block ref="65d5312cbb5d7497db9571af7d19e76d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="af82c537bd0f6778b9916dc78da8c55a" category="paragraph">O resultado de uma falha do sistema de armazenamento ou do local é quase idêntico ao resultado da perda do link de replicação. O site sobrevivente deve experimentar uma pausa de IO de cerca de 15 segundos nas gravações. Uma vez decorrido esse período de 15 segundos, o IO será retomado nesse site como de costume.</block>
  <block id="24f2945a7c742e126cdf5dcdfb08ec89" category="paragraph">Se apenas o sistema de armazenamento tiver sido afetado, o nó Oracle RAC no site com falha perderá os serviços de armazenamento e entrará na mesma contagem regressiva de tempo limite de disco de 200 segundos antes da remoção e reinicialização subsequente.</block>
  <block id="0cff2ae5f5c305f11d8d8a333bd1da2c" category="paragraph">O estado do caminho SAN no nó RAC que perdeu os serviços de armazenamento é assim:</block>
  <block id="e33921fb5e166f433573176882c09294" category="paragraph">O host linux detetou a perda dos caminhos muito mais rápido do que 200 segundos, mas de uma perspetiva de banco de dados as conexões do cliente com o host no site com falha ainda serão congeladas por 200 segundos sob as configurações padrão do Oracle RAC. As operações de banco de dados completo só serão retomadas após a conclusão do despejo.</block>
  <block id="db34db4ac9bd7910a9eded83e1ff30f9" category="paragraph">Enquanto isso, o nó Oracle RAC no local oposto registrará a perda do outro nó RAC. De outra forma, continua a funcionar como de costume.</block>
  <block id="ad08bdae586fc05e13eff6bd6d9f0ee2" category="paragraph">Se o link de replicação de sincronização ativa do SnapMirror, a e/S de gravação não puder ser concluída porque seria impossível que um cluster replique alterações no local oposto.</block>
  <block id="564a95e2696af68aa1c3a4953ecd1ce9" category="section-title">Local A</block>
  <block id="18fe52a46fad1fa4c9873ea81b6e885f" category="paragraph">O resultado de uma falha no link de replicação no local A será uma pausa de aproximadamente 15 segundos no processamento de e/S de gravação, já que o ONTAP tenta replicar gravações antes de determinar que o link de replicação está genuinamente inoperável. Após os 15 segundos decorridos, o cluster do ONTAP no local A retoma o processamento de e/S de leitura e gravação. Os caminhos de SAN não serão alterados e os LUNs permanecerão online.</block>
  <block id="657e60cc43634129c8f9314afdd5c48b" category="paragraph">O link de replicação foi cortado no carimbo de data/hora 15:19:44. O primeiro aviso do Oracle RAC chega 100 segundos depois, quando o tempo limite de 200 segundos (controlado pelo parâmetro Oracle RAC disktimeout) se aproxima.</block>
  <block id="f29d4b902de1f9de93b8673047367cb3" category="paragraph">Assim que o tempo limite do disco de votação de 200 segundos for atingido, esse nó Oracle RAC se despejará do cluster e reiniciará.</block>
  <block id="b864ca7c3ca6173547e4a66ba059c688" category="summary">Oracle,SM-as,sincronização ativa,mediador</block>
  <block id="01682ebdcacbc827e3ef8083e7b4c060" category="summary">Oracle e SM-as acesso não uniforme</block>
  <block id="f6dbb06140585fe45ddeaf49cae9418e" category="summary">Sincronização ativa do Oracle e do SnapMirror</block>
  <block id="d6e7dde9799f39cece01cbc4b2728cdf" category="paragraph">O SnapMirror ative Sync permite que você crie ambientes de banco de dados Oracle de alta disponibilidade, onde LUNs estão disponíveis em dois clusters de storage diferentes.</block>
  <block id="13645bda5e7e84c7e547caee4c6325b2" category="paragraph">Com a sincronização ativa do SnapMirror, não há cópia "primária" e "secundária" dos dados. Cada cluster pode fornecer leitura de e/S de sua cópia local dos dados, e cada cluster replicará uma gravação para seu parceiro. O resultado é um comportamento de IO simétrico.</block>
  <block id="36b94662a6696bbaee0152aefe40ed13" category="paragraph">Entre outras opções, isso permite que você execute o Oracle RAC como um cluster estendido com instâncias operacionais em ambos os sites. Como alternativa, você pode criar clusters de banco de dados ativo-passivo RPO igual a 0 em que bancos de dados de instância única podem ser movidos por locais durante uma falha no local. Esse processo pode ser automatizado por meio de produtos como pacemaker ou VMware HA. A base para todas essas opções é a replicação síncrona gerenciada pela sincronização ativa do SnapMirror.</block>
  <block id="b56265ceb6311e42003e668438136a59" category="section-title">Replicação síncrona</block>
  <block id="d1a363496283d60774ff9c9c51ffe653" category="paragraph">Em operação normal, o SnapMirror active Sync fornece réplica síncrona RPO igual a 0 em todos os momentos, com uma exceção. Se os dados não puderem ser replicados, o ONTAP cumprirá o requisito de replicar dados e retomar a distribuição de I/o em um local, enquanto os LUNs no outro local ficam offline.</block>
  <block id="72f31f711b37dc7ce7b34e00dd56b5ae" category="paragraph">O Mediador ONTAP é um aplicativo de software que é baixado do suporte do NetApp e normalmente é implantado em uma pequena máquina virtual. O Mediador ONTAP não é um tiebreaker quando usado com a sincronização ativa do SnapMirror. É um canal de comunicação alternativo para os dois clusters que participam da replicação de sincronização ativa do SnapMirror. As operações automatizadas são orientadas pelo ONTAP com base nas respostas recebidas do parceiro por meio de conexões diretas e por meio do mediador.</block>
  <block id="b06e5b68abe4f23a716133f1fa1a4472" category="summary">Oracle e SM-as site preferido</block>
  <block id="6d14548094c3b2a5b0a69049f8497fa8" category="doc">Oracle e SM-as acesso uniforme</block>
  <block id="1234e92308935cf0a5a22541f312c541" category="summary">Bancos de dados Oracle com SnapMirror e SyncMirror</block>
  <block id="64bba30b717cb45555458da4fed880a1" category="paragraph">Quase todas as aplicações precisam de replicação de dados.</block>
  <block id="25fb1fa02f326334533a22c105ad3e69" category="paragraph">No nível mais básico, a replicação pode significar uma cópia em fita armazenada fora do local ou replicação no nível do aplicativo para um local de espera. A recuperação de desastres se refere ao uso dessas cópias de réplica para colocar um serviço on-line em caso de perda catastrófica de serviço.</block>
  <block id="eab6cb3a1168ef2311865e6155b8272c" category="paragraph">O ONTAP oferece várias opções de replicação para atender a uma variedade de requisitos nativamente no storage array, atendendo a uma ampla gama de necessidades. Essas opções incluem replicação simples de backups para um local remoto e uma solução síncrona e totalmente automatizada que oferece recuperação de desastres e alta disponibilidade na mesma plataforma.</block>
  <block id="32df0c1cabf839652741a56bdaac7def" category="paragraph">As principais tecnologias de replicação do ONTAP aplicáveis às aplicações são as tecnologias NetApp SnapMirror e NetApp SyncMirror. Estes não são produtos complementares; em vez disso, eles são totalmente integrados ao ONTAP e são ativados pela simples adição de uma chave de licença. A replicação no nível de storage também não é a única opção. A replicação no nível da aplicação, como o Oracle DataGuard, também pode ser integrada a uma estratégia de proteção de dados baseada no ONTAP.</block>
  <block id="a2259fa074bae962e46ca7fc7aa31be1" category="paragraph">A escolha certa depende dos requisitos específicos de replicação, recuperação e retenção.</block>
  <block id="0d3b37ff5855bf299f3c4a154373c1e2" category="section-title">ONTAP SnapMirror</block>
  <block id="296e89e943f5160d338484b3b705a44e" category="paragraph">O SnapMirror é a solução de replicação assíncrona da NetApp, ideal para proteger conjuntos de dados grandes, complicados e dinâmicos, como bancos de dados e suas aplicações associadas. Seus valores-chave são os seguintes:</block>
  <block id="d9f36dae2818ace926c4259271530724" category="list-text">*Capacidade de gerenciamento.* O SnapMirror é fácil de configurar e gerenciar porque é uma parte nativa do software de storage. Não são necessários produtos complementares. As relações de replicação podem ser estabelecidas em minutos e podem ser gerenciadas diretamente no sistema de storage.</block>
  <block id="8f761eff026903aa0140319f597d1fb0" category="list-text">*Simplicidade.* A replicação é baseada em volumes FlexVol, que são contêineres de LUNs ou arquivos replicados como um único grupo consistente.</block>
  <block id="8b737d6a9db3de6436966db508cb51d4" category="list-text">*Eficiência.* Depois que a relação de replicação inicial é estabelecida, apenas as alterações são replicadas. Além disso, recursos de eficiência como deduplicação e compactação são preservados, reduzindo ainda mais a quantidade de dados que precisam ser transferidos para um local remoto.</block>
  <block id="0783dadb67ff77ed26bbfc5d80fa0cbd" category="list-text">*Flexibilidade.* Os espelhos podem ser quebrados temporariamente para permitir testes de procedimentos de recuperação de desastres e, em seguida, o espelhamento pode ser facilmente restabelecido sem a necessidade de um novo espelhamento completo. Apenas os dados alterados devem ser aplicados para sincronizar os espelhos novamente. O espelhamento também pode ser revertido para permitir uma ressincronização rápida após a conclusão do desastre e o local original voltar ao serviço. Por fim, clones de leitura e gravação de dados replicados estão disponíveis para teste e desenvolvimento.</block>
  <block id="8a00f09d8937e890f2cfb4d7acf72733" category="paragraph">O ONTAP oferece várias tecnologias de replicação diferentes, mas a mais flexível é o SnapMirror, uma opção de espelhamento assíncrono volume a volume.</block>
  <block id="80c8fae3d0b5dd100cc984d9ba3eced7" category="paragraph">Como mencionado anteriormente, um FlexVol volume é a unidade básica de gerenciamento para backups baseados em snapshot e recuperação baseada em SnapRestore. Um FlexVol volume também é a unidade básica para replicação baseada em SnapMirror. O primeiro passo é estabelecer o espelho de linha de base do volume de origem para o volume de destino. Depois que esta relação espelhada é inicializada, todas as operações subsequentes são baseadas apenas na replicação dos dados alterados.</block>
  <block id="c1020b1755f65f23643158ce6a4d22cc" category="paragraph">Do ponto de vista da recuperação, os valores-chave do SnapMirror são os seguintes:</block>
  <block id="50bde20b37cd4d57fbff2b95f2f8ec97" category="list-text">As operações do SnapMirror são simples de entender e podem ser facilmente automatizadas.</block>
  <block id="66162be45733f65fee4abb22e989eb78" category="list-text">Uma simples atualização de uma réplica do SnapMirror requer que apenas as alterações delta sejam replicadas, reduzindo as demandas de largura de banda e permitindo atualizações mais frequentes.</block>
  <block id="a3b4fbe416387a4991ccaa8b325a68be" category="list-text">O SnapMirror é altamente granular. Ele é baseado em relacionamentos simples de volume para volume, permitindo a criação de centenas de réplicas gerenciadas de forma independente e intervalos de replicação. A replicação não precisa ser um tamanho único para todos.</block>
  <block id="4e3785883ef3ccad9938d7e35e493057" category="list-text">A direção do espelhamento pode ser facilmente revertida, preservando a capacidade de atualizar o relacionamento com base nas mudanças sozinhas. Isso fornece recurso de failback rápido depois que o local principal é restaurado para o serviço após um desastre, como uma falha de energia. Somente as alterações devem ser sincronizadas de volta à fonte.</block>
  <block id="8b8325381cf528eff12c1e678a3112f9" category="list-text">Os espelhos podem ser facilmente quebrados e resynced eficientemente para permitir o ensaio dos procedimentos de recuperação de desastres.</block>
  <block id="b1f45b7d95bfc815351fb649fa94b671" category="list-text">O SnapMirror que opera no modo de replicação em nível de bloco completo replica não apenas os dados em um volume, mas também os snapshots. Essa funcionalidade fornece uma cópia dos dados e um conjunto completo de backups no local de recuperação de desastres.</block>
  <block id="ffafd9ae31dee51209961eb2453ac806" category="paragraph">O SnapMirror operando no modo flexível de versão permite a replicação de snapshots específicos, permitindo tempos de retenção diferentes nos locais primário e secundário.</block>
  <block id="974658d7ac018cb945e78365b0a760fb" category="section-title">SnapMirror síncrono</block>
  <block id="ffbf9d0ce29a631b6eae8b22c41ec95e" category="paragraph">O SnapMirror síncrono (SM-S) é um aprimoramento para o SnapMirror que oferece replicação síncrona RPO de 0. Ele é mais usado em arquiteturas de storage em que apenas um subconjunto do total de dados requer espelhamento síncrono.</block>
  <block id="e8a45c4c0391895df78421904703c933" category="paragraph">SM-S pode operar em dois modos ligeiramente diferentes, Sync e StrictSync.</block>
  <block id="15a4e16195fb9d30c5df0e11df5c2166" category="paragraph">No modo de sincronização, as alterações são replicadas antes de serem confirmadas. Isso garante um RPO de zero, contanto que a replicação esteja operacional. Se a alteração não puder ser replicada, o SM-S pode sair do modo síncrono e permitir que as operações continuem. Isso permite RPO de 0 em circunstâncias normais, mas os processos de dados não param completamente se o destino da replicação não estiver disponível.</block>
  <block id="115455025d4664c0dd6deaaf3c1fc93c" category="paragraph">A StrictSync garante um RPO igual a 0. Uma falha na replicação de alterações resulta em um erro de e/S, que normalmente causa o desligamento de um aplicativo.</block>
  <block id="1b1ea0d1ad6e5cfb06253a14fcdcfe71" category="inline-link">TR-4733</block>
  <block id="9ccd61d6efc86cc37743fdff385832e8" category="paragraph">Para obter uma explicação completa do SM-S, consulte<block ref="4459b84726c651a8047a6486e87e48fb" category="inline-link-rx"></block> e a documentação oficial do ONTAP. Os recursos são continuamente adicionados com novas versões do ONTAP.</block>
  <block id="0651e813e385dbd62a9bca9baee23c6c" category="paragraph">O ONTAP permite a criação de snapshots de grupo de consistência. A partir do 9.13.1, o ONTAP pode replicar grupos de volumes (lembre-se de que um volume na terminologia do ONTAP não é um LUN, é um contêiner de gerenciamento que consiste em um ou mais arquivos ou LUNs) como grupo consistente.</block>
  <block id="a4cdac841b6453db2f51ce52a1303209" category="paragraph">A replicação do SnapMirror e a relação CG SnapMirror que quebra preserva a consistência nos volumes, e as sincronizações SnapMirror e SnapMirror active Sync preservam a consistência nos volumes constituintes.</block>
  <block id="455c7758003d6ebd974e8858f5ef1d7d" category="paragraph">Como resultado, você pode replicar um conjunto de dados multivolumes e garantir que todos os volumes sejam consistentes entre si. Entre outras coisas, isso permite "quebrar o espelho e ir" operações de DR sem a necessidade de etapas adicionais de recuperação de aplicativos ou bancos de dados.</block>
  <block id="c44a2da164b7b770fce6338a987670ee" category="section-title">MetroCluster e SyncMirror</block>
  <block id="b1a1cfbf3988d8abdfdedaabc1742ae9" category="paragraph">O MetroCluster também é uma solução de replicação síncrona, destinada a workloads essenciais de grande escala. A replicação é baseada no SyncMirror. Na camada mais simples, o SyncMirror cria dois conjuntos completos de dados protegidos por RAID em dois locais diferentes. Eles podem estar em salas adjacentes dentro de um data center ou podem estar localizados a muitos quilômetros de distância.</block>
  <block id="89b8adf28db7abb0febecafdca5871ad" category="paragraph">O SyncMirror é totalmente integrado ao ONTAP e opera um pouco acima do nível RAID. Portanto, todos os recursos habituais do ONTAP, como cópias Snapshot, SnapRestore e NetApp FlexClone, funcionam de forma otimizada. Ainda é ONTAP, ele inclui apenas uma camada adicional de espelhamento síncrono de dados.</block>
  <block id="75c677fa68f5d15c17efbf6fd1fe1765" category="paragraph">Uma coleção de controladores ONTAP que gerenciam dados do SyncMirror é chamada de configuração do NetApp MetroCluster. O principal objetivo do MetroCluster é fornecer acesso de alta disponibilidade a dados espelhados de forma síncrona em uma variedade de cenários típicos de falha de recuperação de desastres.</block>
  <block id="af845652f0234e1f71bc37e241ab63dc" category="paragraph">Os principais valores de proteção de dados com o MetroCluster e o SyncMirror são os seguintes:</block>
  <block id="9ab80c5e33e343c3415c21be433c4447" category="list-text">Em operações normais, o SyncMirror oferece espelhamento síncrono garantido entre locais. Uma operação de gravação não é reconhecida até que esteja presente em Mídia não volátil em ambos os sites.</block>
  <block id="680ccf94624c9f922ed236c8cc0c1af2" category="list-text">Se a conetividade entre locais falhar, o SyncMirror alterna automaticamente para o modo assíncrono para manter o site principal fornecendo dados até que a conetividade seja restaurada. Quando restaurado, ele oferece ressincronização rápida atualizando eficientemente as alterações acumuladas no local principal. A reinicialização total não é necessária.</block>
  <block id="c18ec55908c635b68abe8c6edbf6476e" category="paragraph">O SnapMirror também é totalmente compatível com sistemas baseados em SyncMirror. Por exemplo, um banco de dados principal pode estar sendo executado em um cluster MetroCluster espalhado por dois sites geográficos. Esse banco de dados também pode replicar backups para um terceiro local como arquivos de longo prazo ou para a criação de clones em um ambiente DevOps.</block>
  <block id="3873b13983c66ae61dd877b0443a3828" category="summary">Recuperação de desastres do grupo de consistência e banco de dados Oracle</block>
  <block id="5eda890cc07e4b7cd409730d8af8ddc3" category="paragraph">A replicação do grupo de consistência pode ser tão simples quanto programar a replicação de um único volume via SnapMirror. Isso inclui datafiles, controlfiles, logs de arquivo e logs de refazer. Cada atualização do SnapMirror resulta em uma nova cópia do banco de dados no site de destino que é consistente e pronta para ativação quebrando o espelho.</block>
  <block id="89cb1432594ce7c25dadf229401874e7" category="paragraph">Quando um banco de dados deve abranger volumes, é necessário um snapshot de grupo de consistência (cg-snapshot).</block>
  <block id="f96b125d1bacc785389957041be148e9" category="paragraph">Um benefício adicional dessa estratégia quando usada com o SnapMirror no modo de replicação em nível de bloco é a replicação completa de todos os snapshots no sistema de storage de origem. O complemento completo de backups é replicado, além da cópia de recuperação de desastres.</block>
  <block id="102aeb54bf1a69403672f53090c52878" category="summary">Oracle Database DR via envio de log</block>
  <block id="3a8111f0b903472ec78531619bf984f6" category="paragraph">Os procedimentos de replicação para um banco de dados Oracle são essencialmente os mesmos que os procedimentos de backup. O requisito principal é que os snapshots que constituem um backup recuperável devem ser replicados para o sistema de storage remoto.</block>
  <block id="c62b3abab4fdbaf8f0a84e8c3559b5fd" category="paragraph">Como discutido anteriormente na documentação sobre proteção de dados local, um backup recuperável pode ser criado com o processo de hot backup ou aproveitando backups otimizados por snapshot.</block>
  <block id="3d8f8c6a5c90bcd85a22fbd17390a864" category="inline-link-macro">Layout dos dados</block>
  <block id="36ba939f32969ddc6751427944e3569d" category="paragraph">O requisito mais importante é o isolamento dos arquivos de dados em um ou mais volumes dedicados. Eles devem ser não contaminados por qualquer outro tipo de arquivo. O motivo é garantir que a replicação de arquivos de dados seja totalmente independente da replicação de outros tipos de dados, como Registros de arquivo. Para obter informações adicionais sobre layouts de arquivo e detalhes importantes sobre como garantir que o layout de armazenamento seja amigável a instantâneos, <block ref="c87a7212960b8cc2aca49adb1795e291" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="f3f227cc5c07a040d61c36679053a58a" category="paragraph">Supondo que os arquivos de dados sejam encapsulados em volumes dedicados, a próxima pergunta é como gerenciar os logs do refazer, os logs do arquivo e os controlfiles. A abordagem mais simples é colocar todos esses tipos de dados em um único volume. A vantagem disso é que os logs replicados do refazer, os logs do arquivo e os controlfiles são perfeitamente sincronizados. Não há nenhum requisito para recuperação incompleta ou usar um arquivo de controle de backup, embora possa ser desejável também criar scripts de controle de backup para outros cenários de recuperação potenciais.</block>
  <block id="927992cbeccc8211e382c97e81514ef9" category="section-title">Layout de dois volumes</block>
  <block id="fe1cf96940a710dc95fd30bbb7533b52" category="paragraph">O layout mais simples é mostrado na figura a seguir.</block>
  <block id="1a43000eb9893bff7ab7b1ce1d3fd6a8" category="paragraph"><block ref="1a43000eb9893bff7ab7b1ce1d3fd6a8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="57f1db4bdf2ce49a98f375d8393f02bf" category="paragraph">Esta é a abordagem mais comum. Do ponto de vista DBA, pode parecer incomum colocar todas as cópias dos logs de refazer e arquivar logs no mesmo volume. No entanto, a separação não oferece muita proteção extra quando os arquivos e LUNs ainda estão localizados no mesmo conjunto subjacente de unidades.</block>
  <block id="bc46e4831ef5654d084e456c4c544a42" category="section-title">Layout de três volumes</block>
  <block id="f6e969769d9d166122489505d676769b" category="paragraph">Às vezes, a separação de logs de refazer é necessária devido a preocupações de proteção de dados ou a necessidade de distribuir e/S de log refazer entre controladores. Em caso afirmativo, o layout de três volumes descrito na figura abaixo será usado para replicação, evitando ainda qualquer requisito para executar a recuperação incompleta ou confiar em arquivos de controle de backup.</block>
  <block id="4b7a8562c98b8c652bdfb6aa79788222" category="paragraph"><block ref="4b7a8562c98b8c652bdfb6aa79788222" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4957c2feaa2cb72d80a0ab65228ad43f" category="paragraph">Isso permite o striping dos logs do refazer e controlfiles em conjuntos independentes de spindles e controladores na fonte. No entanto, os logs de arquivo e um conjunto de controlfiles e refazer logs ainda podem ser replicados em um estado sincronizado com os logs de arquivo.</block>
  <block id="39128da64bc55500b4b11391aa54a011" category="paragraph">Neste modelo, o volume Redo Log B não é replicado.</block>
  <block id="c0ce858e99375deac8274c96b7e5d0ee" category="section-title">Procedimento de recuperação de desastre: Backups ativos</block>
  <block id="6993729228512b7e23e3ff3ec9099f33" category="paragraph">Para executar a recuperação de desastres usando backups ativos, use o seguinte procedimento básico:</block>
  <block id="41bde9c586a860264c425700c48bd375" category="list-text">Os binários Oracle são instalados no servidor de recuperação de desastres.</block>
  <block id="cebf7cec81152da2cadffd580d81937f" category="list-text">As instâncias do banco de dados são listadas<block ref="2c0b0433aa1c96a2be6f40d9e71bc6af" prefix=" " category="inline-code"></block>no .</block>
  <block id="17f8e5eda67237f2ca94c7dcce3e4022" category="list-text">O<block ref="76a2173be6393254e72ffa4d6df1030a" prefix=" " category="inline-code"></block> e<block ref="6b2f852f7f63f2e5d4be597bbca97bb6" prefix=" " category="inline-code"></block> ou<block ref="1737629d60b511cf45957529a8f046e2" prefix=" " category="inline-code"></block> para a instância deve estar no<block ref="45c7302d9c2e8745b3a2bff0f992b6df" prefix=" " category="inline-code"></block> diretório. .</block>
  <block id="25d18766964d7515e1f5acd893094f6e" category="list-text">Quebre os espelhos para os datafiles e volume de log comum.</block>
  <block id="8fc655e4752d521563db3bfa138ba62e" category="list-text">Restaure o(s) volume(s) de arquivo de dados para o instantâneo de backup mais recente dos arquivos de dados.</block>
  <block id="68a9c75816a16f6d4f7572fe287961bf" category="list-text">Se a SAN for usada, ative grupos de volume e/ou monte sistemas de arquivos.</block>
  <block id="72e5734d53581f86093de5c97d8a3a24" category="paragraph">O uso do NFS simplifica o procedimento dramaticamente porque os sistemas de arquivos NFS para arquivos de Registro e datafiles podem ser montados no servidor de recuperação de desastres a qualquer momento. Torna-se leitura/escrita quando os espelhos estão quebrados.</block>
  <block id="de4735bc5bbfdcae3d690313c739ad67" category="section-title">Procedimento de recuperação de desastre: Backups otimizados para snapshot</block>
  <block id="6b2b8ef11e5ded8a083372ba49d488d2" category="paragraph">A recuperação de backups otimizados por snapshot é quase idêntica ao procedimento de recuperação de hot backup com as seguintes alterações:</block>
  <block id="af1e49e7bc2b25ce36bd93df09433fb4" category="list-text">Restaure o(s) volume(s) de arquivo de dados para um instantâneo criado antes da réplica atual do volume de log.</block>
  <block id="5e09669c98226c5d3a748f7e0f0333ad" category="paragraph">Essas diferenças simplificam o procedimento geral de recuperação porque não há nenhum requisito para se certificar de que um snapshot foi criado corretamente na origem enquanto o banco de dados estava no modo hot backup. O procedimento de recuperação de desastres é baseado nos carimbos de data/hora dos snapshots no local de recuperação de desastres. O estado do banco de dados quando os snapshots foram criados não é importante.</block>
  <block id="81d6beef7eaf28bbce692d4b59888f3e" category="section-title">Recuperação de desastres com snapshots hot backup</block>
  <block id="dc711b77f0d6a9c9ccf88b424509440a" category="paragraph">Este é um exemplo de uma estratégia de recuperação de desastres baseada na replicação de snapshots de hot backup. Ele também serve como um exemplo de uma estratégia de backup local simples e escalável.</block>
  <block id="edaef18e1c956b9284405fd664c4ca4a" category="paragraph">O banco de dados de exemplo está localizado em uma arquitetura básica de dois volumes.<block ref="f006bf17b06c884c47190c4225d3215a" prefix=" " category="inline-code"></block> contém datafiles e<block ref="894db1fc1592356880976f1b92c3e6a2" prefix=" " category="inline-code"></block> é usado para logs de refazer combinados, logs de arquivo e controlfiles.</block>
  <block id="fc0e7b6cd7cd15929987b1429d1c3a7e" category="paragraph">São necessárias duas programações, uma para os backups de arquivos de dados noturnos e outra para os backups de arquivos de log. Estes são chamados de meia-noite e 15minutes, respetivamente.</block>
  <block id="44c0956347a70c78d2124c1041321049" category="paragraph">Essas programações são então usadas dentro das políticas de snapshot<block ref="44dc83cda2d6b3ce99cc25803e824061" prefix=" " category="inline-code"></block> e<block ref="9b055600529d69c4ae0d2a9408dc7aa3" prefix=" " category="inline-code"></block>, como mostrado abaixo:</block>
  <block id="180e86b8e3c5049779c98c2c1006bb15" category="paragraph">Por fim, essas políticas de snapshot são aplicadas aos volumes.</block>
  <block id="2887f2c14c7efbc97d53ac2f914c5657" category="paragraph">Isso define o agendamento de backup dos volumes. Os instantâneos de arquivo de dados são criados à meia-noite e retidos por 60 dias. O volume de log contém 72 instantâneos criados em intervalos de 15 minutos, o que adiciona até 18 horas de cobertura.</block>
  <block id="e1e5ef0e7100311d950b4ffebe040670" category="paragraph">Em seguida, certifique-se de que o banco de dados está no modo hot backup quando um instantâneo de arquivo de dados é criado. Isso é feito com um pequeno script que aceita alguns argumentos básicos que iniciam e param o modo de backup no SID especificado.</block>
  <block id="683cdd7abd993faf3ace355cd6870b6f" category="paragraph">Esta etapa garante que o banco de dados esteja no modo hot backup durante uma janela de quatro minutos em torno do instantâneo da meia-noite.</block>
  <block id="ccff7eb3ad0059a184886709c87f4889" category="paragraph">A replicação para o local de recuperação de desastres é configurada da seguinte forma:</block>
  <block id="42d3752a745fb0cdae528f6cc425b569" category="paragraph">O destino do volume de log é atualizado a cada 15 minutos. Isso fornece um RPO de aproximadamente 15 minutos. O intervalo preciso de atualização varia um pouco, dependendo do volume total de dados que devem ser transferidos durante a atualização.</block>
  <block id="e272424001d72919ad498e0e9d3c2cc4" category="paragraph">O destino do volume do arquivo de dados é atualizado a cada seis horas. Isso não afeta o RPO ou rto. Se a recuperação de desastres for necessária, uma das primeiras etapas é restaurar o volume do arquivo de dados de volta para um snapshot de backup automático. O objetivo do intervalo de atualização mais frequente é suavizar a taxa de transferência deste volume. Se a atualização estiver agendada para uma vez por dia, todas as alterações acumuladas durante o dia devem ser transferidas de uma só vez. Com atualizações mais frequentes, as alterações são replicadas de forma mais gradual ao longo do dia.</block>
  <block id="ce176ff569d716c1fa73d0754aba684b" category="paragraph">Se ocorrer um desastre, o primeiro passo é quebrar os espelhos para ambos os volumes:</block>
  <block id="4b9cdb6e2096c0828aeccd2ee5eecf42" category="paragraph">As réplicas agora são de leitura e gravação. A próxima etapa é verificar o carimbo de data/hora do volume de log.</block>
  <block id="b4d461e48f5be5d08f677045d11e8200" category="paragraph">A cópia mais recente do volume de log é 14th de março às 13:30:00.</block>
  <block id="96f75a4b63f4377efdf64d571d71caec" category="paragraph">Em seguida, identifique o instantâneo de backup automático criado imediatamente antes do estado do volume de log. Isso é necessário porque o processo de repetição de log requer todos os logs de arquivamento criados durante o modo de backup automático. Por conseguinte, a réplica do volume de registo tem de ser mais antiga do que as imagens de cópia de segurança automática ou não conterá os registos necessários.</block>
  <block id="d358e4eb10a2f4e0b591e16941d7782c" category="paragraph">O instantâneo criado mais recentemente é<block ref="c001e27abf0e66d13790bb8a7e00da54" prefix=" " category="inline-code"></block>. Esta é a imagem de backup mais recente dos arquivos de dados, e é restaurada da seguinte forma:</block>
  <block id="d2037035a976c9be71cf6f372300c8c3" category="paragraph">Nesta fase, o banco de dados está pronto para ser recuperado. Se esse fosse um ambiente SAN, a próxima etapa incluiria ativar grupos de volume e montar sistemas de arquivos, um processo facilmente automatizado. Como este exemplo usa NFS, os sistemas de arquivos já estão montados e se tornaram leitura-gravação sem necessidade de montagem ou ativação no momento em que os espelhos foram quebrados.</block>
  <block id="2edce22eade45b42bc6b2665057fa082" category="paragraph">O banco de dados agora pode ser recuperado para o ponto desejado no tempo, ou pode ser totalmente recuperado em relação à cópia dos logs do refazer que foi replicado. Este exemplo ilustra o valor do log de arquivo combinado, controlfile e refazer volume de log. O processo de recuperação é drasticamente mais simples, porque não há necessidade de confiar em arquivos de controle de backup ou arquivos de log de redefinição.</block>
  <block id="51f74a82c7125b3b288755b6668091b1" category="section-title">Recuperação de desastres com backups otimizados para snapshot</block>
  <block id="3680a4757ddad43934237ab6a0ca955c" category="paragraph">O procedimento de recuperação de desastres usando backups otimizados para snapshot é quase idêntico ao procedimento de recuperação de desastres de hot backup. Tal como acontece com o procedimento de snapshot do hot backup, ele também é essencialmente uma extensão de uma arquitetura de backup local na qual os backups são replicados para uso na recuperação de desastres. O exemplo a seguir mostra o procedimento detalhado de configuração e recuperação. Este exemplo também chama a atenção para as principais diferenças entre backups ativos e backups otimizados para snapshot.</block>
  <block id="330dadae5e2585726f41ed1f90e88f9f" category="paragraph">O banco de dados de exemplo está localizado em uma arquitetura básica de dois volumes.<block ref="f006bf17b06c884c47190c4225d3215a" prefix=" " category="inline-code"></block> contém datafiles, e<block ref="894db1fc1592356880976f1b92c3e6a2" prefix=" " category="inline-code"></block> é usado para logs de refazer combinados, logs de arquivo e controlfiles.</block>
  <block id="1669f47e046ce7e069e9d143f42e025d" category="paragraph">São necessárias duas programações: Uma para os backups de arquivos de dados noturnos e outra para os backups de arquivos de log. Estes são chamados de meia-noite e 15minutes, respetivamente.</block>
  <block id="ef4adcab3e9bd572d0670f9f2073c311" category="paragraph">Isso controla o cronograma final de backup dos volumes. Os instantâneos são criados à meia-noite e retidos por 60 dias. O volume de log contém 72 instantâneos criados em intervalos de 15 minutos, o que adiciona até 18 horas de cobertura.</block>
  <block id="f9d5149b630a43ff5996adc26c6e1f08" category="paragraph">O destino do volume de log é atualizado a cada 15 minutos. Isso fornece um RPO de aproximadamente 15 minutos, com o intervalo de atualização preciso variando um pouco, dependendo do volume total de dados que deve ser transferido durante a atualização.</block>
  <block id="992398ebd9e9f825f0aa4415519abdba" category="paragraph">O destino do volume do ficheiro de dados é atualizado a cada 6 horas. Isso não afeta o RPO ou rto. Se a recuperação de desastres for necessária, você deve primeiro restaurar o volume do arquivo de dados de volta para um snapshot de backup automático. O objetivo do intervalo de atualização mais frequente é suavizar a taxa de transferência deste volume. Se a atualização foi agendada uma vez por dia, todas as alterações acumuladas durante o dia devem ser transferidas de uma só vez. Com atualizações mais frequentes, as alterações são replicadas de forma mais gradual ao longo do dia.</block>
  <block id="9e85b8590ac2f9ff5ebc8d1def51ae82" category="paragraph">Se ocorrer um desastre, o primeiro passo é quebrar os espelhos para todos os volumes:</block>
  <block id="fd2834dcadb39f00eb897fdcdc07a03d" category="paragraph">A cópia mais recente do volume de log é 14th de março às 13:30. Em seguida, identifique o instantâneo do ficheiro de dados criado imediatamente antes do estado do volume de registo. Isso é necessário porque o processo de repetição de log requer todos os logs de arquivamento de pouco antes do snapshot até o ponto de recuperação desejado.</block>
  <block id="810e47566b9cd5aa3b28e6514ec95735" category="paragraph">O instantâneo criado mais recentemente é<block ref="c001e27abf0e66d13790bb8a7e00da54" prefix=" " category="inline-code"></block>. Restaurar este instantâneo.</block>
  <block id="87d83a0406ac6622efcdf91c42784ecd" category="paragraph">O banco de dados está pronto para ser recuperado. Se esse fosse um ambiente SAN, você ativaria grupos de volume e montaria sistemas de arquivos, um processo facilmente automatizado. No entanto, este exemplo está usando NFS, então os sistemas de arquivos já estão montados e se tornaram leitura-gravação sem necessidade de montagem ou ativação no momento em que os espelhos foram quebrados.</block>
  <block id="7a2e97f17454be76b7e522ce612ff961" category="paragraph">O banco de dados agora pode ser recuperado para o ponto desejado no tempo, ou pode ser totalmente recuperado em relação à cópia dos logs do refazer que foi replicado. Este exemplo ilustra o valor do log de arquivo combinado, controlfile e refazer volume de log. O processo de recuperação é drasticamente mais simples, porque não há necessidade de confiar em arquivos de controle de backup ou redefinir arquivos de log.</block>
  <block id="204d288bf0e9d1ee9912d68d6282d7a9" category="summary">Bancos de dados Oracle com AIX</block>
  <block id="90b3697759466f587c318ce55df76258" category="doc">Bancos de dados Oracle com IBM AIX</block>
  <block id="14ab10a24aa8f6c18bfdfd0d8a394dcb" category="paragraph">Tópicos de configuração para banco de dados Oracle no IBM AIX com ONTAP.</block>
  <block id="d99ae60d37a12f766bc2a1f1c228fb4f" category="section-title">E/S simultânea</block>
  <block id="0f3eb508f611e203aeffa91d5753648a" category="paragraph">Alcançar o desempenho ideal no IBM AIX requer o uso de e/S simultâneas Sem I/o concorrente, as limitações de desempenho provavelmente são porque o AIX executa e/S atômica serializada, o que incorre em sobrecarga significativa.</block>
  <block id="ecdc41fc6a2adf7e41e7277e12eeb805" category="paragraph">Originalmente, o NetApp recomendou o uso da<block ref="4482571a249db31b3abed938e4567a15" prefix=" " category="inline-code"></block> opção de montagem para forçar o uso de e/S concorrente no sistema de arquivos, mas esse processo teve desvantagens e não é mais necessário. Desde a introdução do AIX 5,2 e do Oracle 10gR1, o Oracle no AIX pode abrir arquivos individuais para IO simultâneo, em vez de forçar e/S simultânea em todo o sistema de arquivos.</block>
  <block id="445b433b62b675f0ca0bda7acb56d41b" category="paragraph">O melhor método para ativar e/S concorrente é definir o<block ref="b6bd7c570605affc5b50bbd3e436f0c0" prefix=" " category="inline-code"></block> parâmetro<block ref="f1110589be196c2310808482067fce1b" prefix=" " category="inline-code"></block> como<block ref="aef8f91b1e026cc1bb55e8b08c491d35" prefix=" " category="inline-code"></block>. Isso permite que a Oracle abra arquivos específicos para uso com e/S concorrente</block>
  <block id="6206c23a0282b18352573158f9a8f9b3" category="paragraph">Usar<block ref="4482571a249db31b3abed938e4567a15" prefix=" " category="inline-code"></block> como opção de montagem força o uso de e/S concorrente, o que pode ter consequências negativas. Por exemplo, forçar e/S concorrente desativa o readahead em sistemas de arquivos, o que pode danificar o desempenho de e/S que ocorre fora do software de banco de dados Oracle, como copiar arquivos e executar backups de fita. Além disso, produtos como Oracle GoldenGate e SAP BR*Tools não são compatíveis com o uso da<block ref="4482571a249db31b3abed938e4567a15" prefix=" " category="inline-code"></block> opção de montagem com certas versões do Oracle.</block>
  <block id="770cb9a1e9321ca3012ecbb9ec65c422" category="list-text">Não use a<block ref="4482571a249db31b3abed938e4567a15" prefix=" " category="inline-code"></block> opção de montagem no nível do sistema de arquivos. Em vez disso, ative a e/S concorrente através do uso<block ref="b6a2b868e8bebfc19497b406a12a1071" prefix=" " category="inline-code"></block> do .</block>
  <block id="872080b7d5ec5585776f1426fb157842" category="list-text">Utilize apenas a<block ref="4482571a249db31b3abed938e4567a15" prefix=" " category="inline-code"></block> opção de montagem se não for possível definir<block ref="b6a2b868e8bebfc19497b406a12a1071" prefix=" " category="inline-code"></block>.</block>
  <block id="0c5d86482201f32acb30cd2f7de3048f" category="section-title">Opções de montagem AIX NFS</block>
  <block id="1ce07cafb2507c98c8b96ad5f35fb66a" category="paragraph">A tabela a seguir lista as opções de montagem NFS AIX para bancos de dados de instância única Oracle.</block>
  <block id="6622c14ce91b6b9683505626a5eebdd2" category="cell">Tipo de ficheiro</block>
  <block id="f18f8a29d3e2281d374f43c78cf8f0f1" category="cell">Opções de montagem</block>
  <block id="a45543a64530673135f37ff8f9e95e69" category="cell">ADR Home</block>
  <block id="9a8f040dae3f0f15b337fe69a85239c0" category="cell"><block ref="86d38d6e2b36f6557e583e005e23d258" prefix="" category="inline-code"></block></block>
  <block id="80d52d74fd5c383b43f91575d569b42c" category="cell">Registros do Redo ControlFiles Datafiles</block>
  <block id="72d33cb5c8b7ff5f7fd6a894094b0697" category="cell"><block ref="e1f651debac4f720c13ae930ff3ca14a" prefix="" category="inline-code"></block></block>
  <block id="d45a1a2afa30c30042b28f028fe75953" category="cell"><block ref="915be14765d6133923d803e1221f1513" prefix="" category="inline-code"></block></block>
  <block id="b74f5956b4bcda2de3c82ee97e192ab6" category="paragraph">A tabela a seguir lista as opções de montagem NFS AIX para RAC.</block>
  <block id="b547b55ba7f2a20602494777c5426eba" category="cell"><block ref="7e879bda961bd5b7d64d2ef4f5fb7869" prefix="" category="inline-code"></block></block>
  <block id="875abb256654bd3f6da7abcb1bd92f27" category="cell"><block ref="f93eecf9c582d76d4e14292dc34c79f8" prefix="" category="inline-code"></block></block>
  <block id="42c82995de255264e2a8690c3149c16a" category="cell">Dedicado<block ref="e1f651debac4f720c13ae930ff3ca14a" prefix=" " category="inline-code"></block></block>
  <block id="273f714e976e2a709a6abe18d34e4b61" category="cell">Compartilhado<block ref="e1f651debac4f720c13ae930ff3ca14a" prefix=" " category="inline-code"></block></block>
  <block id="3ed8fb68917b28af138fb74ccde62e80" category="cell"><block ref="415e8eb8b9fc05cb48e633d31fd04944" prefix="" category="inline-code"></block></block>
  <block id="8102775fe4080f632332ab8d3312311a" category="paragraph">A principal diferença entre as opções de montagem de instância única e RAC é a adição<block ref="79fea224ffd9e8111e4e87cab732464b" prefix=" " category="inline-code"></block> das opções de montagem. Essa adição tem o efeito de desabilitar o cache do sistema operacional do host, que permite que todas as instâncias do cluster RAC tenham uma visão consistente do estado dos dados.</block>
  <block id="1e3f10dfa324520cb7261c0da5bf6ec7" category="paragraph">Embora o uso da<block ref="4482571a249db31b3abed938e4567a15" prefix=" " category="inline-code"></block> opção de montagem e do<block ref="b6bd7c570605affc5b50bbd3e436f0c0" prefix=" " category="inline-code"></block> parâmetro<block ref="b6a2b868e8bebfc19497b406a12a1071" prefix=" " category="inline-code"></block> tenha o mesmo efeito de desabilitar o cache do host, ainda é necessário usar<block ref="79fea224ffd9e8111e4e87cab732464b" prefix=" " category="inline-code"></block>o .<block ref="79fea224ffd9e8111e4e87cab732464b" prefix=" " category="inline-code"></block> É necessário para implantações compartilhadas<block ref="e1f651debac4f720c13ae930ff3ca14a" prefix=" " category="inline-code"></block> para facilitar a consistência de arquivos, como arquivos de senha Oracle e<block ref="1737629d60b511cf45957529a8f046e2" prefix=" " category="inline-code"></block> arquivos de parâmetros. Se cada instância em um cluster RAC tiver um dedicado<block ref="e1f651debac4f720c13ae930ff3ca14a" prefix=" " category="inline-code"></block>, esse parâmetro não será necessário.</block>
  <block id="5365dd1a92461c9e6cf65017c4a11647" category="section-title">AIX jfs/jfs2 Opções de montagem</block>
  <block id="d7a578263480a2003f05c459a8961298" category="paragraph">A tabela a seguir lista as opções de montagem do AIX jfs/jfs2.</block>
  <block id="0aabf727ab0a83c5f5d078e8b18445e0" category="cell">Predefinições</block>
  <block id="e1f651debac4f720c13ae930ff3ca14a" category="cell">ORACLE_HOME</block>
  <block id="27a7ffa293f5a4d2a5bb54354486dece" category="paragraph">Antes de usar dispositivos AIX<block ref="b7cc91287fc99a8937a55e79376c6f54" prefix=" " category="inline-code"></block> em qualquer ambiente, incluindo bancos de dados, verifique o parâmetro<block ref="9d51746070ef554ad4e93a16de4aed0f" prefix=" " category="inline-code"></block>. Este parâmetro não é a profundidade da fila HBA; em vez disso, ele se relaciona com a profundidade da fila SCSI do indivíduo<block ref="66ad66c6ace8456eae4ca6807552e54b" prefix=" " category="inline-code"></block> pode ser muito baixa para um bom desempenho. Os testes mostraram que o valor ideal é 64.</block>
  <block id="8a05777f407870cbc2668230c8117503" category="summary">Bancos de dados Oracle com Linux e ASMlib/ASM Filter Driver</block>
  <block id="494900ae2c2cdb5abdba3806f4dfaeb0" category="doc">Bancos de dados Oracle com ASMLib/AFD (ASM Filter Driver)</block>
  <block id="5802d9527a43305e9e1c903bc6b5a721" category="paragraph">Tópicos de configuração específicos para o sistema operacional Linux usando AFD e ASMlib</block>
  <block id="2681013be5b0a9063a7ef0a8fe4d31da" category="section-title">Tamanhos de blocos ASMlib</block>
  <block id="1943673cc25055e93f0129f2baa8f499" category="paragraph">ASMlib é uma biblioteca de gerenciamento ASM opcional e utilitários associados. Seu valor principal é a capacidade de carimbar um LUN ou um arquivo baseado em NFS como um recurso ASM com uma etiqueta legível por humanos.</block>
  <block id="51713fdb873939c9c333273947776b8e" category="paragraph">Versões recentes do ASMlib detetam um parâmetro LUN chamado Logical Blocks per Physical Block expoent (LBPPBE). Esse valor não foi reportado pelo destino SCSI ONTAP até recentemente. Ele agora retorna um valor que indica que um tamanho de bloco 4KB é preferido. Esta não é uma definição de tamanho de bloco, mas é uma dica para qualquer aplicativo que usa LBPPBE que I/os de um determinado tamanho podem ser manipulados de forma mais eficiente. No entanto, o ASMlib interpreta LBPPBE como um tamanho de bloco e marca persistentemente o cabeçalho ASM quando o dispositivo ASM é criado.</block>
  <block id="65242d5b49071240043eeef598415104" category="paragraph">Esse processo pode causar problemas com atualizações e migrações de várias maneiras, tudo com base na incapacidade de misturar dispositivos ASMlib com diferentes tamanhos de bloco no mesmo grupo de discos ASM.</block>
  <block id="ea884eec0628302adc731211dc4e2cc7" category="paragraph">Por exemplo, arrays mais antigos geralmente relataram um valor LBPPBE de 0 ou não relataram esse valor de todo. ASMlib interpreta isso como um tamanho de bloco de 512 bytes. Matrizes mais recentes seriam interpretadas como tendo um tamanho de bloco 4KB. Não é possível misturar dispositivos de 512 bytes e 4KB no mesmo grupo de discos ASM. Isso bloquearia um usuário de aumentar o tamanho do grupo de discos ASM usando LUNs de dois arrays ou utilizando ASM como uma ferramenta de migração. Em outros casos, o RMAN pode não permitir a cópia de arquivos entre um grupo de discos ASM com um tamanho de bloco de 512 bytes e um grupo de discos ASM com um tamanho de bloco de 4KBMB.</block>
  <block id="f17ff15b23b87f35906ece98842a080f" category="paragraph">A solução preferida é corrigir o ASMlib. O ID do bug Oracle é 13999609, e o patch está presente no oracleasm-support-2,1.8-1 e superior. Este patch permite que um usuário defina o parâmetro<block ref="442e2026c8afecc4611b52331b5d0d56" prefix=" " category="inline-code"></block> como<block ref="b326b5062b2f0e69046810717534cb09" prefix=" " category="inline-code"></block> no<block ref="92a59ba9a0643a344be2d72cfd504181" prefix=" " category="inline-code"></block> arquivo de configuração. Isso impede que o ASMlib use o parâmetro LBPPBE, o que significa que os LUNs na nova matriz agora são reconhecidos como dispositivos de bloco de 512 bytes.</block>
  <block id="f140ff6b2b71e70e551e39dacb9561ef" category="admonition">A opção não altera o tamanho do bloco em LUNs que foram previamente carimbados pelo ASMlib. Por exemplo, se um grupo de discos ASM com blocos de 512 bytes precisar ser migrado para um novo sistema de armazenamento que relata um bloco 4KB, a opção<block ref="442e2026c8afecc4611b52331b5d0d56" prefix=" " category="inline-code"></block> deve ser definida antes que os novos LUNs sejam carimbados com ASMlib. Se os dispositivos já tiverem sido carimbados por oracleasm, eles devem ser reformatados antes de serem carimbados com um novo tamanho de bloco. Primeiro, desfigure o dispositivo com<block ref="41bd8c47b8e640da7bdb5c7dc995d435" prefix=" " category="inline-code"></block>e, em seguida, limpe os primeiros 1GB do dispositivo com<block ref="85c2e94baaf4d9c084e19d290907596e" prefix=" " category="inline-code"></block>. Por fim, se o dispositivo tiver sido particionado anteriormente, use o<block ref="9a287d63dabd6fbcbbe1b12344bfe922" prefix=" " category="inline-code"></block> comando para remover partições obsoletas ou simplesmente reiniciar o sistema operacional.</block>
  <block id="75ad83418241561186f96dfed5229aaa" category="paragraph">Se o ASMlib não puder ser corrigido, o ASMlib pode ser removido da configuração. Esta alteração é disruptiva e requer a remoção de carimbo de discos ASM e certificar-se de que o<block ref="0802edf7303a95bdecde832bbbe3a89c" prefix=" " category="inline-code"></block> parâmetro está definido corretamente. No entanto, essa alteração não requer a migração de dados.</block>
  <block id="ad9ac4c6d7ed2e11bdcf8c693658a482" category="section-title">Tamanhos de bloco do Acionamento do filtro ASM (AFD)</block>
  <block id="de59cd97a61c9f9964a35d2cd8b05c88" category="paragraph">O AFD é uma biblioteca de gerenciamento ASM opcional que está se tornando a substituição do ASMlib. Do ponto de vista do armazenamento, ele é muito semelhante ao ASMlib, mas inclui recursos adicionais, como a capacidade de bloquear e/S não-Oracle para reduzir as chances de erros de usuário ou aplicativo que poderiam corromper dados.</block>
  <block id="36dc27685773851e52f035f82e3deba2" category="section-title">Tamanhos de bloco de dispositivos</block>
  <block id="1ef92cf7e561e179d6079cc937b2778a" category="paragraph">Como o ASMlib, o AFD também lê o parâmetro LUN blocos lógicos por expoente de bloco físico (LBPPBE) e, por padrão, usa o tamanho do bloco físico, não o tamanho do bloco lógico.</block>
  <block id="b95ce6c503801cb15f2f9c0773c58f00" category="paragraph">Isso pode criar um problema se AFD for adicionado a uma configuração existente onde os dispositivos ASM já estejam formatados como dispositivos de bloco de 512 bytes. O driver AFD reconheceria o LUN como um dispositivo 4K e a incompatibilidade entre o rótulo ASM e o dispositivo físico impediria o acesso. Da mesma forma, as migrações seriam afetadas porque não é possível misturar dispositivos de 512 bytes e 4KB no mesmo grupo de discos ASM. Isso bloquearia um usuário de aumentar o tamanho do grupo de discos ASM usando LUNs de dois arrays ou utilizando ASM como uma ferramenta de migração. Em outros casos, o RMAN pode não permitir a cópia de arquivos entre um grupo de discos ASM com um tamanho de bloco de 512 bytes e um grupo de discos ASM com um tamanho de bloco de 4KBMB.</block>
  <block id="7ef45d3a7c5fff234bf42bdf549b8339" category="paragraph">A solução é simples - AFD inclui um parâmetro para controlar se usa os tamanhos de blocos lógicos ou físicos. Este é um parâmetro global que afeta todos os dispositivos no sistema. Para forçar o AFD a usar o tamanho do bloco lógico, defina<block ref="722fc896569f3d455bb5ef8f5b8c3703" prefix=" " category="inline-code"></block> no<block ref="dcd5fd81543c5e08e927c54e89acdd40" prefix=" " category="inline-code"></block> arquivo.</block>
  <block id="47b0d7fc4c27720c4fc326722edad27c" category="section-title">Tamanhos de transferência multipath</block>
  <block id="7c329811bcc7bb2f50005da5a3aff250" category="paragraph">As recentes alterações do kernel do linux impõem restrições de tamanho de e/S enviadas para dispositivos multipath, e o AFD não honra essas restrições. Os I/os são então rejeitados, o que faz com que o caminho LUN fique offline. O resultado é uma incapacidade de instalar o Oracle Grid, configurar ASM ou criar um banco de dados.</block>
  <block id="926e4b7a2822a39a07f61474b92e9d8c" category="paragraph">A solução é especificar manualmente o comprimento máximo de transferência no arquivo multipath.conf para LUNs ONTAP:</block>
  <block id="3d0c741146f1e8e31bc7d07128ca6e0a" category="admonition">Mesmo que não existam problemas atualmente, este parâmetro deve ser definido se AFD for usado para garantir que uma futura atualização do linux não cause problemas inesperadamente.</block>
  <block id="e712ed441aacc4eeecb5656d5493c99c" category="summary">Bancos de dados Oracle com HP-UX</block>
  <block id="c36ae718fe9d7978c8781b19d0b3dee0" category="paragraph">Tópicos de configuração para banco de dados Oracle no HP-UX com ONTAP.</block>
  <block id="8ec258cd0b6ab050fc478a415a20f2e9" category="section-title">Opções de montagem NFS HP-UX</block>
  <block id="7c5876d5737071c64af78562fe375386" category="paragraph">A tabela a seguir lista as opções de montagem HP-UX NFS para uma única instância.</block>
  <block id="b71e04a676ec52e65edb52c138f2ad98" category="cell"><block ref="ac15a7c050732bc5169b6c17ce30f859" prefix="" category="inline-code"></block></block>
  <block id="9c9fb3cc18a83e4e46165b5c3d4ce8ef" category="cell">Arquivos de controle Datafiles Redo logs</block>
  <block id="55b835c747261995c0e1022d234e286d" category="cell"><block ref="fa8766c679857b7d589983df0ab5bcf4" prefix="" category="inline-code"></block></block>
  <block id="189dbd39cabd57c5d2e51714d9a5b85b" category="paragraph">A tabela a seguir lista as opções de montagem HP-UX NFS para RAC.</block>
  <block id="fa9da3a6a7ef8986a94c7395577c322f" category="cell"><block ref="8b080dc74532d24847a6163dcc34d93f" prefix="" category="inline-code"></block></block>
  <block id="add42ff64fa5b57e5abeab49d154a9d9" category="cell"><block ref="acdef4af05a9f0c43f72b7c600f04d62" prefix="" category="inline-code"></block></block>
  <block id="f93eecf9c582d76d4e14292dc34c79f8" category="cell">CRS/votação</block>
  <block id="c88a7b7f83f761f7fc2979815d210140" category="cell"><block ref="d29d7b7ed8c19a99fe17fd7f3d07ea7b" prefix="" category="inline-code"></block></block>
  <block id="2052aa052eee25e077178cd737b68f47" category="cell"><block ref="18f533bce293643d1004086db883dd03" prefix="" category="inline-code"></block></block>
  <block id="af8831a1b8129b099114c3237a61db88" category="paragraph">A principal diferença entre as opções de montagem de uma única instância e RAC é a adição<block ref="79fea224ffd9e8111e4e87cab732464b" prefix=" " category="inline-code"></block> de e<block ref="6698a391ee8befa0ca4646a86a1bbd66" prefix=" " category="inline-code"></block> às opções de montagem. Essa adição tem o efeito de desabilitar o cache do sistema operacional do host, o que permite que todas as instâncias do cluster RAC tenham uma visão consistente do estado dos dados. Embora o uso do<block ref="b6bd7c570605affc5b50bbd3e436f0c0" prefix=" " category="inline-code"></block> parâmetro<block ref="b6a2b868e8bebfc19497b406a12a1071" prefix=" " category="inline-code"></block> tenha o mesmo efeito de desabilitar o cache do host, ainda é necessário usar<block ref="79fea224ffd9e8111e4e87cab732464b" prefix=" " category="inline-code"></block> e<block ref="6698a391ee8befa0ca4646a86a1bbd66" prefix=" " category="inline-code"></block>.</block>
  <block id="b865c6aba24c3f61595471aab993d27c" category="paragraph">O motivo<block ref="79fea224ffd9e8111e4e87cab732464b" prefix=" " category="inline-code"></block> necessário para implantações compartilhadas<block ref="e1f651debac4f720c13ae930ff3ca14a" prefix=" " category="inline-code"></block> é facilitar a consistência de arquivos, como arquivos de senha Oracle e spfiles. Se cada instância em um cluster RAC tiver um dedicado<block ref="e1f651debac4f720c13ae930ff3ca14a" prefix=" " category="inline-code"></block>, esse parâmetro não será necessário.</block>
  <block id="898311d838a2fa2fa41b4b52a63a7f1d" category="section-title">Opções de montagem HP-UX VxFS</block>
  <block id="85b4a3d44370909d395ab8af28ff4927" category="paragraph">Use as seguintes opções de montagem para sistemas de arquivos que hospedam binários Oracle:</block>
  <block id="6630bbc9a901be0d038b2c39e2faf65d" category="paragraph">Use as seguintes opções de montagem para sistemas de arquivos que contêm datafiles, logs de refazer, logs de arquivamento e arquivos de controle nos quais a versão do HP-UX não suporta e/S simultânea:</block>
  <block id="ed37730e0f28a631768a396e7898e197" category="paragraph">Quando a e/S simultânea for suportada (VxFS 5.0.1 e posterior, ou com o ServiceGuard Storage Management Suite), utilize estas opções de montagem para sistemas de ficheiros que contenham ficheiros de dados, registos refeitos, registos de arquivo e ficheiros de controlo:</block>
  <block id="f51ddb98d92e83609db075add5fba4d8" category="admonition">O parâmetro<block ref="d3cc759510a3aba837fc8efeb2e24b91" prefix=" " category="inline-code"></block> é especialmente crítico em ambientes VxFS. A Oracle recomenda que esse parâmetro permaneça desconfigurado no Oracle 10g R1i e posterior, a menos que especificamente direcionado de outra forma. O padrão com um tamanho de bloco Oracle 8KB é 128. Se o valor deste parâmetro for forçado a 16 ou menos, remova a<block ref="a6b02283cba560dcfdea44af66ec792c" prefix=" " category="inline-code"></block> opção de montagem porque pode danificar o desempenho sequencial de e/S. Esta etapa prejudica outros aspetos do desempenho e só deve ser tomada se o valor de<block ref="d3cc759510a3aba837fc8efeb2e24b91" prefix=" " category="inline-code"></block> tiver de ser alterado do valor padrão.</block>
  <block id="cf451e0aed3c944d3f1c761387762e56" category="summary">Bancos de dados Oracle com Linux</block>
  <block id="dfc95ed5e895617bbd0d4b1a8bfba8ca" category="paragraph">Tópicos de configuração específicos para o sistema operacional Linux.</block>
  <block id="26ed9768d6a659a9768842d903d0025f" category="section-title">Tabelas de slots TCP do Linux NFSv3</block>
  <block id="2518e65e64213437c921c39a097db167" category="section-title">Opções de montagem em NFS do Linux</block>
  <block id="29cd2e6d4fc96e749c4a0e622cad7f50" category="paragraph">A tabela a seguir lista as opções de montagem NFS do Linux para uma única instância.</block>
  <block id="9fafd031075cede0e8a5a796ec45fbff" category="paragraph">A tabela a seguir lista as opções de montagem NFS do Linux para RAC.</block>
  <block id="f16135915fe2ca5c3b0d660acc0325d3" category="cell"><block ref="4c927b3193f1cd00c7cfd3ac2e7ba8ea" prefix="" category="inline-code"></block></block>
  <block id="e72cc50c204d77a1e47f0dcc8ad28a56" category="cell">Arquivos de controle arquivos de dados Redo logs</block>
  <block id="fc1ea13514277ff14dc705f62c31c0fc" category="cell"><block ref="4d0511346ac74044d79c9bc297d59b09" prefix="" category="inline-code"></block></block>
  <block id="13c64659680c0bc3603209997cc22225" category="cell">CRS/votação</block>
  <block id="672c5eef2603018159295408f761324b" category="cell"><block ref="26b20bdf0b0e7d3ddef3749a70c17932" prefix="" category="inline-code"></block></block>
  <block id="f7085c7dc406f5b44813ac43c18b80c0" category="paragraph">A principal diferença entre as opções de montagem de instância única e RAC é a adição<block ref="3504e2b0e7c968444314433be465518d" prefix=" " category="inline-code"></block> das opções de montagem. Essa adição tem o efeito de desabilitar o cache do sistema operacional do host, o que permite que todas as instâncias do cluster RAC tenham uma visão consistente do estado dos dados. Embora o uso do<block ref="b6bd7c570605affc5b50bbd3e436f0c0" prefix=" " category="inline-code"></block> parâmetro<block ref="b6a2b868e8bebfc19497b406a12a1071" prefix=" " category="inline-code"></block> tenha o mesmo efeito de desabilitar o cache do host, ainda é necessário usar<block ref="3504e2b0e7c968444314433be465518d" prefix=" " category="inline-code"></block>o .</block>
  <block id="d2537738f34705bc9d100925252c0102" category="paragraph">O motivo<block ref="3504e2b0e7c968444314433be465518d" prefix=" " category="inline-code"></block> necessário para implantações compartilhadas<block ref="e1f651debac4f720c13ae930ff3ca14a" prefix=" " category="inline-code"></block> é facilitar a consistência de arquivos, como os arquivos de senha Oracle e spfiles. Se cada instância em um cluster RAC tiver um dedicado<block ref="e1f651debac4f720c13ae930ff3ca14a" prefix=" " category="inline-code"></block>, esse parâmetro não será necessário.</block>
  <block id="5084019c1051a9937b5ff77568ce579b" category="paragraph">Geralmente, arquivos que não sejam de banco de dados devem ser montados com as mesmas opções usadas para datafiles de instância única, embora aplicativos específicos possam ter requisitos diferentes. Evite as opções de montagem<block ref="79fea224ffd9e8111e4e87cab732464b" prefix=" " category="inline-code"></block> e<block ref="3504e2b0e7c968444314433be465518d" prefix=" " category="inline-code"></block>, se possível, porque essas opções desativam a leitura e o buffer no nível do sistema de arquivos. Isso pode causar problemas graves de desempenho para processos como extração, tradução e carregamento.</block>
  <block id="243de27c01fea05cc58186d2e5ad1ce5" category="section-title">ACESSO e GETATTR</block>
  <block id="59dcf78e97c197a0f240067da57a248f" category="paragraph">Alguns clientes observaram que um nível extremamente alto de outros IOPS, como O ACCESS e GETATTR, pode dominar suas cargas de trabalho. Em casos extremos, operações como leituras e gravações podem ser tão baixas quanto 10% do total. Este é um comportamento normal com qualquer banco de dados que inclua o uso<block ref="3504e2b0e7c968444314433be465518d" prefix=" " category="inline-code"></block> e/ou<block ref="79fea224ffd9e8111e4e87cab732464b" prefix=" " category="inline-code"></block> no Linux porque essas opções fazem com que o sistema operacional Linux recarregue constantemente metadados de arquivos do sistema de armazenamento. Operações como ACCESS e GETATTR são operações de baixo impactos que são atendidas a partir do cache ONTAP em um ambiente de banco de dados. Não devem ser consideradas IOPS originais, como leituras e gravações, que criem verdadeira demanda em sistemas de storage. No entanto, esses outros IOPS criam alguma carga, especialmente em ambientes RAC. Para resolver esta situação, ative o DNFS, que ignora o cache do buffer do sistema operacional e evita essas operações desnecessárias de metadados.</block>
  <block id="041f371e212c70407e145ae9f752a8b4" category="section-title">Linux Direct NFS</block>
  <block id="dd2f3f344f14ae5daf12cb0a817a72e0" category="paragraph">Uma opção de montagem adicional, chamada<block ref="4740c034d97ca90a96b8050082816605" prefix=" " category="inline-code"></block>, é necessária quando (a) o DNFS está ativado e (b) um volume de origem é montado mais de uma vez em um único servidor (c) com uma montagem NFS aninhada. Essa configuração é vista principalmente em ambientes compatíveis com aplicações SAP. Por exemplo, um único volume em um sistema NetApp pode ter um diretório localizado em<block ref="9f9f4ccb1fc3afcbfe0cc3f5eac4332c" prefix=" " category="inline-code"></block> e um segundo em<block ref="ac2f9bbcd397d8f6b39e6713658051ea" prefix=" " category="inline-code"></block>. Se<block ref="9f9f4ccb1fc3afcbfe0cc3f5eac4332c" prefix=" " category="inline-code"></block> for montado em<block ref="9ad16912cc0ba54a259b1a15d233c264" prefix=" " category="inline-code"></block> e<block ref="ac2f9bbcd397d8f6b39e6713658051ea" prefix=" " category="inline-code"></block> for montado em<block ref="1da707b60c3b55bd01cb7df7c171a368" prefix=" " category="inline-code"></block>, o resultado serão montagens NFS aninhadas que se originam na mesma fonte.</block>
  <block id="64c93f87be857cf43f66e341a377693a" category="paragraph">O sistema operacional pode detetar o fato de que<block ref="9ad16912cc0ba54a259b1a15d233c264" prefix=" " category="inline-code"></block> e<block ref="1da707b60c3b55bd01cb7df7c171a368" prefix=" " category="inline-code"></block> residir no mesmo volume, que é o mesmo sistema de arquivos de origem. Em seguida, o SO usa o mesmo identificador de dispositivo para acessar os dados. Isso melhora o uso do cache do sistema operacional e outras operações, mas interfere com o DNFS. Se o DNFS tiver de aceder a um ficheiro, como o<block ref="1737629d60b511cf45957529a8f046e2" prefix=" " category="inline-code"></block>, ligado<block ref="1da707b60c3b55bd01cb7df7c171a368" prefix=" " category="inline-code"></block>, poderá tentar, erroneamente, utilizar o caminho errado para os dados. O resultado é uma operação de e/S com falha. Nessas configurações, adicione a<block ref="4740c034d97ca90a96b8050082816605" prefix=" " category="inline-code"></block> opção de montagem a qualquer sistema de arquivos NFS que compartilhe um volume de origem com outro sistema de arquivos NFS nesse host. Isso força o sistema operacional Linux a alocar um identificador de dispositivo independente para esse sistema de arquivos.</block>
  <block id="14dd7af30f62ec838445a1e167d2aff6" category="section-title">Linux Direct NFS e Oracle RAC</block>
  <block id="c6a209e4ad702c6424efb7d63d76feca" category="paragraph">O uso do DNFS tem benefícios especiais de desempenho para o Oracle RAC no sistema operacional Linux porque o Linux não tem um método para forçar e/S direto, o que é necessário com RAC para coerência entre os nós. Como solução alternativa, o Linux requer o uso da<block ref="3504e2b0e7c968444314433be465518d" prefix=" " category="inline-code"></block> opção de montagem, que faz com que os dados de arquivo expirem imediatamente do cache do sistema operacional. Essa opção, por sua vez, força o cliente NFS Linux a reler constantemente os dados de atributos, o que danifica a latência e aumenta a carga no controlador de armazenamento.</block>
  <block id="3070cb366c38db327b0cf057d63792c1" category="paragraph">A ativação do DNFS ignora o cliente NFS do host e evita esse dano. Vários clientes relataram melhorias significativas no desempenho em clusters RAC e reduções significativas na carga do ONTAP (especialmente em relação a outros IOPS) ao habilitar o DNFS.</block>
  <block id="e97ab7f94d503bbec4b013b5b77118c6" category="section-title">Linux Direct NFS e arquivo oranfstab</block>
  <block id="f63255b70940d25581e0cf5f81dd6cd6" category="paragraph">Ao usar DNFS no Linux com a opção multipathing, várias sub-redes devem ser usadas. Em outros sistemas operacionais, vários canais DNFS podem ser estabelecidos usando as<block ref="54b4c4075463b2e02cd69f5cd139b5b2" prefix=" " category="inline-code"></block> opções e<block ref="bbf52a1a57a4eaa83512cab68fd52b70" prefix=" " category="inline-code"></block> para configurar vários canais DNFS em uma única sub-rede. No entanto, isso não funciona corretamente no Linux e problemas de desempenho inesperados podem resultar. Com o Linux, cada NIC usada para o tráfego DNFS deve estar em uma sub-rede diferente.</block>
  <block id="6c5cf31ca1af553b1f4a9b99e3cb054c" category="section-title">Programador de e/S.</block>
  <block id="49bb1f5f4810e5f3d32dac84bd96005d" category="paragraph">O kernel Linux permite um controle de baixo nível sobre a maneira como e/S para bloquear dispositivos é agendada. Os padrões em várias distribuições do Linux variam consideravelmente. Testes mostram que o prazo geralmente oferece os melhores resultados, mas ocasionalmente o NOOP foi um pouco melhor. A diferença de desempenho é mínima, mas teste ambas as opções se for necessário extrair o máximo desempenho possível de uma configuração de banco de dados. O CFQ é o padrão em muitas configurações e demonstrou problemas significativos de desempenho com cargas de trabalho de banco de dados.</block>
  <block id="38f25b8840d56fc601af1024115764b2" category="paragraph">Consulte a documentação relevante do fornecedor do Linux para obter instruções sobre como configurar o agendador de e/S.</block>
  <block id="4150162ad42bffea7bb903b4c7a4ffd9" category="section-title">Multipathing</block>
  <block id="305482bf1c318f0a9a04f94987db06b2" category="paragraph">Alguns clientes encontraram falhas durante a interrupção da rede porque o daemon multipath não estava sendo executado em seu sistema. Em versões recentes do Linux, o processo de instalação do sistema operacional e do daemon multipathing podem deixar esses sistemas operacionais vulneráveis a esse problema. Os pacotes são instalados corretamente, mas não são configurados para inicialização automática após uma reinicialização.</block>
  <block id="6fb0bf499bef576f56e0fd6360eba0a6" category="paragraph">Por exemplo, o padrão para o daemon multipath no RHEL5,5 pode aparecer da seguinte forma:</block>
  <block id="31026ba0b77cbe4c9d44ed6afc859ed6" category="paragraph">Isso pode ser corrigido com os seguintes comandos:</block>
  <block id="c759a9b7e4db09da8a25fb73d256f6b7" category="section-title">Espelhamento ASM</block>
  <block id="f2f41836b42c08199948378b4a4a6e26" category="paragraph">O espelhamento ASM pode exigir alterações nas configurações de multipath do Linux para permitir que o ASM reconheça um problema e alterne para um grupo de falhas alternativo. A maioria das configurações ASM no ONTAP usa redundância externa, o que significa que a proteção de dados é fornecida pelo array externo e o ASM não espelha dados. Alguns sites usam ASM com redundância normal para fornecer espelhamento bidirecional, normalmente em diferentes sites.</block>
  <block id="25f47751ccd5df99e3c25a8eb2a21fc5" category="inline-link-macro">Documentação dos utilitários de host do NetApp</block>
  <block id="066a79b72a430b074cdc0476b67bbde3" category="paragraph">As configurações do Linux mostradas na <block ref="210658f6fe0d0061c73c19a9a6b263d1" category="inline-link-macro-rx"></block> incluem parâmetros multipath que resultam em filas indefinidas de e/S Isso significa que uma e/S em um dispositivo LUN sem caminhos ativos aguarda o tempo necessário para que a e/S seja concluída. Isso geralmente é desejável porque os hosts Linux esperam que as alterações de caminho SAN sejam concluídas, que os switches FC sejam reiniciados ou que um sistema de storage conclua um failover.</block>
  <block id="184ea23c04f24d03fc0123bc6eb30de2" category="paragraph">Esse comportamento ilimitado de enfileiramento causa um problema com o espelhamento ASM porque o ASM deve receber uma falha de e/S para que ele tente novamente e/S em um LUN alternativo.</block>
  <block id="5616945ee545765b51d3fe1871cff4ec" category="paragraph">Defina os seguintes parâmetros no arquivo Linux<block ref="9ac80d53ede05256c28cf9e043eb423c" prefix=" " category="inline-code"></block> para LUNs ASM usados com espelhamento ASM:</block>
  <block id="49af3bbe0c557480960d217b217502ff" category="paragraph">Essas configurações criam um tempo limite de 120 segundos para dispositivos ASM. O tempo limite é calculado como<block ref="e2f0125c5971e1ce714f86f145386ee3" prefix=" " category="inline-code"></block> *<block ref="9434de34302b4f40887a7277cf35a8fc" prefix=" " category="inline-code"></block> como segundos. O valor exato pode precisar ser ajustado em algumas circunstâncias, mas um tempo limite de 120 segundos deve ser suficiente para a maioria dos usos. Especificamente, 120 segundos devem permitir que uma tomada de controle ou giveback ocorra sem produzir um erro de e/S que resultaria em que o grupo de falha fosse colocado offline.</block>
  <block id="dbff1dc161f3f1d61258259b3a0b549c" category="paragraph">Um valor menor<block ref="9434de34302b4f40887a7277cf35a8fc" prefix=" " category="inline-code"></block> pode reduzir o tempo necessário para que o ASM alterne para um grupo de falhas alternativo, mas isso também aumenta o risco de um failover indesejado durante atividades de manutenção, como um controle de controle. O risco pode ser atenuado por um monitoramento cuidadoso do estado de espelhamento do ASM. Se ocorrer um failover indesejado, os espelhos podem ser ressinced rapidamente se a ressincronização for executada de forma relativamente rápida. Para obter informações adicionais, consulte a documentação Oracle sobre ASM Fast Mirror Resync para a versão do software Oracle em uso.</block>
  <block id="ec0b68df6b5a0fdd6d73ac710b9684da" category="section-title">Opções de montagem Linux xfs, ext3 e ext4</block>
  <block id="278230e4238d02fcb49850454e7d79e0" category="admonition">*A NetApp recomenda* usando as opções de montagem padrão.</block>
  <block id="4f03272fa32b53344924740fd30fc52d" category="summary">Bancos de dados Oracle com Solaris</block>
  <block id="fb04d97697a77a89d0c3f5c09cd9ba47" category="paragraph">Tópicos de configuração específicos do Solaris os.</block>
  <block id="eefc332f1bd0a0aa81d0ce222989294f" category="section-title">Opções de montagem do Solaris NFS</block>
  <block id="3e484486d582145f6d93ca5f8c71e228" category="paragraph">A tabela a seguir lista as opções de montagem do Solaris NFS para uma única instância.</block>
  <block id="93a02670f814a2df6c830194a7244ea9" category="cell"><block ref="623bbf58c0b2f552d891a1c276bcc3bc" prefix="" category="inline-code"></block></block>
  <block id="73cf9d3814b8678439c37316096219b1" category="cell"><block ref="4c899c62e1ffeb12078476828bb54351" prefix="" category="inline-code"></block></block>
  <block id="3f490427e0bf55dc5c837e7b0d4c651c" category="cell"><block ref="b9ce73264210e6d0faa4115ce7525610" prefix="" category="inline-code"></block></block>
  <block id="b00b0ab6e8494db1a230bf3da7f42fd6" category="paragraph">Provou-se que o uso do<block ref="545e1db0caafaa47ef37ce893c8fb92c" prefix=" " category="inline-code"></block> melhora significativamente a performance nos ambientes dos clientes, eliminando a latência associada à aquisição e liberação de bloqueios no sistema de storage. Use essa opção com cuidado em ambientes nos quais vários servidores são configurados para montar os mesmos sistemas de arquivos e o Oracle está configurado para montar esses bancos de dados. Embora esta seja uma configuração altamente incomum, ela é usada por um pequeno número de clientes. Se uma instância for iniciada acidentalmente uma segunda vez, a corrupção de dados pode ocorrer porque a Oracle não consegue detetar os arquivos de bloqueio no servidor estrangeiro. Os bloqueios NFS não oferecem proteção de outra forma; como no NFS versão 3, eles são apenas consultivos.</block>
  <block id="f480015b57b289b7dad1473ee5c55216" category="paragraph">Como<block ref="545e1db0caafaa47ef37ce893c8fb92c" prefix=" " category="inline-code"></block> os parâmetros e<block ref="6698a391ee8befa0ca4646a86a1bbd66" prefix=" " category="inline-code"></block> são mutuamente exclusivos, é importante que<block ref="b6a2b868e8bebfc19497b406a12a1071" prefix=" " category="inline-code"></block> esteja presente no<block ref="b6bd7c570605affc5b50bbd3e436f0c0" prefix=" " category="inline-code"></block> arquivo para que<block ref="6887bae4cda2d09a283a165c5be3f2b8" prefix=" " category="inline-code"></block> seja usado. Sem esse parâmetro, o cache do buffer do sistema operacional do host é usado e o desempenho pode ser afetado negativamente.</block>
  <block id="5171d5dfdc21b0941b921796638c10a9" category="paragraph">A tabela a seguir lista as opções de montagem do Solaris NFS RAC.</block>
  <block id="38e4e10abf410c92cd13e9cb4d54ae35" category="cell"><block ref="41a82b9bd64cb001f8913a34614b00d1" prefix="" category="inline-code"></block></block>
  <block id="98ee9e91a49f27abbd9dc831afa9fae5" category="cell"><block ref="f3a0fd4a197a2eae60d2ef904e5366f1" prefix="" category="inline-code"></block></block>
  <block id="e9d3beba8b6a40da6f8074236ca3ddbc" category="paragraph">A principal diferença entre as opções de montagem de uma única instância e RAC é a adição<block ref="79fea224ffd9e8111e4e87cab732464b" prefix=" " category="inline-code"></block> de e<block ref="6698a391ee8befa0ca4646a86a1bbd66" prefix=" " category="inline-code"></block> às opções de montagem. Essa adição tem o efeito de desabilitar o cache do sistema operacional do host, o que permite que todas as instâncias do cluster RAC tenham uma visão consistente do estado dos dados. Embora o uso do<block ref="b6bd7c570605affc5b50bbd3e436f0c0" prefix=" " category="inline-code"></block> parâmetro<block ref="b6a2b868e8bebfc19497b406a12a1071" prefix=" " category="inline-code"></block> tenha o mesmo efeito de desabilitar o cache do host, ainda é necessário usar<block ref="79fea224ffd9e8111e4e87cab732464b" prefix=" " category="inline-code"></block> e<block ref="6698a391ee8befa0ca4646a86a1bbd66" prefix=" " category="inline-code"></block>.</block>
  <block id="983c4ff0cb78851d95be06277152653f" category="paragraph">O motivo<block ref="3504e2b0e7c968444314433be465518d" prefix=" " category="inline-code"></block> necessário para implantações compartilhadas<block ref="e1f651debac4f720c13ae930ff3ca14a" prefix=" " category="inline-code"></block> é facilitar a consistência de arquivos, como arquivos de senha Oracle e spfiles. Se cada instância em um cluster RAC tiver um dedicado<block ref="e1f651debac4f720c13ae930ff3ca14a" prefix=" " category="inline-code"></block>, esse parâmetro não será necessário.</block>
  <block id="5a11994cffaa4d0a9c8594d2223e3e96" category="section-title">Opções de montagem do Solaris UFS</block>
  <block id="130c5ffb786e38c2e6648fd53593681a" category="paragraph">A NetApp recomenda fortemente o uso da opção de montagem de log para que a integridade dos dados seja preservada no caso de uma falha de host do Solaris ou a interrupção da conetividade FC. A opção de montagem de log também preserva a usabilidade dos backups Snapshot.</block>
  <block id="516f7006de2e9b1f7f871d961db4a1ca" category="section-title">Solaris ZFS</block>
  <block id="a92c2c52c7360246c6da2b1169e0fa50" category="paragraph">O Solaris ZFS deve ser instalado e configurado cuidadosamente para oferecer o melhor desempenho.</block>
  <block id="c9208a3ad95d5ce3d9e2ba1839426251" category="section-title">mvector</block>
  <block id="30d0582d4c5a0b280454304dcff9c28f" category="paragraph">O Solaris 11 incluiu uma mudança na forma como processa grandes operações de e/S, o que pode resultar em graves problemas de desempenho em matrizes de armazenamento SAN. O problema está documentado no relatório de bug de rastreamento do NetApp 630173, "regressão de desempenho do Solaris 11 ZFS".</block>
  <block id="c041cd46ed4caba0947ab494ac5bb1d9" category="paragraph">Este não é um bug do ONTAP. É um defeito do Solaris que é rastreado sob os defeitos Solaris 7199305 e 7082975.</block>
  <block id="a83650b3549679a1591275f0f9cd38e0" category="paragraph">Você pode consultar o suporte Oracle para saber se sua versão do Solaris 11 é afetada ou testar a solução alternativa alterando<block ref="954f82599f7db0212a28fd448e03bdf3" prefix=" " category="inline-code"></block> para um valor menor.</block>
  <block id="65711e429e82120028dff2df28b4b92d" category="paragraph">Você pode fazer isso executando o seguinte comando como root:</block>
  <block id="bc7e9b3c34345bf9ebe88467d6714f1b" category="paragraph">Se surgir algum problema inesperado dessa alteração, ela pode ser facilmente revertida executando o seguinte comando como root:</block>
  <block id="6ff9f4444ac481652f4412b5e1623846" category="section-title">Kernel</block>
  <block id="78d06f587305b9e5481c8cf660693a61" category="paragraph">O desempenho confiável do ZFS requer um kernel Solaris corrigido contra problemas de alinhamento de LUN. A correção foi introduzida com o patch 147440-19 no Solaris 10 e com o SRU 10,5 para Solaris 11. Utilize apenas o Solaris 10 e posterior com o ZFS.</block>
  <block id="db8880d80ab20f2f01a010e5c454f7fb" category="section-title">Configuração LUN</block>
  <block id="3b296d65c0c37979abe39ac7f6d8e1d8" category="paragraph">Para configurar um LUN, execute as seguintes etapas:</block>
  <block id="3bdc2a5622b76404f8b0ce2fc774e69a" category="list-text">Crie um LUN do tipo<block ref="7bee0477f82303aa43de5d78f7b9cb05" prefix=" " category="inline-code"></block>.</block>
  <block id="c06f6c6685c06bb821295b3a6d5e580c" category="list-text">Instale o Kit de Utilitário do host (HUK) apropriado especificado pelo <block ref="b5b16f3cdb0eb25a282348ba54f8c677" category="inline-link-macro-rx"></block>.</block>
  <block id="33db73c9b3936cb8eaae825d3101f60c" category="inline-link-macro">documentação mais recente</block>
  <block id="c8646086dca29c1d978ab285faa93709" category="list-text">Siga as instruções no HUK exatamente como descrito. Os passos básicos estão descritos abaixo, mas consulte o <block ref="33574dfffc2cb6d01be0edb6738c51bb" category="inline-link-macro-rx"></block> para obter o procedimento adequado.</block>
  <block id="6c06455cad171d61eac3593147bd71d6" category="list-text">Execute o<block ref="3062dc928daa4d85f6e34b6dea110a00" prefix=" " category="inline-code"></block> utilitário para atualizar o<block ref="d5416d340f5bec1fcb3addb6ae7d059e" prefix=" " category="inline-code"></block> arquivo. Isso permite que as unidades SCSI descubram corretamente LUNs ONTAP.</block>
  <block id="7ec6668202fa9a677238143b0445102f" category="list-text">Siga as instruções dadas pelo<block ref="3062dc928daa4d85f6e34b6dea110a00" prefix=" " category="inline-code"></block> utilitário para ativar a entrada/saída multipath (MPIO).</block>
  <block id="b53abe6c0013125abea171427b351ccc" category="list-text">Reinicie. Esta etapa é necessária para que quaisquer alterações sejam reconhecidas em todo o sistema.</block>
  <block id="b88caedbe9708683eed783eb534ae5f6" category="list-text">Particione os LUNs e verifique se eles estão alinhados corretamente. Consulte o "Apêndice B: Verificação do alinhamento do WAFL" para obter instruções sobre como testar e confirmar diretamente o alinhamento.</block>
  <block id="a0c1c26e783204cf713b2e1f0823aab3" category="section-title">zpools</block>
  <block id="c81b8fe4a368c32102406e65fc41a227" category="inline-link-macro">Configuração LUN</block>
  <block id="911e63244fc82405263306a64e535c69" category="paragraph">Um zpool só deve ser criado após as etapas no <block ref="e8673fdb712a2edcdf56742c7eec0045" category="inline-link-macro-rx"></block> serem executadas. Se o procedimento não for feito corretamente, pode resultar em degradação grave do desempenho devido ao alinhamento de e/S. O desempenho ideal no ONTAP requer que a e/S seja alinhada a um limite de 4K mm numa unidade. Os sistemas de arquivos criados em um zpool usam um tamanho de bloco efetivo que é controlado por meio de um parâmetro<block ref="81df978a8e3da4bee74b135548f390f3" prefix=" " category="inline-code"></block> chamado , que pode ser visualizado executando o comando<block ref="1615297782a0dff59b20451e2ca97ea7" prefix=" " category="inline-code"></block>.</block>
  <block id="869dc3a8daf591c7f33e5bb32a4a63c9" category="paragraph">O valor<block ref="81df978a8e3da4bee74b135548f390f3" prefix=" " category="inline-code"></block> padrão é 9, o que significa 2 9, ou 512 bytes. Para um desempenho ideal, o<block ref="81df978a8e3da4bee74b135548f390f3" prefix=" " category="inline-code"></block> valor deve ser 12 (2 12 4K). Esse valor é definido no momento em que o zpool é criado e não pode ser alterado, o que significa que os dados em zpools com<block ref="81df978a8e3da4bee74b135548f390f3" prefix=" " category="inline-code"></block> outros que não 12 devem ser migrados copiando dados para um zpool recém-criado.</block>
  <block id="6a00a2262e030c2656588743cb031710" category="paragraph">Depois de criar um zpool, verifique o valor de<block ref="81df978a8e3da4bee74b135548f390f3" prefix=" " category="inline-code"></block> antes de continuar. Se o valor não for 12, os LUNs não foram detetados corretamente. Destrua o zpool, verifique se todas as etapas mostradas na documentação relevante dos Utilitários do host foram executadas corretamente e recrie o zpool.</block>
  <block id="15ec722ce3f6694d12f89aeb5b621941" category="section-title">Zpools e Solaris LDOMs</block>
  <block id="8826ef54a7d108df25ed6921b5129cb6" category="paragraph">Os Solaris LDOMs criam um requisito adicional para garantir que o alinhamento de e/S esteja correto. Embora um LUN possa ser encontrado corretamente como um dispositivo 4K, um dispositivo vdsk virtual em um LDOM não herda a configuração do domínio de e/S. O vdsk baseado nesse LUN retorna para um bloco de 512 bytes.</block>
  <block id="9a984f24f825e4f0bca1f36e11acbca9" category="paragraph">É necessário um ficheiro de configuração adicional. Primeiro, os LDOM individuais devem ser corrigidos para o bug Oracle 15824910 para habilitar as opções de configuração adicionais. Este patch foi portado para todas as versões usadas atualmente do Solaris. Uma vez que o LDOM é corrigido, ele está pronto para a configuração dos novos LUNs corretamente alinhados da seguinte forma:</block>
  <block id="e0f306ab540315b015db849b1ae9099e" category="list-text">Identifique o LUN ou LUNs a serem usados no novo zpool. Neste exemplo, é o dispositivo c2d1.</block>
  <block id="f469046d419183a7be08ed5a13d2c65e" category="list-text">Recupere a instância vdc dos dispositivos a serem usados para um pool ZFS:</block>
  <block id="bcaa63dcd5db76bffd8b867e8720a272" category="list-text"><block ref="ebceeaa7b6ce5abf6c8de7177255fef5" prefix=" " category="inline-code"></block>Editar :</block>
  <block id="ec960a08b4666fe258b6e005064378ab" category="paragraph">Isso significa que a instância 1 do dispositivo recebe um tamanho de bloco de 4096MB.</block>
  <block id="3df4cdc476a0c3a5a930597e9d8da84c" category="paragraph">Como exemplo adicional, suponha que as instâncias 1 a 6 do vdsk precisem ser configuradas para um tamanho de bloco 4K e<block ref="74a491ed941b00d0c9909d488eee67bf" prefix=" " category="inline-code"></block> lerem da seguinte forma:</block>
  <block id="dfed6d8974f03c5b31f20c9c5c2bbe66" category="list-text">O arquivo final<block ref="3328fba80b08b36663ffae0684f6c578" prefix=" " category="inline-code"></block> deve conter o seguinte:</block>
  <block id="5c442834a7707cc96719e468c87b2ff6" category="cell">O LDOM deve ser reinicializado depois que o vdc.conf é configurado e o vdsk é criado. Este passo não pode ser evitado. A alteração do tamanho do bloco só entra em vigor após uma reinicialização. Prossiga com a configuração do zpool e certifique-se de que o ashift está corretamente configurado para 12, conforme descrito anteriormente.</block>
  <block id="2138e0b461ac7e557539bb0b33bde81a" category="section-title">Registo intenção ZFS (ZIL)</block>
  <block id="5477cebfd480a13008afdd16bea2b3f9" category="paragraph">Geralmente, não há razão para localizar o ZFS Intent Log (ZIL) em um dispositivo diferente. O log pode compartilhar espaço com a piscina principal. O uso principal de um ZIL separado é quando se usa unidades físicas que não têm os recursos de armazenamento em cache de gravação em arrays de armazenamento modernos.</block>
  <block id="26a004aeb043de19f767bd7daa39cf2f" category="section-title">logbias</block>
  <block id="07fff183bc4c01bf9bbb21a48b389845" category="paragraph">Defina<block ref="26a004aeb043de19f767bd7daa39cf2f" prefix=" " category="inline-code"></block> o parâmetro em sistemas de arquivos ZFS que hospedam dados Oracle.</block>
  <block id="ac01fbc5e98d6450f3b565d0617f4a55" category="paragraph">O uso desse parâmetro reduz os níveis gerais de gravação. Sob os padrões, os dados escritos são comprometidos primeiro com o ZIL e depois para o pool de armazenamento principal. Essa abordagem é apropriada para uma configuração usando uma configuração de unidade simples, que inclui um dispositivo ZIL baseado em SSD e Mídia giratória para o pool de armazenamento principal. Isso ocorre porque permite que um commit ocorra em uma única transação de e/S na Mídia de menor latência disponível.</block>
  <block id="c6cc0f147c42f124079d7fc1a0761886" category="paragraph">Ao usar um storage array moderno que inclua sua própria funcionalidade de armazenamento em cache, essa abordagem geralmente não é necessária. Em circunstâncias raras, pode ser desejável submeter uma gravação com uma única transação ao log, como uma carga de trabalho que consiste em gravações aleatórias altamente concentradas e sensíveis à latência. Há consequências na forma de amplificação de gravação porque os dados registrados são gravados no pool de armazenamento principal, resultando em uma duplicação da atividade de gravação.</block>
  <block id="92b9531657a4ce6a31c623d889a2c55d" category="section-title">E/S direta</block>
  <block id="387f4a4c250ed7a5003f3f6a19abfd1f" category="paragraph">Muitas aplicações, incluindo produtos Oracle, podem ignorar o cache de buffer do host habilitando a e/S direta Esta estratégia não funciona como esperado com sistemas de arquivos ZFS. Embora o cache do buffer do host seja ignorado, o próprio ZFS continua a armazenar dados em cache. Essa ação pode resultar em resultados enganosos ao usar ferramentas como fio ou sio para realizar testes de desempenho, pois é difícil prever se a e/S está chegando ao sistema de armazenamento ou se está sendo armazenada em cache localmente no sistema operacional. Essa ação também torna muito difícil usar esses testes sintéticos para comparar o desempenho do ZFS com outros sistemas de arquivos. Na prática, há pouca ou nenhuma diferença no desempenho do sistema de arquivos em workloads reais do usuário.</block>
  <block id="ec79b30d56e7bae54aa7efedccc47e93" category="section-title">Vários zpools</block>
  <block id="f5aa5b31f0536ddcdb748ae360d91358" category="paragraph">Backups, restaurações, clones e arquivamento baseados em snapshot de dados baseados em ZFS devem ser executados no nível do zpool e, geralmente, exigem vários zpools. Um zpool é análogo a um grupo de discos LVM e deve ser configurado usando as mesmas regras. Por exemplo, um banco de dados provavelmente é melhor definido com os datafiles que residem em<block ref="f1fb162e58045170396a0ac29d648fa5" prefix=" " category="inline-code"></block> e os logs de arquivo, arquivos de controle e logs de refazer que residem em<block ref="92073f03d18c8eaec3eb5e0908210e1a" prefix=" " category="inline-code"></block>. Essa abordagem permite um hot backup padrão no qual o banco de dados é colocado no modo hot backup, seguido por um snapshot de<block ref="f1fb162e58045170396a0ac29d648fa5" prefix=" " category="inline-code"></block>. O banco de dados é então removido do modo hot backup, o arquivo de log é forçado e um snapshot de<block ref="92073f03d18c8eaec3eb5e0908210e1a" prefix=" " category="inline-code"></block> é criado. Uma operação de restauração requer a desmontagem dos sistemas de arquivos zfs e a remoção do zpool em sua totalidade, seguindo-se uma operação de restauração do SnapRestore. O zpool pode então ser colocado on-line novamente e o banco de dados recuperado.</block>
  <block id="f1110589be196c2310808482067fce1b" category="section-title">sistema de arquivos_options</block>
  <block id="c271ff9f255f2d215054d508448781a3" category="paragraph">O parâmetro Oracle<block ref="f1110589be196c2310808482067fce1b" prefix=" " category="inline-code"></block> funciona de forma diferente com o ZFS. Se<block ref="aef8f91b1e026cc1bb55e8b08c491d35" prefix=" " category="inline-code"></block> ou<block ref="6887bae4cda2d09a283a165c5be3f2b8" prefix=" " category="inline-code"></block> for usado, as operações de gravação são síncronas e ignoram o cache do buffer do sistema operacional, mas as leituras são armazenadas em buffer pelo ZFS. Essa ação causa dificuldades na análise de desempenho, pois às vezes, a e/S é intercetada e atendida pelo cache ZFS, tornando a latência do armazenamento e a e/S total menos do que parece ser.</block>
  <block id="665de76ea0059ac13982f04e19e74216" category="summary">Bancos de dados Oracle com Microsoft Windows</block>
  <block id="0d4fbbc8820271a0ce5d46a15e7bf90f" category="paragraph">Tópicos de configuração para banco de dados Oracle no Microsoft Windows com ONTAP.</block>
  <block id="14ce2582c2080a7f08fe9249f6565f40" category="paragraph">A Oracle suporta o uso do Microsoft Windows com o cliente NFS direto. Esse recurso oferece um caminho para os benefícios de gerenciamento do NFS, incluindo a capacidade de exibir arquivos entre ambientes, redimensionar volumes dinamicamente e utilizar um protocolo IP menos caro. Consulte a documentação oficial da Oracle para obter informações sobre como instalar e configurar um banco de dados no Microsoft Windows usando DNFS. Não existem boas práticas especiais.</block>
  <block id="f854b764258138b512f30be71e1c7908" category="paragraph">Para uma ótima eficiência de compressão, certifique-se de que o sistema de ficheiros NTFS utilize uma unidade de alocação de 8K GB ou maior. O uso de uma unidade de alocação 4K, que geralmente é o padrão, afeta negativamente a eficiência da compressão.</block>
  <block id="440a667261bd94f099ef4dde5caf024f" category="summary">Migração de datafiles Oracle individuais</block>
  <block id="d3c8171a7167ce43c547aac8fdd86cfb" category="doc">Migração de arquivos de dados Oracle</block>
  <block id="fade70b277397e039e100bf0faa98d8e" category="paragraph">Datafiles Oracle individuais podem ser movidos com um único comando.</block>
  <block id="50c3d56e93d52f122bab9de1f2b35780" category="paragraph">Por exemplo, o comando a seguir move o arquivo de dados IOPST.dbf do sistema de arquivos para o sistema de<block ref="eff8b2f7c4da1cf002bdea257a43fd10" prefix=" " category="inline-code"></block> arquivos<block ref="87941c54be03c9785752ea54ac9a2dd4" prefix=" " category="inline-code"></block> .</block>
  <block id="53784088a62519d581c3dac4640c41b5" category="paragraph">Mover um arquivo de dados com esse método pode ser lento, mas normalmente não deve produzir e/S suficiente para interferir com as cargas de trabalho diárias do banco de dados. Em contraste, a migração via rebalanceamento do ASM pode ser executada muito mais rápido, mas à custa de diminuir a velocidade do banco de dados geral enquanto os dados estão sendo movidos.</block>
  <block id="f92065612dfd409585ca08d95cc7a4dc" category="paragraph">O tempo necessário para mover arquivos de dados pode ser facilmente medido criando um arquivo de dados de teste e, em seguida, movendo-o. O tempo decorrido para a operação é gravado nos dados da sessão:</block>
  <block id="78fb69ccdf01155db62828d0bc182b84" category="paragraph">Neste exemplo, o arquivo que foi movido foi o arquivo de dados 8, que era de 21GB MB de tamanho e exigiu cerca de 6 minutos para migrar. O tempo necessário obviamente depende dos recursos do sistema de storage, da rede de armazenamento e da atividade geral do banco de dados que ocorre no momento da migração.</block>
  <block id="85cef7bf4ac9d983cf8e1e11785eeef1" category="summary">Migração Oracle com FLI - conclusão</block>
  <block id="b171714b39ad4102aced4daceef8c678" category="paragraph">Do ponto de vista do host, a migração está concluída, mas a e/S ainda é atendida do array estrangeiro até que as relações de importação sejam excluídas.</block>
  <block id="f708d001227724fa0a8a3d57aacedb1a" category="paragraph">Antes de excluir os relacionamentos, confirme se o processo de migração está concluído para todos os LUNs.</block>
  <block id="85cf20229bc9008553794abdaed507f5" category="section-title">Eliminar relações de importação</block>
  <block id="b23ec325eb9c6278cb36e4c45c2c3499" category="paragraph">Quando o processo de migração estiver concluído, exclua a relação de migração. Depois de fazer isso, e/S é servido exclusivamente a partir das unidades no ONTAP.</block>
  <block id="40b98b0023a7eea7c432c29e3c44ba7d" category="section-title">Anular o registo de LUNs estranhos</block>
  <block id="5ccc14ae93ba94bd4183439a9f80f6c8" category="paragraph">Finalmente, modifique o disco para remover a<block ref="96ea0e5f46787e93e2970a086b47fdb6" prefix=" " category="inline-code"></block> designação.</block>
  <block id="2e34d4efdcf01f27eb9407a010ca1621" category="summary">Migração Oracle com FLI - transição</block>
  <block id="c28b52826242c7cdffe5f3ae1e917f61" category="paragraph">Alguma interrupção durante uma importação LUN estrangeira é inevitável devido à necessidade de alterar a configuração da rede FC. No entanto, a interrupção não precisa durar muito mais do que o tempo necessário para reiniciar o ambiente de banco de dados e atualizar o zoneamento FC para alternar a conetividade FC do host do LUN externo para o ONTAP.</block>
  <block id="a2248459756ffc1877beb9b39c77668b" category="paragraph">Este processo pode ser resumido da seguinte forma:</block>
  <block id="c9f77905e39abbada6c73a7a3d5f51f8" category="list-text">Quiesce toda a atividade LUN nos LUNs externos.</block>
  <block id="cff6e7c6c4f8dd7e57a0286f28712c58" category="list-text">Redirecione as conexões FC do host para o novo sistema ONTAP.</block>
  <block id="9fea842823b73e1eb32307ab325f170e" category="list-text">Acione o processo de importação.</block>
  <block id="df814ea2bf92d4f18e72a648e93103a2" category="list-text">Redescubra os LUNs.</block>
  <block id="030a5009bbe6fb141ca5863ab6c59464" category="list-text">Reinicie o banco de dados.</block>
  <block id="f3bb22d18791c042e889671ad1963239" category="paragraph">Não é necessário esperar que o processo de migração seja concluído. Assim que a migração para um determinado LUN começar, ele estará disponível no ONTAP e poderá servir dados enquanto o processo de cópia de dados continuar. Todas as leituras são passadas para o LUN estrangeiro, e todas as gravações são escritas de forma síncrona em ambos os arrays. A operação de cópia é muito rápida e a sobrecarga de redirecionar o tráfego FC é mínima, portanto, qualquer impactos no desempenho deve ser transitório e mínimo. Se houver problema, você pode atrasar a reinicialização do ambiente até que o processo de migração seja concluído e as relações de importação tenham sido excluídas.</block>
  <block id="b19e17ab765f91aa0bc0e7152f13779f" category="section-title">Encerre a base de dados</block>
  <block id="2869cd69e0fec20ba28a42e74afef158" category="paragraph">O primeiro passo para silenciar o ambiente neste exemplo é desligar o banco de dados.</block>
  <block id="e20dab0880a91f5da2ea05170177576d" category="section-title">Encerre os serviços da grade</block>
  <block id="89c458e5176d6caf0690f1e61ecb0620" category="paragraph">Um dos sistemas de arquivos baseados em SAN que está sendo migrado também inclui os serviços Oracle ASM. A supressão dos LUNs subjacentes requer a desmontagem dos sistemas de arquivos, o que, por sua vez, significa parar todos os processos com arquivos abertos neste sistema de arquivos.</block>
  <block id="49f05bf7da4eacfa4c80bb987443eb5a" category="section-title">Desmontar sistemas de arquivos</block>
  <block id="c5a09ac3ff0bb25c97951c7b7f815cd0" category="paragraph">Se todos os processos forem desligados, a operação umount será bem-sucedida. Se a permissão for negada, deve haver um processo com um bloqueio no sistema de arquivos. O<block ref="ace112f9725b6fa0b702e6b3970b2102" prefix=" " category="inline-code"></block> comando pode ajudar a identificar esses processos.</block>
  <block id="765e13ffc3361a9fd6c6088b2603ffbf" category="section-title">Desativar grupos de volume</block>
  <block id="907e5f35f70dc2f5e4b67da56381bdf4" category="paragraph">Depois de todos os sistemas de arquivos em um determinado grupo de volume serem desmontados, o grupo de volume pode ser desativado.</block>
  <block id="ad80f935ccd133a802189e3c2f4421d7" category="section-title">Alterações na rede FC</block>
  <block id="a497da6790d9ab4bb5cce3d04b0efd2e" category="paragraph">As zonas FC agora podem ser atualizadas para remover todo o acesso do host ao array externo e estabelecer acesso ao ONTAP.</block>
  <block id="3ef31115a10790468ad841ec2cdf566f" category="section-title">Inicie o processo de importação</block>
  <block id="5bc309ef1913ddc70534a0a7135ba938" category="paragraph">Para iniciar os processos de importação de LUN, execute o<block ref="76ffc50817aa4cd6214aa0061339fdf6" prefix=" " category="inline-code"></block> comando.</block>
  <block id="0a10f1ad4a0b45d384c5771ec0906c4c" category="section-title">Monitorar o progresso da importação</block>
  <block id="9a3a7545f4a7407ec022c4b2271e0c34" category="paragraph">A operação de importação pode ser monitorada com o<block ref="1ab15ef2c245a4434fcea3cc3149f4f4" prefix=" " category="inline-code"></block> comando. Como mostrado abaixo, a importação de todos os LUNs 20 está em andamento, o que significa que os dados agora estão acessíveis por meio do ONTAP, mesmo que a operação de cópia de dados ainda progrida.</block>
  <block id="d36f98c8a305e33483232e7b5cd90c49" category="inline-link-macro">Importação LUN estrangeiro - conclusão</block>
  <block id="f0eff8c4d89b44c0cf8b8c323abeaa20" category="paragraph">Se você precisar de um processo off-line, atrasar a redescoberta ou a reinicialização dos serviços até que o<block ref="1ab15ef2c245a4434fcea3cc3149f4f4" prefix=" " category="inline-code"></block> comando indique que toda a migração foi bem-sucedida e concluída. Em seguida, você pode concluir o processo de migração conforme descrito em <block ref="bfe85b0236d22bff0d0d13e4e3fecb98" category="inline-link-macro-rx"></block>.</block>
  <block id="a9c97f84ee4958d39ed989b3da7ed0ba" category="paragraph">Se precisar de uma migração online, continue a redescobrir os LUNs na sua nova casa e a abrir os serviços.</block>
  <block id="d0369936c6fe8c292874e3bc647893b8" category="section-title">Verifique se há alterações no dispositivo SCSI</block>
  <block id="6d338faddede649cab4c5b498e8e4379" category="paragraph">Na maioria dos casos, a opção mais simples para redescobrir novos LUNs é reiniciar o host. Isso remove automaticamente dispositivos obsoletos antigos, descobre corretamente todos os novos LUNs e cria dispositivos associados, como dispositivos multipathing. O exemplo aqui mostra um processo totalmente online para fins de demonstração.</block>
  <block id="3b493a859f19779c1f7db7d1951785ee" category="paragraph">Cuidado: Antes de reiniciar um host, certifique-se de que todas as entradas<block ref="816a3ef77b62ade41c3f936c958aa555" prefix=" " category="inline-code"></block> nessa referência migradas dos recursos SAN sejam comentadas. Se isso não for feito e houver problemas com o acesso LUN, o sistema operacional pode não inicializar. Esta situação não danifica os dados. No entanto, pode ser muito inconveniente inicializar no modo de recuperação ou em um modo semelhante e corrigir o<block ref="816a3ef77b62ade41c3f936c958aa555" prefix=" " category="inline-code"></block> para que o sistema operacional possa ser inicializado para habilitar a solução de problemas.</block>
  <block id="9d7b16568eb7edb80492b49cb02d7663" category="paragraph">Os LUNs na versão do Linux usada neste exemplo podem ser reconfigurados com o<block ref="b6f75508bf2af141e9de6f862662661e" prefix=" " category="inline-code"></block> comando. Se o comando for bem-sucedido, cada caminho LUN deverá aparecer na saída. A saída pode ser difícil de interpretar, mas, se o zoneamento e a configuração do igrop estavam corretos, muitos LUNs devem aparecer que incluem uma<block ref="971c047750d8e3b03c71d24020b3816f" prefix=" " category="inline-code"></block> string de fornecedor.</block>
  <block id="3384aa7c090758ad18028832967b143f" category="section-title">Verifique se existem dispositivos multipath</block>
  <block id="07a39d42e6d8cc61e0a880e43b83e2a3" category="paragraph">O processo de descoberta LUN também aciona a recriação de dispositivos multipath, mas o driver de multipathing Linux é conhecido por ter problemas ocasionais. A saída de<block ref="eeb30d005cab1d8c69785a3cd5818f55" prefix=" " category="inline-code"></block> deve ser verificada para verificar se a saída parece como esperado. Por exemplo, a saída abaixo mostra os dispositivos multipath associados a uma<block ref="971c047750d8e3b03c71d24020b3816f" prefix=" " category="inline-code"></block> cadeia de carateres de fornecedor. Cada dispositivo tem quatro caminhos, com dois em uma prioridade de 50 e dois em uma prioridade de 10. Embora a saída exata possa variar com diferentes versões do Linux, essa saída parece como esperado.</block>
  <block id="efd921479c3d57448954050760c568ca" category="admonition">Consulte a documentação dos utilitários do host para a versão do Linux que você usa para verificar se as<block ref="dd5ff67ba72768d33f75e645aa2b8e56" prefix=" " category="inline-code"></block> configurações estão corretas.</block>
  <block id="28751dc1e914a778d11ca0e69613690b" category="section-title">Reative o grupo de volumes LVM</block>
  <block id="a66a38e4056f28a310ef6d1fa8bbcc77" category="paragraph">Se os LUNs LVM tiverem sido detetados corretamente, o<block ref="5239f542d8edbc4b528b1f362153c0c7" prefix=" " category="inline-code"></block> comando deverá ser bem-sucedido. Este é um bom exemplo do valor de um gerenciador de volume lógico. Uma alteração na WWN de um LUN ou mesmo de um número de série não é importante porque os metadados do grupo de volume são gravados no próprio LUN.</block>
  <block id="1d374f8de5ba1b82ab4407b8c6efbd0d" category="paragraph">O sistema operacional digitalizou os LUNs e descobriu uma pequena quantidade de dados gravados no LUN que os identifica como um volume físico pertencente ao<block ref="83b7788c8e4de444d6cd4c69978eaf32" prefix=" " category="inline-code"></block>. Em seguida, ele construiu todos os dispositivos necessários. Tudo o que é necessário é reativar o grupo de volume.</block>
  <block id="1f0285a57b2357507c3b77ce5130b548" category="section-title">Remontagem dos sistemas de arquivos</block>
  <block id="a9047d68dc7e99f553b71590cff301d6" category="paragraph">Depois que o grupo de volume é reativado, os sistemas de arquivos podem ser montados com todos os dados originais intactos. Como discutido anteriormente, os sistemas de arquivos estão totalmente operacionais, mesmo que a replicação de dados ainda esteja ativa no grupo de volta.</block>
  <block id="a787d65e2525ac6bc3a6328efe383b5c" category="section-title">Redigitalização para dispositivos ASM</block>
  <block id="a25bb20f07ed95a633f623678855e8dc" category="paragraph">Os dispositivos ASMlib devem ter sido redescobertos quando os dispositivos SCSI foram reconfigurados. A redescoberta pode ser verificada on-line reiniciando o ASMlib e, em seguida, digitalizando os discos.</block>
  <block id="37fb12a52b4a5371c12209e89e09b04f" category="admonition">Esta etapa só é relevante para configurações ASM onde ASMlib é usado.</block>
  <block id="6de48f39063d81d53fd0ff3e9938af13" category="paragraph">Atenção: Onde o ASMlib não é usado, os<block ref="9c9f766701f811ef6f170c7a3453c53f" prefix=" " category="inline-code"></block> dispositivos devem ter sido recriados automaticamente. No entanto, as permissões podem não estar corretas. Você deve definir permissões especiais nos dispositivos subjacentes para ASM na ausência de ASMlib. Isso geralmente é feito através de entradas especiais nas<block ref="dd5ff67ba72768d33f75e645aa2b8e56" prefix=" " category="inline-code"></block> regras ou<block ref="ab775c875d5f89d991a670444dd32ad2" prefix=" " category="inline-code"></block>, ou possivelmente em ambos os conjuntos de regras. Esses arquivos podem precisar ser atualizados para refletir alterações no ambiente em termos de WWNs ou números de série para garantir que os dispositivos ASM ainda tenham as permissões corretas.</block>
  <block id="08b33d6af4ec78f99dbbc3533589aafc" category="paragraph">Neste exemplo, reiniciar o ASMlib e procurar discos mostra os mesmos LUNs ASM 10 do ambiente original.</block>
  <block id="17c4ae76000d9a79a56195071665af32" category="section-title">Reinicie os serviços de grade</block>
  <block id="e8c3dc00e15826e3b77a2d41d7fde92a" category="paragraph">Agora que os dispositivos LVM e ASM estão online e disponíveis, os serviços de grade podem ser reiniciados.</block>
  <block id="934317e45581988a01f54761705ca58a" category="section-title">Reinicie a base de dados</block>
  <block id="41475a737e947d73c674b90e78e246a0" category="paragraph">Depois que os serviços de grade tiverem sido reiniciados, o banco de dados pode ser criado. Pode ser necessário esperar alguns minutos para que os serviços ASM fiquem totalmente disponíveis antes de tentar iniciar o banco de dados.</block>
  <block id="afae47e326854c63cbc85989720416e0" category="summary">Migração Oracle com FLI - Planejamento</block>
  <block id="dbd3f1a817d137c052ec01ef60940131" category="inline-link">Documentação de importação de LUN estrangeiro da ONTAP</block>
  <block id="1e63fd2b99b2fef1f5d2ae61ebd5b4a3" category="paragraph">Os procedimentos para migrar recursos SAN usando FLI estão documentados no NetApp<block ref="3a5bd22edab525577a3f095f01c2551b" category="inline-link-rx"></block> .</block>
  <block id="795bbfbd054829fad905065087ba2d5a" category="paragraph">Do ponto de vista de um banco de dados e host, não são necessárias etapas especiais. Depois que as zonas FC forem atualizadas e os LUNs ficarem disponíveis no ONTAP, o LVM poderá ler os metadados do LVM dos LUNs. Além disso, os grupos de volume estão prontos para uso sem etapas de configuração adicionais. Em casos raros, os ambientes podem incluir arquivos de configuração que foram codificados com referências à matriz de armazenamento anterior. Por exemplo, um sistema Linux que incluía<block ref="dd5ff67ba72768d33f75e645aa2b8e56" prefix=" " category="inline-code"></block> regras que referiam uma WWN de um determinado dispositivo deve ser atualizado para refletir as alterações introduzidas pela FLI.</block>
  <block id="9e7ddc2ddefcd6f202fb11a82a80bc7e" category="admonition">Consulte a Matriz de compatibilidade do NetApp para obter informações sobre as configurações suportadas. Se o seu ambiente não estiver incluído, contacte o seu representante da NetApp para obter assistência.</block>
  <block id="0f5b3758229b3e28c8605b6c42398115" category="paragraph">Este exemplo mostra a migração de LUNs ASM e LVM hospedados em um servidor Linux. O FLI é suportado em outros sistemas operacionais e, embora os comandos do lado do host possam diferir, os princípios são os mesmos e os procedimentos do ONTAP são idênticos.</block>
  <block id="f1036cd97e461d07351c9df32fc5948d" category="section-title">Identificar LUNs LVM</block>
  <block id="88f7413f9621a816ee3d370703168647" category="paragraph">O primeiro passo em preparação é identificar os LUNs a serem migrados. No exemplo mostrado aqui, dois sistemas de arquivos baseados em SAN são montados<block ref="572f241ef88fdb17d16eba97133d861f" prefix=" " category="inline-code"></block> em e<block ref="d14bc7787c7396144583e99a7df52f67" prefix=" " category="inline-code"></block>.</block>
  <block id="ecad615a52fda392a9b7c1075d2cb2c5" category="paragraph">O nome do grupo de volume pode ser extraído do nome do dispositivo, que usa o formato (nome do grupo de volume)-(nome do volume lógico). Neste caso, o grupo de volume é<block ref="bb97320b8c517da828eae4ec543113db" prefix=" " category="inline-code"></block> chamado .</block>
  <block id="b08986bb1757d5ae8de06d523c71803d" category="paragraph">O<block ref="f1e2c495108b111c930735e3a0f9a04e" prefix=" " category="inline-code"></block> comando pode ser usado da seguinte forma para identificar os LUNs que suportam este grupo de volumes. Nesse caso, existem 10 LUNs que compõem o<block ref="bb97320b8c517da828eae4ec543113db" prefix=" " category="inline-code"></block> grupo de volumes.</block>
  <block id="8b47fac6803dfff2e8d2cdad6f297cfa" category="section-title">Identificar LUNs ASM</block>
  <block id="a23d0124954ecdbfe9d0f3aceb9e17a2" category="paragraph">LUNs ASM também devem ser migrados. Para obter o número de LUNs e caminhos LUN do sqlplus como usuário do sysasm, execute o seguinte comando:</block>
  <block id="918841992da84786f00de7c4c7d83dbf" category="paragraph">O ambiente atual contém 20 LUNs a serem migrados. Atualize a SAN atual para que o ONTAP possa acessar os LUNs atuais. Os dados ainda não foram migrados, mas o ONTAP deve ler informações de configuração dos LUNs atuais para criar a nova casa para esses dados.</block>
  <block id="5816768a5d83977f34ffa5025c14f430" category="paragraph">No mínimo, pelo menos uma porta HBA no sistema AFF/FAS deve ser configurada como uma porta do iniciador. Além disso, as zonas FC precisam ser atualizadas para que o ONTAP possa acessar os LUNs no storage array estrangeiro. Alguns storages de armazenamento têm o mascaramento LUN configurado, o que limita quais WWNs podem acessar um determinado LUN. Nesses casos, o mascaramento de LUN também deve ser atualizado para conceder acesso às WWNs do ONTAP.</block>
  <block id="030a992b1340f67584d67ef6230e9adf" category="paragraph">Depois que esta etapa for concluída, o ONTAP deve ser capaz de visualizar a matriz de armazenamento estrangeira com o<block ref="d90ba20b63acab53952d68665c50ec47" prefix=" " category="inline-code"></block> comando. O campo chave que retorna é o prefixo usado para identificar o LUN estranho no sistema. No exemplo abaixo, os LUNs na matriz estrangeira<block ref="25103eba8d70e82b5bd837be0d2f63c4" prefix=" " category="inline-code"></block> aparecem no ONTAP usando o prefixo do<block ref="6b35470d99880c4630ed3ca7b4c842e7" prefix=" " category="inline-code"></block>.</block>
  <block id="c1a0f5174323df40a8b659eb65ac5155" category="section-title">Identificar matriz estrangeira</block>
  <block id="6c1b8919e2e706972b3ec48cb7f014ba" category="section-title">Identificar LUNs estranhos</block>
  <block id="63841e312d3a8531331e35bd826268d1" category="paragraph">Os LUNs podem ser listados passando o<block ref="907702f5103a7823393b8dd296a75c26" prefix=" " category="inline-code"></block> para o<block ref="242f4ce1948273386f8bb487bdd3732f" prefix=" " category="inline-code"></block> comando. Os dados retornados são referenciados várias vezes durante o procedimento de migração.</block>
  <block id="e5e94f7e2098883f0d621e064b1104f4" category="section-title">Registre LUNs de matriz estrangeira como candidatos à importação</block>
  <block id="c968ec41c1c0c449b0263962966d8293" category="paragraph">Os LUNs estrangeiros são inicialmente classificados como qualquer tipo de LUN específico. Antes que os dados possam ser importados, os LUNs devem ser marcados como estrangeiros e, portanto, um candidato para o processo de importação. Esta etapa é concluída passando o número de série para<block ref="93c633f7fa188f1b27df574c0e5e929a" prefix=" " category="inline-code"></block> o comando, como mostrado no exemplo a seguir. Observe que esse processo marca somente o LUN como estranho dentro do ONTAP. Nenhum dado é gravado no próprio LUN estrangeiro.</block>
  <block id="33380a523841f23815f2f83c9de1a628" category="section-title">Criar volumes para hospedar LUNs migrados</block>
  <block id="2c2ba8ca6bdd77da1da981b91a3fae4a" category="paragraph">É necessário um volume para hospedar os LUNs migrados. A configuração exata do volume depende do plano geral para aproveitar os recursos do ONTAP. Neste exemplo, os LUNs ASM são colocados em um volume e os LUNs LVM são colocados em um segundo volume. Com isso, você pode gerenciar os LUNs como grupos independentes para fins como disposição em camadas, criação de snapshots ou configuração de controles de QoS.</block>
  <block id="8bc7d64e68e4be8f4908effd57293a2a" category="paragraph">Defina o<block ref="fb983ebeedc63d8723c0d4aa558a4c02" prefix=" " category="inline-code"></block>. O processo de migração pode incluir uma grande quantidade de rotatividade de dados. Portanto, pode haver um grande aumento no consumo de espaço se os snapshots forem criados acidentalmente porque os dados indesejados são capturados nos snapshots.</block>
  <block id="8c0675d07e44f55f1f5aa6d45abe0cdb" category="section-title">Criar LUNs ONTAP</block>
  <block id="0b799020dac78a5e12a3d1a6400fd0c8" category="paragraph">Após a criação dos volumes, é necessário criar os novos LUNs. Normalmente, a criação de um LUN requer que o usuário especifique tais informações como o tamanho do LUN, mas neste caso o argumento de disco externo é passado para o comando. Como resultado, o ONTAP replica os dados de configuração de LUN atuais a partir do número de série especificado. Ele também usa a geometria LUN e os dados da tabela de partição para ajustar o alinhamento LUN e estabelecer o desempenho ideal.</block>
  <block id="5272a1dc3854f1eddc353c8073234e03" category="paragraph">Nesta etapa, os números de série devem ser cruzados em relação à matriz estrangeira para garantir que o LUN estranho correto seja correspondido ao novo LUN correto.</block>
  <block id="f6ee70ec9fce7bd34fa5a33d8969fb5e" category="section-title">Crie relações de importação</block>
  <block id="94700a911b95416221efe4064acbc2ba" category="paragraph">Os LUNs agora foram criados, mas não estão configurados como um destino de replicação. Antes que essa etapa possa ser executada, os LUNs devem primeiro ser colocados off-line. Esta etapa extra foi projetada para proteger dados contra erros do usuário. Se o ONTAP permitisse que uma migração fosse executada em um LUN on-line, isso criaria o risco de que um erro tipográfico pudesse resultar na substituição de dados ativos. A etapa adicional de forçar o usuário a primeiro colocar um LUN off-line ajuda a verificar se o LUN de destino correto é usado como um destino de migração.</block>
  <block id="85255e52054af9c6ffd3c4e79c723a34" category="paragraph">Depois que os LUNs estiverem offline, você pode estabelecer a relação de importação passando o número de série LUN estrangeiro para<block ref="04c2f87857699971f5aedd525e65690a" prefix=" " category="inline-code"></block> o comando.</block>
  <block id="8e3c921431d2b7f66fa0cc85f3ae5c9d" category="paragraph">Depois que todas as relações de importação forem estabelecidas, os LUNs podem ser colocados online novamente.</block>
  <block id="ea382cbfdb353cee0cf25eaae9bba150" category="section-title">Criar grupo de iniciadores</block>
  <block id="152c4728a5fb152525a639439b9d7cb9" category="inline-link-macro">Conversão de protocolo</block>
  <block id="e4da750cce448393b2597f8f66086894" category="paragraph">Um grupo de iniciadores (igroup) faz parte da arquitetura de mascaramento de LUN do ONTAP. Um LUN recém-criado não é acessível a menos que um host tenha acesso concedido pela primeira vez. Isso é feito criando um grupo que lista os nomes dos iniciadores FC WWNs ou iSCSI que devem ser concedidos acesso. Na época em que esse relatório foi escrito, a FLI era compatível apenas com LUNs FC. No entanto, a conversão para iSCSI pós-migração é uma tarefa simples, como mostrado na <block ref="43085dc2a05784d4912331d1ed1db91d" category="inline-link-macro-rx"></block>.</block>
  <block id="298a1c3c736859f2cfa3cb8eb1f3fdcc" category="paragraph">Neste exemplo, um grupo é criado que contém duas WWNs que correspondem às duas portas disponíveis no HBA do host.</block>
  <block id="4f6f03762bfcdc7174cdd30240ce45b3" category="section-title">Mapear novos LUNs para o host</block>
  <block id="c22fee2d07a149be91ae1ae2ada1cb57" category="paragraph">Após a criação do grupo, os LUNs são então mapeados para o grupo definido. Esses LUNs estão disponíveis apenas para as WWNs incluídas neste grupo. O NetApp assume nesta fase do processo de migração que o host não foi zoneado para o ONTAP. Isso é importante porque, se o host for simultaneamente zoneado para o array estrangeiro e o novo sistema ONTAP, existe o risco de que LUNs com o mesmo número de série possam ser descobertos em cada array. Essa situação pode levar a falhas de multipath ou danos aos dados.</block>
  <block id="1404b2da267c376dac716bd5455f4ff3" category="summary">Migração Oracle com FLI - conversão de protocolo</block>
  <block id="2adcfd589637337984e39e94dd14ae33" category="paragraph">Alterar o protocolo usado para acessar um LUN é um requisito comum.</block>
  <block id="38fe6838f11a6023172d11d806adbfcf" category="paragraph">Em alguns casos, faz parte de uma estratégia geral para migrar dados para a nuvem. O TCP/IP é o protocolo da nuvem e a mudança de FC para iSCSI permite uma migração mais fácil para vários ambientes de nuvem. Em outros casos, o iSCSI pode ser desejável para aproveitar os custos reduzidos de uma SAN IP. Ocasionalmente, uma migração pode usar um protocolo diferente como medida temporária. Por exemplo, se um array estrangeiro e LUNs baseados em ONTAP não contiverem nos mesmos HBAs, você poderá usar LUNs iSCSI o suficiente para copiar dados do array antigo. Em seguida, você pode converter de volta para FC depois que os LUNs antigos forem removidos do sistema.</block>
  <block id="832c81bd0db3ad98a3804ff5ce996a58" category="paragraph">O procedimento a seguir demonstra a conversão de FC para iSCSI, mas os princípios gerais se aplicam a uma conversão de iSCSI para FC reversa.</block>
  <block id="e21180783b17ea695cf9275fce8a0bc7" category="section-title">Instale o iniciador iSCSI</block>
  <block id="0e1ddcc32a3ef636c9ca084a3d7706f5" category="paragraph">A maioria dos sistemas operacionais inclui um iniciador iSCSI de software por padrão, mas se um não estiver incluído, ele pode ser facilmente instalado.</block>
  <block id="289fe013df899f5f74fb362d4efcdd5d" category="section-title">Identificar o nome do iniciador iSCSI</block>
  <block id="8242e97b190184a6c7b8ec96c5662886" category="paragraph">Um nome exclusivo do iniciador iSCSI é gerado durante o processo de instalação. No Linux, ele está localizado no<block ref="22565a44e8f73044eb2029acbb069639" prefix=" " category="inline-code"></block> arquivo. Esse nome é usado para identificar o host na SAN IP.</block>
  <block id="721a96eb0b922b337fa815839839b328" category="section-title">Crie um novo grupo de iniciadores</block>
  <block id="cda1311d977b7b77ad3aebe4a813b3bd" category="paragraph">Um grupo de iniciadores (igroup) faz parte da arquitetura de mascaramento de LUN do ONTAP. Um LUN recém-criado não é acessível a menos que um host tenha acesso concedido pela primeira vez. Esta etapa é realizada criando um grupo que lista os nomes de iniciador iSCSI ou WWNs FC que exigem acesso.</block>
  <block id="6548788f050643897f7354b6df4488db" category="paragraph">Neste exemplo, um grupo é criado que contém o iniciador iSCSI do host Linux.</block>
  <block id="da8490d81c1ef6b559b09c2ab94631d2" category="section-title">Encerrar o ambiente</block>
  <block id="0bf211160ad57fedca3499176f213b11" category="paragraph">Antes de alterar o protocolo LUN, os LUNs devem estar totalmente quietos. Qualquer banco de dados em um dos LUNs sendo convertidos deve ser desligado, sistemas de arquivos devem ser desmontados e grupos de volumes devem ser desativados. Quando o ASM for usado, certifique-se de que o grupo de discos ASM esteja desmontado e desligue todos os serviços de grade.</block>
  <block id="2ba1c509ee5f5e31f05b24aed2d23054" category="section-title">Desmapear LUNs da rede FC</block>
  <block id="2f9e42c479a76dd54d7946c181049dd4" category="paragraph">Depois que os LUNs estiverem totalmente quietos, remova os mapeamentos do grupo FC original.</block>
  <block id="5f889f52ef85be290c3e5c0211bbb8fa" category="section-title">Remapear LUNs para a rede IP</block>
  <block id="4ac84701530b31d8d33d9aa742715d25" category="paragraph">Conceda acesso a cada LUN ao novo grupo de iniciadores baseado em iSCSI.</block>
  <block id="3d59eaa280c8b75d8e997eac2cf5b3e6" category="section-title">Descubra iSCSI Targets</block>
  <block id="981b782c3eacf8b87d8231b887873f03" category="paragraph">Existem duas fases para a descoberta iSCSI. O primeiro é descobrir os alvos, o que não é o mesmo que descobrir um LUN. O<block ref="f88921f58beaaae5bcb9dffac54bf5ad" prefix=" " category="inline-code"></block> comando mostrado abaixo sonda o grupo do portal especificado pelo<block ref="24e12535882a30ad33a21d76d76bd0ff" prefix=" " category="inline-code"></block> e armazena uma lista de todos os endereços IP e portas que oferecem serviços iSCSI. Neste caso, existem quatro endereços IP que têm serviços iSCSI na porta padrão 3260.</block>
  <block id="0ab5dd035c7f92f4dce1026744c01604" category="admonition">Este comando pode levar vários minutos para ser concluído se algum dos endereços IP de destino não puder ser alcançado.</block>
  <block id="1dba8f39914c5f44e3cb635e7ac7563e" category="section-title">Descubra iSCSI LUNs</block>
  <block id="68307bef4b9dc4071d875a0c2aadd321" category="paragraph">Depois que os iSCSI Targets forem descobertos, reinicie o serviço iSCSI para descobrir os iSCSI LUNs disponíveis e criar dispositivos associados, como os dispositivos multipath ou ASMlib.</block>
  <block id="25d811252f87ae85dda97f2ab9dd1f3a" category="section-title">Reinicie o ambiente</block>
  <block id="8a9aae851d31dae8baf96171f114955e" category="paragraph">Reinicie o ambiente reativando grupos de volumes, remontando sistemas de arquivos, reiniciando serviços RAC e assim por diante. Como precaução, o NetApp recomenda que você reinicie o servidor após o processo de conversão estar concluído para ter certeza de que todos os arquivos de configuração estão corretos e todos os dispositivos obsoletos são removidos.</block>
  <block id="00f4c8378b0bf837cee4b0aed8886f31" category="paragraph">Cuidado: Antes de reiniciar um host, certifique-se de que todas as entradas<block ref="816a3ef77b62ade41c3f936c958aa555" prefix=" " category="inline-code"></block> nessa referência migradas dos recursos SAN sejam comentadas. Se esta etapa não for tomada e houver problemas com o acesso LUN, o resultado pode ser um sistema operacional que não inicializa. Este problema não danifica os dados. No entanto, pode ser muito inconveniente inicializar no modo de recuperação ou em um modo semelhante e corrigir<block ref="816a3ef77b62ade41c3f936c958aa555" prefix=" " category="inline-code"></block> para que o sistema operacional possa ser inicializado para permitir que os esforços de solução de problemas comecem.</block>
  <block id="593b763e01de37a327966ee1abb3f8a2" category="summary">Migração Oracle usando a pilha de storage do lado do host</block>
  <block id="b7433f552fcf8a4e34f2ccc357037d4e" category="doc">Cópia de dados do host do banco de dados Oracle</block>
  <block id="3dc2d5f8d7209bb75e8d67aed68bc5ed" category="paragraph">Assim como na migração no nível do banco de dados, a migração na camada de host fornece uma abordagem independente de fornecedor de storage.</block>
  <block id="1686ceaaa0d8fb4f9a8adb5e717b029c" category="paragraph">Em outras palavras, em algum momento "basta copiar os arquivos" é a melhor opção.</block>
  <block id="d5732a4ab4c633ceb871cebdbf9ae34f" category="paragraph">Embora essa abordagem de baixa tecnologia possa parecer muito básica, ela oferece benefícios significativos porque nenhum software especial é necessário e os dados originais permanecem intactos com segurança durante o processo. A limitação principal é o fato de que uma migração de dados de cópia de arquivo é um processo disruptivo, porque o banco de dados deve ser desligado antes que a operação de cópia comece. Não há uma boa maneira de sincronizar as alterações dentro de um arquivo, então os arquivos devem ser completamente quiesced antes que a cópia comece.</block>
  <block id="706e7514bb30a289d7ce786a1a5c2ca0" category="paragraph">Se o desligamento exigido por uma operação de cópia não for desejável, a próxima melhor opção baseada em host é aproveitar um gerenciador de volume lógico (LVM). Existem muitas opções de LVM, incluindo Oracle ASM, todas com capacidades semelhantes, mas também com algumas limitações que devem ser levadas em conta. Na maioria dos casos, a migração pode ser realizada sem tempo de inatividade e interrupção.</block>
  <block id="f58e97ac8406ca3e8f0bb7a019a81985" category="section-title">Filesystem para cópia do sistema de arquivos</block>
  <block id="a08ab728e75c63a41ce7571cb781cda2" category="paragraph">A utilidade de uma operação de cópia simples não deve ser subestimada. Essa operação requer tempo de inatividade durante o processo de cópia, mas é um processo altamente confiável e não requer experiência especial com sistemas operacionais, bancos de dados ou sistemas de storage. Além disso, é muito seguro porque não afeta os dados originais. Normalmente, um administrador de sistema altera os sistemas de arquivos de origem para serem montados como somente leitura e, em seguida, reinicia um servidor para garantir que nada pode danificar os dados atuais. O processo de cópia pode ser programado para garantir que ele seja executado o mais rápido possível sem risco de erro do usuário. Como o tipo de e/S é uma transferência sequencial simples de dados, ele é altamente eficiente em largura de banda.</block>
  <block id="ba0bd93801872993ce832352dd03b56a" category="paragraph">O exemplo a seguir demonstra uma opção para uma migração segura e rápida.</block>
  <block id="0ba29c6a1afacf586b03a26162c72274" category="section-title">Ambiente</block>
  <block id="d8cb8bcd239bbe7a2a488c1d68dbe420" category="paragraph">O ambiente a ser migrado é o seguinte:</block>
  <block id="3ffbdefc66ad1d1e707c1d6820afbdc0" category="list-text">Sistemas de arquivos atuais</block>
  <block id="bdc9e98c6b17bb14a7bce916054413ba" category="list-text">Novos sistemas de arquivos</block>
  <block id="e76912cd513cc8cbcabc2735b524e814" category="paragraph">O banco de dados pode ser migrado por um DBA simplesmente desligando o banco de dados e copiando os arquivos, mas o processo é facilmente programado se muitos bancos de dados precisam ser migrados ou minimizar o tempo de inatividade é fundamental. O uso de scripts também reduz a chance de erro do usuário.</block>
  <block id="d21aae9692f3b1d4e53fd73131414b93" category="paragraph">Os scripts de exemplo mostrados automatizam as seguintes operações:</block>
  <block id="66909ae9d06bad444f5a059b8ee2cd41" category="list-text">Encerrar o banco de dados</block>
  <block id="ae737f3f8c04ccbefa99b2bbf87dccc2" category="list-text">Convertendo os sistemas de arquivos existentes em um estado somente leitura</block>
  <block id="1dd90b7b28cbd03687df6538c66ff494" category="list-text">Copiar todos os dados da origem para os sistemas de arquivos de destino, o que preserva todas as permissões de arquivo</block>
  <block id="741341be7809d7f5765b2352e6ab0aab" category="list-text">Desmontar os sistemas de ficheiros antigos e novos</block>
  <block id="7465bc030ca3fe236bcf3ecdf8aaebe4" category="list-text">Remontar os novos sistemas de arquivos nos mesmos caminhos que os sistemas de arquivos anteriores</block>
  <block id="8c4271e6faf2cea4cfc8e5b7108d8ee9" category="section-title">Procedimento</block>
  <block id="67eadd4b70772835f318e6d3027e4308" category="inline-link-macro">Converter sistema de arquivos para somente leitura</block>
  <block id="474aae6515223cc3ba71074c9d5abcae" category="list-text">Converta os sistemas de arquivos para somente leitura. Isso pode ser feito mais rapidamente usando um script, como mostrado em <block ref="2d6e37849c641071fe1cf71ac348d28c" category="inline-link-macro-rx"></block>.</block>
  <block id="4879ec77723fce4974f8ae2a7f87121a" category="list-text">Confirme se os sistemas de arquivos agora são somente leitura.</block>
  <block id="c91e7f5dba3c873d0978f4892bf8b3f2" category="list-text">Sincronize o conteúdo do sistema de arquivos com o<block ref="89a4551b0f29c1a652648b1cb8747021" prefix=" " category="inline-code"></block> comando.</block>
  <block id="91e702884985853b8a7091ed5f2beceb" category="inline-link-macro">Substitua o sistema de arquivos</block>
  <block id="ea27cab9fe7b891870e0ce59aa34e853" category="list-text">Desmonte os sistemas de arquivos antigos e reposicione os dados copiados. Isso pode ser feito mais rapidamente usando um script, como mostrado em <block ref="fa3b775593af4f3de8972aced258710d" category="inline-link-macro-rx"></block>.</block>
  <block id="5fe2431acb45422c46eadf66a93851af" category="list-text">Confirme se os novos sistemas de ficheiros estão na posição correta.</block>
  <block id="2d53403ab873059f92ad884eb271e8dc" category="list-text">Inicie o banco de dados.</block>
  <block id="40351c33ab81b8b374a20fd292057481" category="section-title">Redução totalmente automatizada</block>
  <block id="3f70361470a11fb351c83257cd7aa63e" category="paragraph">Este script de exemplo aceita argumentos do SID do banco de dados seguido por pares de sistemas de arquivos delimitados por comum. Para o exemplo mostrado acima, o comando é emitido da seguinte forma:</block>
  <block id="5cddd7b314b7ae819e2cfcac85021426" category="paragraph">Quando executado, o script de exemplo tenta executar a seguinte sequência. Ele termina se encontrar um erro em qualquer etapa:</block>
  <block id="43d4fce7952ee09c0c8df60a17f5ea56" category="list-text">Converta os sistemas de arquivos atuais para o status somente leitura.</block>
  <block id="9d53d62d1e6dc69460f47c83e6c1919d" category="list-text">Use cada par delimitado por vírgulas de argumentos do sistema de arquivos e sincronize o primeiro sistema de arquivos para o segundo.</block>
  <block id="39ff0e6dfa9915344ec96f9e78a27267" category="list-text">Desmonte os sistemas de ficheiros anteriores.</block>
  <block id="e220fa2a2806386a64e9860f27372e43" category="list-text">Atualize o<block ref="816a3ef77b62ade41c3f936c958aa555" prefix=" " category="inline-code"></block> ficheiro da seguinte forma:</block>
  <block id="232c2c4ddd45fc028ae13b58251c5f7e" category="list-text">Crie uma cópia de segurança em<block ref="9eb56e72a6bb8350a1453c2762d14178" prefix=" " category="inline-code"></block>.</block>
  <block id="d5082ae73767550813688202df21bc4d" category="list-text">Comente as entradas anteriores para os sistemas de ficheiros anteriores e novos.</block>
  <block id="b8793b424d1738f1e00e545379867b0d" category="list-text">Crie uma nova entrada para o novo sistema de arquivos que usa o ponto de montagem antigo.</block>
  <block id="29478980f354caa483bc0cfb827c7251" category="list-text">Monte os sistemas de ficheiros.</block>
  <block id="a0ec0d8bede7d9d58172084de7d5ce53" category="paragraph">O texto a seguir fornece um exemplo de execução para este script:</block>
  <block id="350265a378d2cb1183cd51d56f0e5843" category="section-title">Migração Oracle ASM spfile e passwd</block>
  <block id="f37bc722651f2fd86ba4da87f947c4db" category="paragraph">Uma dificuldade em concluir a migração envolvendo ASM é o arquivo spfile específico ASM e o arquivo de senha. Por padrão, esses arquivos de metadados críticos são criados no primeiro grupo de discos ASM definido. Se um determinado grupo de discos ASM tiver de ser evacuado e removido, o ficheiro spfile e password que regem essa instância ASM deve ser realocado.</block>
  <block id="88e2a97e52f9854b59ce63e74c4b0cac" category="paragraph">Outro caso de uso no qual esses arquivos podem precisar ser relocados é durante a implantação de software de gerenciamento de banco de dados, como o SnapManager para Oracle ou o plug-in SnapCenter Oracle. Um dos recursos desses produtos é restaurar rapidamente um banco de dados revertendo o estado dos LUNs ASM que hospedam os arquivos de dados. Fazer isso requer que o grupo de discos ASM fique offline antes de executar uma restauração. Este não é um problema, desde que os arquivos de dados de um determinado banco de dados sejam isolados em um grupo de discos ASM dedicado.</block>
  <block id="24de04443b6bdae76336fcab04ae946c" category="paragraph">Quando esse grupo de discos também contém o arquivo ASM spfile/passwd, a única maneira que o grupo de discos pode ser colocado offline é desligar toda a instância ASM. Este é um processo disruptivo, o que significa que o arquivo spfile/passwd precisaria ser relocado.</block>
  <block id="a6221bf4332cc966c69066295a843480" category="list-text">Base de dados SID: TOAST</block>
  <block id="0af0da2831407b8130e7f2fabdfab87d" category="list-text">Ficheiros de dados atuais ligados<block ref="c097579d8cb34b312d396304e0b8f487" prefix=" " category="inline-code"></block></block>
  <block id="24aa2824a0b52b46b301afdb3af9336f" category="list-text">Ficheiros de registo e ficheiros de controlo atuais ligados<block ref="ad6062251d172504e3b3bed3a8256a5a" prefix=" " category="inline-code"></block></block>
  <block id="bb6de9ea84381f7d01fdd038f104e4ae" category="list-text">Novos grupos de discos ASM estabelecidos como<block ref="cb2eb5386826561ac7895f1c878e4252" prefix=" " category="inline-code"></block> e.<block ref="5e20ccf28224fc0cc564f9825c208dbd" prefix=" " category="inline-code"></block></block>
  <block id="8b14bd9d310bf8b211c19645576201e3" category="section-title">Localizações de ficheiros ASM spfile/passwd</block>
  <block id="7c7d8dd5d09a73f06678562b66dcdc68" category="paragraph">A realocação desses arquivos pode ser feita sem interrupções. No entanto, por motivos de segurança, a NetApp recomenda desligar o ambiente de banco de dados para que você possa ter certeza de que os arquivos foram realocados e a configuração foi atualizada corretamente. Este procedimento deve ser repetido se várias instâncias ASM estiverem presentes em um servidor.</block>
  <block id="3666b74ddcf77306328ac5d6db94fecd" category="section-title">Identificar instâncias ASM</block>
  <block id="9d19a85576af8e1b3dbd78e343a2b022" category="paragraph">Identifique as instâncias ASM com base nos dados gravados no<block ref="9da4474b569071bcb2ece1d0bdfe7560" prefix=" " category="inline-code"></block> arquivo. As instâncias ASM são denotadas por um símbolo.</block>
  <block id="3fe2dd8cf6f82ac15544fd96f9b59b28" category="paragraph">Há uma instância ASM chamada ASM neste servidor.</block>
  <block id="35a557b0490d5a93931025eaaf712cac" category="section-title">Certifique-se de que todos os bancos de dados estão desligados</block>
  <block id="e6b0819ae1eca7d408a097efc2fbf2cf" category="paragraph">O único processo smon visível deve ser o Smon para a instância ASM em uso. A presença de outro processo Smon indica que um banco de dados ainda está em execução.</block>
  <block id="97639c779a60f010af01997e2363f4eb" category="paragraph">O único processo smon é a própria instância ASM. Isso significa que nenhum outro banco de dados está sendo executado e é seguro prosseguir sem o risco de interromper as operações do banco de dados.</block>
  <block id="a8d157790e55d19378ddbbdfeb675ef8" category="section-title">Localize arquivos</block>
  <block id="12d8c982eb4072e31ac4bfe375193160" category="paragraph">Identifique a localização atual do arquivo ASM spfile e senha usando os<block ref="e258dbf5114b4df07f0d9e72deb386f2" prefix=" " category="inline-code"></block> comandos e.<block ref="bb41cdf6c9bb75ee17856f938070f23d" prefix=" " category="inline-code"></block></block>
  <block id="bebe64e9d0d4ae3d44b4dfb3583e0109" category="paragraph">Os arquivos estão localizados na base do<block ref="c097579d8cb34b312d396304e0b8f487" prefix=" " category="inline-code"></block> grupo de discos.</block>
  <block id="558f28628ba8ab4cb8420949524832d3" category="section-title">Copiar ficheiros</block>
  <block id="c0c2c850cb11c5bb52abbd55a9578e54" category="paragraph">Copie os ficheiros para o novo grupo de discos ASM com os<block ref="c0baea639672c84505e661b9e369c68a" prefix=" " category="inline-code"></block> comandos e.<block ref="c7adee97d05083a7b65e4b6953045177" prefix=" " category="inline-code"></block> Se o novo grupo de discos tiver sido criado recentemente e estiver vazio, poderá ser necessário montar primeiro.</block>
  <block id="3ed2faf3e1299edd7d92d6c4064f1579" category="paragraph">Os ficheiros foram agora copiados de<block ref="c097579d8cb34b312d396304e0b8f487" prefix=" " category="inline-code"></block> para<block ref="cb2eb5386826561ac7895f1c878e4252" prefix=" " category="inline-code"></block>.</block>
  <block id="1dba5fc559232a8dae45d9f88ed36030" category="section-title">Atualizar instância ASM</block>
  <block id="1fe2cc6cf436a4bcc6bdc41f947a416a" category="paragraph">A instância ASM agora deve ser atualizada para refletir a alteração no local. Os<block ref="c8b1affa9ec15d0c0e79347905e75d3e" prefix=" " category="inline-code"></block> comandos e<block ref="73fb08020d8535b4123a8968c596038c" prefix=" " category="inline-code"></block> atualizam os metadados ASM necessários para iniciar o grupo de discos ASM.</block>
  <block id="626759f91a0458b0c068cce8a05a6468" category="section-title">Ative ASM usando arquivos atualizados</block>
  <block id="69f08287c6faa04381e5a05f4087abe1" category="paragraph">Neste ponto, a instância ASM ainda usa os locais anteriores desses arquivos. A instância deve ser reiniciada para forçar uma releitura dos arquivos de seus novos locais e liberar bloqueios nos arquivos anteriores.</block>
  <block id="5505cf0c514193b89221f1cef3004c58" category="section-title">Remova arquivos spfile e senhas antigos</block>
  <block id="8f2d3ac58be7a91f51d7ce9ffa04e397" category="paragraph">Se o procedimento tiver sido executado com êxito, os ficheiros anteriores já não estão bloqueados e podem ser removidos.</block>
  <block id="cfca2b2eb0d694e70904ec82f5d1c34e" category="section-title">Cópia Oracle ASM para ASM</block>
  <block id="12632d520b8d9518b5622ac00dc764a8" category="paragraph">O Oracle ASM é essencialmente um gerenciador de volumes e um sistema de arquivos combinados leves. Como o sistema de arquivos não é facilmente visível, o RMAN deve ser usado para executar operações de cópia. Embora um processo de migração baseado em cópia seja seguro e simples, isso resulta em algumas interrupções. A interrupção pode ser minimizada, mas não totalmente eliminada.</block>
  <block id="152106ebb2aaa94cc87657d353331189" category="paragraph">Se você quiser migração sem interrupções de um banco de dados baseado em ASM, a melhor opção é utilizar a funcionalidade do ASM para rebalancear as extensões ASM para novos LUNs e deixar cair os LUNs antigos. Isso geralmente é seguro e sem interrupções para operações, mas não oferece caminho de back-out. Se forem encontrados problemas funcionais ou de desempenho, a única opção é migrar os dados de volta para a origem.</block>
  <block id="81fe23a1ac3b2bb348e579b2c5b0f5d5" category="paragraph">Esse risco pode ser evitado copiando o banco de dados para o novo local em vez de mover dados, para que os dados originais fiquem intactos. O banco de dados pode ser totalmente testado em seu novo local antes de entrar em funcionamento, e o banco de dados original está disponível como uma opção de retorno se problemas forem encontrados.</block>
  <block id="3028182db088e823770b3d02aa0eac9e" category="paragraph">Este procedimento é uma das muitas opções envolvendo RMAN. Ele foi projetado para permitir um processo de duas etapas no qual o backup inicial é criado e, em seguida, sincronizado mais tarde através da repetição de log. Esse processo é desejável para minimizar o tempo de inatividade, pois permite que o banco de dados permaneça operacional e forneça dados durante a cópia inicial da linha de base.</block>
  <block id="634f50a6c6f112c46150a301d749dbcb" category="section-title">Copiar base de dados</block>
  <block id="5f0bd85dd65afab1472713e8e034fff7" category="paragraph">O Oracle RMAN cria uma cópia de nível 0 (completa) do banco de dados de origem atualmente localizado no grupo de discos ASM<block ref="c097579d8cb34b312d396304e0b8f487" prefix=" " category="inline-code"></block> para o novo local no<block ref="cb2eb5386826561ac7895f1c878e4252" prefix=" " category="inline-code"></block>.</block>
  <block id="b51dc519efad4b151a05682b68f4b182" category="section-title">Forçar o interrutor de registo de arquivo</block>
  <block id="10793485747151dfa2eaddb0854c84b2" category="paragraph">Você deve forçar um switch de log de arquivamento para garantir que os logs de arquivamento contenham todos os dados necessários para tornar a cópia totalmente consistente. Sem este comando, os dados de chave ainda podem estar presentes nos logs de refazer.</block>
  <block id="c55a88a6b8fdc5972d4e2a4924f93dbf" category="section-title">Desligue o banco de dados de origem</block>
  <block id="9ec82bff06c706f42a8170befdd6cf39" category="paragraph">A interrupção começa nesta etapa porque o banco de dados é desligado e colocado em um modo de acesso limitado, somente leitura. Para encerrar o banco de dados de origem, execute os seguintes comandos:</block>
  <block id="6ecf02e1343e82cf0cd95d7303346ff1" category="section-title">Backup do Controlfile</block>
  <block id="e7bc82f6d1381df55ace121dc02368e6" category="paragraph">Você deve fazer backup do controlfile caso precise abortar a migração e reverter para o local de armazenamento original. Uma cópia do ficheiro de controlo de cópia de segurança não é 100% necessária, mas facilita o processo de reposição das localizações dos ficheiros de base de dados para a localização original.</block>
  <block id="f34a9f7c077457a54f8838b55b9fc025" category="section-title">Atualizações de parâmetros</block>
  <block id="4e7a51f2c1ee60c69cd719d415f5e87a" category="paragraph">O spfile atual contém referências aos controlfiles em seus locais atuais dentro do grupo de discos ASM antigo. Ele deve ser editado, o que é facilmente feito editando uma versão intermediária pfile.</block>
  <block id="253e30479f86461bc79f2fca58ee4cb1" category="section-title">Atualize o pfile</block>
  <block id="35db8a54b9c7581f0f77b059233cc61b" category="paragraph">Atualize quaisquer parâmetros referentes a grupos de discos ASM antigos para refletir os novos nomes de grupos de discos ASM. Em seguida, salve o arquivo pfile atualizado. Certifique-se de que os<block ref="5fa1d01559c04dcdb3ba05775712b1ab" prefix=" " category="inline-code"></block> parâmetros estão presentes.</block>
  <block id="bb607fbd46f48c3a4080ecda83288b69" category="paragraph">No exemplo abaixo, as referências a<block ref="c097579d8cb34b312d396304e0b8f487" prefix=" " category="inline-code"></block> que foram alteradas<block ref="cb2eb5386826561ac7895f1c878e4252" prefix=" " category="inline-code"></block> são realçadas em amarelo. Dois parâmetros-chave são os<block ref="5fa1d01559c04dcdb3ba05775712b1ab" prefix=" " category="inline-code"></block> parâmetros que criam quaisquer novos arquivos no local correto.</block>
  <block id="5275e85db4d606621d8f074e44b95748" category="section-title">Atualize o arquivo init.ora</block>
  <block id="17a2b5d1af48f7f8d1511d5372896f7a" category="paragraph">A maioria dos bancos de dados baseados em ASM usa um<block ref="b6bd7c570605affc5b50bbd3e436f0c0" prefix=" " category="inline-code"></block> arquivo localizado no<block ref="45c7302d9c2e8745b3a2bff0f992b6df" prefix=" " category="inline-code"></block> diretório, que é um ponto para o spfile no grupo de discos ASM. Esse arquivo deve ser redirecionado para um local no novo grupo de discos ASM.</block>
  <block id="6ad274256421918b584abff3b9446b09" category="paragraph">Altere este ficheiro da seguinte forma:</block>
  <block id="b6638505615764c377e2cf2585993fd0" category="section-title">Recriação do arquivo de parâmetros</block>
  <block id="52b21c2e6103a3b8d888a4185e21a787" category="paragraph">O arquivo spfile agora está pronto para ser preenchido pelos dados no arquivo pfile editado.</block>
  <block id="37f4738eddd35e77d15af55a40e1ab1c" category="section-title">Inicie o banco de dados para começar a usar o novo spfile</block>
  <block id="79f8a930424fe3b21dc30a72791171d4" category="paragraph">Inicie o banco de dados para se certificar de que ele agora usa o arquivo spfile recém-criado e que quaisquer outras alterações aos parâmetros do sistema são registradas corretamente.</block>
  <block id="231ef0ea12d142611eeea2fdfad67114" category="section-title">Restaure o ficheiro de controlo</block>
  <block id="33cdbbeabc7f2c647f20b3f8b924307f" category="paragraph">O arquivo de controle de backup criado pelo RMAN também pode ser restaurado pelo RMAN diretamente para o local especificado no novo spfile.</block>
  <block id="ce656b7f351ebdc7c599aff6a99e0f2a" category="paragraph">Monte o banco de dados e verifique o uso do novo controlfile.</block>
  <block id="fda1e79fe400519496075b7e2871092a" category="section-title">Registo de reprodução</block>
  <block id="daaec4441f16b5bac11476d4582a296c" category="paragraph">O banco de dados usa atualmente os arquivos de dados no local antigo. Antes que a cópia possa ser usada, ela deve ser sincronizada. O tempo passou durante o processo de cópia inicial e as alterações foram registradas principalmente nos logs de arquivo. Essas alterações são replicadas da seguinte forma:</block>
  <block id="fca6726270a94f51cab3142509d32919" category="list-text">Execute uma cópia de segurança incremental RMAN, que contém os registos de arquivo.</block>
  <block id="8b8a5667b011b5f37163ff4da1004343" category="list-text">Repetir o registo.</block>
  <block id="a9a62e70841c4d06dd16306a85700d36" category="section-title">Ativação</block>
  <block id="8fecb0145484a35b1d9d5926c945ca30" category="paragraph">O arquivo de controle que foi restaurado ainda faz referência aos arquivos de dados no local original e também contém as informações de caminho para os arquivos de dados copiados.</block>
  <block id="f590db5fdc10f6942f7cd173c0bb578b" category="list-text">Para alterar os arquivos de dados ativos, execute o<block ref="7705ebb59373d0b1dfc71d86ef726f93" prefix=" " category="inline-code"></block> comando.</block>
  <block id="2c5c2b5174eafe321358329636e80f5e" category="paragraph">Os arquivos de dados ativos agora são os arquivos de dados copiados, mas ainda podem haver alterações contidas nos logs de refazer finais.</block>
  <block id="fe83c5826bec1aa20e26802fa94a4a0f" category="list-text">Para reproduzir todos os logs restantes, execute o<block ref="81168dbef15af03d02c51a7447378e76" prefix=" " category="inline-code"></block> comando. Se a mensagem<block ref="cef3519da39a73834e89a18ca91951f1" prefix=" " category="inline-code"></block> for exibida, o processo foi bem-sucedido.</block>
  <block id="15434ad90ad32205a804fe96f265b91d" category="paragraph">Este processo só alterou a localização dos ficheiros de dados normais. Os arquivos de dados temporários devem ser renomeados, mas não precisam ser copiados porque são apenas temporários. O banco de dados está inativo no momento, portanto não há dados ativos nos arquivos de dados temporários.</block>
  <block id="2a7c5560f8e4ad220c853666c46eb051" category="list-text">Para realocar os arquivos de dados temporários, primeiro identifique sua localização.</block>
  <block id="10b2632cf9c3bf6568b36f6a37e627c2" category="list-text">Reposicione arquivos de dados temporários usando um comando RMAN que define o novo nome para cada arquivo de dados. Com o Oracle Managed Files (OMF), o nome completo não é necessário; o grupo de discos ASM é suficiente. Quando o banco de dados é aberto, o OMF vincula ao local apropriado no grupo de discos ASM. Para realocar arquivos, execute os seguintes comandos:</block>
  <block id="2c592b1e2841899b280deafe27eeefbf" category="section-title">Refazer a migração de log</block>
  <block id="3f53598059c3bf11ff505ad9dc0d6776" category="paragraph">O processo de migração está quase concluído, mas os logs de refazer ainda estão localizados no grupo de discos ASM original. Os registos de refazer não podem ser transferidos diretamente. Em vez disso, um novo conjunto de logs de refazer é criado e adicionado à configuração, seguido de uma gota dos logs antigos.</block>
  <block id="dd786d22c88a5f1fe0c10cfec58c1b44" category="list-text">Identifique o número de grupos de registo de refazer e os respetivos números de grupo.</block>
  <block id="3cd0f7a32a4f5ee026702f8125f3dda7" category="list-text">Introduza o tamanho dos registos de refazer.</block>
  <block id="d54f1c98a924385411a8488657b21dad" category="list-text">Para cada log refazer, crie um novo grupo com uma configuração correspondente. Se você não estiver usando OMF, você deve especificar o caminho completo. Este também é um exemplo que usa os<block ref="c9655c773db3ebd5871fbe76c0e38a52" prefix=" " category="inline-code"></block> parâmetros. Como foi mostrado anteriormente, este parâmetro foi definido para -NEWLOGS. Esta configuração permite que você use os seguintes comandos para criar novos logs on-line sem a necessidade de especificar um local de arquivo ou mesmo um grupo de discos ASM específico.</block>
  <block id="3e0c7c8ee841e9919343fe45e3e04f2d" category="list-text">Abra o banco de dados.</block>
  <block id="7e4b38db083a404d0d628bdb1ad83311" category="list-text">Solte os logs antigos.</block>
  <block id="37e48dd687a01e58ed329feebebf3198" category="list-text">Se encontrar um erro que o impeça de largar um registo ativo, force um interrutor para o registo seguinte para libertar o bloqueio e force um ponto de verificação global. Um exemplo é mostrado abaixo. A tentativa de soltar o grupo de arquivos de log 3, que estava localizado no local antigo, foi negada porque ainda havia dados ativos neste arquivo de log. Um arquivo de log após um ponto de verificação permite que você exclua o arquivo de log.</block>
  <block id="79d08abfbe5fd73dc85c55cd20ad4974" category="list-text">Revise o ambiente para garantir que todos os parâmetros baseados em localização sejam atualizados.</block>
  <block id="799f5ce04f1d9cad4455676b2fd908d9" category="list-text">O script a seguir demonstra como simplificar esse processo:</block>
  <block id="9867dfc0eee2725f24f86d8114c356a0" category="list-text">Se os grupos de discos ASM foram completamente evacuados, eles agora podem ser desmontados com<block ref="ae709dc3414219bf2c9c8abc9ff6c67a" prefix=" " category="inline-code"></block>. No entanto, em muitos casos, os arquivos pertencentes a outros bancos de dados ou o arquivo ASM spfile/passwd ainda podem estar presentes.</block>
  <block id="49f8dc5754bd205ea0da17521cb89a1f" category="section-title">Oracle ASM para cópia do sistema de arquivos</block>
  <block id="0f5b1767a58e43cb548226e94441dc07" category="paragraph">O procedimento de cópia do Oracle ASM para sistema de arquivos é muito semelhante ao procedimento de cópia ASM para ASM, com benefícios e restrições semelhantes. A principal diferença é a sintaxe dos vários comandos e parâmetros de configuração ao usar um sistema de arquivos visível em vez de um grupo de discos ASM.</block>
  <block id="b533404c568b600f9fceddeac9253964" category="paragraph">O Oracle RMAN é usado para criar uma cópia de nível 0 (completa) do banco de dados de origem atualmente localizado no grupo de discos ASM<block ref="c097579d8cb34b312d396304e0b8f487" prefix=" " category="inline-code"></block> para o novo local no<block ref="f006bf17b06c884c47190c4225d3215a" prefix=" " category="inline-code"></block>.</block>
  <block id="f78b0ab71e2863c28dbe331056451135" category="paragraph">É necessário forçar o comutador de registo de arquivo para garantir que os registos de arquivo contêm todos os dados necessários para tornar a cópia totalmente consistente. Sem este comando, os dados de chave ainda podem estar presentes nos logs de refazer. Para forçar um switch de log de arquivo, execute o seguinte comando:</block>
  <block id="c37c761fc28428b9ead4533aba9ee148" category="paragraph">A interrupção começa nesta etapa porque o banco de dados é desligado e colocado em um modo somente leitura de acesso limitado. Para encerrar o banco de dados de origem, execute os seguintes comandos:</block>
  <block id="3abd8870d8a333edcaec6a1082520c67" category="paragraph">Faça backup de arquivos de controle no caso de você precisar abortar a migração e reverter para o local de armazenamento original. Uma cópia do ficheiro de controlo de cópia de segurança não é 100% necessária, mas facilita o processo de reposição das localizações dos ficheiros de base de dados para a localização original.</block>
  <block id="38825215f02e25ca63ff64387b01c1c2" category="paragraph">Quaisquer parâmetros referentes a grupos de discos ASM antigos devem ser atualizados e, em alguns casos, excluídos quando não forem mais relevantes. Atualize-os para refletir os novos caminhos do sistema de arquivos e salvar o arquivo pfile atualizado. Certifique-se de que o caminho de destino completo está listado. Para atualizar esses parâmetros, execute os seguintes comandos:</block>
  <block id="9d0dce3e570fa0ec18269ca508809401" category="section-title">Desative o arquivo init.ora original</block>
  <block id="03dda6526778417460fd0bbb7716b373" category="paragraph">Esse arquivo está localizado no<block ref="45c7302d9c2e8745b3a2bff0f992b6df" prefix=" " category="inline-code"></block> diretório e geralmente está em um arquivo pfile que serve como um ponteiro para o arquivo spfile no grupo de discos ASM. Para se certificar de que o arquivo spfile original não é mais usado, renomeie-o. Não o exclua, no entanto, porque esse arquivo é necessário se a migração tiver de ser abortada.</block>
  <block id="6087f741090627369fd114fbc794abc4" category="paragraph">Esta é a etapa final na realocação do arquivo spfile. O arquivo spfile original não é mais usado e o banco de dados está atualmente iniciado (mas não montado) usando o arquivo intermediário. O conteúdo deste arquivo pode ser escrito para o novo local spfile da seguinte forma:</block>
  <block id="3f62847435205b7b2af1bd5aaf1d3277" category="paragraph">Você deve iniciar o banco de dados para liberar os bloqueios no arquivo intermediário e iniciar o banco de dados usando apenas o novo arquivo spfile. Iniciar o banco de dados também prova que o novo local spfile está correto e seus dados são válidos.</block>
  <block id="ea164abfd83078cd71a2f3ba5d237900" category="paragraph">Um arquivo de controle de backup foi criado no caminho<block ref="7a1a1280501cff0194d8ce6e351f2a2c" prefix=" " category="inline-code"></block> anteriormente no procedimento. O novo spfile define os locais do controlfile como <block ref="b4d54c88ccade13a82dcaf8f7c07cac5" prefix="/" category="inline-code"></block> e<block ref="cd300fb0386526438b368e7a6d1b8ace" prefix=" " category="inline-code"></block>. No entanto, esses arquivos ainda não existem.</block>
  <block id="f7ed72e578ca8d23dd45bfa2c0a61ed8" category="list-text">Este comando restaura os dados do controlfile para os caminhos definidos no spfile.</block>
  <block id="c947c89cb4c7a595782d0be73bbe8cfa" category="list-text">Emita o comando mount para que os controlfiles sejam descobertos corretamente e contenham dados válidos.</block>
  <block id="da4ae71a31a1286600968f8a340fddb2" category="paragraph">Para validar o<block ref="d98137bd230dac4372cf20a2e7839463" prefix=" " category="inline-code"></block> parâmetro, execute o seguinte comando:</block>
  <block id="c25a81770c591c46d6909aae84bf5814" category="paragraph">O banco de dados está usando os arquivos de dados no local antigo. Antes que a cópia possa ser usada, os arquivos de dados devem ser sincronizados. O tempo passou durante o processo de cópia inicial, e as alterações foram registradas principalmente nos Registros de arquivamento. Essas alterações são replicadas nas duas etapas a seguir.</block>
  <block id="95ea23a5654037c0ab2a5418478d9da2" category="list-text">Repetir os registos.</block>
  <block id="e726fdb8508ef59abc6d8ef533186382" category="list-text">Para alterar os arquivos de dados ativos, execute o<block ref="7705ebb59373d0b1dfc71d86ef726f93" prefix=" " category="inline-code"></block> comando:</block>
  <block id="7fdba4cfea0e0d298cda23e7f46e40c4" category="list-text">Embora os arquivos de dados devam ser totalmente consistentes, uma etapa final é necessária para reproduzir as alterações restantes registradas nos logs de refazer on-line. Use o<block ref="81168dbef15af03d02c51a7447378e76" prefix=" " category="inline-code"></block> comando para reproduzir essas alterações e tornar a cópia 100% idêntica ao original. No entanto, a cópia ainda não está aberta.</block>
  <block id="8eb94d53286760da56ca9c892a49cd8b" category="section-title">Realocar arquivos de dados temporários</block>
  <block id="a1e7f15bee0eaa976661307aa884fd99" category="list-text">Identificar a localização dos ficheiros de dados temporários ainda em utilização no grupo de discos original.</block>
  <block id="89b79c94ceba42d5bc646c1b4b1acd24" category="list-text">Para realocar os arquivos de dados, execute os seguintes comandos. Se houver muitos tempfiles, use um editor de texto para criar o comando RMAN e, em seguida, corte e cole-o.</block>
  <block id="81aa65cb154a5f125bbf3ede064d4b3f" category="paragraph">O processo de migração está quase concluído, mas os logs de refazer ainda estão localizados no grupo de discos ASM original. Os registos de refazer não podem ser transferidos diretamente. Em vez disso, um novo conjunto de logs de refazer é criado e adicionado à configuração, seguindo-se uma gota dos logs antigos.</block>
  <block id="6e46687c6cc5deabe53fa42932683c4d" category="list-text">Para cada log de refazer, crie um novo grupo usando o mesmo tamanho que o grupo de log de refazer atual usando o novo local do sistema de arquivos.</block>
  <block id="22fd48a866ce4d04edb57c15b2fad5da" category="list-text">Remova os grupos de arquivos de log antigos que ainda estão localizados no armazenamento anterior.</block>
  <block id="94158400e59555bf69ecd550887bd9f6" category="list-text">Se for encontrado um erro que bloqueia a queda de um log ativo, force um switch para o próximo log para liberar o bloqueio e forçar um ponto de verificação global. Um exemplo é mostrado abaixo. A tentativa de soltar o grupo de arquivos de log 3, que estava localizado no local antigo, foi negada porque ainda havia dados ativos neste arquivo de log. Um arquivo de log seguido por um ponto de verificação permite a exclusão de arquivos de log.</block>
  <block id="326770a786c5933416b6a167c854e7b8" category="list-text">O script a seguir demonstra como tornar esse processo mais fácil.</block>
  <block id="ffdcdc8ee9653232a906773fa11358fd" category="list-text">Se os grupos de discos ASM foram completamente evacuados, eles agora podem ser desmontados com<block ref="ae709dc3414219bf2c9c8abc9ff6c67a" prefix=" " category="inline-code"></block>. Em muitos casos, os arquivos pertencentes a outros bancos de dados ou o arquivo ASM spfile/passwd ainda podem estar presentes.</block>
  <block id="3d8b8f4734039817e35d5fb6993c8d08" category="section-title">Procedimento de limpeza do ficheiro de dados</block>
  <block id="637607e2203ac522fc9dbc88deb6c36f" category="inline-link-macro">Limpeza de migração ASM</block>
  <block id="18325b8b206963bc1ae6cca25406f942" category="paragraph">O processo de migração pode resultar em arquivos de dados com sintaxe longa ou críptica, dependendo de como o Oracle RMAN foi usado. No exemplo mostrado aqui, o backup foi realizado com o formato de arquivo<block ref="1da91ad80bcfeb818066022a42cde773" prefix=" " category="inline-code"></block> do .<block ref="432459869b7d0085e120ec9454032267" prefix=" " category="inline-code"></block> Indica que o RMAN deve criar um nome exclusivo padrão para cada arquivo de dados. O resultado é semelhante ao que é mostrado no texto a seguir. Os nomes tradicionais para os arquivos de dados são incorporados nos nomes. Isso pode ser limpo usando a abordagem roteirizada mostrada em <block ref="bf0c2c579af181f7d1e4d0267c1385fe" category="inline-link-macro-rx"></block>.</block>
  <block id="5e8488a95f83d2789417a1f3298f2f31" category="section-title">Rebalancear o Oracle ASM</block>
  <block id="2768938325db3a71a6713959a0f309d9" category="paragraph">Como discutido anteriormente, um grupo de discos Oracle ASM pode ser migrado de forma transparente para um novo sistema de storage usando o processo de rebalanceamento. Em resumo, o processo de rebalanceamento requer a adição de LUNs de tamanho igual ao grupo de LUNs existente, seguido de uma operação de queda do LUN anterior. O Oracle ASM relocaliza automaticamente os dados subjacentes para o novo storage em um layout ideal e, em seguida, libera os LUNs antigos quando concluído.</block>
  <block id="24a638b29b3c55f26c731aa4b9943a52" category="paragraph">O processo de migração usa e/S sequenciais eficientes e geralmente não causa interrupções no desempenho, mas a taxa de migração pode ser controlada quando necessário.</block>
  <block id="25d06b03dd002ad791b19500c58e9f72" category="section-title">Identifique os dados a serem migrados</block>
  <block id="3709d4034873467e8e6ae138da54a443" category="section-title">Criar novos LUNs</block>
  <block id="32176bd565539329eafb96db9447e517" category="paragraph">Crie novos LUNs do mesmo tamanho e defina a associação de usuário e grupo conforme necessário. Os LUNs devem aparecer como<block ref="bea4821516973214973a70aea8337c38" prefix=" " category="inline-code"></block> discos.</block>
  <block id="6e59535a7b8dd239c67b8d015618f5e1" category="section-title">Adicione novos LUNS</block>
  <block id="71f7e1ff1a6e075f8364d083f145b655" category="paragraph">Embora as operações de adição e exclusão possam ser executadas em conjunto, geralmente é mais fácil adicionar novos LUNs em duas etapas. Primeiro, adicione os novos LUNs ao grupo de discos. Essa etapa faz com que metade das extensões sejam migradas dos LUNs ASM atuais para os novos LUNs.</block>
  <block id="7989dfdf722e8bee00001dac817e4833" category="paragraph">A energia de reequilíbrio indica a taxa à qual os dados estão sendo transferidos. Quanto maior o número, maior o paralelismo da transferência de dados. A migração é realizada com operações de e/S sequenciais eficientes que provavelmente causarão problemas de performance. No entanto, se desejado, o poder de reequilíbrio de uma migração contínua pode ser ajustado com o<block ref="e20ea7dfbbe351f6a5275d7adc71efbd" prefix=" " category="inline-code"></block> comando. Migrações típicas usam um valor de 5.</block>
  <block id="2b69f08c262a142b3fb0868f4d31ab4f" category="section-title">Monitorização da operação</block>
  <block id="a5097a0967c777285f74d63bf0cc26a1" category="paragraph">Uma operação de rebalanceamento pode ser monitorada e gerenciada de várias maneiras. Usamos o seguinte comando para este exemplo.</block>
  <block id="5d68829c11bdb5ae7a50b847bb126d44" category="paragraph">Quando a migração estiver concluída, nenhuma operação de rebalanceamento será relatada.</block>
  <block id="957310262614cddc1992368d2d0b14b3" category="section-title">Soltar LUNs antigos</block>
  <block id="260c16583c8eb689202ed5b4a44708b1" category="paragraph">A migração está agora a meio caminho. Pode ser desejável realizar alguns testes básicos de desempenho para garantir que o ambiente esteja saudável. Após a confirmação, os dados restantes podem ser relocados deixando cair os LUNs antigos. Observe que isso não resulta no lançamento imediato dos LUNs. A operação de queda sinaliza ao Oracle ASM para realocar as extensões primeiro e, em seguida, liberar o LUN.</block>
  <block id="90423249814011b02ba06afd9fb2d617" category="paragraph">A operação de rebalanceamento pode ser monitorada e gerenciada de várias maneiras. Usamos o seguinte comando para este exemplo:</block>
  <block id="1544b3a52519b3856f1f7d1e704cb56f" category="section-title">Remova LUNs antigos</block>
  <block id="983d704730b30910fc03d3ed444278f0" category="paragraph">Antes de remover os LUNs antigos do grupo de discos, deve efetuar uma verificação final sobre o estado do cabeçalho. Depois que um LUN é liberado do ASM, ele não tem mais um nome listado e o status do cabeçalho é listado como<block ref="e2ffc99cf675f5f0f1a3456438551a9a" prefix=" " category="inline-code"></block>. Isso indica que esses LUNs podem ser removidos com segurança do sistema.</block>
  <block id="22a67c375eff91d37f2363ea69b0c41f" category="section-title">Migração para LVM</block>
  <block id="d52f83c78118c243801797ba9b795b72" category="paragraph">O procedimento apresentado aqui mostra os princípios de uma migração baseada em LVM de um grupo de volumes<block ref="ec2db4422261eae02091227fb9e53c88" prefix=" " category="inline-code"></block> chamado . Os exemplos são extraídos do LVM Linux, mas os princípios se aplicam igualmente a AIX, HP-UX e VxVM. Os comandos precisos podem variar.</block>
  <block id="64a375907ede7a86c9e8a1b4b142f22e" category="list-text">Identificar os LUNs atualmente no<block ref="ec2db4422261eae02091227fb9e53c88" prefix=" " category="inline-code"></block> grupo de volumes.</block>
  <block id="0ae75856dd12545cdd98b8cad5c12ad8" category="list-text">Crie novos LUNs do mesmo tamanho físico ou ligeiramente maior e defina-os como volumes físicos.</block>
  <block id="2426fa707e9d362c711977b79acd65bb" category="list-text">Adicione os novos volumes ao grupo de volumes.</block>
  <block id="02443ebd7f86c3a688a1e3466d3f106a" category="list-text">Emita o<block ref="8167c9a6bd495f7ed235364201039099" prefix=" " category="inline-code"></block> comando para realocar as extensões de cada LUN atual para o novo LUN. O<block ref="1b464374742cfda0167b82bc6f9462f1" prefix=" " category="inline-code"></block> argumento monitora o progresso da operação.</block>
  <block id="ce4a174d56245f6ba5b8808527919921" category="list-text">Quando esse processo estiver concluído, solte os LUNs antigos do grupo de volumes usando o<block ref="3a4d1e7b0af1cf3d80e419c09d238535" prefix=" " category="inline-code"></block> comando. Se for bem-sucedido, o LUN pode agora ser removido de forma segura do sistema.</block>
  <block id="875bb561ba851d301052704e0ffb70f4" category="summary">Migração Oracle via envio de log</block>
  <block id="48e2495d3eeb1b57ea7d073e06620063" category="doc">Migração de banco de dados Oracle via envio de log</block>
  <block id="8e42b5809657e127c7e2d24f30bc493e" category="paragraph">O objetivo de uma migração usando o envio de log é criar uma cópia dos arquivos de dados originais em um novo local e, em seguida, estabelecer um método de envio de alterações no novo ambiente.</block>
  <block id="599df5f564506c95624dd78b0b75eeac" category="paragraph">Uma vez estabelecido, o envio de log e a repetição podem ser automatizados para manter o banco de dados de réplica em grande parte em sincronia com a fonte. Por exemplo, um trabalho cron pode ser programado para (a) copiar os logs mais recentes para o novo local e (b) reproduzi-los a cada 15 minutos. Isso proporciona uma interrupção mínima no momento da transição, porque não mais de 15 minutos de logs de arquivo devem ser reproduzidos.</block>
  <block id="41bec1b4ddc17b3367c68a025c0ddfb9" category="paragraph">O procedimento mostrado abaixo também é essencialmente uma operação clone do banco de dados. A lógica mostrada é semelhante ao mecanismo no NetApp SnapManager para Oracle (SMO) e no plug-in NetApp SnapCenter Oracle. Alguns clientes usaram o procedimento mostrado em scripts ou fluxos de trabalho WFA para operações de clonagem personalizadas. Embora esse procedimento seja mais manual do que o uso de SMO ou SnapCenter, ele ainda é facilmente programado e as APIs de gerenciamento de dados no ONTAP simplificam ainda mais o processo.</block>
  <block id="f0616883a5ca70aa97676de436a7fb9e" category="section-title">Envio de log - sistema de arquivos para sistema de arquivos</block>
  <block id="8f922b64f0bc64f6bba1d555a61ee3bb" category="paragraph">Este exemplo demonstra a migração de um banco de dados chamado WAFFLE de um sistema de arquivos comum para outro sistema de arquivos comum localizado em um servidor diferente. Ele também ilustra o uso do SnapMirror para fazer uma cópia rápida dos arquivos de dados, mas isso não é parte integrante do procedimento geral.</block>
  <block id="60100e1b826a4b972fc113c391f932e7" category="section-title">Criar cópia de segurança da base de dados</block>
  <block id="80cf34e10dcfbc5e76c6b2f845f2708d" category="paragraph">O primeiro passo é criar um backup de banco de dados. Especificamente, este procedimento requer um conjunto de arquivos de dados que podem ser usados para a repetição do log de arquivamento.</block>
  <block id="f9b673452d1da030fef3f976bbbbb103" category="paragraph">Neste exemplo, o banco de dados de origem está em um sistema ONTAP. O método mais simples para criar um backup de um banco de dados é usando um snapshot. O banco de dados é colocado no modo hot backup por alguns segundos enquanto uma<block ref="252ce13e6c150af4d3e7eea5fca266bc" prefix=" " category="inline-code"></block> operação é executada no volume que hospeda os arquivos de dados.</block>
  <block id="630a571b99791968d41f9caba4a3e39c" category="paragraph">O resultado é um instantâneo no disco chamado<block ref="a8b3bc9f12cd194b80d404c30e9015ee" prefix=" " category="inline-code"></block> que contém uma imagem dos arquivos de dados enquanto no modo de backup automático. Quando combinados com os logs de arquivo apropriados para tornar os arquivos de dados consistentes, os dados nesse snapshot podem ser usados como base de uma restauração ou um clone. Neste caso, ele é replicado para o novo servidor.</block>
  <block id="744a73803cdac4a5067725ca5814a2cf" category="section-title">Restauração de um novo ambiente</block>
  <block id="46228bb2ce31b0d397faad2b805e8a37" category="paragraph">Agora, o backup precisa ser restaurado no novo ambiente. Isso pode ser feito de várias maneiras, incluindo Oracle RMAN, restauração de um aplicativo de backup como NetBackup, ou uma operação de cópia simples de arquivos de dados que foram colocados no modo de backup ativo.</block>
  <block id="96a1129a5a4b32943286cafd5e0ca2e1" category="paragraph">Neste exemplo, o SnapMirror é usado para replicar o hotbackup instantâneo para um novo local.</block>
  <block id="1f255556546f1fdfb53692e41f35eb6c" category="list-text">Crie um novo volume para receber os dados instantâneos. Inicialize o espelhamento de<block ref="937e9fa808ccfe9a4f6b004a2a7caada" prefix=" " category="inline-code"></block> para<block ref="96f9dacb3cb1b1f6f9b4ad02992a1a0e" prefix=" " category="inline-code"></block>.</block>
  <block id="5b1944ec8c0ed933e5b2ea2e3e5fa76e" category="list-text">Depois que o estado é definido pelo SnapMirror, indicando que a sincronização está concluída, atualize o espelho com base especificamente no instantâneo desejado.</block>
  <block id="f4d90c6c29b1f76ab9c87a9996c9751e" category="list-text">A sincronização bem-sucedida pode ser verificada visualizando o<block ref="31952c255e722053d4cc3f82921e95db" prefix=" " category="inline-code"></block> campo no volume do espelho.</block>
  <block id="0934c3fcad3065c2a479125e4a80b259" category="list-text">O espelho pode então ser quebrado.</block>
  <block id="fcf1f505b94151a36eba8e1563e7176f" category="list-text">Monte o novo sistema de arquivos. Com sistemas de arquivos baseados em blocos, os procedimentos precisos variam de acordo com a LVM em uso. O zoneamento FC ou as conexões iSCSI devem ser configuradas. Depois que a conetividade com os LUNs for estabelecida, comandos como o Linux<block ref="302c49bbd5bcda5463eb5130804effc1" prefix=" " category="inline-code"></block> podem ser necessários para descobrir quais grupos de volume ou LUNs precisam ser configurados corretamente para serem descobertos pelo ASM.</block>
  <block id="20c4d1d4163c2463cf15ff7df6424459" category="paragraph">Neste exemplo, um sistema de arquivos NFS simples é usado. Este sistema de arquivos pode ser montado diretamente.</block>
  <block id="b2dd88a1f03a5fb4c2e3c0d46f425161" category="section-title">Criar modelo de criação de controlfile</block>
  <block id="1c30e11140f1d0a1093bedee34eef1e4" category="paragraph">Em seguida, você deve criar um modelo de controlfile. O<block ref="3177841b2335a6640ea3054199830f1c" prefix=" " category="inline-code"></block> comando cria comandos de texto para recriar um controlfile. Esta função pode ser útil para restaurar um banco de dados de backup em algumas circunstâncias, e é frequentemente usada com scripts que executam tarefas como clonagem de banco de dados.</block>
  <block id="3f51d58ec72b9d36cb5e0636525130b5" category="list-text">A saída do comando a seguir é usada para recriar os controlfiles para o banco de dados migrado.</block>
  <block id="cb395c3bf18fd427287caecc9b28058a" category="list-text">Depois que os arquivos de controle tiverem sido criados, copie o arquivo para o novo servidor.</block>
  <block id="cf5c9046a3617a19c0ccc24e4cf54a33" category="section-title">Ficheiro de parâmetros de cópia de segurança</block>
  <block id="0d1d1a7db58f3f93ec977733f4909f5d" category="paragraph">Um arquivo de parâmetro também é necessário no novo ambiente. O método mais simples é criar um pfile a partir do spfile ou pfile atual. Neste exemplo, o banco de dados de origem está usando um spfile.</block>
  <block id="051a634cb1e9a53dbf139214e1d24001" category="section-title">Crie uma entrada oratab</block>
  <block id="2dabc26c8b55d44e25a184ba2624eed0" category="paragraph">A criação de uma entrada oratab é necessária para o bom funcionamento de utilitários como oraenv. Para criar uma entrada oratab, execute a seguinte etapa.</block>
  <block id="87ef75141d237e3b44e8310aad8fcf19" category="section-title">Prepare a estrutura do diretório</block>
  <block id="12f833c44c11e6bbd970cc126bce2bcb" category="paragraph">Se os diretórios necessários ainda não estavam presentes, você deve criá-los ou o procedimento de inicialização do banco de dados falhar. Para preparar a estrutura de diretórios, preencha os seguintes requisitos mínimos.</block>
  <block id="60225c364a012796a6d886e8cf4ec486" category="section-title">Atualizações do arquivo de parâmetros</block>
  <block id="e36ee2d9a95a6b672917862d714af383" category="list-text">Para copiar o arquivo de parâmetro para o novo servidor, execute os seguintes comandos. O local padrão é o<block ref="45c7302d9c2e8745b3a2bff0f992b6df" prefix=" " category="inline-code"></block> diretório. Neste caso, o pfile pode ser colocado em qualquer lugar. Ele só está sendo usado como um passo intermediário no processo de migração.</block>
  <block id="d437a40a59905247cfb39cf9dc9da256" category="list-text">Edite o arquivo conforme necessário. Por exemplo, se a localização do log do arquivo foi alterada, o arquivo pfile deve ser alterado para refletir o novo local. Neste exemplo, apenas os controlfiles estão sendo relocados, em parte para distribuí-los entre os sistemas de arquivos de log e dados.</block>
  <block id="55cc35656c3d28c1b3267c246b397521" category="list-text">Depois que as edições estiverem concluídas, crie um spfile baseado nesse pfile.</block>
  <block id="a833a03e6af0b969524dcccb8f296f1c" category="section-title">Recrie controlfiles</block>
  <block id="74a636ee3a009f08cd5623dc8066dd09" category="paragraph">Em uma etapa anterior, a saída do<block ref="3177841b2335a6640ea3054199830f1c" prefix=" " category="inline-code"></block> foi copiada para o novo servidor. A parte específica da saída necessária é o<block ref="0ca1fba455d799b9a1cc2440b9ba7043" prefix=" " category="inline-code"></block> comando. Esta informação pode ser encontrada no ficheiro na secção marcada<block ref="9fb76d62be749cec8bdd06f46c77bf5b" prefix=" " category="inline-code"></block>. Começa com a linha<block ref="13ac20c4a96b2ecfd703e831ad722907" prefix=" " category="inline-code"></block> e deve incluir a palavra<block ref="c3c62948f78a7ccaabb9ef2eea80a895" prefix=" " category="inline-code"></block>. Termina com o caractere ponto e vírgula (; ).</block>
  <block id="bf4b2a006646a8e77166a2a596425074" category="list-text">Neste procedimento de exemplo, o arquivo lê o seguinte.</block>
  <block id="a9a27c002ec883341220e267712250a7" category="list-text">Edite este script como desejado para refletir a nova localização dos vários arquivos. Por exemplo, certos arquivos de dados conhecidos por oferecer suporte a e/S alta podem ser redirecionados para um sistema de arquivos em uma camada de storage de alto desempenho. Em outros casos, as alterações podem ser puramente por razões de administrador, como isolar os arquivos de dados de um determinado PDB em volumes dedicados.</block>
  <block id="2540fb1670d4f9ee8a704a7eb8d748fe" category="list-text">Neste exemplo, a<block ref="b86df74c6982de8dec7509d039294d7a" prefix=" " category="inline-code"></block> estrofe permanece inalterada, mas os logs de refazer são movidos para um novo local em<block ref="96bb85ed0fe822778c4e5a821e991ad8" prefix=" " category="inline-code"></block> vez de compartilhar espaço com logs de arquivo no<block ref="0e62afc91abe157ef67895cca0a7f912" prefix=" " category="inline-code"></block>.</block>
  <block id="8d47ad079859f2976fdc7ebf742f768d" category="paragraph">Se algum arquivo estiver perdido ou os parâmetros estiverem mal configurados, são gerados erros que indicam o que deve ser corrigido. O banco de dados está montado, mas ainda não está aberto e não pode ser aberto porque os arquivos de dados em uso ainda estão marcados como estando no modo hot backup. Os logs de arquivamento devem primeiro ser aplicados para tornar o banco de dados consistente.</block>
  <block id="6b7c2d588ac708b58f7ac889090608f6" category="section-title">Replicação inicial do log</block>
  <block id="2db2d3d6001a06d1a027904fa66bc78c" category="paragraph">Pelo menos uma operação de resposta de log é necessária para tornar os arquivos de dados consistentes. Muitas opções estão disponíveis para reproduzir logs. Em alguns casos, o local do log do arquivo original no servidor original pode ser compartilhado por NFS e a resposta do log pode ser feita diretamente. Em outros casos, os logs do arquivo devem ser copiados.</block>
  <block id="5c394e6951584d114c6706d0768e30d7" category="paragraph">Por exemplo, uma operação simples<block ref="8a444a43bdf534c0c6338bb7809659b3" prefix=" " category="inline-code"></block> pode copiar todos os logs atuais do servidor de origem para o servidor de migração:</block>
  <block id="5fdb3158ed28dd3aa90b94556476b781" category="section-title">Reprodução inicial do registo</block>
  <block id="c2f93ef52583f81f0eba05a39483e2d8" category="paragraph">Depois que os arquivos estão no local do log de arquivamento, eles podem ser reproduzidos emitindo o comando<block ref="5fea768eb2d353716ca623ae58ce382c" prefix=" " category="inline-code"></block> seguido da resposta<block ref="e1f2d5134ed2543d38a0de9751cf75d9" prefix=" " category="inline-code"></block> para reproduzir automaticamente todos os logs disponíveis.</block>
  <block id="f30a45a22256018185c5d235292e4d5e" category="paragraph">A resposta final do log do arquivo relata um erro, mas isso é normal. O log indica que<block ref="a84f4f3da79386c29ab6dfa560af786e" prefix=" " category="inline-code"></block> estava procurando um arquivo de log específico e não o encontrou. A razão é, muito provavelmente, que o arquivo log ainda não existe.</block>
  <block id="80bea8a60412cace54760b223b2d799e" category="paragraph">Se o banco de dados de origem puder ser desligado antes de copiar logs de arquivo, esta etapa deve ser executada apenas uma vez. Os logs de arquivo são copiados e reproduzidos e, em seguida, o processo pode continuar diretamente para o processo de transição que replica os logs críticos de refazer.</block>
  <block id="1e334141582a9dcb581c9b34ef2df071" category="section-title">Replicação e repetição de registos incrementais</block>
  <block id="5fd2b0bf662c2b1ebdc677ea888536ce" category="paragraph">Na maioria dos casos, a migração não é realizada imediatamente. Pode ser dias ou mesmo semanas antes que o processo de migração seja concluído, o que significa que os logs devem ser enviados continuamente para o banco de dados de réplica e reproduzidos. Portanto, quando a transição chega, os dados mínimos devem ser transferidos e reproduzidos.</block>
  <block id="0c56d82ec6857bcef5475899b9f7b5cc" category="paragraph">Fazer isso pode ser script de várias maneiras, mas um dos métodos mais populares é usar rsync, um utilitário comum de replicação de arquivos. A maneira mais segura de usar este utilitário é configurá-lo como um daemon. Por exemplo, o<block ref="b31375af035ed8a698a803a491084f61" prefix=" " category="inline-code"></block> arquivo a seguir mostra como criar um recurso<block ref="260e23541ff372b9bc53b4bd3c0c38ba" prefix=" " category="inline-code"></block> chamado que é acessado com credenciais de usuário Oracle e é mapeado para<block ref="488a4921a81e36fca411e6f13cefbbf2" prefix=" " category="inline-code"></block>o . Mais importante ainda, o recurso é definido como somente leitura, o que permite que os dados de produção sejam lidos, mas não alterados.</block>
  <block id="eabf1b424989b2c7113ba3a538079afa" category="paragraph">O comando a seguir sincroniza o destino do log de arquivamento do novo servidor com o recurso rsync<block ref="260e23541ff372b9bc53b4bd3c0c38ba" prefix=" " category="inline-code"></block> no servidor original. O<block ref="e358efa489f58062f10dd7316b65649e" prefix=" " category="inline-code"></block> argumento em<block ref="293e33723231f0504effabb52b054a31" prefix=" " category="inline-code"></block> faz com que a lista de arquivos seja comparada com base no timestamp, e apenas novos arquivos são copiados. Este processo fornece uma atualização incremental do novo servidor. Esse comando também pode ser programado no cron para ser executado regularmente.</block>
  <block id="c775c44069da13c8f7ee5c5116e76e36" category="inline-link-macro">Reproduzir Registos na base de dados</block>
  <block id="c3bf9b2ef3e3ae2ae6a02f7f77cfcbc6" category="paragraph">Depois que os logs tiverem sido recebidos, eles devem ser reproduzidos novamente. Exemplos anteriores mostram o uso do sqlplus para executar manualmente<block ref="5fea768eb2d353716ca623ae58ce382c" prefix=" " category="inline-code"></block> , um processo que pode ser facilmente automatizado. O exemplo mostrado aqui usa o script descrito em <block ref="3e57a2099043fa40c58f1e0d4eed995d" category="inline-link-macro-rx"></block>. Os scripts aceitam um argumento que especifica o banco de dados que requer uma operação de repetição. Isso permite que o mesmo script seja usado em um esforço de migração multibanco de dados.</block>
  <block id="4ea2a6c39b10b3e3076f976f58a861d1" category="section-title">Redução</block>
  <block id="5de3f1ba0bbef459baa93f04f63b9ea1" category="paragraph">Quando você estiver pronto para cortar para o novo ambiente, você deve executar uma sincronização final que inclua Registros de arquivamento e os logs de refazer. Se a localização original do registo de refazer ainda não for conhecida, pode ser identificada da seguinte forma:</block>
  <block id="677f005cc0f8be0f891df5af72fb5688" category="list-text">Encerre o banco de dados de origem.</block>
  <block id="41b182875e12de118d17b3432cca93fa" category="list-text">Execute uma sincronização final dos logs de arquivo no novo servidor com o método desejado.</block>
  <block id="37d6d9420cef8230249e7691315f0e13" category="list-text">Os logs de refazer de origem devem ser copiados para o novo servidor. Neste exemplo, os logs de refazer foram relocados para um novo diretório em<block ref="96bb85ed0fe822778c4e5a821e991ad8" prefix=" " category="inline-code"></block>.</block>
  <block id="d0a5f1380bd67b0d0fd3bc72f22d88f2" category="list-text">Neste estágio, o novo ambiente de banco de dados contém todos os arquivos necessários para trazê-lo para o mesmo estado exato da origem. Os registos de arquivo têm de ser reproduzidos uma última vez.</block>
  <block id="c2721157205b2d2e96c656c45ca72992" category="list-text">Uma vez concluído, os logs de refazer devem ser reproduzidos novamente. Se a mensagem<block ref="975df7a5099101ffbe47981cd1d37c2c" prefix=" " category="inline-code"></block> for retornada, o processo será bem-sucedido e os bancos de dados serão sincronizados e poderão ser abertos.</block>
  <block id="6acab27c5f334c66f06f3f74bc62d6d8" category="section-title">Registo de envio - ASM para o sistema de ficheiros</block>
  <block id="a67ffcc8b155bb909a6f8c5d5ba2f334" category="paragraph">Este exemplo demonstra o uso do Oracle RMAN para migrar um banco de dados. É muito semelhante ao exemplo anterior de sistema de arquivos para o envio de log do sistema de arquivos, mas os arquivos no ASM não são visíveis para o host. As únicas opções de migração de dados localizados em dispositivos ASM são a realocação do ASM LUN ou o Oracle RMAN para executar as operações de cópia.</block>
  <block id="1c51600a778919f7f3abb5b25175220a" category="paragraph">Embora o RMAN seja um requisito para copiar arquivos do Oracle ASM, o uso do RMAN não se limita ao ASM. O RMAN pode ser usado para migrar de qualquer tipo de armazenamento para qualquer outro tipo.</block>
  <block id="2cb6a5bfc4a76f651d496cddc685e078" category="paragraph">Este exemplo mostra a realocação de um banco de dados chamado PANCAKE do armazenamento ASM para um sistema de arquivos regular localizado em um servidor diferente em caminhos<block ref="f006bf17b06c884c47190c4225d3215a" prefix=" " category="inline-code"></block> e<block ref="0e62afc91abe157ef67895cca0a7f912" prefix=" " category="inline-code"></block>.</block>
  <block id="d1d789c37f1c96d0a5de07798c14fcc5" category="paragraph">O primeiro passo é criar um backup do banco de dados para ser migrado para um servidor alternativo. Como a fonte usa o Oracle ASM, o RMAN deve ser usado. Um simples backup RMAN pode ser executado da seguinte forma. Este método cria um backup marcado que pode ser facilmente identificado pelo RMAN mais tarde no procedimento.</block>
  <block id="ed927706d8abc2bbf3a5a8bc55e1e562" category="paragraph">O primeiro comando define o tipo de destino para o backup e o local a ser usado. O segundo inicia o backup dos arquivos de dados somente.</block>
  <block id="db85d05166dd65559ae5f426b51198e6" category="section-title">Ficheiro de controlo de cópia de segurança</block>
  <block id="a0b95d36955723a82dde7bbe40b6ccb9" category="paragraph">Um ficheiro de controlo de cópia de segurança é necessário mais tarde no procedimento para a<block ref="08de2bfcc2d52d5bc4f3f2dcb97558ad" prefix=" " category="inline-code"></block> operação.</block>
  <block id="76ff543de72e62217293a1d0ceade0aa" category="paragraph">Um arquivo de parâmetro também é necessário no novo ambiente. O método mais simples é criar um pfile a partir do spfile ou pfile atual. Neste exemplo, o banco de dados de origem usa um spfile.</block>
  <block id="d28f3a5b77909b45c50e6c711bef8b60" category="section-title">Script de renomeação do arquivo ASM</block>
  <block id="c242730c760d895368557f78141ff8b1" category="paragraph">Vários locais de arquivo atualmente definidos nos controlfiles mudam quando o banco de dados é movido. O script a seguir cria um script RMAN para facilitar o processo. Este exemplo mostra um banco de dados com um número muito pequeno de arquivos de dados, mas normalmente os bancos de dados contêm centenas ou até mesmo milhares de arquivos de dados.</block>
  <block id="359b84bcf7447a77b212e844aeaa9d89" category="inline-link-macro">ASM para conversão de nome de sistema de arquivos</block>
  <block id="374a1a0facd7c604ac09ed0dca6efb3e" category="paragraph">Este script pode ser encontrado em <block ref="288325982fd7bee6cf9eb66ad33f6f7a" category="inline-link-macro-rx"></block> e faz duas coisas.</block>
  <block id="42787fdca1cf792241ce03151ec7dbd3" category="paragraph">Primeiro, ele cria um parâmetro para redefinir os locais de log refazer chamados<block ref="0f2d7ef9b967c2d9fb1ad5aa5e9eb688" prefix=" " category="inline-code"></block>. É essencialmente uma lista de campos alternados. O primeiro campo é a localização de um log de refazer atual e o segundo campo é a localização no novo servidor. O padrão é então repetido.</block>
  <block id="cf444fd96c87609516f0ad8212f41b01" category="paragraph">A segunda função é fornecer um modelo para renomeação de arquivos de dados. O script percorre os arquivos de dados, puxa as informações de nome e número do arquivo e formata-as como um script RMAN. Em seguida, ele faz o mesmo com os arquivos temporários. O resultado é um script rman simples que pode ser editado como desejado para garantir que os arquivos sejam restaurados para o local desejado.</block>
  <block id="50614366822786a4f2ee3a5065543634" category="paragraph">Capture a saída desta tela. O<block ref="0f2d7ef9b967c2d9fb1ad5aa5e9eb688" prefix=" " category="inline-code"></block> parâmetro é colocado no arquivo pfile como descrito abaixo. O nome do arquivo de dados RMAN e o script duplicado devem ser editados de acordo para colocar os arquivos de dados nos locais desejados. Neste exemplo, todos eles são colocados<block ref="36c3572e381980ee1f1343988ae4a955" prefix=" " category="inline-code"></block> em .</block>
  <block id="e60cd818b9f7ae02a73d8b3a6ea0a809" category="paragraph">Os scripts estão quase prontos para serem executados, mas primeiro a estrutura de diretórios deve estar no lugar. Se os diretórios necessários ainda não estiverem presentes, eles devem ser criados ou o procedimento de inicialização do banco de dados falha. O exemplo abaixo reflete os requisitos mínimos.</block>
  <block id="2f2eed2ed14ba876a017aa9ea9515724" category="paragraph">O comando a seguir é necessário para que utilitários como oraenv funcionem corretamente.</block>
  <block id="fd5c3a935e7374f8b1577e73e85ef375" category="paragraph">O arquivo pfile salvo deve ser atualizado para refletir quaisquer alterações de caminho no novo servidor. As alterações no caminho do arquivo de dados são alteradas pelo script de duplicação RMAN, e quase todos os bancos de dados exigem alterações nos<block ref="d98137bd230dac4372cf20a2e7839463" prefix=" " category="inline-code"></block> parâmetros e.<block ref="2d205df7ae2efff1576140524b40b93c" prefix=" " category="inline-code"></block> Também pode haver locais de arquivo de auditoria que devem ser alterados e parâmetros como<block ref="40f8833ae28ec69bcc89eb0eba090fe4" prefix=" " category="inline-code"></block> podem não ser relevantes fora do ASM. Um DBA experiente deve analisar cuidadosamente as alterações propostas antes de prosseguir.</block>
  <block id="b581dd429e9b4c24127b8940ca8e4346" category="paragraph">Neste exemplo, as alterações de chave são as localizações do arquivo de controle, o destino do arquivo de log e a adição do<block ref="0f2d7ef9b967c2d9fb1ad5aa5e9eb688" prefix=" " category="inline-code"></block> parâmetro.</block>
  <block id="bbba1f65801697ba3abd94d90c83ba71" category="paragraph">Depois que os novos parâmetros são confirmados, os parâmetros devem ser colocados em vigor. Existem várias opções, mas a maioria dos clientes cria um spfile baseado no pfile de texto.</block>
  <block id="3a17a12678d74dabb1032aaf373166d8" category="section-title">Nomunt de arranque</block>
  <block id="a9dc570a0b3161e69edc31f3545cbf22" category="paragraph">A etapa final antes de replicar o banco de dados é abrir os processos do banco de dados, mas não montar os arquivos. Nesta etapa, os problemas com o spfile podem se tornar evidentes. Se o<block ref="357eedab214bb515c5622e275bc19cdb" prefix=" " category="inline-code"></block> comando falhar por causa de um erro de parâmetro, é simples desligar, corrigir o modelo pfile, recarregá-lo como um spfile e tentar novamente.</block>
  <block id="0257eff4bf9bf0cb483f2544fd42f109" category="section-title">Duplique o banco de dados</block>
  <block id="4632b675c558eda129fe6da4fbbae2b2" category="paragraph">Restaurar o backup RMAN anterior para o novo local consome mais tempo do que outras etapas deste processo. O banco de dados deve ser duplicado sem uma alteração no ID do banco de dados (DBID) ou redefinir os logs. Isso impede que os logs sejam aplicados, que é uma etapa necessária para sincronizar totalmente as cópias.</block>
  <block id="06206ea0cdea741420d9f7619503db89" category="paragraph">Conete-se ao banco de dados com RMAN como aux e emita o comando duplicar banco de dados usando o script criado em uma etapa anterior.</block>
  <block id="5ae45dfed3c4aff7fe4fd6a7e3606cb0" category="paragraph">Agora você deve enviar as alterações do banco de dados de origem para um novo local. Fazer isso pode exigir uma combinação de etapas. O método mais simples seria fazer com que o RMAN no banco de dados de origem escrevesse logs de arquivo em uma conexão de rede compartilhada. Se um local compartilhado não estiver disponível, um método alternativo é usar o RMAN para gravar em um sistema de arquivos local e, em seguida, usar RCP ou rsync para copiar os arquivos.</block>
  <block id="e355807335e5f05930a748afe1c3b23d" category="paragraph">Neste exemplo, o<block ref="45987b06d5eae35fc3e3487749a9ba27" prefix=" " category="inline-code"></block> diretório é um compartilhamento NFS disponível para o banco de dados original e migrado.</block>
  <block id="49fffa356bcd041918ce24ef714f3f72" category="paragraph">Uma questão importante aqui é a<block ref="6761e3b36547cd115b3966fcbc7192b2" prefix=" " category="inline-code"></block> cláusula. O formato de disco do backup é<block ref="9ae0f22d9fa2eac270499e74092af364" prefix=" " category="inline-code"></block>, o que significa que você deve usar o formato de número de thread, número de sequência e ID de ativação para o banco de dados. Embora as letras sejam diferentes, isso corresponde ao<block ref="03e92f2c3a8cae5315f0e42bf6acf436" prefix=" " category="inline-code"></block> parâmetro no pfile. Este parâmetro também especifica Registros de arquivo no formato de número de thread, número de sequência e ID de ativação. O resultado final é que os backups dos arquivos de log na fonte usam uma convenção de nomenclatura esperada pelo banco de dados. Isso torna operações como<block ref="81168dbef15af03d02c51a7447378e76" prefix=" " category="inline-code"></block> muito mais simples porque sqlplus antecipa corretamente os nomes dos logs do arquivo a serem reproduzidos.</block>
  <block id="76d77393c7ffc6b0a0edd47ad09afe4d" category="paragraph">Depois que os arquivos estão no local do log de arquivamento, eles podem ser reproduzidos emitindo o comando<block ref="5fea768eb2d353716ca623ae58ce382c" prefix=" " category="inline-code"></block> seguido da resposta<block ref="e1f2d5134ed2543d38a0de9751cf75d9" prefix=" " category="inline-code"></block> para reproduzir automaticamente todos os logs disponíveis. O arquivo de parâmetros está direcionando Registros de arquivo para<block ref="e421a42fc6f604fcc78707336ed222b9" prefix=" " category="inline-code"></block>, mas isso não corresponde ao local onde o RMAN foi usado para salvar logs. O local pode ser temporariamente redirecionado da seguinte forma antes de recuperar o banco de dados.</block>
  <block id="0a96a4559ad3ab8c616a12a207e8daca" category="paragraph">A resposta final do log do arquivo relata um erro, mas isso é normal. O erro indica que sqlplus estava procurando um arquivo de log específico e não o encontrou. A razão é mais provável que o arquivo log ainda não existe.</block>
  <block id="e2a234d3299b9e66f0756db00c9ee8c7" category="paragraph">Na maioria dos casos, a migração não é realizada imediatamente. Pode ser dias ou mesmo semanas antes que o processo de migração seja concluído, o que significa que os logs devem ser continuamente enviados para o banco de dados de réplica e reproduzidos. Isso garante que os dados mínimos devem ser transferidos e reproduzidos quando a transição chegar.</block>
  <block id="247e1695519da78866726a4dcb2c5252" category="paragraph">Este processo pode ser facilmente programado. Por exemplo, o comando a seguir pode ser agendado no banco de dados original para garantir que o local usado para o envio de logs seja atualizado continuamente.</block>
  <block id="3ce19ecb7c874f75b9a46e29abe2012e" category="inline-link-macro">Reproduzir Registos na base de dados em espera</block>
  <block id="469d3082a0f3ad08223ba8fe69bf9311" category="paragraph">Depois que os logs tiverem sido recebidos, eles devem ser reproduzidos novamente. Exemplos anteriores mostraram o uso do sqlplus para executar manualmente<block ref="5fea768eb2d353716ca623ae58ce382c" prefix=" " category="inline-code"></block> , que pode ser facilmente automatizado. O exemplo mostrado aqui usa o script descrito em <block ref="7c7730292e0135c86626e1771f7f02ec" category="inline-link-macro-rx"></block>. O script aceita um argumento que especifica o banco de dados que requer uma operação de repetição. Esse processo permite que o mesmo script seja usado em um esforço de migração de multibanco de dados.</block>
  <block id="15d3442f7626bb62f4b255c7ed5c5098" category="paragraph">Quando estiver pronto para ser cortado para o novo ambiente, você deve executar uma sincronização final. Ao trabalhar com sistemas de arquivos regulares, é fácil garantir que o banco de dados migrado seja 100% sincronizado com o original, pois os logs de refazer originais são copiados e reproduzidos. Não há uma boa maneira de fazer isso com ASM. Apenas os logs de arquivo podem ser facilmente retratados. Para se certificar de que nenhum dado é perdido, o encerramento final do banco de dados original deve ser realizado com cuidado.</block>
  <block id="f9952f2469fbec5fc9dca180322ff9ee" category="list-text">Primeiro, o banco de dados deve ser silenciado, garantindo que nenhuma alteração esteja sendo feita. Essa quiescência pode incluir a desativação de operações agendadas, o desligamento de ouvintes e/ou o desligamento de aplicativos.</block>
  <block id="58fd1c52efcde7151ac264a8f67b14ff" category="list-text">Depois que essa etapa é tomada, a maioria dos DBAs cria uma tabela fictícia para servir como um marcador do desligamento.</block>
  <block id="442da9ab2cced82a6cbdd112be285bcf" category="list-text">Forçar um arquivo de log para garantir que a criação da tabela fictícia seja gravada nos logs do arquivo. Para fazer isso, execute os seguintes comandos:</block>
  <block id="83fce8a41250d6af49205f9659468351" category="list-text">Para copiar o último dos registos de arquivo, execute os seguintes comandos. O banco de dados deve estar disponível, mas não aberto.</block>
  <block id="1b0e887c1394d4617c2a5243da19e44e" category="list-text">Para copiar os logs de arquivo, execute os seguintes comandos:</block>
  <block id="86a7e05acb17098c514dd570b9220302" category="list-text">Por fim, reproduza os registos de arquivo restantes no novo servidor.</block>
  <block id="a430882deb5403e7b4b8061dec17cc80" category="list-text">Nesse estágio, replique todos os dados. O banco de dados está pronto para ser convertido de um banco de dados de reserva para um banco de dados operacional ativo e, em seguida, aberto.</block>
  <block id="077c7bcbf9a94bb62aecadc85045886e" category="list-text">Confirmar a presença da tabela fictícia e, em seguida, soltá-la.</block>
  <block id="6130a27b8ec8ccf18e06bb3389b0fbbd" category="section-title">REDO log migração sem interrupções</block>
  <block id="26c294f993888218237d5f9306bfcfc4" category="paragraph">Há momentos em que um banco de dados é organizado corretamente em geral, com exceção dos logs de refazer. Isso pode acontecer por muitos motivos, sendo que o mais comum está relacionado a instantâneos. Produtos como SnapManager para Oracle, SnapCenter e a estrutura de gerenciamento de storage NetApp Snap Creator permitem a recuperação quase instantânea de um banco de dados, mas somente se você reverter o estado dos volumes de arquivos de dados. Se os logs de refazer compartilham espaço com os arquivos de dados, a reversão não pode ser executada com segurança porque isso resultaria na destruição dos logs de refazer, provavelmente significando perda de dados. Portanto, os logs de refazer devem ser relocados.</block>
  <block id="2c56f5081b94b926c93c40f4c935a44a" category="paragraph">Esse procedimento é simples e pode ser realizado sem interrupções.</block>
  <block id="2986f9fe7ed4aab5aaa64c2ee9fe4841" category="section-title">Configuração atual do registo de reprocessamento</block>
  <block id="7c2f6ada37d59f2be0bc1a3ead80f77c" category="section-title">Crie novos logs</block>
  <block id="106b215e5d87fb1256e47932f2ebf9cf" category="list-text">Para cada log de refazer, crie um novo grupo com um tamanho e número correspondentes de membros.</block>
  <block id="0851b65f20b98420968e488fc3c0085e" category="list-text">Verifique a nova configuração.</block>
  <block id="cbccec9e0905e0b7f5cd630a3fa12f64" category="section-title">Soltar registos antigos</block>
  <block id="00f63618719701ddae7fc2ff1d406ec2" category="list-text">Solte os logs antigos (grupos 1, 2 e 3).</block>
  <block id="f00c8361a8acc818247282bb6420a8c1" category="list-text">Se encontrar um erro que o impeça de largar um registo ativo, force um interrutor para o registo seguinte para libertar o bloqueio e force um ponto de verificação global. Veja o exemplo a seguir deste processo. A tentativa de soltar o grupo de arquivos de log 2, que estava localizado no local antigo, foi negada porque ainda havia dados ativos neste arquivo de log.</block>
  <block id="5d49a93437a42d2926c8be7eb3c7a56f" category="list-text">Um arquivo de log seguido por um ponto de verificação permite que você solte o arquivo de log.</block>
  <block id="e3898c187d7edf64fc8e4d4e409fd244" category="list-text">Em seguida, elimine os registos do sistema de ficheiros. Você deve realizar este processo com extremo cuidado.</block>
  <block id="633d94718c25247da5772ed6f2b244c9" category="summary">Introdução à migração de armazenamento Oracle</block>
  <block id="c37c1629ee55e6d553c16bbab86adbde" category="doc">Migração de bancos de dados Oracle para sistemas de storage ONTAP</block>
  <block id="f1d34b6e878aac7179a735d301e4fb76" category="paragraph">Aproveitar os recursos de uma nova plataforma de storage tem um requisito inevitável; os dados devem ser colocados no novo sistema de storage. O ONTAP simplifica o processo de migração, incluindo migrações e atualizações do ONTAP para o ONTAP, importações de LUN estrangeiras e procedimentos para o uso do sistema operacional host ou do software de banco de dados Oracle diretamente.</block>
  <block id="08beeb11d62fd51ef2742eae3ee3719f" category="admonition">Esta documentação substitui o relatório técnico publicado anteriormente _TR-4534: Migração de bancos de dados Oracle para sistemas de armazenamento NetApp_</block>
  <block id="5f2a4190824fd64be3c8cabeb7dc62ff" category="paragraph">No caso de um novo projeto de banco de dados, isso não é uma preocupação porque os ambientes de banco de dados e aplicativos são construídos no lugar. A migração, no entanto, apresenta desafios especiais em relação à interrupção dos negócios, ao tempo necessário para a conclusão da migração, aos conjuntos de habilidades necessários e à minimização dos riscos.</block>
  <block id="a83f1ca5ad00b39773d9e6a26b0e70b2" category="section-title">Scripts</block>
  <block id="08293bec81c296b61f4a751175d9caa7" category="paragraph">Exemplos de scripts são fornecidos nesta documentação. Esses scripts fornecem métodos de exemplo para automatizar vários aspetos da migração para reduzir a chance de erros do usuário. Os scripts podem reduzir as demandas gerais da equipe DE TI responsável por uma migração e acelerar o processo geral. Todos esses scripts são extraídos de projetos de migração reais executados pelos Serviços profissionais da NetApp e parceiros da NetApp. Exemplos de seu uso são mostrados ao longo desta documentação.</block>
  <block id="4fbe2d000cdf5390ca980149d98eec4d" category="summary">Planejamento de migração de banco de dados Oracle</block>
  <block id="dacc2a633e9981c9f91e43ac6b59e889" category="paragraph">A migração de dados Oracle pode ocorrer em um de três níveis: O banco de dados, o host ou o storage array.</block>
  <block id="5153193d50d4c628312db2d5bc0132ed" category="paragraph">As diferenças estão em qual componente da solução geral é responsável pela movimentação de dados: O banco de dados, o sistema operacional host ou o sistema de storage.</block>
  <block id="cc3e73ae592a355b9beb405232d08fe2" category="paragraph">A figura abaixo mostra um exemplo dos níveis de migração e do fluxo de dados. No caso da migração no nível do banco de dados, os dados são movidos do sistema de storage original pelas camadas do host e do banco de dados para o novo ambiente. A migração em nível de host é semelhante, mas os dados não passam pela camada de aplicativo e são gravados no novo local usando processos de host. Finalmente, com a migração no nível do storage, um array como um sistema NetApp FAS é responsável pela movimentação de dados.</block>
  <block id="204415652114bfb773b51cd76c8c692e" category="paragraph"><block ref="204415652114bfb773b51cd76c8c692e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b059e0e23ffaa8fbd97f681942ce0018" category="paragraph">Uma migração no nível do banco de dados geralmente se refere ao uso do Oracle log enviado por meio de um banco de dados de reserva para concluir uma migração na camada Oracle. As migrações em nível de host são executadas usando a capacidade nativa da configuração do sistema operacional do host. Essa configuração inclui operações de cópia de arquivos usando comandos como cp, tar e Oracle Recovery Manager (RMAN) ou usando um gerenciador de volume lógico (LVM) para realocar os bytes subjacentes de um sistema de arquivos. O Oracle Automatic Storage Management (ASM) é categorizado como um recurso no nível do host, porque é executado abaixo do nível do aplicativo de banco de dados. O ASM ocupa o lugar do gerenciador de volume lógico usual em um host. Finalmente, os dados podem ser migrados no nível de storage array, o que significa que estão abaixo do nível do sistema operacional.</block>
  <block id="228d9e0418aa12bae73676a5743558db" category="section-title">Considerações de Planejamento</block>
  <block id="ce7eea640cd6ee20e55cbe868f4026e9" category="paragraph">A melhor opção para migração depende de uma combinação de fatores, incluindo a escala do ambiente a ser migrado, a necessidade de evitar tempo de inatividade e o esforço geral necessário para realizar a migração. Bancos de dados grandes obviamente exigem mais tempo e esforço para a migração, mas a complexidade dessa migração é mínima. Pequenos bancos de dados podem ser migrados rapidamente, mas, se houver milhares para serem migrados, a escala do esforço pode criar complicações. Finalmente, quanto maior o banco de dados, maior a probabilidade de ser crítico para os negócios, o que dá origem a uma necessidade de minimizar o tempo de inatividade, preservando um caminho de back-out.</block>
  <block id="d4b9b19593598d98059aae44d6a7bbe1" category="paragraph">Algumas das considerações para o Planejamento de uma estratégia de migração são discutidas aqui.</block>
  <block id="931c6f2c99380fbd899e3eaa31e97d98" category="section-title">Tamanho dos dados</block>
  <block id="64e4d570abeebacf6bdcb19dfb73fcae" category="paragraph">Os tamanhos dos bancos de dados a serem migrados obviamente afetam o Planejamento da migração, embora o tamanho não afete necessariamente o tempo de transição. Quando uma grande quantidade de dados precisa ser migrada, a principal consideração é a largura de banda. As operações de cópia são geralmente realizadas com e/S sequenciais eficientes Como uma estimativa conservadora, suponha 50% de utilização da largura de banda de rede disponível para operações de cópia. Por exemplo, uma porta FC de 8GB GB pode transferir cerca de 800MBps GB teoricamente. Assumindo 50% de utilização, um banco de dados pode ser copiado a uma taxa de cerca de 400Mbps. Portanto, um banco de dados 10TB pode ser copiado em cerca de sete horas a essa taxa.</block>
  <block id="84a80a048e7abc027dd6bdce55fda9d2" category="inline-link-macro">Movimentação online do arquivo de dados</block>
  <block id="deb8cb7644231cae002f5f37c725b86f" category="paragraph">A migração em distâncias maiores geralmente requer uma abordagem mais criativa, como o processo de envio de logs explicado em <block ref="86efe12ea0d3a769a4b7cfc2b6362f49" category="inline-link-macro-rx"></block>. As redes IP de longa distância raramente têm largura de banda em qualquer lugar perto das velocidades LAN ou SAN. Em um caso, o NetApp ajudou com a migração de longa distância de um banco de dados 220TB com taxas de geração de arquivos log muito altas. A abordagem escolhida para transferência de dados foi o envio diário de fitas, pois esse método oferecia a máxima largura de banda possível.</block>
  <block id="1c169b76761527b28040655a783e50a2" category="section-title">Contagem da base de dados</block>
  <block id="da3770c5d6d1215e9f2524b9d7b7c3c5" category="paragraph">Em muitos casos, o problema de mover uma grande quantidade de dados não é o tamanho dos dados, mas sim a complexidade da configuração que suporta o banco de dados. Simplesmente saber que 50TB de bancos de dados devem ser migrados não é informação suficiente. Pode ser um único banco de dados de missão crítica 50TB, uma coleção de 4, 000 bancos de dados legados ou uma combinação de dados de produção e não produção. Em alguns casos, grande parte dos dados consiste em clones de um banco de dados de origem. Esses clones não precisam ser migrados porque podem ser facilmente recriados, especialmente quando a nova arquitetura foi projetada para utilizar volumes NetApp FlexClone.</block>
  <block id="a1739e745a7544d2432b2b990a715817" category="paragraph">Para Planejar a migração, você deve entender quantos bancos de dados estão no escopo e como eles devem ser priorizados. À medida que o número de bancos de dados aumenta, a opção de migração preferida tende a ser menor e menor na pilha. Por exemplo, copiar um único banco de dados pode ser facilmente executado com RMAN e uma pequena interrupção. Essa é a replicação no nível do host.</block>
  <block id="284723d6a05b50ace5e5b96c761d03ac" category="paragraph">Se houver bancos de dados 50, pode ser mais fácil evitar a configuração de uma nova estrutura de sistema de arquivos para receber uma cópia RMAN e, em vez disso, mover os dados no lugar. Esse processo pode ser feito aproveitando a migração LVM baseada em host para realocar dados de LUNs antigos para novos LUNs. Isso move a responsabilidade da equipe do administrador do banco de dados (DBA) para a equipe do sistema operacional e, como resultado, os dados são migrados de forma transparente em relação ao banco de dados. A configuração do sistema de arquivos não foi alterada.</block>
  <block id="8e734da04d394519001f47f723341e9d" category="paragraph">Por fim, se for necessário migrar bancos de dados 500 em servidores 200, opções baseadas em armazenamento, como o recurso de importação de LUN estrangeiro (FLI) do ONTAP, podem ser usadas para realizar uma migração direta dos LUNs.</block>
  <block id="39f43935349622951e0f392c83b6e736" category="section-title">Requisitos de rearquitetura</block>
  <block id="50f1558a3f9d47464b5d57f9d9d0f9d1" category="paragraph">Normalmente, um layout de arquivo de banco de dados deve ser alterado para aproveitar os recursos do novo storage array; no entanto, isso nem sempre é o caso. Por exemplo, os recursos dos all-flash arrays EF-Series são direcionados principalmente à performance de SAN e à confiabilidade de SAN. Na maioria dos casos, os bancos de dados podem ser migrados para um array da EF-Series sem considerações especiais para o layout de dados. Os únicos requisitos são alto IOPS, baixa latência e confiabilidade robusta. Embora existam práticas recomendadas relacionadas a fatores como configuração RAID ou Dynamic Disk Pools, os projetos EF-Series raramente exigem alterações significativas na arquitetura de storage geral para utilizar esses recursos.</block>
  <block id="0e2c78f7e9948e19ccb1bf2e1b7f0faf" category="paragraph">Em contraste, a migração para o ONTAP geralmente requer mais consideração do layout do banco de dados para garantir que a configuração final forneça o valor máximo. Por si só, o ONTAP oferece muitos recursos para um ambiente de banco de dados, mesmo sem nenhum esforço de arquitetura específico. O mais importante é que ele oferece a capacidade de migrar sem interrupções para um novo hardware quando o hardware atual atinge seu fim de vida útil. De um modo geral, uma migração para o ONTAP é a última migração que você precisaria executar. O hardware subsequente é atualizado e os dados são migrados para novas Mídias sem interrupções.</block>
  <block id="ad93bd21d59f2286385dc519fd7e39fb" category="paragraph">Com algum Planejamento, ainda mais benefícios estão disponíveis. As considerações mais importantes envolvem o uso de instantâneos. Os snapshots são a base para realizar backups, restaurações e operações de clonagem quase instantâneos. Como exemplo do poder dos snapshots, o maior uso conhecido é com um único banco de dados de 996TB GB executado em cerca de 250 LUNs em controladores de 6. Esse banco de dados pode ser feito em 2 minutos, restaurado em 2 minutos e clonado em 15 minutos. Os benefícios adicionais incluem a capacidade de mover dados pelo cluster em resposta a alterações no workload e a aplicação de controles de qualidade do serviço (QoS) para fornecer performance boa e consistente em um ambiente de vários bancos de dados.</block>
  <block id="6b48ce64da84423ce167ffb72f5f9a8b" category="inline-link-macro">Visão geral dos procedimentos de migração Oracle</block>
  <block id="1311d3b592e4da5950e91965dac1d593" category="paragraph">Tecnologias como controles de QoS, realocação de dados, snapshots e clonagem funcionam em praticamente qualquer configuração. No entanto, alguns pensamentos geralmente são necessários para maximizar os benefícios. Em alguns casos, os layouts de armazenamento de banco de dados podem exigir alterações de design para maximizar o investimento no novo storage array. Essas alterações no design podem afetar a estratégia de migração porque as migrações baseadas em host ou baseadas em storage replicam o layout de dados original. Etapas adicionais podem ser necessárias para concluir a migração e fornecer um layout de dados otimizado para o ONTAP. Os procedimentos mostrados em <block ref="d4d5600aaaced44e203002ec1910822d" category="inline-link-macro-rx"></block> e mais tarde demonstram alguns dos métodos para não apenas migrar um banco de dados, mas para migrá-lo para o layout final ideal com o mínimo de esforço.</block>
  <block id="1fd9b0a8321228b5b8ad4be85e71cf64" category="section-title">Tempo de redução</block>
  <block id="95b9194d9f06f6f70febc87c071f3050" category="paragraph">A interrupção máxima permitida de serviço durante a transição deve ser determinada. É um erro comum supor que todo o processo de migração causa interrupções. Muitas tarefas podem ser concluídas antes do início de qualquer interrupção de serviço e muitas opções permitem a conclusão da migração sem interrupção ou interrupção. Mesmo quando a interrupção é inevitável, você ainda deve definir a interrupção máxima de serviço permitida, pois a duração do tempo de transição varia de procedimento para procedimento.</block>
  <block id="e0f9c3b73fe5700df95f30eb98ca4034" category="inline-link-macro">Oracle log de envio</block>
  <block id="055362c7082175c34483772a43b776cf" category="paragraph">Por exemplo, copiar um banco de dados 10TB normalmente requer aproximadamente sete horas para ser concluído. Se as necessidades empresariais permitirem uma interrupção de sete horas, a cópia de arquivos é uma opção fácil e segura para migração. Se cinco horas forem inaceitáveis, um processo simples de envio de logs (consulte <block ref="eee8a7589b6555fc3411165c58a62ca5" category="inline-link-macro-rx"></block>) pode ser configurado com o mínimo de esforço para reduzir o tempo de transferência para aproximadamente 15 minutos. Durante esse tempo, um administrador de banco de dados pode concluir o processo. Se 15 minutos forem inaceitáveis, o processo de transição final pode ser automatizado por meio de script para reduzir o tempo de transição para apenas alguns minutos. Você sempre pode acelerar uma migração, mas isso acontece com o custo de tempo e esforço. As metas de tempo de transição devem ser baseadas no que é aceitável para o negócio.</block>
  <block id="9cfeaf56d2fc41c2695a69adf260c3f8" category="section-title">Caminho de back-out</block>
  <block id="f493e16f7e2caba820eba88a1c5f82d8" category="paragraph">Nenhuma migração é completamente livre de riscos. Mesmo que a tecnologia funcione perfeitamente, há sempre a possibilidade de erro do usuário. O risco associado a um caminho de migração escolhido deve ser considerado juntamente com as consequências de uma migração falhada. Por exemplo, o recurso transparente de migração de armazenamento on-line do Oracle ASM é um de seus principais recursos, e esse método é um dos mais confiáveis conhecidos. No entanto, os dados estão sendo copiados irreversivelmente com este método. No caso altamente improvável de que um problema ocorra com ASM, não há um caminho de back-out fácil. A única opção é restaurar o ambiente original ou usar o ASM para reverter a migração de volta para os LUNs originais. O risco pode ser minimizado, mas não eliminado, executando um backup do tipo snapshot no sistema de storage original, supondo que o sistema seja capaz de executar tal operação.</block>
  <block id="1886f1ab01daa4511ce537d1af675427" category="section-title">Ensaio</block>
  <block id="dd5dac65febd7071311b1ae3be1eca90" category="paragraph">Alguns procedimentos de migração devem ser totalmente verificados antes da execução. A necessidade de migração e ensaio do processo de transição é uma solicitação comum com bancos de dados de missão crítica para os quais a migração deve ser bem-sucedida e o tempo de inatividade deve ser minimizado. Além disso, os testes de aceitação do usuário são frequentemente incluídos como parte do trabalho de pós-migração, e o sistema geral pode ser devolvido à produção somente após a conclusão desses testes.</block>
  <block id="7d06b32cdd06d27f7c62fb110d831e60" category="paragraph">Se houver necessidade de ensaio, vários recursos do ONTAP podem tornar o processo muito mais fácil. Em particular, os snapshots podem redefinir um ambiente de teste e criar rapidamente várias cópias com uso eficiente de espaço de um ambiente de banco de dados.</block>
  <block id="599a80136f745b38f35077e1c7eb020e" category="summary">Procedimentos de migração Oracle</block>
  <block id="329ffa7a9038afa62748f87628b749d5" category="paragraph">Muitos procedimentos estão disponíveis para o banco de dados de migração Oracle. O certo depende das necessidades do seu negócio.</block>
  <block id="48a2d08de8943e7ca4718c02e6b791b6" category="paragraph">Em muitos casos, os administradores de sistema e DBAs têm seus próprios métodos preferidos de relocalização de dados de volume físico, espelhamento e desirritações, ou de aproveitamento do Oracle RMAN para copiar dados.</block>
  <block id="79d01f6e7efcfef7db530c0b3c5ea516" category="paragraph">Esses procedimentos são fornecidos principalmente como orientação para a equipe DE TI menos familiarizada com algumas das opções disponíveis. Além disso, os procedimentos ilustram as tarefas, os requisitos de tempo e as demandas do conjunto de habilidades para cada abordagem de migração. Isso permite que outras partes, como NetApp e serviços profissionais de parceiros ou gerenciamento DE TI, apreciem mais plenamente os requisitos de cada procedimento.</block>
  <block id="5604c71a7d9ae37df511cc85052c1894" category="paragraph">Não existe uma prática recomendada única para a criação de uma estratégia de migração. A criação de um plano requer primeiro compreender as opções de disponibilidade e, em seguida, selecionar o método que melhor se adapta às necessidades do negócio. A figura abaixo ilustra as considerações básicas e conclusões típicas feitas pelos clientes, mas não é universalmente aplicável a todas as situações.</block>
  <block id="fa2e72668f7d48694bef3ba5474e3967" category="paragraph">Por exemplo, uma etapa levanta a questão do tamanho total do banco de dados. A próxima etapa depende se o banco de dados é mais ou menos do que 1TB. As etapas recomendadas são exatamente isso: Recomendações baseadas em práticas típicas do cliente. A maioria dos clientes não usaria o DataGuard para copiar um pequeno banco de dados, mas alguns podem. A maioria dos clientes não tentaria copiar um banco de dados 50TB devido ao tempo necessário, mas alguns podem ter uma janela de manutenção suficientemente grande para permitir tal operação.</block>
  <block id="4fc57ef291a6bc6be0f3f8c81e4f9b44" category="paragraph">O fluxograma abaixo mostra os tipos de considerações sobre qual caminho de migração é melhor. Você pode clicar com o botão direito na imagem e abri-la em uma nova guia para melhorar a legibilidade.</block>
  <block id="17ed98f652bb960b10b3357e44785f38" category="inline-image-macro">Fluxograma de migração</block>
  <block id="f420007a3c90420b30780388a0e05dbc" category="paragraph"><block ref="6ee66f70cd2b82e9dd03128a50a38de9" category="inline-image-macro-rx" type="image"></block>.</block>
  <block id="e38af1623479eee6cfe1782df43819d3" category="paragraph">Oracle 12cR1 e superior incluem a capacidade de mover um arquivo de dados enquanto o banco de dados permanece online. Ele também funciona entre diferentes tipos de sistema de arquivos. Por exemplo, um arquivo de dados pode ser relocado de um sistema de arquivos xfs para ASM. Esse método geralmente não é usado em escala devido ao número de operações individuais de movimentação de arquivos de dados que seriam necessárias, mas é uma opção que vale a pena considerar com bancos de dados menores com menos datafiles.</block>
  <block id="5972a038819f045814401b2baea9ee09" category="paragraph">Além disso, simplesmente mover um arquivo de dados é uma boa opção para migrar partes de bancos de dados existentes. Por exemplo, datafiles menos ativos podem ser relocados para um storage mais econômico, como um volume FabricPool que pode armazenar blocos ociosos no armazenamento de objetos.</block>
  <block id="fcdd0d9eae6df775f1bdc52f950a0160" category="section-title">Migração em nível de banco de dados</block>
  <block id="2b619622b2b8505c335acc8be3a2c3fd" category="paragraph">Migração no nível do banco de dados significa permitir que o banco de dados relocate os dados. Especificamente, isso significa o envio de logs. Tecnologias como RMAN e ASM são produtos Oracle, mas, para fins de migração, elas operam no nível do host, onde copiam arquivos e gerenciam volumes.</block>
  <block id="1048000638cc5357b8b2b36ab55cbc5a" category="section-title">Registrar envio</block>
  <block id="36f7294e33f88b462199b92362434684" category="paragraph">A base para a migração no nível do banco de dados é o log de arquivo Oracle, que contém um log de alterações no banco de dados. Na maioria das vezes, um log de arquivamento faz parte de uma estratégia de backup e recuperação. O processo de recuperação começa com a restauração de um banco de dados e, em seguida, a reprodução de um ou mais logs de arquivo para trazer o banco de dados para o estado desejado. Essa mesma tecnologia básica pode ser usada para realizar uma migração com pouca ou nenhuma interrupção das operações. Mais importante ainda, essa tecnologia permite a migração ao mesmo tempo em que deixa o banco de dados original intocado, preservando um caminho de back-out.</block>
  <block id="d43de5ded302797939b76670bc488b51" category="paragraph">O processo de migração começa com a restauração de um backup de banco de dados para um servidor secundário. Você pode fazer isso de várias maneiras, mas a maioria dos clientes usa seu aplicativo de backup normal para restaurar os arquivos de dados. Depois que os arquivos de dados são restaurados, os usuários estabelecem um método para o envio de log. O objetivo é criar um feed constante de logs de arquivo gerados pelo banco de dados principal e reproduzi-los no banco de dados restaurado para mantê-los ambos perto do mesmo estado. Quando o tempo de transição chega, o banco de dados de origem é completamente desligado e os Registros finais do arquivo e, em alguns casos, os logs de refazer são copiados e reproduzidos. É fundamental que os logs de refazer também sejam considerados porque eles podem conter algumas das transações finais confirmadas.</block>
  <block id="f6fc42763ddbd981d5803ee6676dc7c3" category="paragraph">Depois que esses logs foram transferidos e reproduzidos, ambos os bancos de dados são consistentes uns com os outros. Neste ponto, a maioria dos clientes realiza alguns testes básicos. Se algum erro for feito durante o processo de migração, a repetição do log deve relatar erros e falhar. Ainda é aconselhável realizar alguns testes rápidos com base em consultas conhecidas ou atividades orientadas por aplicativos para verificar se a configuração é ideal. Também é uma prática comum criar uma tabela de teste final antes de encerrar o banco de dados original para verificar se ele está presente no banco de dados migrado. Esta etapa garante que não foram feitos erros durante a sincronização final do log.</block>
  <block id="d8e9d23b4beb4db3da15d77542782747" category="paragraph">Uma simples migração de envio de logs pode ser configurada fora da banda em relação ao banco de dados original, o que o torna particularmente útil para bancos de dados de missão crítica. Nenhuma alteração de configuração é necessária para o banco de dados de origem, e a restauração e configuração inicial do ambiente de migração não têm efeito sobre as operações de produção. Depois que o envio de log é configurado, ele coloca algumas demandas de e/S nos servidores de produção. No entanto, o envio de logs consiste em leituras sequenciais simples dos logs do arquivo, o que é improvável que tenha qualquer efeito no desempenho do banco de dados de produção.</block>
  <block id="2c31403002a9f424c6ef56460c6b3715" category="paragraph">O envio de logs provou ser particularmente útil para projetos de migração de longa distância e alta taxa de mudança. Em um caso, um único banco de dados 220TB foi migrado para um novo local a aproximadamente 500 km de distância. A taxa de mudança foi extremamente alta e as restrições de segurança impediram o uso de uma conexão de rede. O envio de log foi realizado usando fita adesiva e correio. Uma cópia do banco de dados de origem foi inicialmente restaurada usando os procedimentos descritos abaixo. Os logs foram então enviados semanalmente pelo correio até o momento da transição quando o conjunto final de fitas foi entregue e os logs foram aplicados ao banco de dados de réplica.</block>
  <block id="b8efa655c4deb7af8a24fc241f8b53ff" category="section-title">Oracle DataGuard</block>
  <block id="d3165c4060fc6d19c0a6364e7c4580ee" category="paragraph">Em alguns casos, um ambiente DataGuard completo é garantido. É incorreto usar o termo DataGuard para se referir a qualquer envio de log ou configuração de banco de dados em espera. O Oracle DataGuard é uma estrutura abrangente para gerenciar a replicação de banco de dados, mas não é uma tecnologia de replicação. O principal benefício de um ambiente DataGuard completo em um esforço de migração é o switchover transparente de um banco de dados para outro. O DataGuard também permite um switchover transparente de volta para o banco de dados original se um problema for descoberto, como um problema de desempenho ou conetividade de rede com o novo ambiente. Um ambiente DataGuard totalmente configurado requer a configuração não apenas da camada de banco de dados, mas também de aplicativos para que os aplicativos sejam capazes de detetar uma alteração na localização do banco de dados primário. Em geral, não é necessário usar o DataGuard para concluir uma migração, mas alguns clientes têm uma vasta experiência do DataGuard internamente e já dependem dele para o trabalho de migração.</block>
  <block id="f17c0a1ce359c1a6665412f89234bf41" category="section-title">Rearquitetura</block>
  <block id="ece8d784e248d63091fc0d248cdeebc3" category="paragraph">Como discutido anteriormente, aproveitar os recursos avançados de storage arrays às vezes requer a alteração do layout do banco de dados. Além disso, uma alteração no protocolo de armazenamento, como a mudança de ASM para um sistema de arquivos NFS, necessariamente altera o layout do sistema de arquivos.</block>
  <block id="71843fb61639ed5fe216bfebc85af16f" category="paragraph">Uma das principais vantagens dos métodos de envio de log, incluindo o DataGuard, é que o destino de replicação não precisa corresponder à origem. Não há problemas com o uso de uma abordagem de envio de logs para migrar do ASM para um sistema de arquivos regular ou vice-versa. O layout preciso dos arquivos de dados pode ser alterado no destino para otimizar o uso da tecnologia PDB (Pluggable Database) ou para definir controles de QoS seletivamente em determinados arquivos. Em outras palavras, um processo de migração baseado no envio de logs permite otimizar o layout de armazenamento de banco de dados de forma fácil e segura.</block>
  <block id="f00ec1b23f539163f4c748a85e49e2dd" category="section-title">Recursos do servidor</block>
  <block id="76c5d43a72d856a95b0eed94694ae696" category="paragraph">Uma limitação à migração no nível do banco de dados é a necessidade de um segundo servidor. Há duas maneiras de usar este segundo servidor:</block>
  <block id="6cb133f8b5045ef30c17e96ab281749e" category="list-text">Você pode usar o segundo servidor como uma nova casa permanente para o banco de dados.</block>
  <block id="f5133929790fe62dbc76a73db4c88544" category="list-text">Você pode usar o segundo servidor como um servidor de teste temporário. Depois que a migração de dados para o novo storage array for concluída e testada, os sistemas de arquivos LUN ou NFS são desconetados do servidor de teste e reconetados ao servidor original.</block>
  <block id="48a00ba9881b62c610201cd833ee9c88" category="paragraph">A primeira opção é a mais fácil, mas usá-la pode não ser viável em ambientes muito grandes que exigem servidores muito poderosos. A segunda opção requer trabalho extra para realocar os sistemas de arquivos de volta para o local original. Essa pode ser uma operação simples na qual o NFS é usado como protocolo de armazenamento, pois os sistemas de arquivos podem ser desmontados do servidor de teste e remontados no servidor original.</block>
  <block id="c223252c2d577984b75caddbd1dff9dc" category="paragraph">Os sistemas de arquivos baseados em blocos exigem trabalho extra para atualizar o zoneamento FC ou iniciadores iSCSI. Com a maioria dos gerenciadores lógicos de volume (incluindo ASM), os LUNs são detetados e colocados on-line automaticamente depois que são disponibilizados no servidor original. No entanto, algumas implementações de sistema de arquivos e LVM podem exigir mais trabalho para exportar e importar os dados. O procedimento preciso pode variar, mas geralmente é fácil estabelecer um procedimento simples e repetível para concluir a migração e realojar os dados no servidor original.</block>
  <block id="2d22ab8be3661ce5dfd8c9910d1cc003" category="paragraph">Embora seja possível configurar o envio de log e replicar um banco de dados em um único ambiente de servidor, a nova instância deve ter um SID de processo diferente para reproduzir os logs. É possível abrir temporariamente o banco de dados em um conjunto diferente de IDs de processo com um SID diferente e alterá-lo mais tarde. No entanto, isso pode levar a muitas atividades de gerenciamento complicadas, e coloca o ambiente de banco de dados em risco de erro do usuário.</block>
  <block id="2660e825d3a58f68aeec49e1c749f477" category="section-title">Migração em nível de host</block>
  <block id="fae5bb68519bf78c1b3711566283f4ef" category="paragraph">Migrar dados no nível do host significa usar o sistema operacional host e os utilitários associados para concluir a migração. Esse processo inclui qualquer utilitário que copia dados, incluindo Oracle RMAN e Oracle ASM.</block>
  <block id="01070e0746a412afd171ccf162d3a170" category="section-title">Cópia de dados</block>
  <block id="180e717e34d5e4bd2991c47960d00f51" category="paragraph">O valor de uma operação de cópia simples não deve ser subestimado. Infraestruturas de rede modernas podem mover dados a taxas medidas em gigabytes por segundo, e as operações de cópia de arquivos são baseadas em e/S de leitura e gravação sequencial eficiente Mais interrupções são inevitáveis com uma operação de cópia de host quando comparada ao envio de logs, mas uma migração é mais do que apenas a movimentação de dados. Geralmente inclui alterações na rede, no tempo de reinicialização do banco de dados e nos testes de pós-migração.</block>
  <block id="750e04d167938f35054d1c30fd06af58" category="paragraph">O tempo real necessário para copiar dados pode não ser significativo. Além disso, uma operação de cópia preserva um caminho de back-out garantido porque os dados originais permanecem intocados. Se algum problema for encontrado durante o processo de migração, os sistemas de arquivos originais com os dados originais podem ser reativados.</block>
  <block id="5a3572c65171e06d99a4e055f9d35d32" category="section-title">Replatforming</block>
  <block id="d123cc133e4de7ab3a4b1a5af3bf37a7" category="paragraph">Replatforming refere-se a uma alteração no tipo de CPU. Quando um banco de dados é migrado de uma plataforma tradicional Solaris, AIX ou HP-UX para o Linux x86, os dados devem ser reformatados devido a alterações na arquitetura da CPU. SPARC, IA64 e CPUs DE ENERGIA são conhecidos como processadores big endian, enquanto as arquiteturas x86 e x86_64 são conhecidas como little endian. Como resultado, alguns dados dentro dos arquivos de dados Oracle são ordenados de forma diferente, dependendo do processador em uso.</block>
  <block id="6a03806f9c4b1f0048478bab7863fd2c" category="paragraph">Tradicionalmente, os clientes usam o DataPump para replicar dados entre plataformas. DataPump é um utilitário que cria um tipo especial de exportação de dados lógicos que pode ser mais rapidamente importado no banco de dados de destino. Como ele cria uma cópia lógica dos dados, o DataPump deixa as dependências da endianidade do processador para trás. O DataPump ainda é usado por alguns clientes para replatforming, mas uma opção mais rápida se tornou disponível com o Oracle 11g: Tablespaces transportáveis entre plataformas. Este avanço permite que um espaço de tablespace seja convertido para um formato de endian diferente no lugar. Esta é uma transformação física que oferece melhor desempenho do que uma exportação DataPump, que deve converter bytes físicos em dados lógicos e depois converter de volta para bytes físicos.</block>
  <block id="713bf8ff4ea4c4ece861f3345e15e3ea" category="paragraph">Uma discussão completa sobre DataPump e tablespaces transportáveis está além da documentação do Scope NetApp, mas o NetApp tem algumas recomendações com base em nossa experiência ajudando os clientes durante a migração para um novo log de storage array com uma nova arquitetura de CPU:</block>
  <block id="86b0ebca28354c7f55b4cc2fe79bee0e" category="list-text">Se o DataPump estiver sendo usado, o tempo necessário para concluir a migração deve ser medido em um ambiente de teste. Às vezes, os clientes ficam surpresos no momento necessário para concluir a migração. Este tempo de inatividade adicional inesperado pode causar interrupções.</block>
  <block id="8a592f25a72fd6f3718b1b01869ade30" category="list-text">Muitos clientes acreditam erroneamente que as tabelas transportáveis entre plataformas não exigem conversão de dados. Quando uma CPU com um endian diferente é usada, uma operação RMAN<block ref="31168275dcaac634489082b54c4c66d0" prefix=" " category="inline-code"></block> deve ser executada nos arquivos de dados de antemão. Esta não é uma operação instantânea. Em alguns casos, o processo de conversão pode ser acelerado por ter vários threads operando em diferentes arquivos de dados, mas o processo de conversão não pode ser evitado.</block>
  <block id="db7b3f86f4c9a2a6a76adac81614c03b" category="section-title">Migração lógica orientada pelo Gerenciador de volumes</block>
  <block id="86586aa50b0df80a7c68bcd3e86c8606" category="paragraph">Os LVMs funcionam tomando um grupo de uma ou mais LUNs e dividindo-os em pequenas unidades geralmente chamadas de extensões. O conjunto de extensões é então usado como uma fonte para criar volumes lógicos que são essencialmente virtualizados. Essa camada de virtualização agrega valor de várias maneiras:</block>
  <block id="68d083c44669b8b20f0421b0389c6ded" category="list-text">Volumes lógicos podem usar extensões desenhadas a partir de vários LUNs. Quando um sistema de arquivos é criado em um volume lógico, ele pode usar todas as funcionalidades de performance de todos os LUNs. Ele também promove o carregamento uniforme de todos os LUNs no grupo de volumes, fornecendo performance mais previsível.</block>
  <block id="10d1e748082641ce33e82f457cabcbe7" category="list-text">Os volumes lógicos podem ser redimensionados adicionando e, em alguns casos, removendo extensões. Redimensionar um sistema de arquivos em um volume lógico geralmente não causa interrupções.</block>
  <block id="5efed6e7bf2fda8321882aff35768721" category="list-text">Os volumes lógicos podem ser migrados sem interrupções ao mover as extensões subjacentes.</block>
  <block id="96371ba57b3d2f331cc9bd7b5e34708b" category="paragraph">A migração usando um LVM funciona de duas maneiras: Mover uma extensão ou espelhar/desirritar uma extensão. A migração LVM usa e/S sequenciais de grandes blocos eficientes e raramente cria preocupações de desempenho. Se isso se tornar um problema, geralmente há opções para limitar a taxa de e/S. Isso aumenta o tempo necessário para concluir a migração e, ao mesmo tempo, reduz a sobrecarga de e/S nos sistemas de host e storage.</block>
  <block id="28084a93e6570f55c3923991e269816e" category="section-title">Espelho e demirror</block>
  <block id="f5b05967100f74bb14ae26d5021ef4e3" category="paragraph">Alguns gerenciadores de volume, como o AIX LVM, permitem que o usuário especifique o número de cópias para cada extensão e controle quais dispositivos hospedam cada cópia. A migração é feita pegando um volume lógico existente, espelhando as extensões subjacentes aos novos volumes, aguardando a sincronização das cópias e, em seguida, deixando cair a cópia antiga. Se um caminho de saída for desejado, um instantâneo dos dados originais pode ser criado antes do ponto em que a cópia espelhada é descartada. Como alternativa, o servidor pode ser encerrado brevemente para mascarar LUNs originais antes de excluir forçosamente as cópias espelhadas contidas. Isso preserva uma cópia recuperável dos dados em seu local original.</block>
  <block id="7151373ff69a9fafa4a579b40282beeb" category="section-title">Migração de extensão</block>
  <block id="682ba6adb168511d03877bdbf940a0b7" category="paragraph">Quase todos os gerenciadores de volume permitem que extensões sejam migradas e, às vezes, existem várias opções. Por exemplo, alguns gerenciadores de volume permitem que um administrador relocate as extensões individuais para um volume lógico específico do armazenamento antigo para o novo. Os gerenciadores de volume, como o Linux LVM2, oferecem o<block ref="8167c9a6bd495f7ed235364201039099" prefix=" " category="inline-code"></block> comando, que relocaliza todas as extensões no dispositivo LUN especificado para um novo LUN. Depois que o LUN antigo é evacuado, ele pode ser removido.</block>
  <block id="8c232bd157fb78062260d11e1ec3fc2c" category="admonition">O principal risco para as operações é a remoção de LUNs antigos e não utilizados da configuração. É preciso ter muito cuidado ao alterar o zoneamento FC e remover dispositivos LUN obsoletos.</block>
  <block id="41175a8b2053bedbf868e340edf92f55" category="section-title">Gerenciamento automático de armazenamento Oracle</block>
  <block id="dce3f0c1b1c85aaee6448197054602d1" category="paragraph">O Oracle ASM é um gerenciador de volumes lógicos e um sistema de arquivos combinados. Em um alto nível, o Oracle ASM toma uma coleção de LUNs, os divide em pequenas unidades de alocação e os apresenta como um único volume conhecido como um grupo de discos ASM. O ASM também inclui a capacidade de espelhar o grupo de discos definindo o nível de redundância. Um volume pode ser sem espelhamento (redundância externa), espelhado (redundância normal) ou espelhado em três vias (redundância alta). É necessário ter cuidado ao configurar o nível de redundância porque não pode ser alterado após a criação.</block>
  <block id="d0ac5c14a6207835f733f4366345089d" category="paragraph">O ASM também fornece a funcionalidade do sistema de arquivos. Embora o sistema de arquivos não seja visível diretamente do host, o banco de dados Oracle pode criar, mover e excluir arquivos e diretórios em um grupo de discos ASM. Além disso, a estrutura pode ser navegada usando o utilitário asmcmd.</block>
  <block id="e72c9da30cbec4daedddc9b6e6fdf03b" category="paragraph">Assim como em outras implementações de LVM, o Oracle ASM otimiza a performance de e/S por meio da distribuição e balanceamento de carga da e/S de cada arquivo em todas as LUNs disponíveis. Em segundo lugar, as extensões subjacentes podem ser relocadas para permitir o redimensionamento do grupo de discos ASM, bem como a migração. O Oracle ASM automatiza o processo por meio da operação de rebalanceamento. Novos LUNs são adicionados a um grupo de discos ASM e os LUNs antigos são descartados, o que aciona a realocação de extensão e a subsequente queda do LUN evacuado do grupo de discos. Esse processo é um dos métodos de migração mais comprovados, e a confiabilidade do ASM na entrega de migração transparente é possivelmente sua caraterística mais importante.</block>
  <block id="d4ad443888b51ec4e13912c45da68f76" category="admonition">Como o nível de espelhamento do Oracle ASM é fixo, ele não pode ser usado com o método de migração mirror e Demirror.</block>
  <block id="048429277e643e20907317612c1f3318" category="section-title">Migração no nível de storage</block>
  <block id="623bb7ffbb3730716ea39b5086d26f18" category="paragraph">Migração no nível de storage significa realizar a migração abaixo do nível de aplicativo e do sistema operacional. No passado, isso às vezes significava usar dispositivos especializados que copiavam LUNs no nível da rede, mas esses recursos agora são encontrados nativamente no ONTAP.</block>
  <block id="963ce762febea70d619f1fd5c114d85c" category="paragraph">A migração de bancos de dados entre sistemas NetApp é quase universalmente realizada com o software de replicação de dados NetApp SnapMirror. O processo envolve a configuração de uma relação de espelho para os volumes a serem migrados, permitindo que eles sincronizem e, em seguida, aguardando a janela de transição. Quando ele chega, o banco de dados de origem é desligado, uma atualização final do espelho é executada e o espelho é quebrado. Os volumes de réplica ficam prontos para uso, seja pela montagem de um diretório de sistema de arquivos NFS contido ou descobrindo os LUNs contidos e iniciando o banco de dados.</block>
  <block id="1871452e5ea7e53152b5c874a12a890b" category="paragraph">A realocação de volumes em um único cluster do ONTAP não é considerada migração, mas sim uma operação de rotina<block ref="0fc2ecb8aa71bddc595fbc39f593496a" prefix=" " category="inline-code"></block>. O SnapMirror é usado como o mecanismo de replicação de dados no cluster. Este processo é totalmente automatizado. Não há etapas adicionais de migração a serem executadas quando os atributos do volume, como mapeamento LUN ou permissões de exportação NFS, são movidos com o próprio volume. A realocação não causa interrupções nas operações de host. Em alguns casos, o acesso à rede deve ser atualizado para garantir que os dados recém-realocados sejam acessados da maneira mais eficiente possível, mas essas tarefas também não causam interrupções.</block>
  <block id="19fee3ea4b7f4472b5c1853122e8f47b" category="section-title">Importação de LUN estrangeiro (FLI)</block>
  <block id="a73cf458eed5aeff5c15aa5d70298cce" category="paragraph">O FLI é um recurso que permite que um sistema Data ONTAP executando 8,3 ou superior migre um LUN existente de outro storage array. O procedimento é simples: O sistema ONTAP está localizado no storage array existente como se fosse qualquer outro host SAN. O Data ONTAP então assume o controle dos LUNs legados desejados e migra os dados subjacentes. Além disso, o processo de importação usa as configurações de eficiência do novo volume à medida que os dados são migrados, o que significa que os dados podem ser compatados e desduplicados em linha durante o processo de migração.</block>
  <block id="0ee4b09881406835f151f103412a2f1e" category="paragraph">A primeira implementação do FLI no Data ONTAP 8.3 permitiu apenas migração off-line. Esta foi uma transferência extremamente rápida, mas ainda significava que os dados LUN estavam indisponíveis até que a migração fosse concluída. A migração online foi introduzida no Data ONTAP 8.3,1. Esse tipo de migração minimiza a interrupção ao permitir que o ONTAP atenda dados LUN durante o processo de transferência. Há uma breve interrupção, enquanto o host é rezoneado para usar os LUNs por meio do ONTAP. No entanto, assim que essas alterações forem feitas, os dados serão novamente acessíveis e permanecem acessíveis durante todo o processo de migração.</block>
  <block id="19d95ee75467fc2f9a06d150cc99d944" category="paragraph">A leitura de e/S é suportada através do ONTAP até que a operação de cópia esteja concluída, enquanto a escrita de e/S é escrita de forma síncrona para o LUN externo e ONTAP. As duas cópias LUN são mantidas em sincronia dessa maneira até que o administrador execute uma transição completa que libera o LUN estrangeiro e não replica mais gravações.</block>
  <block id="5caad387757ca99ada41709ce30a31a5" category="paragraph">O FLI foi projetado para funcionar com FC, mas se houver um desejo de mudar para iSCSI, o LUN migrado pode ser facilmente remapeado como um iSCSI LUN após a conclusão da migração.</block>
  <block id="7fa6cfc683e0f5f9e3a79f6be14e23f4" category="paragraph">Entre as caraterísticas da FLI está a deteção e ajuste automáticos do alinhamento. Neste contexto, o termo alinhamento refere-se a uma partição em um dispositivo LUN. O desempenho ideal requer que a e/S seja alinhada a 4K blocos. Se uma partição for colocada em um deslocamento que não é um múltiplo de 4K, o desempenho sofre.</block>
  <block id="7b4ef266729f1ddfbc724cad17af4efc" category="paragraph">Há um segundo aspeto do alinhamento que não pode ser corrigido ajustando um deslocamento de partição - o tamanho do bloco do sistema de arquivos. Por exemplo, um sistema de arquivos ZFS geralmente tem um tamanho de bloco interno de 512 bytes. Outros clientes que usam AIX criaram ocasionalmente sistemas de arquivos jfs2 com um tamanho de bloco de 512 ou 1, 024 bytes. Embora o sistema de arquivos possa estar alinhado a um limite 4K, os arquivos criados dentro desse sistema de arquivos não são e o desempenho sofre.</block>
  <block id="1d6b28ed67b1d554df806b0b5a020711" category="paragraph">O FLI não deve ser usado nessas circunstâncias. Embora os dados estejam acessíveis após a migração, o resultado são sistemas de arquivos com sérias limitações de desempenho. Como princípio geral, qualquer sistema de arquivos que suporte uma carga de trabalho de substituição aleatória no ONTAP deve usar um tamanho de bloco 4K. Isso é principalmente aplicável a workloads como arquivos de dados de banco de dados e implantações de VDI. O tamanho do bloco pode ser identificado usando os comandos relevantes do sistema operacional do host.</block>
  <block id="4941562ef813562e0d6aaef673158b99" category="paragraph">Por exemplo, no AIX, o tamanho do bloco pode ser visualizado com<block ref="10c9a985c983a826424b496a708263ec" prefix=" " category="inline-code"></block>o . Com Linux,<block ref="ba5265473f00b27178098cc38d3aef24" prefix=" " category="inline-code"></block> e<block ref="1f8a87190704df357c64a49aee936874" prefix=" " category="inline-code"></block> pode ser usado para<block ref="310201b6353c5f38bc039e0e51b079d3" prefix=" " category="inline-code"></block> e<block ref="5382133ffbecb9bce9d47f2e44327b16" prefix=" " category="inline-code"></block>, respetivamente. <block ref="8cbc6ba7c8bba133ce2bc44780d88742" prefix=" " category="inline-code"></block>Com , o comando é<block ref="1615297782a0dff59b20451e2ca97ea7" prefix=" " category="inline-code"></block>.</block>
  <block id="033a4cb04b5225e2b7cf966f2ce16598" category="paragraph">O parâmetro que controla o tamanho do bloco é e geralmente o padrão é<block ref="81df978a8e3da4bee74b135548f390f3" prefix=" " category="inline-code"></block> 9, o que significa 2 9, ou 512 bytes. Para um desempenho ideal, o<block ref="81df978a8e3da4bee74b135548f390f3" prefix=" " category="inline-code"></block> valor deve ser 12 (2 12 4K). Esse valor é definido no momento em que o zpool é criado e não pode ser alterado, o que significa que os zpools de dados com<block ref="81df978a8e3da4bee74b135548f390f3" prefix=" " category="inline-code"></block> outro que não o 12 devem ser migrados copiando dados para um zpool recém-criado.</block>
  <block id="8bd9661d8c8eb9924c62b8242191af4e" category="paragraph">O Oracle ASM não tem um tamanho de bloco fundamental. O único requisito é que a partição na qual o disco ASM é construído deve estar alinhada corretamente.</block>
  <block id="ea7f7e1e8119ee64585b6173afe720e8" category="section-title">Ferramenta de transição de 7 modos</block>
  <block id="75df51cc2f43b8dde951695f97b838c0" category="paragraph">A 7-Mode Transition Tool (7MTT) é um utilitário de automação usado para migrar grandes configurações de 7 modos para o ONTAP. A maioria dos clientes de bancos de dados encontra outros métodos mais fáceis, em parte porque eles geralmente migram seus ambientes de banco de dados por banco de dados, em vez de realocar todo o espaço físico do storage. Além disso, os bancos de dados costumam fazer parte apenas de um ambiente de storage maior. Portanto, os bancos de dados geralmente são migrados individualmente e, em seguida, o ambiente restante pode ser movido com 7MTT.</block>
  <block id="85fd7dcbc2206c27059ae7f88712154d" category="paragraph">Há um número pequeno, mas significativo de clientes que têm sistemas de storage dedicados a ambientes de banco de dados complicados. Esses ambientes podem conter muitos volumes, snapshots e vários detalhes de configuração, como permissões de exportação, grupos de iniciadores LUN, permissões de usuário e configuração do Lightweight Directory Access Protocol. Nesses casos, as habilidades de automação do 7MTT podem simplificar uma migração.</block>
  <block id="2c87fbdecbf0dfe299f9f89958d61085" category="paragraph">7MTT pode operar em um de dois modos:</block>
  <block id="dc818e71a5519d1b99c7e996cf21fd74" category="list-text">*Transição baseada em cópia (CBT).* O 7MTT com CBT configura volumes SnapMirror de um sistema de 7 modos existente no novo ambiente. Depois que os dados estiverem sincronizados, o 7MTT orquestrará o processo de transição.</block>
  <block id="453bbc96e365e25cc2d091dced3565a6" category="list-text">*Transição livre de cópia (CFT).* O 7MTT com CFT é baseado na conversão no local de prateleiras de disco existentes de 7 modos. Nenhum dado é copiado e os compartimentos de disco existentes podem ser reutilizados. Preserva a proteção de dados e a configuração de eficiência de storage existentes.</block>
  <block id="16262236c3981cb3310b9320b5a67fd0" category="paragraph">A principal diferença entre essas duas opções é que a transição livre de cópias é uma abordagem de grande impactos na qual todos os compartimentos de disco conetados ao par de HA de 7 modos original devem ser relocados para o novo ambiente. Não há opção de mover um subconjunto de prateleiras. A abordagem baseada em cópia permite que os volumes selecionados sejam movidos. Também há potencialmente uma janela de transição mais longa com transição livre de cópias por causa do laço necessário para reciclar compartimentos de disco e converter metadados. Com base na experiência de campo, a NetApp recomenda permitir 1 hora para realocação e desativação das gavetas de disco e entre 15 minutos e 2 horas para conversão de metadados.</block>
  <block id="ecca392290c36269e0489c0b1cf36f50" category="summary">Scripts de exemplo para automatizar operações de migração Oracle</block>
  <block id="eed7df980a6ae17f8e0fecdecf0e25f4" category="doc">Exemplos de scripts de procedimento de migração Oracle</block>
  <block id="6f78af00b87bcad5d08c95c7b6066ad0" category="paragraph">Os scripts apresentados são fornecidos como exemplos de como fazer scripts de várias tarefas do sistema operacional e do banco de dados. Eles são fornecidos como estão. Se for necessário suporte para um procedimento específico, entre em Contato com a NetApp ou um revendedor da NetApp.</block>
  <block id="3146889e40b3ca2b78c56a19178bff84" category="section-title">Encerramento da base de dados</block>
  <block id="5b98b9877c0c74dc3a3daf46cf943d3f" category="paragraph">O seguinte script Perl toma um único argumento do Oracle SID e desliga um banco de dados. Ele pode ser executado como o usuário Oracle ou como root.</block>
  <block id="7df41a3619af59182fb5df6d1920d11a" category="section-title">Inicialização do banco de dados</block>
  <block id="57249fb9cdac8ddc9ea8843636c4e088" category="section-title">Converter sistema de arquivos para somente leitura</block>
  <block id="f2977a22ba44544ca8921e2d75bce435" category="paragraph">O script a seguir toma um argumento file-system e tenta desmontá-lo e remontá-lo como somente leitura. Isso é útil durante os processos de migração nos quais um sistema de arquivos deve ser mantido disponível para replicar dados e, no entanto, deve ser protegido contra danos acidentais.</block>
  <block id="4eac395595a8d266839db0b88fae31e4" category="section-title">Substitua o sistema de arquivos</block>
  <block id="988d7030a130298e1641007b5b0aae20" category="paragraph">O exemplo de script a seguir é usado para substituir um sistema de arquivos por outro. Como edita o arquivo "/etc/fstab", ele deve ser executado como root. Ele aceita um único argumento delimitado por vírgulas dos sistemas de arquivos antigos e novos.</block>
  <block id="149c75d086adf78a50a16bcb5e349158" category="list-text">Para substituir o sistema de arquivos, execute o seguinte script:</block>
  <block id="67a4c588434c781febb12c165c3e860a" category="paragraph">Como exemplo do uso deste script, suponha que os dados em<block ref="f006bf17b06c884c47190c4225d3215a" prefix=" " category="inline-code"></block> são migrados para<block ref="27df80f143a5812bda1553d09c712efc" prefix=" " category="inline-code"></block> e<block ref="0e62afc91abe157ef67895cca0a7f912" prefix=" " category="inline-code"></block> são migrados para<block ref="1c988fc7a325635f00f9b55992128a08" prefix=" " category="inline-code"></block>o . Um dos métodos mais simples para executar esta tarefa é usando uma operação de cópia de arquivo simples para realocar o novo dispositivo de volta para o ponto de montagem original.</block>
  <block id="4a3d90c30a5e921650fe8ad0decf4827" category="list-text">Suponha que os sistemas de arquivos antigos e novos estão presentes no<block ref="816a3ef77b62ade41c3f936c958aa555" prefix=" " category="inline-code"></block> arquivo da seguinte forma:</block>
  <block id="4588a4e3d2f8d0f7c036f59c1be2163f" category="list-text">Quando executado, esse script desmonta o sistema de arquivos atual e o substitui pelo novo:</block>
  <block id="2d808cb44231d0a80164567e7220fc44" category="list-text">O script também atualiza o<block ref="816a3ef77b62ade41c3f936c958aa555" prefix=" " category="inline-code"></block> arquivo de acordo. No exemplo mostrado aqui, ele inclui as seguintes alterações:</block>
  <block id="840967a448e36b9efeaacf7673f825aa" category="section-title">Migração automatizada de banco de dados</block>
  <block id="1107dd36fe8ba0c18ea8abc8734986e2" category="paragraph">Este exemplo demonstra o uso de scripts de desligamento, inicialização e substituição do sistema de arquivos para automatizar totalmente uma migração.</block>
  <block id="36881541e7d9c7bced65fcac337ac327" category="section-title">Apresentar localizações dos ficheiros</block>
  <block id="1e9a1acc40d4943a73e6865cdebaf560" category="paragraph">Este script coleta uma série de parâmetros críticos do banco de dados e os imprime em um formato fácil de ler. Este script pode ser útil ao revisar layouts de dados. Além disso, o script pode ser modificado para outros usos.</block>
  <block id="6172b49b7fdf806b59af0aeef8de71e3" category="section-title">Limpeza da migração do ASM</block>
  <block id="dd8d75d6766af495b5442e67eb27d387" category="section-title">ASM para conversão de nome de sistema de arquivos</block>
  <block id="abc3fc91423668bb4bd49e6e837fa3e4" category="section-title">Repetir registos na base de dados</block>
  <block id="cc7b9a518bb2532f61662a9893248133" category="paragraph">Este script aceita um único argumento de um SID Oracle para um banco de dados que está no modo de montagem e tenta reproduzir todos os logs de arquivo disponíveis atualmente.</block>
  <block id="2a5bd3a209a1ed33b81c5306780227ce" category="section-title">Repetir registos na base de dados em espera</block>
  <block id="ea7bebed0b4151a9b28acbde55fc0eb3" category="paragraph">Esse script é idêntico ao script anterior, exceto que ele é projetado para um banco de dados em espera.</block>
  <block id="190d2bad1c6e231bc18c33e002e663c7" category="summary">Banco de dados Oracle e conetividade ONTAP de conexão direta</block>
  <block id="d078ae9a339971900f939db9e82f253d" category="paragraph">Às vezes, os administradores de storage preferem simplificar suas infraestruturas removendo switches de rede da configuração. Isso pode ser suportado em alguns cenários.</block>
  <block id="89c60635365825dfa13d154785577592" category="summary">Configuração Oracle e TCP/IP e ethernet</block>
  <block id="aaa024a70ffabce1e14fdc1a4b17fe8d" category="doc">Configuração TCP/IP e ethernet para bancos de dados Oracle</block>
  <block id="02a5a4d50c5112bb31ff9c94f5b47ce9" category="paragraph">Muitos clientes do Oracle no ONTAP usam ethernet, o protocolo de rede de NFS, iSCSI, NVMe/TCP e, especialmente, a nuvem.</block>
  <block id="f445528d334d486a14570735705e2223" category="summary">Configuração de rede FC para bancos de dados Oracle</block>
  <block id="92cdde4ecc529b9f9379ed2bdb6aae34" category="paragraph">A configuração do FC SAN para bancos de dados Oracle trata principalmente de seguir as práticas recomendadas diárias de SAN.</block>
  <block id="8a1870adbe8a237106c32d72660a9c42" category="summary">Design de interface lógica para bancos de dados Oracle</block>
  <block id="f46a94d438563c03413adfec27c6bfda" category="paragraph">Os bancos de dados Oracle precisam de acesso ao armazenamento. Interfaces lógicas (LIFs) são o encanamento de rede que coneta uma máquina virtual de armazenamento (SVM) à rede e, por sua vez, ao banco de dados. O design de LIF adequado é necessário para garantir que haja largura de banda suficiente para cada workload de banco de dados, e o failover não resulta em perda de serviços de storage.</block>
  <block id="7aa93b5fc17b83fc9e4816155f8f59ab" category="summary">Teste de desempenho de banco de dados Oracle</block>
  <block id="355ba59494fea8b20be391a73cc755eb" category="paragraph">O teste preciso do desempenho de armazenamento de banco de dados é um assunto extremamente complicado. Requer uma compreensão dos seguintes problemas:</block>
  <block id="b57041cc3b57577b5c21eff44739e3f9" category="list-text">IOPS e taxa de transferência</block>
  <block id="236e7fd957ada95e8094e302623980d3" category="list-text">A diferença entre as operações de e/S de primeiro plano e segundo plano</block>
  <block id="902f90cc4ab59808cac5606f767f61c4" category="list-text">O efeito da latência sobre o banco de dados</block>
  <block id="196198dbaa1d1ea17cfc478fbb2f419f" category="list-text">Várias configurações de sistema operacional e rede que também afetam o desempenho do armazenamento</block>
  <block id="5ff18eadb2ef3fc20e13bed3e5b61d79" category="paragraph">Além disso, há tarefas de bancos de dados que não são de storage a serem consideradas. Há um ponto em que a otimização do desempenho de storage não produz benefícios úteis porque a performance do storage não é mais um fator limitante para o desempenho.</block>
  <block id="035ecd1be6cacde993302b440e396bc2" category="paragraph">A maioria dos clientes de bancos de dados agora seleciona all-flash arrays, o que cria algumas considerações adicionais. Por exemplo, considere o teste de desempenho em um sistema AFF A900 de dois nós:</block>
  <block id="33f545d041b93838074263c0efd2e9da" category="list-text">Com uma taxa de leitura/gravação de 80/20, dois nós de A900 TB podem fornecer mais de 1M IOPS de banco de dados aleatórios antes mesmo de a latência ultrapassar a marca de 150µs. Isso está muito além das demandas atuais de desempenho da maioria dos bancos de dados que é difícil prever a melhoria esperada. O storage seria, em grande parte, apagado como um gargalo.</block>
  <block id="32a993d3f497a6dd4392d3348b05ebc3" category="list-text">A largura de banda da rede é uma fonte cada vez mais comum de limitações de desempenho. Por exemplo, as soluções de disco giratório costumam ser gargalos para a performance do banco de dados, pois a latência de e/S é muito alta. Quando as limitações de latência são removidas por um array all-flash, a barreira frequentemente muda para a rede. Isso é especialmente notável com ambientes virtualizados e sistemas blade, onde a verdadeira conetividade de rede é difícil de visualizar. Isso pode complicar o teste de desempenho se o próprio sistema de armazenamento não puder ser totalmente utilizado devido a limitações de largura de banda.</block>
  <block id="8caa382fb0f5f7a8279424d306dd003d" category="list-text">Em geral, não é possível comparar o desempenho de um array all-flash com um array que contém discos giratórios devido à latência drasticamente aprimorada dos all-flash arrays. Os resultados dos testes normalmente não são significativos.</block>
  <block id="bc2b8b37bdda467f2ce639ab28bf4646" category="list-text">Comparar o desempenho máximo de IOPS com um array all-flash geralmente não é um teste útil, pois os bancos de dados não são limitados pela e/S do storage Por exemplo, suponha que um array possa suportar 500K IOPS aleatórios, enquanto outro pode sustentar 300KK. A diferença é irrelevante no mundo real se um banco de dados está gastando 99% do seu tempo em processamento de CPU. Os workloads nunca utilizam todas as funcionalidades do storage array. Em contraste, os recursos de IOPS de pico podem ser críticos em uma plataforma de consolidação na qual o storage array deve ser carregado para seus recursos de pico.</block>
  <block id="0c2cbb26e6baa58b7d3a3309f95a2786" category="list-text">Considere sempre a latência e o IOPS em qualquer teste de storage. Muitos storage arrays no mercado reivindicam níveis extremos de IOPS, mas a latência torna esses IOPS inúteis em tais níveis. O destino típico com all-flash arrays é a marca 1ms. Uma abordagem melhor para testar não é medir o máximo de IOPS possível, mas determinar quantos IOPS um storage array pode sustentar antes que a latência média seja maior que 1ms.</block>
  <block id="e6d8362588e550c19912b0f3f0e1a129" category="section-title">Oracle Automatic Workload Repository e benchmarking</block>
  <block id="d035df494751722dd56d4cf4a8d1f795" category="paragraph">O padrão-ouro para comparações de desempenho Oracle é um relatório do Oracle Automatic Workload Repository (AWR).</block>
  <block id="95f7e55383674168e90b01b708bc88db" category="paragraph">Existem vários tipos de relatórios AWR. Do ponto de vista de armazenamento, um relatório gerado pela execução do<block ref="5053a9940effa118d38161a53f3b80f8" prefix=" " category="inline-code"></block> comando é o mais abrangente e valioso, porque tem como alvo uma instância de banco de dados específica e inclui alguns histogramas detalhados que quebram eventos de e/S de armazenamento com base na latência.</block>
  <block id="7b79802e5668e6e5b990081db481505d" category="paragraph">Comparar dois arrays de desempenho idealmente envolve executar a mesma carga de trabalho em cada array e produzir um relatório AWR que segmente precisamente a carga de trabalho. No caso de uma carga de trabalho muito longa, um único relatório de AWR com um tempo decorrido que engloba o tempo de início e de parada pode ser usado, mas é preferível dividir os dados de AWR como vários relatórios. Por exemplo, se um trabalho em lote foi executado da meia-noite às 6 da manhã, crie uma série de relatórios AWR de uma hora das meia-noite às 1 da manhã, das 1 às 2 da manhã, e assim por diante.</block>
  <block id="e39ecb86ad7d25413ba8ad2976fd3e4a" category="paragraph">Em outros casos, uma consulta muito curta deve ser otimizada. A melhor opção é um relatório AWR baseado em um instantâneo AWR criado quando a consulta começa e um segundo instantâneo AWR criado quando a consulta termina. O servidor de banco de dados deve ser silencioso para minimizar a atividade em segundo plano que obscureceria a atividade da consulta em análise.</block>
  <block id="2fe7152c186ec1b5b0451e13ec8b968b" category="admonition">Onde os relatórios AWR não estão disponíveis, os relatórios do Oracle statspack são uma boa alternativa. Eles contêm a maioria das mesmas estatísticas de e/S que um relatório AWR.</block>
  <block id="8b8c73ac7e509a897688356d1d283d75" category="section-title">Oracle AWR e solução de problemas</block>
  <block id="42a92c79ee82f4343e7d65f2f1cf2dd2" category="paragraph">Um relatório AWR também é a ferramenta mais importante para analisar um problema de desempenho.</block>
  <block id="ad5387afbab7c506c781c8b12b0a4b24" category="paragraph">Assim como no benchmarking, a solução de problemas de desempenho exige que você meça com precisão uma carga de trabalho específica. Quando possível, forneça dados de AWR ao relatar um problema de desempenho ao centro de suporte da NetApp ou ao trabalhar com um NetApp ou equipe de conta de parceiro sobre uma nova solução.</block>
  <block id="6471146c0e33e2a8ec8a5c6635c837bc" category="paragraph">Ao fornecer dados AWR, considere os seguintes requisitos:</block>
  <block id="5c3ba265890805919f93c246b3f8d2d6" category="list-text">Execute o<block ref="5053a9940effa118d38161a53f3b80f8" prefix=" " category="inline-code"></block> comando para gerar o relatório. A saída pode ser texto ou HTML.</block>
  <block id="25db65f9a36910f3e488a8b7407130de" category="list-text">Se os Oracle Real Application clusters (RACs) forem usados, gere relatórios AWR para cada instância no cluster.</block>
  <block id="96d55341f8208c60720e68b3155f3aa1" category="list-text">Segmente a hora específica em que o problema existia. O tempo decorrido máximo aceitável de um relatório AWR é geralmente de uma hora. Se um problema persistir por várias horas ou envolver uma operação de várias horas, como um trabalho em lote, forneça vários relatórios AWR de uma hora que cobrem todo o período a ser analisado.</block>
  <block id="4533b15b837909c68a0171d2638494d2" category="list-text">Se possível, ajuste o intervalo de instantâneos AWR para 15 minutos. Esta definição permite efetuar uma análise mais detalhada. Isso também requer execuções adicionais de<block ref="5053a9940effa118d38161a53f3b80f8" prefix=" " category="inline-code"></block> para fornecer um relatório para cada intervalo de 15 minutos.</block>
  <block id="97eb6d04cc93934c1be4ab95054cd0b0" category="list-text">Se o problema for uma consulta em execução muito curta, forneça um relatório AWR com base em um instantâneo AWR criado quando a operação começar e um segundo instantâneo AWR criado quando a operação terminar. O servidor de banco de dados deve ser silencioso para minimizar a atividade em segundo plano que obscureceria a atividade da operação em análise.</block>
  <block id="5186f459ce7d75e587a083bcb7c5927a" category="list-text">Se um problema de desempenho for relatado em determinados momentos, mas não em outros, forneça dados AWR adicionais que demonstrem bom desempenho para comparação.</block>
  <block id="108a72dad388aa310cc52ee3bac7d1cc" category="section-title">calibrar_io</block>
  <block id="f1c07dfccef6a6c47a5ccef938e10e3d" category="paragraph">O<block ref="108a72dad388aa310cc52ee3bac7d1cc" prefix=" " category="inline-code"></block> comando nunca deve ser usado para testar, comparar ou comparar sistemas de storage. Conforme indicado na documentação da Oracle, este procedimento calibra os recursos de e/S do armazenamento.</block>
  <block id="872892cce56a2665ad7ceecc44b38166" category="paragraph">A calibração não é a mesma que o benchmarking. O objetivo deste comando é emitir e/S para ajudar a calibrar as operações do banco de dados e melhorar sua eficiência otimizando o nível de e/S emitido para o host. Como o tipo de I/o realizado pela<block ref="108a72dad388aa310cc52ee3bac7d1cc" prefix=" " category="inline-code"></block> operação não representa a e/S real do usuário do banco de dados, os resultados não são previsíveis e frequentemente nem reprodutíveis.</block>
  <block id="e66807fad19acd41db50eedff918a4dd" category="section-title">SLOB2</block>
  <block id="0a6192ff5412539c31db2c7a98f408b3" category="inline-link-macro"><block ref="0a6192ff5412539c31db2c7a98f408b3" category="inline-link-rx"></block></block>
  <block id="d1f6fb23f52090ffd944dc54549735b8" category="paragraph">SLOB2, o silly Little Oracle Benchmark, tornou-se a ferramenta preferida para avaliar o desempenho do banco de dados. Foi desenvolvido por Kevin Closson e está disponível em <block ref="3ccce0719b1965cd915da75778e4e706" category="inline-link-macro-rx"></block>. Leva minutos para instalar e configurar, e ele usa um banco de dados Oracle real para gerar padrões de e/S em um espaço de tabela definido pelo usuário. É uma das poucas opções de teste disponíveis que pode saturar um array all-flash com e/S. Também é útil para gerar níveis muito mais baixos de e/S para simular workloads de storage com IOPS baixo, mas sensíveis à latência.</block>
  <block id="baffd8ac40ca7b966340e7b257b4c7b4" category="section-title">Banco oscilante</block>
  <block id="905a59d6f73f4e2aea1dc232a3bcd195" category="paragraph">O Swingbench pode ser útil para testar o desempenho do banco de dados, mas é extremamente difícil usar o Swingbench de uma forma que estressa o armazenamento. NetApp não viu nenhum teste do Swingbench que rendeu e/S suficiente para ser uma carga significativa em qualquer array AFF. Em casos limitados, o teste de entrada de pedidos (OET) pode ser usado para avaliar o armazenamento de um ponto de vista de latência. Isso pode ser útil em situações em que um banco de dados tem uma dependência de latência conhecida para consultas específicas. É preciso ter cuidado para garantir que o host e a rede estejam configurados adequadamente para realizar os potenciais de latência de um array all-flash.</block>
  <block id="e3cf940afa524b20b15c43b20405be77" category="section-title">HammerDB</block>
  <block id="5c9408da71d2ff7554b9fd11add795cf" category="paragraph">HammerDB é uma ferramenta de teste de banco de dados que simula benchmarks TPC-C e TPC-H, entre outros. Pode levar muito tempo para construir um conjunto de dados suficientemente grande para executar corretamente um teste, mas pode ser uma ferramenta eficaz para avaliar o desempenho para aplicativos OLTP e data warehouse.</block>
  <block id="7e1ad070b7fff621d9d64a71cec87684" category="section-title">Orion</block>
  <block id="56fedcbec2842fb62a743c5f84311597" category="paragraph">A ferramenta Oracle Orion foi comumente usada com o Oracle 9, mas não foi mantida para garantir a compatibilidade com alterações em vários sistemas operacionais de host. Raramente é usado com Oracle 10i ou Oracle 11i devido a incompatibilidades com o SO e configuração de armazenamento.</block>
  <block id="38622bf572fa7bec2dc7f3915ebd345f" category="paragraph">A Oracle reescreveu a ferramenta, e ela é instalada por padrão com o Oracle 12c. Embora este produto tenha sido melhorado e use muitas das mesmas chamadas que um banco de dados Oracle real usa, ele não usa exatamente o mesmo caminho de código ou comportamento de e/S usado pela Oracle. Por exemplo, a maioria das e/S Oracle são executadas de forma síncrona, o que significa que o banco de dados pára até que a e/S esteja concluída à medida que a operação de e/S for concluída em primeiro plano. Simplesmente inundar um sistema de armazenamento com e/S aleatórias não é uma reprodução de e/S Oracle real e não oferece um método direto de comparar matrizes de armazenamento ou medir o efeito das alterações de configuração.</block>
  <block id="bb68dfada5ca20e256bbd3ffbbfab9e6" category="paragraph">Dito isto, existem alguns casos de uso para Orion, como a medição geral do desempenho máximo possível de uma configuração particular de armazenamento de rede-host, ou para medir a integridade de um sistema de armazenamento. Com testes cuidadosos, testes Orion utilizáveis podem ser desenvolvidos para comparar matrizes de armazenamento ou avaliar o efeito de uma alteração de configuração, desde que os parâmetros incluam consideração de IOPS, taxa de transferência e latência e tentativa de replicar fielmente uma carga de trabalho realista.</block>
  <block id="fd73b1ca3b942a1514078a7e59c7433b" category="summary">Banco de dados Oracle e bloqueios obsoletos NFSv3</block>
  <block id="3f9e1e3abd12ad7445baea4b681b9ceb" category="paragraph">Se um servidor de banco de dados Oracle falhar, ele pode ter problemas com bloqueios NFS obsoletos ao reiniciar. Este problema é evitável prestando atenção cuidadosa à configuração da resolução de nomes no servidor.</block>
  <block id="288ebefc25180862eb0448b786b1b9fc" category="paragraph">Este problema surge porque criar um bloqueio e limpar um bloqueio usam dois métodos ligeiramente diferentes de resolução de nomes. Dois processos estão envolvidos, o Network Lock Manager (NLM) e o cliente NFS. O NLM usa<block ref="e5caaf154dfeed411b9eec65b903a22a" prefix=" " category="inline-code"></block> para determinar o nome do host, enquanto o<block ref="d49331f31f40041ebcee19fca74fd9d4" prefix=" " category="inline-code"></block> processo usa<block ref="330c4316ae6124616389eb1ca9912f7a" prefix=" " category="inline-code"></block>o . Esses nomes de host devem corresponder para que o sistema operacional limpe corretamente os bloqueios obsoletos. Por exemplo, o host pode estar procurando bloqueios de propriedade<block ref="c7169a6dd344d0f0a38071a1262e4973" prefix=" " category="inline-code"></block> do , mas os bloqueios foram registrados pelo host como<block ref="0c32c65f5ac66d0bdb4e63bd5fde7f75" prefix=" " category="inline-code"></block>. Se<block ref="330c4316ae6124616389eb1ca9912f7a" prefix=" " category="inline-code"></block> não retornar o mesmo valor que<block ref="5c020b5bb8d1ce1ace51c2a2f4c06fc2" prefix=" " category="inline-code"></block>, o processo de liberação do bloqueio não foi bem-sucedido.</block>
  <block id="19b9a1f540971d74c69042125bab2abc" category="paragraph">O script de exemplo a seguir verifica se a resolução do nome é totalmente consistente:</block>
  <block id="ee04b3fa3b28391874763596275e09c9" category="paragraph">Se<block ref="b64c6f211add16fd66ac17ef14c2a2b4" prefix=" " category="inline-code"></block> não corresponder<block ref="4040592cec1880aa70936989f05e7c31" prefix=" " category="inline-code"></block>, é provável que os bloqueios obsoletos. Por exemplo, este resultado revela um problema potencial:</block>
  <block id="2b500e5914ea5a219ade17dea0808f51" category="paragraph">A solução é geralmente encontrada alterando a ordem em que os hosts aparecem em<block ref="ad942c725cd0cae65ca4c63717ec464c" prefix=" " category="inline-code"></block>. por exemplo, suponha que o arquivo hosts inclua esta entrada:</block>
  <block id="22b58ec1cec48707dfc018e6e216e966" category="paragraph">Para resolver esse problema, altere a ordem em que o nome de domínio totalmente qualificado e o nome de host curto aparecem:</block>
  <block id="e357ccd0745db58f22ea5c0947b613ee" category="paragraph"><block ref="330c4316ae6124616389eb1ca9912f7a" prefix="" category="inline-code"></block> agora retorna o nome de host curto<block ref="c7169a6dd344d0f0a38071a1262e4973" prefix=" " category="inline-code"></block>, que corresponde à saída<block ref="4040592cec1880aa70936989f05e7c31" prefix=" " category="inline-code"></block> do . Assim, os bloqueios são apagados automaticamente após uma falha do servidor.</block>
  <block id="6b64090d226d30776368e89b08c7c71b" category="summary">Alinhamento do WAFL para bancos de dados Oracle</block>
  <block id="03a35ba2b6191f8cfbd1cca378eefc91" category="doc">Verificação de alinhamento do WAFL para bancos de dados Oracle</block>
  <block id="219900dcd21cee2f958254a708ad36f6" category="paragraph">O alinhamento correto do WAFL é essencial para um bom desempenho. Embora o ONTAP gere blocos em 4KB unidades, esse fato não significa que o ONTAP realize todas as operações em 4KB unidades. Na verdade, o ONTAP suporta operações de blocos de diferentes tamanhos, mas a contabilidade subjacente é gerenciada pela WAFL em 4KB unidades.</block>
  <block id="5d3a5c290e14d74acf49b20d15120886" category="paragraph">O termo "alinhamento" refere-se a como Oracle I/o corresponde a essas 4KB unidades. O desempenho ideal requer um bloco Oracle 8KBi para residir em dois blocos físicos de 4KB WAFL em uma unidade. Se um bloco é compensado por 2KB, este bloco reside em metade de um bloco 4KB, um bloco 4KB completo separado e, em seguida, metade de um terceiro bloco 4KB. Este arranjo causa degradação do desempenho.</block>
  <block id="0073ce99d632b066d5ac09a4ad0cf7fc" category="paragraph">O alinhamento não é um problema com sistemas de arquivos nas. Os arquivos de dados Oracle estão alinhados ao início do arquivo com base no tamanho do bloco Oracle. Portanto, os tamanhos de bloco de 8KB, 16KB e 32KB estão sempre alinhados. Todas as operações de bloco são compensadas desde o início do arquivo em unidades de 4 kilobytes.</block>
  <block id="d7f7edd61ab216efc34578584a7d0e7c" category="paragraph">Os LUNs, em contraste, geralmente contêm algum tipo de cabeçalho de driver ou metadados do sistema de arquivos no início que cria um deslocamento. O alinhamento raramente é um problema em sistemas operacionais modernos porque esses sistemas operacionais são projetados para unidades físicas que podem usar um setor 4KB nativo, que também requer que e/S sejam alinhados aos limites 4KB para um desempenho ideal.</block>
  <block id="38b3d1cd67903560954ad297a92e3de1" category="paragraph">Há, no entanto, algumas exceções. Um banco de dados pode ter sido migrado de um sistema operacional antigo que não foi otimizado para e/S 4KB, ou erro de usuário durante a criação da partição pode ter levado a um deslocamento que não está em unidades de tamanho 4KB.</block>
  <block id="612eeadd26ceeace7b043d37f8e24b1f" category="paragraph">Os exemplos a seguir são específicos do Linux, mas o procedimento pode ser adaptado para qualquer sistema operacional.</block>
  <block id="1d5b772bea21e5e949413e09eedf17de" category="section-title">Alinhado</block>
  <block id="594b0fc1af44897ff4b26f2e6b866685" category="paragraph">O exemplo a seguir mostra uma verificação de alinhamento em um único LUN com uma única partição.</block>
  <block id="dc2c18402c86861702fc1d94a6495ac3" category="paragraph">Primeiro, crie a partição que usa todas as partições disponíveis na unidade.</block>
  <block id="adff8cc6319e96d2685fd082a5aa043c" category="paragraph">O alinhamento pode ser verificado matematicamente com o seguinte comando:</block>
  <block id="4bc7aba328a710bb7d0935cf830634aa" category="paragraph">A saída mostra que as unidades são 512 bytes e o início da partição é 32 unidades. Este é um total de 32 x 512 de 16.834 bytes, que é um múltiplo inteiro de 4KB blocos WAFL. Esta partição está corretamente alinhada.</block>
  <block id="dd343941469b5360af52eb1b94fe5de6" category="paragraph">Para verificar o alinhamento correto, execute as seguintes etapas:</block>
  <block id="7d84e72acd05d0c93d99e414f5b092b5" category="list-text">Identifique o identificador universal único (UUID) do LUN.</block>
  <block id="92af2a93f00a6297c490ba0be5fd7a8a" category="list-text">Insira o shell do nó no controlador ONTAP.</block>
  <block id="5274579d5eff6fe6d1e8ecbf54e84993" category="list-text">Inicie coleções estatísticas no UUID alvo identificado no primeiro passo.</block>
  <block id="52df0a2ea976123bf02330300b2392e3" category="list-text">Execute algumas I/O.. É importante usar o<block ref="3c908d68ba53922b92c5595b72fa011c" prefix=" " category="inline-code"></block> argumento para garantir que a e/S seja síncrona e não armazenada em buffer.</block>
  <block id="fac8a5b490ea29eca93ec213d79e6ff2" category="admonition">Tenha muito cuidado com este comando. Reverter os<block ref="39c8942e1038872a822c0dc75eedbde3" prefix=" " category="inline-code"></block> argumentos e<block ref="8bf8854bebe108183caeb845c7676ae4" prefix=" " category="inline-code"></block> destrói os dados.</block>
  <block id="4f7dce34a21e3de727f3e3ad05e6e7d8" category="list-text">Pare as estatísticas e veja o histograma de alinhamento. Toda a e/S deve estar no<block ref="c6bd178b372b0ddd17fff48819badc6a" prefix=" " category="inline-code"></block> balde, o que indica e/S que está alinhada a um limite de bloco 4KB.</block>
  <block id="5df81374c01d1b7c20fe8cb3883117eb" category="section-title">Desalinhado</block>
  <block id="5ff266dadf965b3c304513f516a13c12" category="paragraph">O exemplo a seguir mostra e/S desalinhadas:</block>
  <block id="25be03b87e6a5d8170ce85b16ea506ab" category="list-text">Crie uma partição que não esteja alinhada a um limite 4KB. Este não é um comportamento padrão em sistemas operacionais modernos.</block>
  <block id="b2ca9da17ac7a0807fb313343c1ba9cb" category="list-text">A partição foi criada com um deslocamento de 33 setores em vez do padrão 32. Repita o procedimento descrito em <block ref="6ba0f94fdd8f9504e3fef5712023fb85" category="inline-link-macro-rx"></block>. O histograma aparece da seguinte forma:</block>
  <block id="4adda0e871000c2b13a4faef6ce4e21b" category="paragraph">O desalinhamento é claro. A e/S cai principalmente no bucket*<block ref="66c8d76cad709856ccec680cab8ab35a" prefix="*" category="inline-code"></block>, que corresponde ao deslocamento esperado. Quando a partição foi criada, ela foi movida 512 bytes mais para o dispositivo do que o padrão otimizado, o que significa que o histograma é deslocado em 512 bytes.</block>
  <block id="b53cb977228ac351c16dfacc3c427a99" category="paragraph">Além disso, a<block ref="20e637b3ddd562732de038fba736c7ee" prefix=" " category="inline-code"></block> estatística é diferente de zero, o que significa que I/o foi realizado que não preencheu um bloco 4KB inteiro.</block>
  <block id="d3d92f87c5235ad11c8bc69e85fb2fd0" category="section-title">Refazer o registo</block>
  <block id="162b54d51a30629d78e153f8da201780" category="paragraph">Os procedimentos aqui explicados são aplicáveis aos datafiles. Os logs do Oracle refazer e os logs de arquivamento têm padrões de e/S diferentes. Por exemplo, refazer o Registro é uma substituição circular de um único arquivo. Se o tamanho padrão de bloco de 512 bytes for usado, as estatísticas de gravação são semelhantes a isso:</block>
  <block id="d36dbaa617441d3308f5a9b50cb6f5ca" category="paragraph">A e/S seria distribuída em todos os intervalos de histograma, mas isso não é uma preocupação de desempenho. No entanto, as taxas de refazer o log extremamente altas podem se beneficiar do uso de um tamanho de bloco de 4KBMB. Nesse caso, é desejável garantir que os LUNs de refazer o log estejam alinhados corretamente. No entanto, isso não é tão crítico para um bom desempenho como o alinhamento de arquivos de dados.</block>
  <block id="999548558d2844d78a3b5f9186c231a4" category="summary">Bancos de dados e ONTAP capacidade de armazenamento e espaço livre</block>
  <block id="d11e22f56fe0c9dd85597038a25cd80d" category="doc">Bancos de dados Oracle e gerenciamento de capacidade de storage</block>
  <block id="360612d74cdd78953036946ec943f795" category="paragraph">Gerenciar um banco de dados ou outra aplicação empresarial com storage empresarial previsível, gerenciável e de alta performance exige espaço livre nas unidades para gerenciamento de dados e metadados. A quantidade de espaço livre necessária depende do tipo de unidade usada e dos processos de negócios.</block>
  <block id="3408fe4b6e4b2ed9366356f08e3b9ab0" category="summary">Bancos de dados Oracle e eficiência de storage</block>
  <block id="151654fbc652cca26707bd7a060073d3" category="doc">Bancos de dados Oracle e recursos de eficiência do ONTAP</block>
  <block id="4564218d346b0ef8263512ebe659337d" category="paragraph">Os recursos de eficiência de espaço do ONTAP são otimizados para bancos de dados Oracle. Em quase todos os casos, a melhor abordagem é deixar os padrões em vigor com todos os recursos de eficiência habilitados.</block>
  <block id="ba0fd7b6bfa61ad7f7ad5326a0934d01" category="summary">É necessário entender as funções de takeover e switchover do storage para garantir que as operações do banco de dados Oracle não sejam interrompidas por essas operações. Além disso, os argumentos usados pelas operações de aquisição e comutação podem afetar a integridade dos dados se usados incorretamente.</block>
  <block id="99a1755be2504777b7e266ed14b33168" category="doc">Failover/switchover do controlador ONTAP e dos bancos de dados Oracle</block>
  <block id="ea84db84607112a0d40fca3ff45dfffa" category="summary">Gerenciamento de desempenho de banco de dados Oracle com QoS ONTAP</block>
  <block id="08e3cfb3c3dfa08d34bcbbfe07fe5f28" category="paragraph">O gerenciamento de vários bancos de dados Oracle com segurança e eficiência requer uma estratégia de QoS eficaz. O motivo são os recursos de performance cada vez maiores de um sistema de storage moderno.</block>
  <block id="794c6d3bb54da92d9a4a4022bc5c4e94" category="summary">Bancos de dados RAID e Oracle</block>
  <block id="784fdd6bf0ebb9c00eaefafc3f9a9cee" category="doc">Bancos de dados RAID e Oracle</block>
  <block id="e959fe6bb794f67f31a0d4e6bc5d5bf4" category="paragraph">RAID refere-se ao uso de redundância para proteger os dados contra a perda de uma unidade.</block>
  <block id="b60b0e7c75501fe2f322675f2e6da6d7" category="paragraph">Ocasionalmente, surgem perguntas sobre os níveis de RAID na configuração do armazenamento NetApp usado para bancos de dados Oracle e outros aplicativos empresariais. Muitas práticas recomendadas legadas da Oracle em relação à configuração do storage array contêm avisos sobre o uso do espelhamento RAID e/ou a prevenção de certos tipos de RAID. Embora apresentem pontos válidos, essas fontes não se aplicam ao RAID 4 e às tecnologias NetApp RAID DP e RAID-teC usadas no ONTAP.</block>
  <block id="c9a6446e7a1a2aa2d3d06c76b3dd02ae" category="summary">Provisionamento de SVM para bancos de dados Oracle</block>
  <block id="eaa6380760494a867d1be23523aaba3e" category="doc">Bancos de dados Oracle e máquinas virtuais de armazenamento</block>
  <block id="ffa2dec61afa63c15c9906328e62e2e8" category="paragraph">O gerenciamento do storage de banco de dados Oracle é centralizado em uma Storage Virtual Machine (SVM).</block>
  <block id="6de6bcceac7c1a53ecb774d42b8d5c9a" category="summary">Thin Provisioning Oracle e ONTAP</block>
  <block id="fac6d6b61dd6bd3ee73d5b425bc5a3b7" category="doc">Thin Provisioning com bancos de dados Oracle</block>
  <block id="26c71bfc140fc9f2d56f83f7aedffd53" category="paragraph">O thin Provisioning para um banco de dados Oracle requer um Planejamento cuidadoso, pois o resultado é configurar mais espaço em um sistema de armazenamento do que necessariamente está fisicamente disponível. Vale muito a pena o esforço porque, quando feito corretamente, o resultado é uma significativa economia de custos e melhorias na capacidade de gerenciamento.</block>
  <block id="64e5a77897fe6326f14436eaaaf5432b" category="section-title">Espaço livre e alocação de espaço LVM</block>
  <block id="702db8f3db66a0eec35817fe5d2e4544" category="inline-link-macro">ASMRU</block>
  <block id="096ca5ad0b3774fee4699e2da1bfa884" category="paragraph">A eficiência do thin Provisioning de LUNs ativos em um ambiente de sistema de arquivos pode ser perdida com o tempo, à medida que os dados são excluídos. A menos que os dados excluídos sejam sobrescritos com zeros (veja também <block ref="5b58c4ec517e475a59d0a785f87cabdc" category="inline-link-macro-rx"></block> ou o espaço seja liberado com recuperação de espaço de recorte/DESMAPEAMENTO, os dados "apagados" ocupam mais e mais espaço em branco não alocado no sistema de arquivos. Além disso, o thin Provisioning de LUNs ativos é de uso limitado em muitos ambientes de banco de dados porque os arquivos de dados são inicializados em seu tamanho total no momento da criação.</block>
  <block id="e10d46632bc86306cf4c22633ee930ab" category="paragraph">Um Planejamento cuidadoso da configuração do LVM pode melhorar a eficiência e minimizar a necessidade de provisionamento de armazenamento e redimensionamento de LUN. Quando um LVM, como Veritas VxVM ou Oracle ASM, é usado, os LUNs subjacentes são divididos em extensões que só são usadas quando necessário. Por exemplo, se um conjunto de dados começar com 2TB TB de tamanho, mas puder crescer para 10TB TB com o tempo, esse conjunto de dados poderá ser colocado em 10TB PB de LUNs provisionados, organizados em um grupo de discos LVM. Ele ocuparia apenas 2TBMB de espaço no momento da criação e só reivindicaria espaço adicional, pois as extensões são alocadas para acomodar o crescimento dos dados. Este processo é seguro, desde que o espaço seja monitorado.</block>
  <block id="422956aac4f76239935ded6a492144f2" category="summary">O ONTAP foi projetado para bancos de dados Oracle. Saiba como!</block>
  <block id="9eaca569c6f5ca3388f5613da3aa008c" category="doc">Bancos de dados Oracle no ONTAP</block>
  <block id="528b35962f1679204260ddef6800eece" category="paragraph">O ONTAP foi projetado para bancos de dados Oracle. Por décadas, o ONTAP foi otimizado para as demandas exclusivas de e/S de banco de dados relacional e vários recursos do ONTAP foram criados especificamente para atender às necessidades dos bancos de dados Oracle e até mesmo a pedido da própria Oracle Inc..</block>
  <block id="c9f8ef2db64ce19b15d2cc98fbd3d24c" category="admonition">Esta documentação substitui esses relatórios técnicos publicados anteriormente _TR-3633: Bancos de dados Oracle no ONTAP; TR-4591: Proteção de dados Oracle: Backup, recuperação, replicação; TR-4592: Oracle no MetroCluster; e TR-4534: Migração de bancos de dados Oracle para sistemas de armazenamento NetApp_</block>
  <block id="b42ad0517ef7394f97178fb9e1de8d78" category="paragraph">Além das muitas maneiras possíveis pelas quais o ONTAP agrega valor ao seu ambiente de banco de dados, há também uma grande variedade de requisitos do usuário, incluindo tamanho do banco de dados, requisitos de desempenho e necessidades de proteção de dados. As implantações conhecidas do storage NetApp incluem tudo, desde um ambiente virtualizado de aproximadamente 6.000 bancos de dados executados no VMware ESX até um data warehouse de instância única atualmente dimensionado a 996TB TB e em crescimento. Como resultado, existem algumas práticas recomendadas claras para configurar um banco de dados Oracle no storage NetApp.</block>
  <block id="7bf0493f27e81fe4c3740e773e137a48" category="paragraph">Os requisitos para operar um banco de dados Oracle no storage NetApp são abordados de duas maneiras. Em primeiro lugar, quando existir uma boa prática clara, ela será chamada especificamente. Em um alto nível, muitas considerações de design que devem ser abordadas pelos arquitetos de soluções de armazenamento Oracle com base em seus requisitos de negócios específicos serão explicadas.</block>
  <block id="35b12c67685c33721c1a59e8b736fd61" category="summary">Armazenamento em cache NFS com bancos de dados Oracle</block>
  <block id="748f6387bf49161b9a69b7bfd691dcd2" category="paragraph">A presença de qualquer uma das seguintes opções de montagem faz com que o cache do host seja desativado:</block>
  <block id="9f75df502ef11eaef4292c94110cb673" category="paragraph">Essas configurações podem ter um efeito negativo grave na velocidade de instalação do software, patches e operações de backup/restauração. Em alguns casos, especialmente com aplicações em cluster, essas opções são necessárias como resultado inevitável da necessidade de fornecer coerência de cache em todos os nós do cluster. Em outros casos, os clientes usam erroneamente esses parâmetros e o resultado é danos desnecessários no desempenho.</block>
  <block id="8d23519d53d6611bc42fef8dc4a432df" category="paragraph">Muitos clientes removem temporariamente essas opções de montagem durante a instalação ou o patch dos binários da aplicação. Essa remoção pode ser realizada com segurança se o usuário verificar que nenhum outro processo está usando ativamente o diretório de destino durante o processo de instalação ou patch.</block>
  <block id="c4fb6f7d31d205bc07dbff47d0ae4bb3" category="summary">Oracle Direct NFS</block>
  <block id="1bd6ec1185ba67395dc6f9cd2b458ec8" category="paragraph">Os bancos de dados Oracle podem usar o NFS de duas maneiras.</block>
  <block id="96997ca5c577dd19a3ba5f7ff771f27a" category="paragraph">Primeiro, ele pode usar um sistema de arquivos montado usando o cliente NFS nativo que faz parte do sistema operacional. Isso às vezes é chamado de kernel NFS, ou kNFS. O sistema de arquivos NFS é montado e usado pelo banco de dados Oracle exatamente o mesmo que qualquer outro aplicativo usaria um sistema de arquivos NFS.</block>
  <block id="95c17c63df7ceea39a175b1d96955bb7" category="paragraph">O segundo método é o Oracle Direct NFS (DNFS). Esta é uma implementação do padrão NFS no software de banco de dados Oracle. Ele não altera a maneira como os bancos de dados Oracle são configurados ou gerenciados pelo DBA. Desde que o próprio sistema de armazenamento tenha as configurações corretas, o uso do DNFS deve ser transparente para o grupo DBA e para os usuários finais.</block>
  <block id="43539d2fca21e5b644484efb94614a7b" category="paragraph">Um banco de dados com o recurso DNFS habilitado ainda tem os sistemas de arquivos NFS usuais montados. Uma vez que o banco de dados está aberto, o banco de dados Oracle abre um conjunto de sessões TCP/IP e executa operações NFS diretamente.</block>
  <block id="26e7ebad3936387b4b3f7c4f5688ef27" category="section-title">NFS direto</block>
  <block id="6d431a52c8a41a7c2335f98e2ae8c454" category="paragraph">O principal valor do NFS direto da Oracle é ignorar o cliente NFS do host e executar operações de arquivos NFS diretamente em um servidor NFS. A ativação da TI requer apenas a alteração da biblioteca do Oracle Disk Manager (ODM). As instruções para este processo são fornecidas na documentação da Oracle.</block>
  <block id="8401d91735209aeccbe56f33b4e2db73" category="paragraph">O uso do DNFS resulta em uma melhoria significativa no desempenho de e/S e diminui a carga no host e no sistema de armazenamento, pois a e/S é realizada da maneira mais eficiente possível.</block>
  <block id="b0dedecb00787180a9e0c657cfb278c9" category="paragraph">Além disso, o Oracle DNFS inclui uma *opção* para multipathing de interface de rede e tolerância a falhas. Por exemplo, duas interfaces 10Gb podem ser Unidas para oferecer 20Gb Gbps de largura de banda. Uma falha de uma interface faz com que a I/o seja tentada novamente na outra interface. A operação geral é muito semelhante ao multipathing FC. Multipathing era comum anos atrás, quando 1GB ethernet era o padrão mais comum. Uma NIC 10Gb é suficiente para a maioria das cargas de trabalho Oracle, mas se for necessário mais, 10Gb NICs podem ser colados.</block>
  <block id="11e50b3c816105439151db3a3b4fdda3" category="paragraph">Quando o DNFS é usado, é fundamental que todos os patches descritos no Oracle Doc 1495104,1 sejam instalados. Se um patch não puder ser instalado, o ambiente deve ser avaliado para garantir que os bugs descritos nesse documento não causem problemas. Em alguns casos, a incapacidade de instalar os patches necessários impede o uso do DNFS.</block>
  <block id="8f98002fee392ad6151679875de1a7cc" category="paragraph">Não use DNFS com qualquer tipo de resolução de nome de round-robin, incluindo DNS, DDNS, NIS ou qualquer outro método. Isso inclui o recurso de balanceamento de carga DNS disponível no ONTAP. Quando um banco de dados Oracle usando DNFS resolve um nome de host para um endereço IP, ele não deve ser alterado em pesquisas subsequentes. Isso pode resultar em falhas de banco de dados Oracle e possível corrupção de dados.</block>
  <block id="e80ad3efb180dc2d016b27506b7b24ce" category="section-title">Acesso direto ao NFS e ao sistema de arquivos do host</block>
  <block id="4c38a8c0a49e721bf2a378d0b4fb2010" category="paragraph">O uso do DNFS pode ocasionalmente causar problemas para aplicativos ou atividades do usuário que dependem dos sistemas de arquivos visíveis montados no host porque o cliente DNFS acessa o sistema de arquivos fora da banda do sistema operacional do host. O cliente DNFS pode criar, excluir e modificar arquivos sem o conhecimento do sistema operacional.</block>
  <block id="c03389fdb295f2acb079603123e6d0e3" category="paragraph">Quando as opções de montagem para bancos de dados de instância única são usadas, elas permitem o armazenamento em cache de atributos de arquivo e diretório, o que também significa que o conteúdo de um diretório é armazenado em cache. Portanto, o DNFS pode criar um arquivo, e há um curto atraso antes que o sistema operacional releia o conteúdo do diretório e o arquivo se torne visível para o usuário. Isso geralmente não é um problema, mas, em raras ocasiões, utilitários como SAP BR*Tools podem ter problemas. Se isso acontecer, solucione o problema alterando as opções de montagem para usar as recomendações do Oracle RAC. Essa alteração resulta na desativação de todo o cache do host.</block>
  <block id="a370a203383b565c3fb746c1c2e1a64b" category="paragraph">Altere apenas as opções de montagem quando (a) DNFS for usado e (b) um problema resulta de um atraso na visibilidade do arquivo. Se o DNFS não estiver em uso, o uso das opções de montagem do Oracle RAC em um banco de dados de instância única resulta em desempenho degradado.</block>
  <block id="fb3e908ec44ab0657a364e90a649adee" category="admonition">Veja a nota sobre<block ref="4740c034d97ca90a96b8050082816605" prefix=" " category="inline-code"></block> o in <block ref="6ada863f3548cecdf5d7a06e9c4201cd" category="inline-link-macro-rx"></block> para um problema DNFS específico do Linux que pode produzir resultados incomuns.</block>
  <block id="3d1bd23e74923cdc48fe992d0687809f" category="summary">Locações e bloqueios de bancos de dados Oracle e NFS</block>
  <block id="cec6f8a988408ba212798e1cc32658c7" category="paragraph">O NFSv3 está sem monitoração de estado. Isso efetivamente significa que o servidor NFS (ONTAP) não controla quais sistemas de arquivos são montados, por quem, ou quais bloqueios estão realmente no lugar.</block>
  <block id="7c96331bd03e63c4eb3505c526b42244" category="paragraph">O ONTAP tem alguns recursos que gravarão tentativas de montagem para que você tenha uma ideia de quais clientes podem estar acessando dados, e pode haver bloqueios de consultoria presentes, mas essa informação não é garantida para ser 100% completa. Ele não pode ser concluído, porque o rastreamento do estado do cliente NFS não faz parte do padrão NFSv3.</block>
  <block id="20733ad7135aa0ede95fd8637fe05cf6" category="section-title">NFSv4 declaração</block>
  <block id="3f7c11f662fc6e07a91179fdf2322ef5" category="paragraph">Em contraste, NFSv4 é stateful. O servidor NFSv4 rastreia quais clientes estão usando quais sistemas de arquivos, quais arquivos existem, quais arquivos e/ou regiões de arquivos estão bloqueados, etc. isso significa que precisa haver comunicação regular entre um servidor NFSv4 para manter os dados de estado atuais.</block>
  <block id="6f7e4a1e570f45fa3db0b8a0ed80a38f" category="paragraph">Os estados mais importantes que estão sendo gerenciados pelo servidor NFS são NFSv4 bloqueios e NFSv4 arrendamentos, e eles estão muito interligados. Você precisa entender como cada um funciona por si mesmo, e como eles se relacionam uns com os outros.</block>
  <block id="0d55fd4062f29237d0fb3b7f666fb8eb" category="section-title">NFSv4 fechaduras</block>
  <block id="bf4139ff42e411ae5483e062387b3f70" category="paragraph">Com o NFSv3, os bloqueios são consultivos. Um cliente NFS ainda pode modificar ou excluir um arquivo "bloqueado". Um bloqueio NFSv3 não expira por si só, ele deve ser removido. Isso cria problemas. Por exemplo, se você tiver um aplicativo em cluster que crie NFSv3 bloqueios e um dos nós falhar, o que você faz? Você pode codificar o aplicativo nos nós sobreviventes para remover os bloqueios, mas como você sabe que isso é seguro? Talvez o nó "falhou" esteja operacional, mas não esteja se comunicando com o restante do cluster?</block>
  <block id="11d1c33ac6b190a233c00cdbdd6a355b" category="paragraph">Com NFSv4, os bloqueios têm uma duração limitada. Desde que o cliente que detém os bloqueios continue a efetuar o check-in com o servidor NFSv4, nenhum outro cliente tem permissão para adquirir esses bloqueios. Se um cliente não conseguir efetuar o check-in com o NFSv4, os bloqueios eventualmente serão revogados pelo servidor e outros clientes poderão solicitar e obter bloqueios.</block>
  <block id="c17985911e0182dc5e96c4d60aadf139" category="section-title">NFSv4 arrendamentos</block>
  <block id="596bcfef3aaccfe299bb45a969afcaf0" category="paragraph">NFSv4 bloqueios estão associados a um leasing de NFSv4. Quando um cliente NFSv4 estabelece uma conexão com um servidor NFSv4, ele recebe um leasing. Se o cliente obtém um bloqueio (existem muitos tipos de bloqueios), então o bloqueio está associado ao leasing.</block>
  <block id="b5248856b1835e14738aa32e053e30e0" category="paragraph">Este leasing tem um tempo limite definido. Por padrão, o ONTAP definirá o valor de tempo limite para 30 segundos:</block>
  <block id="7e2a66190f452806ac1183721a43eaa1" category="paragraph">Isso significa que um cliente NFSv4 precisa fazer o check-in com o servidor NFSv4 a cada 30 segundos para renovar suas locações.</block>
  <block id="809c552ae0a4d377e87f495b4e3ac62b" category="paragraph">A locação é renovada automaticamente por qualquer atividade, portanto, se o cliente estiver fazendo trabalho, não há necessidade de realizar operações de adição. Se um aplicativo ficar quieto e não estiver fazendo trabalho real, ele precisará executar uma espécie de operação keep-alive (chamada de SEQUÊNCIA). É essencialmente apenas dizer "Eu ainda estou aqui, por favor, atualize meus arrendamentos."</block>
  <block id="70cb78bb7e91dcafab559f9b72e40bb6" category="paragraph">O NFSv3 está sem monitoração de estado. Não está à espera de comunicação dos clientes. O NFSv4 tem estado monitorado e, uma vez decorrido esse período de locação, o leasing expira e os bloqueios são revogados e os arquivos bloqueados são disponibilizados para outros clientes.</block>
  <block id="2ee5d81cfa6306ae71ce534ed9b31431" category="paragraph">Com o NFSv3, você pode mover cabos de rede, reinicializar switches de rede, fazer alterações de configuração e ter certeza de que nada de ruim aconteceria. Os aplicativos normalmente apenas esperariam pacientemente para que a conexão de rede funcione novamente.</block>
  <block id="8900ff182e4197f8eb2acd7d2b7fd902" category="paragraph">Com NFSv4, você tem 30 segundos (a menos que você tenha aumentado o valor desse parâmetro dentro do ONTAP) para concluir seu trabalho. Se você exceder isso, suas locações expiram. Normalmente, isso resulta em falhas no aplicativo.</block>
  <block id="ffa8c7744b3e2d43b18c67aec0fe7743" category="paragraph">Como exemplo, se você tiver um banco de dados Oracle e tiver uma perda de conetividade de rede (às vezes chamada de "partição de rede") que exceda o tempo limite de concessão, você irá travar o banco de dados.</block>
  <block id="33b9897348039594b4b17bf1e1629c74" category="paragraph">Aqui está um exemplo do que acontece no log de alerta Oracle se isso acontecer:</block>
  <block id="85608585bf8e790a579c49ba9af705c6" category="paragraph">Se você olhar para os syslogs, você deve ver vários desses erros:</block>
  <block id="e19b338de53dada4cf4da3837aaba76d" category="paragraph">As mensagens de log são geralmente o primeiro sinal de um problema, além do congelamento do aplicativo. Normalmente, você não vê nada durante a interrupção da rede porque os processos e o próprio sistema operacional estão bloqueados tentando acessar o sistema de arquivos NFS.</block>
  <block id="7a3c8c17a9dd10fa565f79e0ebb5bba7" category="paragraph">Os erros aparecem depois que a rede estiver operacional novamente. No exemplo acima, uma vez que a conetividade foi restabelecida, o sistema operacional tentou readquirir os bloqueios, mas era tarde demais. O arrendamento expirou e os bloqueios foram removidos. Isso resulta em um erro que se propaga até a camada Oracle e causa a mensagem no log de alerta. Você pode ver variações desses padrões dependendo da versão e configuração do banco de dados.</block>
  <block id="4bec5e793e34a5819aefb68e4f65db26" category="paragraph">Em resumo, o NFSv3 tolera a interrupção da rede, mas o NFSv4 é mais sensível e impõe um período de locação definido.</block>
  <block id="069de2d717910b2677190b9a9b5ed1cf" category="paragraph">E se um tempo limite de 30 segundos não for aceitável? E se você gerenciar uma rede que muda dinamicamente onde os switches são reinicializados ou os cabos são realocados e o resultado é a interrupção ocasional da rede? Você pode optar por estender o período de locação, mas se você quiser fazer isso requer uma explicação de NFSv4 períodos de carência.</block>
  <block id="4b84416146795544deb5c9de89187f91" category="section-title">NFSv4 períodos de carência</block>
  <block id="7d98e091c5f7be92cd5fb85b985d8d20" category="paragraph">Se um servidor NFSv3 for reinicializado, ele estará pronto para servir o IO quase instantaneamente. Não estava mantendo qualquer tipo de estado sobre os clientes. O resultado é que uma operação de aquisição da ONTAP geralmente parece estar próxima de instantânea. No momento em que um controlador estiver pronto para começar a fornecer dados, ele enviará um ARP para a rede que sinaliza a alteração na topologia. Os clientes normalmente detetam isso quase instantaneamente e os dados continuam fluindo.</block>
  <block id="173d4fd05086441236dbee4710639d10" category="paragraph">NFSv4, no entanto, irá produzir uma breve pausa. É apenas parte de como o NFSv4 funciona.</block>
  <block id="21483115213b27583a07dc2ca994671c" category="paragraph">Os servidores NFSv4 precisam rastrear os arrendamentos, bloqueios e quem está usando quais dados. Se um servidor NFS picar e reiniciar, ou perder energia por um momento, ou for reiniciado durante a atividade de manutenção, o resultado será o leasing/bloqueio e outras informações do cliente serão perdidas. O servidor precisa descobrir qual cliente está usando quais dados antes de retomar as operações. É aqui que entra o período de carência.</block>
  <block id="09b6f386094bd895d3c9694f28bfdf65" category="paragraph">Se você de repente ligar o seu servidor NFSv4. Quando ele voltar, os clientes que tentam retomar o IO receberão uma resposta que diz essencialmente: "Perdi informações de leasing/bloqueio. Pretende registar novamente os seus bloqueios?" Esse é o início do período de carência. O padrão é 45 segundos no ONTAP:</block>
  <block id="e4f8aa90af36d76254e2f02e56232aed" category="paragraph">O resultado é que, após uma reinicialização, um controlador irá pausar o IO enquanto todos os clientes recuperam seus arrendamentos e bloqueios. Quando o período de carência terminar, o servidor retomará as operações de e/S.</block>
  <block id="bb2b26fdcb4e947cda6f8e38724ecfc9" category="section-title">Prazos de concessão vs períodos de carência</block>
  <block id="22a7a03175addfd9aa5b1fa2c351e833" category="summary">Configuração NFS para bancos de dados Oracle</block>
  <block id="6cb2edd2369a17890dce007723d98a6f" category="paragraph">A NetApp fornece storage NFS de nível empresarial há mais de 30 anos, e seu uso está crescendo cada vez mais, levando em consideração a simplicidade de suas infraestruturas baseadas em nuvem.</block>
  <block id="ee4b6ce05339d0d985309ece9b7d4372" category="inline-link-macro">TR-4067 NFS nas práticas recomendadas da ONTAP</block>
  <block id="7a3ba6ac400bdd362b5db9daabcefca2" category="paragraph">O protocolo NFS inclui várias versões com requisitos variados. Para obter uma descrição completa da configuração NFS com o ONTAP, <block ref="d594eac583da3f61bc51209142764c76" category="inline-link-macro-rx"></block>consulte . As seções a seguir abrangem alguns dos requisitos mais críticos e erros comuns do usuário.</block>
  <block id="0f8a941fcc56687ad8e3914162c19a41" category="section-title">Versões de NFS</block>
  <block id="d0972be450ccf257fb73d4878bce204e" category="paragraph">O cliente do sistema operacional NFS deve ter suporte do NetApp.</block>
  <block id="7722a2ae10cef9bccea115dfdfe78a99" category="list-text">O NFSv3 é suportado com os sistemas operacionais que seguem o padrão NFSv3.</block>
  <block id="a3550edc6962850398d217f78cc4ad0d" category="list-text">O NFSv3 é compatível com o cliente Oracle DNFS.</block>
  <block id="89c45ebba54478419aa679a7ece8593d" category="list-text">O NFSv4 é compatível com todos os sistemas operacionais que seguem o padrão NFSv4.</block>
  <block id="471ff51c89daf6e35e8e2b5111039744" category="inline-link-macro">NetApp IMT</block>
  <block id="8594659e8c4292db778973052a30ab86" category="list-text">NFSv4,1 e NFSv4,2 requerem suporte específico ao SO. Consulte o <block ref="d98f827de8e80b3365d5f4160c243cdc" category="inline-link-macro-rx"></block> para ver os SO suportados.</block>
  <block id="d1eb4c2a4d74705a5aa7945f734eff7c" category="list-text">O suporte ao Oracle DNFS para NFSv4,1 requer o Oracle 12.2.0.2 ou superior.</block>
  <block id="d8bacc1a7a9d6baaeb962e367920593b" category="inline-link-macro">Matriz de suporte NetApp</block>
  <block id="f16dcce07ca44aa38c7ebe3016b981b2" category="admonition"><block ref="f1e4f72fb4419d4270270c5ed1e0d9f6" category="inline-link-macro-rx"></block>O para NFSv3 e NFSv4 não inclui sistemas operacionais específicos. Todos os SO que obedecem ao RFC são geralmente suportados. Ao pesquisar no IMT on-line para suporte a NFSv3 ou NFSv4, não selecione um sistema operacional específico porque não haverá correspondências exibidas. Todos os SO são implicitamente suportados pela política geral.</block>
  <block id="837f157b2f309f5415420467f7643e3a" category="section-title">ADR e NFS</block>
  <block id="c0e7bb1383be0bf1268d1d70280bef6d" category="paragraph">Alguns clientes relataram problemas de desempenho resultantes de uma quantidade excessiva de e/S nos dados<block ref="18ca3ed022c239421418de608ceb49c5" prefix=" " category="inline-code"></block> no local. O problema geralmente não ocorre até que muitos dados de desempenho tenham sido acumulados. A razão para a e/S excessiva é desconhecida, mas este problema parece ser um resultado de processos Oracle repetidamente verificando o diretório de destino para mudanças.</block>
  <block id="99be2ae95d50120a7c33c818afda1834" category="paragraph">A remoção<block ref="79fea224ffd9e8111e4e87cab732464b" prefix=" " category="inline-code"></block> das opções e/ou<block ref="3504e2b0e7c968444314433be465518d" prefix=" " category="inline-code"></block> montagem permite que o armazenamento em cache do sistema operacional do host ocorra e reduz os níveis de e/S de storage.</block>
  <block id="8950578c587f9503f949dfc6a274b611" category="admonition">*A NetApp recomenda* não colocar<block ref="18ca3ed022c239421418de608ceb49c5" prefix=" " category="inline-code"></block> dados em um sistema de arquivos com<block ref="79fea224ffd9e8111e4e87cab732464b" prefix=" " category="inline-code"></block> ou<block ref="3504e2b0e7c968444314433be465518d" prefix=" " category="inline-code"></block> porque problemas de desempenho são prováveis. Separe<block ref="18ca3ed022c239421418de608ceb49c5" prefix=" " category="inline-code"></block> os dados em um ponto de montagem diferente, se necessário.</block>
  <block id="cdb92b4a73ae99cde4df55c06e20dd3c" category="section-title">nfs-rootonly e mount-rootonly</block>
  <block id="c1f0a21ee026237bef11139a30b07040" category="paragraph">O ONTAP inclui uma opção NFS chamada<block ref="77743dec92afc92eca95c255fd9333d7" prefix=" " category="inline-code"></block> que controla se o servidor aceita conexões de tráfego NFS de portas altas. Como medida de segurança, apenas o usuário raiz tem permissão para abrir conexões TCP/IP usando uma porta de origem abaixo de 1024, porque essas portas são normalmente reservadas para uso do sistema operacional, não para processos de usuário. Essa restrição ajuda a garantir que o tráfego NFS seja de um cliente NFS do sistema operacional real e não de um processo mal-intencionado emulando um cliente NFS. O cliente Oracle DNFS é um driver de espaço de usuário, mas o processo é executado como root, portanto geralmente não é necessário alterar o valor de<block ref="77743dec92afc92eca95c255fd9333d7" prefix=" " category="inline-code"></block>. As conexões são feitas a partir de portas baixas.</block>
  <block id="832b4524bcec11d28ca777ef9cdb4084" category="paragraph">A<block ref="eb6c1a5ecd1e17d4cd46fa5c9d415816" prefix=" " category="inline-code"></block> opção só se aplica a NFSv3. Ele controla se a chamada DE MONTAGEM RPC será aceita a partir de portas maiores que 1024. Quando o DNFS é usado, o cliente está novamente executando como root, para que ele possa abrir portas abaixo de 1024. Este parâmetro não tem efeito.</block>
  <block id="57c47a1451485bec1ebb060afdf65cb4" category="paragraph">Os processos de abertura de conexões com DNFS em NFS versões 4,0 e superiores não são executados como raiz e, portanto, exigem portas acima de 1024. O<block ref="77743dec92afc92eca95c255fd9333d7" prefix=" " category="inline-code"></block> parâmetro deve ser definido como desativado para que o DNFS conclua a conexão.</block>
  <block id="4dd73247734d116e5039cc04c4979f2c" category="paragraph">Se<block ref="77743dec92afc92eca95c255fd9333d7" prefix=" " category="inline-code"></block> o estiver ativado, o resultado será uma parada durante a fase de montagem abrindo conexões DNFS. A saída sqlplus é semelhante a esta:</block>
  <block id="f62d72479920ff0f8dc9a3ca6f301b5d" category="paragraph">O parâmetro pode ser alterado da seguinte forma:</block>
  <block id="47fc6c6691aed3ba0dbdc66c7896c61b" category="admonition">Em situações raras, você pode precisar alterar tanto nfs-rootonly quanto mount-rootonly para desabilitado. Se um servidor estiver gerenciando um número extremamente grande de conexões TCP, é possível que nenhuma porta abaixo de 1024 esteja disponível e o sistema operacional seja forçado a usar portas mais altas. Esses dois parâmetros ONTAP precisariam ser alterados para permitir que a conexão fosse concluída.</block>
  <block id="10b4eb170fe7bd035f21e7d863796683" category="section-title">Políticas de exportação de NFS: Superusuário e setuid</block>
  <block id="98bfec37486e95443730cc3d462022fb" category="paragraph">Se os binários Oracle estiverem localizados em um compartilhamento NFS, a política de exportação deverá incluir permissões de superusuário e setuid.</block>
  <block id="3c0699ba2c56cb17c145bbda5580ed67" category="paragraph">As exportações de NFS compartilhadas usadas para serviços de arquivos genéricos, como diretórios home do usuário, geralmente esmagam o usuário raiz. Isso significa que uma solicitação do usuário root em um host que montou um sistema de arquivos é remapeada como um usuário diferente com Privileges inferior. Isso ajuda a proteger os dados, impedindo que um usuário root em um servidor específico acesse dados no servidor compartilhado. O bit setuid também pode ser um risco de segurança em um ambiente compartilhado. O bit setuid permite que um processo seja executado como um usuário diferente do usuário que invoca o comando. Por exemplo, um script shell que era de propriedade do root com o bit setuid é executado como root. Se esse script shell pudesse ser alterado por outros usuários, qualquer usuário que não seja root poderá emitir um comando como root atualizando o script.</block>
  <block id="e341736b7d51c23cb7ef95615832e502" category="paragraph">Os binários Oracle incluem arquivos de propriedade do root e usam o bit setuid. Se os binários Oracle estiverem instalados em um compartilhamento NFS, a política de exportação deverá incluir as permissões de superusuário e setuid apropriadas. No exemplo abaixo, a regra inclui tanto<block ref="1efaeada4e3307369aca511f5da0498a" prefix=" " category="inline-code"></block> e permite<block ref="0baea2f0ae20150db78f58cddac442a9" prefix=" " category="inline-code"></block> o acesso (raiz) para clientes NFS usando autenticação de sistema.</block>
  <block id="f1a0fa258c785ac546835a1a75017faf" category="section-title">Configuração NFSv4/4,1</block>
  <block id="52f9ad2e353a42e61d9bf7dd9f59d0cb" category="paragraph">Para a maioria das aplicações, há muito pouca diferença entre NFSv3 e NFSv4. A e/S da aplicação geralmente é muito simples e/S e não se beneficia significativamente de alguns dos recursos avançados disponíveis no NFSv4. Versões mais altas do NFS não devem ser vistas como uma "atualização" da perspectiva do storage de banco de dados, mas sim como versões do NFS que incluem recursos adicionais. Por exemplo, se a segurança de ponta a ponta do modo de privacidade Kerberos (krb5p) for necessária, então NFSv4 será necessário.</block>
  <block id="789a6c7dd865d16eb1df122bcc5c9a3a" category="admonition">*A NetApp recomenda* usar o NFSv4,1 se forem necessários recursos do NFSv4. Há algumas melhorias funcionais no protocolo NFSv4 em NFSv4,1 que melhoram a resiliência em certos casos de borda.</block>
  <block id="dabc72adea00cc712e7650b066f1d8c6" category="inline-link">TR-4067 NFS nas práticas recomendadas da ONTAP</block>
  <block id="36911cfd2b35ef0ca97dab53c7e045f0" category="paragraph">Mudar para NFSv4 é mais complicado do que simplesmente mudar as opções de montagem de vers-3 para vers-4,1. Uma explicação mais completa da configuração do NFSv4 com o ONTAP, incluindo orientações sobre a configuração do sistema operacional,<block ref="92f446ddde3e320c4e32b449cbe3112d" category="inline-link-rx"></block>consulte . As secções seguintes deste TR explicam alguns dos requisitos básicos para a utilização do NFSv4.</block>
  <block id="a1dc4350330c061ae52050f5a3400e25" category="section-title">Domínio NFSv4</block>
  <block id="c30669603c950b31f6093d8beaf8060a" category="paragraph">Uma explicação completa da configuração NFSv4/4,1 está além do escopo deste documento, mas um problema comumente encontrado é uma incompatibilidade no mapeamento de domínio. De um ponto de vista sysadmin, os sistemas de arquivos NFS parecem se comportar normalmente, mas os aplicativos relatam erros sobre permissões e/ou setuid em determinados arquivos. Em alguns casos, os administradores concluíram incorretamente que as permissões dos binários do aplicativo foram danificadas e executaram comandos chown ou chmod quando o problema real era o nome do domínio.</block>
  <block id="f0c6c8a632eeaa954640907ee1da277d" category="paragraph">O nome de domínio NFSv4 é definido no ONTAP SVM:</block>
  <block id="97a98ebe6ac1f4a8eaf69158419dd818" category="paragraph">O nome de domínio NFSv4 no host é definido em<block ref="60969252b5b8391a3378335ae420d2e8" prefix=" " category="inline-code"></block></block>
  <block id="4ade50e8135e817e75aa3086851eaaa8" category="paragraph">Os nomes de domínio devem corresponder. Se não o fizerem, erros de mapeamento semelhantes aos seguintes aparecem em<block ref="452905a167cf4509fd08acb964fdb20c" prefix=" " category="inline-code"></block>:</block>
  <block id="c0eb73bb35a4c58d87b330cd00f1986a" category="paragraph">Binários de aplicativos, como binários de banco de dados Oracle, incluem arquivos de propriedade do root com o bit setuid, o que significa que uma incompatibilidade nos nomes de domínio NFSv4 causa falhas na inicialização do Oracle e um aviso sobre a propriedade ou permissões de um arquivo chamado<block ref="dd440398b298ff16eb1188ba8afca6df" prefix=" " category="inline-code"></block>, que está localizado no<block ref="002f94d606ac06f290f33a5fcc67b264" prefix=" " category="inline-code"></block> diretório. Deve aparecer da seguinte forma:</block>
  <block id="21cc6f8790de2a7022b344914915604e" category="paragraph">Se este arquivo aparecer com a propriedade de ninguém, pode haver um problema de mapeamento de domínio NFSv4.</block>
  <block id="203f1cdb2421d34e9eb7391e03ffcaf6" category="paragraph">Para corrigir isso, verifique o<block ref="60969252b5b8391a3378335ae420d2e8" prefix=" " category="inline-code"></block> arquivo na configuração v4-id-domain no ONTAP e certifique-se de que eles sejam consistentes. Se não estiverem, faça as alterações necessárias, execute<block ref="1c7ebfbcaa2681599e41320ed491ca91" prefix=" " category="inline-code"></block> e aguarde um momento para que as alterações se propaguem. A propriedade do arquivo deve então ser devidamente reconhecida como raiz. Se um usuário tivesse tentado executar<block ref="05f0da969f2e0e6ecf3ab445e1e665ad" prefix=" " category="inline-code"></block> esse arquivo antes que a configuração dos domínios NFS fosse corrigida, talvez seja necessário executar<block ref="05f0da969f2e0e6ecf3ab445e1e665ad" prefix=" " category="inline-code"></block> novamente.</block>
  <block id="b1230060a0220caf9d68d64b9dd85e6f" category="summary">Tamanhos de transferência de NFS com Oracle</block>
  <block id="fabe34ed4a5e432f4d1c4f6584956d8d" category="doc">Tamanhos de transferência de NFS com bancos de dados Oracle</block>
  <block id="3dd6786160916127fc2f6fc2ec955bbe" category="summary">Utilitário de reclamação ASM com deteção de bloco zero ONTAP</block>
  <block id="8eb703f2756cafd21dbac4f23c0d6416" category="paragraph">O ONTAP remove com eficiência blocos zerados gravados em um arquivo ou LUN quando a compactação in-line está ativada. Utilitários como o Oracle ASM Reclamation Utility (ASRU) funcionam escrevendo zeros em extensões ASM não utilizadas.</block>
  <block id="525e71fb331412cd820122c3d51d453c" category="paragraph">Isso permite que os DBAs recuperem espaço na matriz de armazenamento após os dados serem excluídos. O ONTAP interceta os zeros e desaloca o espaço do LUN. O processo de recuperação é extremamente rápido porque nenhum dado está sendo gravado no sistema de storage.</block>
  <block id="9de53c14f2bae0c5d4b6e19be495ee94" category="paragraph">Do ponto de vista do banco de dados, o grupo de discos ASM contém zeros, e a leitura dessas regiões dos LUNs resultaria em um fluxo de zeros, mas o ONTAP não armazena os zeros nas unidades. Em vez disso, são feitas mudanças simples de metadados que marcam internamente as regiões zeroadas do LUN como vazias de qualquer dado.</block>
  <block id="06348c6e795160187e298a91b25a37a3" category="paragraph">Por motivos semelhantes, os testes de desempenho envolvendo dados isolados não são válidos, pois blocos de zeros não são realmente processados como gravações no storage array.</block>
  <block id="cee584f1e6223f6dbb73c0d64d599228" category="admonition">Ao usar o ASRU, certifique-se de que todos os patches recomendados pela Oracle estejam instalados.</block>
  <block id="358b9a846de3e04b423c68bac9bc6d53" category="summary">Alinhamento LUN com bancos de dados Oracle</block>
  <block id="45df37151f6a0fd8a3b55d0423459f82" category="doc">Alinhamento LUN para e/S de banco de dados Oracle</block>
  <block id="3e00e4d28b17eedd6f6c2c38233e06a8" category="paragraph">Alinhamento LUN refere-se a otimizar e/S em relação ao layout do sistema de arquivos subjacente.</block>
  <block id="7dde30333f2f14b8935a6f394318dd19" category="paragraph">Diretiva não resolvida no &lt;stdin&gt; - incluir::lun-alignment.adoc[]</block>
  <block id="a6c7e85d51ae3b98197ceb3eafa3686a" category="inline-link-macro">Eficiência</block>
  <block id="baeaebf1ec4083a8b5a2278617a67479" category="paragraph">Consulte também a discussão sobre o alinhamento do bloco de compressão na <block ref="936e7f76dd05eeca0e082776361dee38" category="inline-link-macro-rx"></block>seção . Qualquer layout que esteja alinhado com os limites do bloco de compressão 8KBD também está alinhado com os limites 4KBD.</block>
  <block id="6e2524d5663b2bdc0c7985fa3e57cc55" category="section-title">Avisos de desalinhamento</block>
  <block id="62cc2062c0bb14fd9ee41267e11b9824" category="paragraph">Diretiva não resolvida no &lt;stdin&gt; - include::database-misalignment-warnings.adoc[]</block>
  <block id="79e721357e358d77c4700c25c863fc37" category="inline-link">Configuração do host SAN ONTAP</block>
  <block id="268b1da3f1ff11d32e385d0223101718" category="paragraph">O alinhamento em ambientes Solaris é mais complicado. <block ref="2d33e0364c07dc165b4079892340d4fe" category="inline-link-rx"></block>Consulte para obter mais informações.</block>
  <block id="6d017248f1e4f0ec7e2cd19d967b6bee" category="cell">Nos ambientes Solaris x86, tenha cuidado adicional com o alinhamento adequado, pois a maioria das configurações tem várias camadas de partições. Os cortes de partição do Solaris x86 geralmente existem em cima de uma tabela de partição de Registro de inicialização principal padrão.</block>
  <block id="ceb8ec6ec593174c2c6f33be2ca966eb" category="summary">Volume e disposição de LUN do Oracle e do ONTAP</block>
  <block id="0724b56ced27e0a66fb4692a57fb1436" category="doc">Colocação de LUN de banco de dados Oracle</block>
  <block id="f595bf3bf71ab0c91a5503ba4efb8ea4" category="paragraph">O posicionamento ideal de LUNs de banco de dados nos volumes do ONTAP depende principalmente de como vários recursos do ONTAP serão usados.</block>
  <block id="17ff263bc6eb701aecb8e79f9ef53efd" category="summary">Redimensionamento LUN e LVM com bancos de dados Oracle</block>
  <block id="ff15e8b125dae74c1231f09380e48886" category="paragraph">Quando um sistema de arquivos baseado em SAN atingiu seu limite de capacidade, há duas opções para aumentar o espaço disponível:</block>
  <block id="eb7f9a88026c895932f70c650c364132" category="list-text">Aumente o tamanho dos LUNs</block>
  <block id="0f11c45e6e7377b9d10a93534d0fa2f3" category="list-text">Adicione um LUN a um grupo de volumes existente e aumente o volume lógico contido</block>
  <block id="d01cbb2be77343ccdb1d3372c4b9891e" category="summary">Diretrizes de dimensionamento de LUN de banco de dados Oracle e contagem de LUN</block>
  <block id="9718528cb14225785c79e3afc4152efc" category="doc">Dimensionamento de LUN de banco de dados Oracle e contagem de LUN</block>
  <block id="51f96d1f8b50084e3a2ddc21ceef8b2f" category="paragraph">Selecionar o tamanho ideal de LUN e o número de LUNs a serem usados é essencial para obter o desempenho e a capacidade de gerenciamento ideais dos bancos de dados Oracle.</block>
  <block id="f73bede4039d47664f70de3c2d1f2b46" category="summary">Configuração de distribuição LVM para bancos de dados Oracle</block>
  <block id="fdf9dde4dc297fff7ac7b3c1458b0dad" category="doc">LVM striping com bancos de dados Oracle</block>
  <block id="1b5681ffc153e25d2a48ae3f3f01b9f5" category="paragraph">A distribuição de LVM refere-se à distribuição de dados entre vários LUNs. O resultado é uma melhoria significativa na performance de muitos bancos de dados.</block>
  <block id="a98d546484d238b37b7e2584ae8d399d" category="summary">Disposição em camadas do backup do Oracle</block>
  <block id="250bce9fbefc7872908d9c2708fc753b" category="doc">Disposição em camadas do backup de banco de dados Oracle</block>
  <block id="9f409a250e4be99904c9e90259cb747d" category="paragraph">Os backups tradicionais de aplicativos incluem produtos como o Oracle Recovery Manager, que criam backups baseados em arquivos fora do local do banco de dados original.</block>
  <block id="77fda44088666155052f9d4224878cbc" category="summary">Disposição em camadas do log de arquivamento do Oracle</block>
  <block id="5059ada12bae6c7e7fac9338d88301b5" category="doc">Disposição em camadas do log de arquivamento de banco de dados Oracle</block>
  <block id="8625af69ad0b5f76799d87df777e3c86" category="paragraph">Talvez o uso mais importante para o FabricPool seja melhorar a eficiência de dados inativos conhecidos, como logs de transações de banco de dados.</block>
  <block id="0b3a030b64747fb3830c79e1ffbef7ee" category="summary">Interrupções de acesso ao banco de dados e armazenamento de objetos Oracle</block>
  <block id="857a8adc9eda2d9e197a52323daca558" category="doc">Visão geral da disposição em camadas do Oracle Database FabricPool</block>
  <block id="ec35a176f3e7c086273baee0c7f374d5" category="paragraph">Entender como a disposição em camadas do FabricPool afeta a Oracle e outros bancos de dados requer um entendimento da arquitetura FabricPool de baixo nível.</block>
  <block id="05f9f35345d8f2164958f3b6b7098fa7" category="summary">Disposição em camadas do Oracle Partial File FabricPool</block>
  <block id="f935a501eae76f9c13d430bc3879cd0d" category="paragraph">Como o FabricPool funciona no nível de bloco, os arquivos sujeitos a alteração podem ser parcialmente dispostos em camadas no storage de objetos, permanecendo também parcialmente na camada de performance.</block>
  <block id="c5753b0ef1dfc2c724f24235a689d1ab" category="summary">Políticas de disposição em camadas do Oracle Database FabricPool</block>
  <block id="4627801bdbb24a1991e64f30a2d80cb1" category="paragraph">Quatro políticas estão disponíveis no ONTAP, que controlam como os dados da Oracle no nível de desempenho se tornam um candidato a ser relocado para o nível de capacidade.</block>
  <block id="b67d277a8a8f29f7b869c9bdbff5fcd1" category="summary">Bancos de dados Oracle e políticas de recuperação FabricPool</block>
  <block id="6edf1821ddc55278229c2156f42905f0" category="paragraph">As políticas de disposição em camadas controlam quais blocos de banco de dados Oracle são dispostos da camada de performance para a camada de capacidade. As políticas de recuperação controlam o que acontece quando um bloco que foi categorizado é lido.</block>
  <block id="2cba4042f0a43491e4ea8f14238ae6e4" category="summary">Disposição em camadas de snapshot do Oracle e FabricPool</block>
  <block id="6f7b1d0f996b7d49f60586ce7fbeca36" category="doc">Oracle com disposição em camadas de snapshot do FabricPool</block>
  <block id="4ac7e99e454283880f5bdf93e9d59eb9" category="summary">Disposição em camadas do FabricPool de arquivo completo do banco de dados Oracle</block>
  <block id="2eea2725f31529888b5e57b36492819f" category="paragraph">Embora a disposição em camadas do FabricPool opere no nível de bloco, em alguns casos, ela pode ser usada para fornecer a disposição em camadas no nível do arquivo.</block>
  <block id="d470f5db851ef84aaa776600805af48b" category="summary">Introdução à virtualização de banco de dados Oracle</block>
  <block id="b8fc1174bb3f1c65475334182829f75e" category="doc">Virtualização de banco de dados Oracle</block>
  <block id="4a884da785a62e8b1758932191ff42de" category="paragraph">A virtualização de bancos de dados com VMware, Oracle OLVM ou KVM é uma escolha cada vez mais comum para os clientes da NetApp que escolheram a virtualização até mesmo para seus bancos de dados mais críticos.</block>
  <block id="3a8ba1ff8824968961222d6b447b4973" category="section-title">Capacidade de suporte</block>
  <block id="3231d83af741101eb02b16e5d7a6dffc" category="paragraph">Existem muitos equívocos sobre as políticas de suporte Oracle para virtualização, especialmente para produtos VMware. Não é incomum ouvir que o Oracle outright não suporta virtualização. Essa noção está incorreta e leva a oportunidades perdidas para se beneficiar da virtualização. O Oracle Doc ID 249212,1 discute os requisitos reais e raramente é considerado pelos clientes como uma preocupação.</block>
  <block id="722bd611ee4f38780607b400c8a604c0" category="paragraph">Se ocorrer um problema em um servidor virtualizado e esse problema for anteriormente desconhecido para o suporte Oracle, o cliente poderá ser solicitado a reproduzir o problema em hardware físico. Um cliente Oracle que executa uma versão de ponta a ponta de um produto pode não querer usar a virtualização devido ao potencial de problemas de capacidade de suporte, mas essa situação não tem sido um mundo real para clientes de virtualização que usam versões de produtos Oracle geralmente disponíveis.</block>
  <block id="9e28dbd7a4f5940eeaf6d3893c5c4b1f" category="section-title">Apresentação de armazenamento</block>
  <block id="c8a4476ecddeda66dbd2c354c8fb2c6b" category="paragraph">Os clientes que consideram a virtualização de seus bancos de dados devem basear suas decisões de storage em suas necessidades de negócios. Embora esta seja uma declaração geralmente verdadeira para todas as DECISÕES DE TI, é especialmente importante para projetos de banco de dados, porque o tamanho e o escopo dos requisitos variam consideravelmente.</block>
  <block id="835ce293f862d9fb74e50f4cf928c56d" category="paragraph">Existem três opções básicas para apresentação de armazenamento:</block>
  <block id="327813abbc0ae1e9d3abe282303bf00c" category="list-text">LUNs virtualizados em datastores do hipervisor</block>
  <block id="151ae53a4100e0a6e83bde4d78083f81" category="list-text">ISCSI LUNs gerenciados pelo iniciador iSCSI na VM, não pelo hipervisor</block>
  <block id="1a1af5efffda8c766ead9f73fc782e0e" category="list-text">Sistemas de arquivos NFS montados pela VM (não em um datastore baseado em NFS)</block>
  <block id="f9bf9489147891f7ee7ba15126a27fda" category="list-text">Mapeamentos diretos de dispositivos. Os RDMs VMware são desfavorecidos pelos clientes, mas os dispositivos físicos ainda são frequentemente mapeados diretamente com a virtualização KVM e OLVM.</block>
  <block id="69b0ac6bf6ea8e1ab4e4fc896294da01" category="paragraph">O método de apresentar armazenamento a um convidado virtualizado geralmente não afeta o desempenho. Os sistemas operacionais de host, drivers de rede virtualizados e implementações de armazenamento de dados do hipervisor são altamente otimizados e geralmente podem consumir toda a largura de banda de rede FC ou IP disponível entre o hipervisor e o sistema de storage, desde que sejam seguidas as práticas recomendadas básicas. Em alguns casos, obter desempenho ideal pode ser um pouco mais fácil usando uma abordagem de apresentação de storage em comparação com outra, mas o resultado final deve ser comparável.</block>
  <block id="a2e8fb5328f6558e3a119d8c224a1897" category="paragraph">O fator chave para decidir como apresentar o storage a um convidado virtualizado é a capacidade de gerenciamento. Não há método certo ou errado. A melhor abordagem depende das necessidades operacionais, habilidades e preferências DE TI.</block>
  <block id="e4919ac0a074fa1bba5303f596a5f591" category="paragraph">Os fatores a considerar incluem:</block>
  <block id="c422e10bbf04c180f4c47f81ed9a1f7a" category="list-text">*Transparência.* Quando uma VM gerencia seus sistemas de arquivos, é mais fácil para um administrador de banco de dados ou um administrador de sistema identificar a origem dos sistemas de arquivos para seus dados. Os sistemas de arquivos e LUNs são acessados de forma diferente do que com um servidor físico.</block>
  <block id="42de52ad09be3101fc535dea2aedce1d" category="list-text">*Consistência.* Quando uma VM possui seus sistemas de arquivos, o uso ou não uso de uma camada de hipervisor afeta a gerenciabilidade. Os mesmos procedimentos de provisionamento, monitoramento, proteção de dados etc. podem ser usados em todo o estado, incluindo ambientes virtualizados e não virtualizados.</block>
  <block id="0562446bc5eefe9a584e23ffb3061cbf" category="paragraph">Por outro lado, em um data center 100% virtualizado, pode ser preferível também usar o armazenamento baseado em datastore em toda a área ocupada com a mesma lógica mencionada acima - consistência - a capacidade de usar os mesmos procedimentos para provisionamento, proteção, monitoramento e proteção de dados.</block>
  <block id="7269a37b557c66664c0377693f62ec8a" category="list-text">*Estabilidade e resolução de problemas.* Quando uma VM é proprietária de seus sistemas de arquivos, fornecer performance boa e estável e solucionar problemas fica mais simples porque toda a pilha de storage está presente na VM. A única função do hipervisor é transportar quadros FC ou IP. Quando um datastore é incluído em uma configuração, complica a configuração introduzindo outro conjunto de timeouts, parâmetros, arquivos de log e possíveis bugs.</block>
  <block id="36f9cea3dc0f65698a9fbe15460591c1" category="list-text">* Portabilidade.* Quando uma VM possui seus sistemas de arquivos, o processo de mover um ambiente Oracle se torna muito mais simples. Os sistemas de arquivos podem ser movidos facilmente entre convidados virtualizados e não virtualizados.</block>
  <block id="c160b6d86853c20a432e2407b82866e6" category="list-text">*Aprisionamento do fornecedor.* depois que os dados são colocados em um datastore, usar um hypervisor diferente ou tirar os dados do ambiente virtualizado torna-se completamente difícil.</block>
  <block id="a42abd01a1e0c89cfa2112dc09378967" category="list-text">*Capacitação de snapshot.* Os procedimentos tradicionais de backup em um ambiente virtualizado podem se tornar um problema devido à largura de banda relativamente limitada. Por exemplo, um tronco 10GbE de quatro portas pode ser suficiente para suportar as necessidades diárias de desempenho de muitos bancos de dados virtualizados, mas esse tronco seria insuficiente para executar backups usando RMAN ou outros produtos de backup que exigem o streaming de uma cópia de tamanho completo dos dados. O resultado é que um ambiente virtualizado cada vez mais consolidado precisa executar backups por meio de snapshots de storage. Isso evita a necessidade de sobrecompilar a configuração do hipervisor apenas para suportar os requisitos de largura de banda e CPU na janela de backup.</block>
  <block id="86c36175331b4a95c083fabdcca8b8a0" category="paragraph">O uso de sistemas de arquivos de propriedade de convidados às vezes facilita a utilização de backups e restaurações baseados em snapshot, porque os objetos de storage que precisam de proteção podem ser segmentados com mais facilidade. No entanto, há um número cada vez maior de produtos de proteção de dados de virtualização que se integram bem aos armazenamentos de dados e snapshots. A estratégia de backup deve ser totalmente considerada antes de tomar uma decisão sobre como apresentar o storage a um host virtualizado.</block>
  <block id="f114856edc6cd8d6a9add5ec3f67656f" category="section-title">Drivers paravirtualizados</block>
  <block id="beeb10ceee6c9aabe178fb51edea7d22" category="paragraph">Para um desempenho ideal, o uso de drivers de rede paravirtualizados é fundamental. Quando um datastore é usado, um driver SCSI paravirtualizado é necessário. Um driver de dispositivo paravirtualizado permite que um convidado se integre mais profundamente no hypervisor, em vez de um driver emulado no qual o hypervisor passa mais tempo de CPU imitando o comportamento do hardware físico.</block>
  <block id="7c5996fc15a24ce96b30160b60ac2b96" category="section-title">Sobrecarga da RAM</block>
  <block id="5bccdd812c4af1cb5b9e36ddce656b60" category="paragraph">Overcommit RAM significa configurar mais RAM virtualizada em vários hosts do que existe no hardware físico. Isso pode causar problemas inesperados de desempenho. Ao virtualizar um banco de dados, os blocos subjacentes do Oracle SGA não devem ser trocados pelo hipervisor para storage. Isso causa resultados de desempenho altamente instáveis.</block>
  <block id="8c19dda4c4cab5e52edf9463f196b97d" category="section-title">Striping do datastore</block>
  <block id="8fa77493c52e71f201ccdb67db26446d" category="paragraph">Ao usar bancos de dados com datastores, há um fator crítico a considerar em relação ao desempenho - striping.</block>
  <block id="53ab623a905e6ec84d908f0b99a8d1c8" category="paragraph">As tecnologias de armazenamento de dados, como o VMFS, são capazes de abranger vários LUNs, mas não são dispositivos distribuídos. Os LUNs são concatenados. O resultado final pode ser pontos quentes LUN. Por exemplo, um banco de dados Oracle típico pode ter um grupo de discos ASM de 8 LUN. Todos os 8 LUNs virtualizados podem ser provisionados em um datastore VMFS de 8 LUN, mas não há garantia sobre quais LUNs os dados residirão. A configuração resultante pode ser todo 8 LUN virtualizado ocupando um único LUN dentro do datastore VMFS. Isso se torna um gargalo de desempenho.</block>
  <block id="e6bb99e411f5495b03c1e0a4e75a1434" category="paragraph">Geralmente é necessário riscar. Com alguns hypervisors, incluindo KVM, é possível criar um datastore usando o striping LVM como descrito <block ref="dd0ff2598ebb26feb9ff73a59186b79f" category="inline-link-macro-rx"></block>. Com a VMware, a arquitetura parece um pouco diferente. Cada LUN virtualizado precisa ser colocado em um datastore VMFS diferente.</block>
  <block id="506c2c0c7f5b70af3df68c45c46f45a7" category="paragraph">Por exemplo:</block>
  <block id="6ec151851a31c86edd358bc49f80908c" category="paragraph"><block ref="6ec151851a31c86edd358bc49f80908c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="70ff2667d6b190dea65bae42217aa310" category="paragraph">O driver principal para essa abordagem não é o ONTAP, é devido à limitação inerente do número de operações que uma única VM ou LUN de hipervisor pode servir em paralelo. Um único LUN de ONTAP geralmente suporta muito mais IOPS do que um host pode solicitar. O limite de desempenho de LUN único é quase universalmente um resultado do sistema operacional do host. Assim, a maioria dos bancos de dados precisa de 4 a 8 LUNs para atender às suas necessidades de performance.</block>
  <block id="59f9d8d1b212a8ff6bd3476975e17620" category="paragraph">As arquiteturas VMware precisam Planejar suas arquiteturas cuidadosamente para garantir que as máximas de armazenamento de dados e/ou caminho LUN não sejam encontradas com essa abordagem. Addtionally, não há nenhum requisito para um conjunto exclusivo de armazenamentos de dados VMFS para cada banco de dados. A principal necessidade é garantir que cada host tenha um conjunto limpo de 4-8 caminhos de e/S, desde os LUNs virtualizados até os LUNs de back-end no próprio sistema de storage. Em raras ocasiões, ainda mais datadores podem ser benéficos para demandas de desempenho verdadeiramente extremas, mas 4-8 LUNs geralmente são suficientes para 95% de todos os bancos de dados. Um único volume ONTAP contendo 8 LUNs pode suportar até 250.000 IOPS de bloco Oracle aleatório com uma configuração típica de os/ONTAP/rede.</block>
  <block id="2c8c2171fc87c96e58fb40d8714f85cf" category="summary">Arquitetura PostgreSQL</block>
  <block id="ee62b4420d426c21a46d892ac084872a" category="paragraph">PostgreSQL é um RDBMS baseado na arquitetura cliente e servidor. Uma instância do PostgreSQL é conhecida como um cluster de banco de dados, que é uma coleção de bancos de dados em vez de uma coleção de servidores.</block>
  <block id="89c30c326e106773af32af40255b92a8" category="inline-image-macro">Erro: Gráfico não encontrado</block>
  <block id="d8299d00f914e35b80644e5781e47a77" category="paragraph"><block ref="d8299d00f914e35b80644e5781e47a77" category="inline-image-macro-rx" type="image"></block></block>
  <block id="54c2dd41fd1ad3efa25e80bee0bae549" category="paragraph">Há três elementos principais em um banco de dados PostgreSQL: O postmaster, o front-end (cliente) e o back-end O cliente envia solicitações para o postmaster com informações como protocolo IP e a que banco de dados se conetar. O postmaster autentica a conexão e a passa para o processo de back-end para comunicação adicional. O processo back-end executa a consulta e envia resultados diretamente para o front-end (cliente).</block>
  <block id="9f96e07bbaf7c0237047d6d0f95301a8" category="paragraph">Uma instância do PostgreSQL é baseada em um modelo multiprocesso em vez de um modelo multithread. Ele gera vários processos para diferentes trabalhos, e cada processo tem sua própria funcionalidade. Os principais processos incluem o processo do cliente, o processo do escritor DE WAL, o processo do escritor de fundo, e o processo do checkpointer:</block>
  <block id="6aebf901bd4be26a765c56e4133b3798" category="list-text">Quando um processo de cliente (primeiro plano) envia solicitações de leitura ou gravação para a instância do PostgreSQL, ele não lê ou grava dados diretamente no disco. Primeiro, ele armazena os dados em buffers compartilhados e buffers de log write-ahead (WAL).</block>
  <block id="458239ee6c634dc5fef96f9dfab275f0" category="list-text">Um processo de escritor WAL manipula o conteúdo dos buffers compartilhados e buffers WAL para escrever nos logs DO WAL. Os logs WAL são normalmente Registros de transações do PostgreSQL e são sequencialmente escritos. Portanto, para melhorar o tempo de resposta do banco de dados, o PostgreSQL primeiro grava nos logs de transação e reconhece o cliente.</block>
  <block id="9ec2999256fe568cd596b42e7da2cc39" category="list-text">Para colocar o banco de dados em um estado consistente, o processo de gravação em segundo plano verifica o buffer compartilhado periodicamente para páginas sujas. Em seguida, ele limpa os dados para os arquivos de dados armazenados em volumes NetApp ou LUNs.</block>
  <block id="5c852dd8ba7215c01dfde8e98f6c46c6" category="list-text">O processo de checkpointer também é executado periodicamente (com menos frequência do que o processo em segundo plano) e impede qualquer modificação nos buffers. Ele sinaliza para o processo de gravação WAL para escrever e lavar o Registro do ponto de verificação para o final dos logs DO WAL que são armazenados no disco NetApp. Ele também sinaliza o processo de gravação em segundo plano para escrever e lavar todas as páginas sujas para o disco.</block>
  <block id="97b4cda00dd31f5be69440f48c4da149" category="summary">Configuração de banco de dados PostgreSQL com ONTAP</block>
  <block id="8daf26b2c72dd18a89fa89a6b1aa988d" category="paragraph">Existem várias configurações de ajuste do PostgreSQL que podem melhorar o desempenho.</block>
  <block id="abb3dae412afe5c801e9ab90de71675b" category="paragraph">Os parâmetros mais utilizados são os seguintes:</block>
  <block id="bfdf741f4acb3dfee6e87075b535610e" category="list-text"><block ref="39d79378db03fed7c5ba62efba38e327" prefix="" category="inline-code"></block>: O número máximo de conexões de banco de dados a ter ao mesmo tempo. Use este parâmetro para restringir a troca para o disco e eliminar o desempenho. Dependendo do requisito do aplicativo, você também pode ajustar esse parâmetro para as configurações do pool de conexões.</block>
  <block id="9625e1a6f5d1f695fd1c72401afaa07e" category="list-text"><block ref="904d399f43708a8a5b6d10c1ee3f8356" prefix="" category="inline-code"></block>: O método mais simples para melhorar o desempenho do seu servidor de banco de dados. O padrão é baixo para a maioria dos hardwares modernos. Ele é definido durante a implantação para aproximadamente 25% da RAM disponível no sistema. Essa configuração de parâmetro varia dependendo de como ele funciona com instâncias de banco de dados específicas; você pode ter que aumentar e diminuir os valores por tentativa e erro. No entanto, a configuração alta pode degradar o desempenho.</block>
  <block id="d1960c56572383fc401fec3f0b767cf9" category="list-text"><block ref="5edeed59821790d8bec6d32da26bca4c" prefix="" category="inline-code"></block>: Este valor diz ao otimizador do PostgreSQL quanta memória o PostgreSQL tem disponível para armazenar dados em cache e ajuda a determinar se deve usar um índice. Um valor maior aumenta a probabilidade de usar um índice. Este parâmetro deve ser definido para a quantidade de memória alocada para<block ref="e15ed0f69e5c2475450b97691d6a2cee" prefix=" " category="inline-code"></block> mais a quantidade de cache de SO disponível. Muitas vezes, esse valor é mais de 50% da memória total do sistema.</block>
  <block id="508df54f84fc7abb00f3a92937ca3506" category="list-text"><block ref="1edef4d43b06d4deb28010505df5724d" prefix="" category="inline-code"></block>: Este parâmetro controla a quantidade de memória a ser usada em operações de classificação e tabelas de hash. Se você fizer uma classificação pesada em seu aplicativo, talvez seja necessário aumentar a quantidade de memória, mas tenha cuidado. Não é um parâmetro amplo do sistema, mas um parâmetro por operação. Se uma consulta complexa tiver várias operações de ordenação nela, ela usará várias unidades de memória work_mem, e vários back-ends poderiam estar fazendo isso simultaneamente. Essa consulta pode muitas vezes levar o servidor de banco de dados a trocar se o valor for muito grande. Essa opção foi anteriormente chamada sort_mem em em versões mais antigas do PostgreSQL.</block>
  <block id="59d9770060aecba84c7e8ed849b5653d" category="list-text"><block ref="65768448b4f275b95af20a317c7355a9" prefix="" category="inline-code"></block>: Este parâmetro determina se todas as suas páginas WAL devem ser sincronizadas com o disco usando fsync() antes que uma transação seja confirmada. Desligá-lo às vezes pode melhorar o desempenho de gravação e ativá-lo aumenta a proteção contra o risco de corrupção quando o sistema trava.</block>
  <block id="625a65dd6cef83bac66319bde3894899" category="list-text"><block ref="ff5a06a39dd6824f30a778a51cf7ea69" prefix="" category="inline-code"></block>: O processo de checkpoint elimina dados comprometidos no disco. Isso envolve muitas operações de leitura/gravação no disco. O valor é definido em segundos e valores mais baixos diminuem o tempo de recuperação de falhas e o aumento de valores pode reduzir a carga nos recursos do sistema reduzindo as chamadas de ponto de verificação. Dependendo da criticidade do aplicativo, uso, disponibilidade do banco de dados, defina o valor de checkpoint_timeout.</block>
  <block id="309b1036c45e7ad490448925dc4f9597" category="list-text"><block ref="6a5c0586429891e84e05d6ab15088405" prefix="" category="inline-code"></block> E<block ref="9080796d32078fea7d191100eab64f92" prefix=" " category="inline-code"></block>: essas opções são usadas em conjunto para ajudar a melhorar o desempenho, escrevendo várias transações que estão cometendo de uma só vez. Se houver vários objetos commit_siblings ativos no momento em que a transação está sendo feita, o servidor aguarda por commit_delay microssegundos para tentar cometer várias transações de uma só vez.</block>
  <block id="8d5137ce002c6328c2b5f4f328662e1d" category="list-text"><block ref="fa4ca2cd95c20a44171f964fb8f5fdb9" prefix="" category="inline-code"></block>: Configurar o número ideal de trabalhadores para processos. Max_Parallel_workers corresponde ao número de CPUs disponíveis. Dependendo do design do aplicativo, as consultas podem exigir um número menor de trabalhadores para operações paralelas. É melhor manter o valor para ambos os parâmetros o mesmo, mas ajustar o valor após o teste.</block>
  <block id="c8736e7ca19e9096796c624f3030dae5" category="list-text"><block ref="8dda85a5feb6de66d8f5f9a4cbdb0754" prefix="" category="inline-code"></block>: Este valor controla a forma como o PostgreSQL visualiza leituras de discos não sequenciais. Um valor maior significa que o PostgreSQL é mais provável de usar uma varredura sequencial em vez de uma varredura de índice, indicando que seu servidor tem discos rápidos Modificar esta configuração depois de avaliar outras opções como otimização baseada em plano, aspiração, indexação para alterar consultas ou esquema.</block>
  <block id="17edf3863f12b7d9480b3336a9fca773" category="list-text"><block ref="709989c844c22473cb8406550423d39a" prefix="" category="inline-code"></block>: Este parâmetro define o número de operações de e/S de disco simultâneas que o PostgreSQL tenta executar simultaneamente. Aumentar esse valor aumenta o número de operações de e/S que qualquer sessão individual do PostgreSQL tenta iniciar em paralelo. O intervalo permitido é de 1 a 1.000, ou zero para desativar a emissão de solicitações de e/S assíncronas. Atualmente, essa configuração afeta somente digitalizações de heap bitmap. As unidades de estado sólido (SSDs) e outro storage baseado em memória (NVMe) costumam processar muitas solicitações simultâneas. Assim, o melhor valor pode ser nas centenas.</block>
  <block id="82b38edb10ad73f9645c5d65e73a659b" category="paragraph">Consulte a documentação do PostgreSQL para obter uma lista completa dos parâmetros de configuração do PostgreSQL.</block>
  <block id="402fbc243dbef50cd5c8e57ccbdd92f5" category="section-title">BRINDE</block>
  <block id="0d2b62abb26bd0b4109f5bc967250933" category="paragraph">TOAST representa a técnica de armazenamento de atributos oversized. PostgreSQL usa um tamanho de página fixo (geralmente 8KB) e não permite que tuplas abranjam várias páginas. Portanto, não é possível armazenar grandes valores de campo diretamente. Quando você tenta armazenar uma linha que excede esse tamanho, O TOAST divide os dados de colunas grandes em "pedaços" menores e os armazena em uma MESA DE BRINDE.</block>
  <block id="3f11f21bdc22c3c955c3f0fca39e9bc0" category="paragraph">Os grandes valores dos atributos tostados são retirados (se selecionados) apenas no momento em que o conjunto de resultados é enviado ao cliente. A tabela em si é muito menor e pode caber mais linhas no cache de buffer compartilhado do que poderia sem qualquer armazenamento fora de linha (TOAST).</block>
  <block id="9a311ef6dad816cb7a15c0ab41920ad8" category="section-title">VÁCUO</block>
  <block id="385e23b8ebe64dfd0005f6846cc8e85e" category="paragraph">Na operação normal do PostgreSQL, tuplas que são excluídas ou tornadas obsoletas por uma atualização não são removidas fisicamente de sua tabela; elas permanecem presentes até que O VÁCUO seja executado. Portanto, você deve executar O VÁCUO periodicamente, especialmente em tabelas atualizadas com frequência. O espaço que ocupa deve ser recuperado para reutilização por novas linhas, para evitar a interrupção do espaço em disco. No entanto, ele não retorna o espaço para o sistema operacional.</block>
  <block id="db81319c35b48ed94867775a9a1ce1d7" category="paragraph">O espaço livre dentro de uma página não é fragmentado. VACUUM reescreve todo o bloco, empacotando eficientemente as linhas restantes e deixando um único bloco contíguo de espaço livre em uma página.</block>
  <block id="8a5c17164c9920590fc057ee01f2fcb3" category="paragraph">Em contraste, O VACUUM FULL compacta ativamente as tabelas escrevendo uma versão completamente nova do arquivo de tabela sem espaço morto. Esta ação minimiza o tamanho da mesa, mas pode levar muito tempo. Ele também requer espaço em disco extra para a nova cópia da tabela até que a operação seja concluída. O objetivo do VÁCUO de rotina é evitar a atividade TOTAL DO VÁCUO. Este processo não só mantém as tabelas em seu tamanho mínimo, mas também mantém o uso em estado estável do espaço em disco.</block>
  <block id="29e2aec511a8e307ecceacbd86c22f14" category="summary">Parâmetros de inicialização do PostgreSQL</block>
  <block id="f4f9dac58f7c47e819293af5f2dd1177" category="paragraph">Você cria um novo cluster de banco de dados usando o<block ref="abc91e782cd3950bfa31202aff74ca69" prefix=" " category="inline-code"></block> programa. <block ref="abc91e782cd3950bfa31202aff74ca69" prefix=" " category="inline-code"></block>Um script cria os arquivos de dados, tabelas do sistema e bancos de dados de modelos (template0 e template1) que definem o cluster.</block>
  <block id="b668460552732302350bbb840d57931c" category="paragraph">A base de dados de modelos representa uma base de dados de stock. Ele contém definições para tabelas de sistema, exibições padrão, funções e tipos de dados.<block ref="3865cf98fe802a965570b4a10a1d894b" prefix=" " category="inline-code"></block> atua como um argumento para o<block ref="abc91e782cd3950bfa31202aff74ca69" prefix=" " category="inline-code"></block> script que especifica a localização do cluster do banco de dados.</block>
  <block id="8fcd14822a5b94d212898fe3e006526e" category="paragraph">Todos os objetos de banco de dados no PostgreSQL são gerenciados internamente pelos respetivos OIDs. Tabelas e índices também são gerenciados por OIDs individuais. As relações entre objetos de banco de dados e seus respetivos OIDs são armazenadas em tabelas de catálogo de sistema apropriadas, dependendo do tipo de objeto. Por exemplo, OIDs de bancos de dados e tabelas de heap são armazenados em<block ref="d0fcebb608269edbd5d67486884ebed7" prefix=" " category="inline-code"></block> e 'pg_class, respetivamente. Você pode determinar os OIDs emitindo consultas no cliente PostgreSQL.</block>
  <block id="d0e97e34fe92edd2facd0f7377b6340b" category="paragraph">Cada banco de dados tem suas próprias tabelas individuais e arquivos de índice que são restritos a 1GB. Cada tabela tem dois arquivos associados, sufixos respetivamente com<block ref="7b9b00c45b01f7b7c6d3a3c8ba2e9275" prefix=" " category="inline-code"></block> e<block ref="a1d869a79e2f43693a6a416fcbdc2724" prefix=" " category="inline-code"></block>. Eles são referidos como o mapa de espaço livre e o mapa de visibilidade. Esses arquivos armazenam as informações sobre a capacidade de espaço livre e têm visibilidade em cada página no arquivo de tabela. Os índices têm apenas mapas de espaço livre individuais e não têm mapas de visibilidade.</block>
  <block id="048a7ed79caf84bb5c725efc5f474911" category="paragraph">O<block ref="c28f4f32219f5ff99fb4b116980b8549" prefix=" " category="inline-code"></block> diretório contém os registos de escrita antecipada. Os logs write-ahead são usados para melhorar a confiabilidade e o desempenho do banco de dados. Sempre que você atualizar uma linha em uma tabela, o PostgreSQL primeiro grava a alteração no log write-ahead e, mais tarde, grava as modificações nas páginas de dados reais em um disco. O<block ref="f7223cfaa9416056a91e259e326ac5cf" prefix=" " category="inline-code"></block> diretório geralmente contém vários arquivos, mas initdb cria apenas o primeiro. Arquivos extras são adicionados conforme necessário. Cada arquivo xlog tem 16MBcm de comprimento.</block>
  <block id="6cabd4dcf3582d38c441228705da3bda" category="doc">Proteção de dados PostgreSQL</block>
  <block id="31c6611c8e0bd237a3ee51db1728a440" category="paragraph">Um dos principais aspetos do design de armazenamento é habilitar a proteção para volumes PostgreSQL. Os clientes podem proteger seus bancos de dados PostgreSQL usando a abordagem dump ou usando backups do sistema de arquivos. Esta seção explica as diferentes abordagens de backup de bancos de dados individuais ou de todo o cluster.</block>
  <block id="9f3265914462c64fd02bc50ab4c9ebe9" category="paragraph">Existem três abordagens para fazer backup de dados PostgreSQL:</block>
  <block id="6b592c7950245a5a9f54d9424e851e97" category="list-text">Despejo do SQL Server</block>
  <block id="c8b1fc69d12d1da6589e384671c8e82c" category="list-text">Backup no nível do sistema de arquivo</block>
  <block id="3c25062a0babfa1495dd604698707610" category="list-text">Arquivamento contínuo</block>
  <block id="58c132e2be12705408a7456c6183b617" category="paragraph">A ideia por trás do método de despejo do SQL Server é gerar um arquivo com comandos do SQL Server que, quando retornados ao servidor, pode recriar o banco de dados como era no momento do despejo. PostgreSQL fornece os programas utilitários<block ref="5a5149b2817f30cbb3805307f9cadae4" prefix=" " category="inline-code"></block> e<block ref="0ead269b3d000482b5a44a1ef4e8cd54" prefix=" " category="inline-code"></block> para criar backup individual e em nível de cluster. Esses despejos são lógicos e não contêm informações suficientes para serem usados pelo replay WAL.</block>
  <block id="1d05b80fc6f199681263e063190e8325" category="paragraph">Uma estratégia alternativa de backup é usar o backup em nível de sistema de arquivos, no qual os administradores copiam diretamente os arquivos que o PostgreSQL usa para armazenar os dados no banco de dados. Este método é feito no modo offline: O banco de dados ou cluster deve ser desligado. Outra alternativa é usar<block ref="35679fc424d9eec0c30f38459fd9b322" prefix=" " category="inline-code"></block> para executar o backup de streaming quente do banco de dados PostgreSQL.</block>
  <block id="b0792163c858a7c221b236d84619b5ef" category="summary">Bancos de dados PostgreSQL NFS com ONTAP</block>
  <block id="189950ed46e5e8b7e92941531a5bb88b" category="doc">Bancos de dados PostgreSQL com sistemas de arquivos NFS</block>
  <block id="f7cc8c4234952826818ad4d0c2050ac9" category="paragraph">Os bancos de dados PostgreSQL podem ser hospedados em sistemas de arquivos NFSv3 ou NFSv4. A melhor opção depende de fatores fora do banco de dados.</block>
  <block id="1482c42acc1dd31ee8496c71a805e73c" category="paragraph">Por exemplo, o comportamento de bloqueio NFSv4D pode ser preferível em determinados ambientes em cluster. (<block ref="bc3a7e667477b8b3590fa1451dcb924c" category="inline-link-macro-rx"></block>Consulte para obter detalhes adicionais)</block>
  <block id="9674525687765646f35916d0e569eda9" category="paragraph">A funcionalidade do banco de dados deve estar próxima da mesma, incluindo o desempenho. O único requisito é o uso da<block ref="d64a84456adc959f56de6af685d0dadd" prefix=" " category="inline-code"></block> opção de montagem. Isso é necessário para garantir que os tempos limite flexíveis não produzam erros de e/S irrecuperáveis.</block>
  <block id="0c6430fad6c643c444b5d6d52b18edb4" category="paragraph">Se NFSv4 for escolhido como um protocolo, a NetApp recomenda o uso de NFSv4,1. Há algumas melhorias funcionais no protocolo NFSv4 em NFSv4,1 que aumentam a resiliência em relação a NFSv4,0.</block>
  <block id="248212b04c23627e2719e106224d2eb3" category="paragraph">Use as seguintes opções de montagem para cargas de trabalho gerais de banco de dados:</block>
  <block id="b39c0496b44447232912303246b46aaa" category="paragraph">Se for esperado uma e/S sequencial grande, os tamanhos de transferência NFS podem ser aumentados conforme descrito na seção a seguir.</block>
  <block id="dee28dd6d1a9ef7bf399f642fd9d588f" category="section-title">Tamanhos de transferência NFS</block>
  <block id="9efbdff43e91279291e95690414bec95" category="paragraph">Uma vez que o tamanho da transferência é aumentado no nível ONTAP, as seguintes opções de montagem seriam usadas:</block>
  <block id="395201f6a339cc4cf6b345e0c259f383" category="section-title">NFSv3 Tabelas de slot TCP</block>
  <block id="1f8260aa2c5a5b35bf771c26828d2096" category="paragraph">Se NFSv3 for usado com Linux, é fundamental definir corretamente as tabelas de slot TCP.</block>
  <block id="3493794b3ccb587f71a663f51f4484ef" category="summary">Bancos de dados PostgreSQL no ONTAP</block>
  <block id="10907e7ac5ab6e5235a23898a2331b31" category="doc">Bancos de dados PostgreSQL no ONTAP</block>
  <block id="93fbb268e5e551ae95265cfe3b3b6c7a" category="paragraph">PostgreSQL vem com variantes que incluem PostgreSQL, PostgreSQL Plus e EDB Postgres Advanced Server (EPAS). O PostgreSQL é normalmente implantado como banco de dados back-end para aplicativos de várias camadas. Ele é suportado por pacotes de middleware comuns (como PHP, Java, Python, Tcl/Tk, ODBC e JDBC) e tem sido historicamente uma escolha popular para sistemas de gerenciamento de banco de dados de código aberto. O ONTAP é uma excelente escolha para executar bancos de dados PostgreSQL de acordo com sua confiabilidade, alto desempenho e recursos eficientes de gerenciamento de dados.</block>
  <block id="841a21e58e7c22a71c07b89a4362d2b6" category="admonition">Esta documentação sobre o ONTAP e o banco de dados PostgreSQL substitui o banco de dados _TR-4770: PostgreSQL publicado anteriormente sobre as melhores práticas do ONTAP._</block>
  <block id="3403aac944f3cb6e2d2c7f7d52bc44b9" category="paragraph">À medida que os dados crescem exponencialmente, o gerenciamento de dados se torna mais complexo para as empresas. Essa complexidade aumenta os custos de licenciamento, operação, suporte e manutenção. Para reduzir o TCO geral, considere mudar de bancos de dados comerciais para de código aberto com armazenamento de back-end confiável e de alto desempenho.</block>
  <block id="dcac08882e3396bd30210108baa1641d" category="paragraph">O ONTAP é uma plataforma ideal porque o ONTAP é literalmente projetado para bancos de dados. Vários recursos, como otimizações aleatórias de latência de e/S para qualidade avançada de serviço (QoS) e funcionalidade básica do FlexClone, foram criados especificamente para atender às necessidades dos workloads de banco de dados.</block>
  <block id="8df3fb35ff15e02683bfb1bc7f852c93" category="paragraph">Mais importante ainda, o ONTAP oferece desempenho incomparável com a capacidade de dimensionar a solução para suas necessidades exclusivas. Nossos sistemas high-end podem fornecer mais de 1M IOPS com latências medidas em microssegundos. No entanto, se você só precisa de 100K IOPS, pode redimensionar sua solução de storage com uma controladora menor que ainda executa o mesmo sistema operacional de storage.</block>
  <block id="3106f8f17f2974fe05da16fb0cc50505" category="summary">Bancos de dados PostgreSQL com SAN no ONTAP</block>
  <block id="74cacb0c34a37e2859e3b054938a344d" category="doc">PostgreSQL com sistemas de arquivos SAN</block>
  <block id="1758f5c81d60f1a0ac8600fddc99a919" category="paragraph">Os bancos de dados PostgreSQL com SAN geralmente são hospedados em sistemas de arquivos xfs, mas outros podem ser usados se suportados pelo fornecedor do sistema operacional</block>
  <block id="d73e7b56b7baa813a32c521ca074e7c4" category="paragraph">Embora um único LUN possa geralmente suportar até 100K IOPS, os bancos de dados com uso intenso de e/S geralmente exigem o uso de LVM com striping.</block>
  <block id="c3f378ef942f6bf228a43aaacc628fea" category="section-title">LVM Striping</block>
  <block id="20d0e2519b3555a0a2927c8914c17280" category="summary">Software de proteção de dados PostgreSQL</block>
  <block id="e265011e47d11db43ee112fd2fdc9d5b" category="paragraph">O plugin NetApp SnapCenter para banco de dados PostgreSQL, combinado com as tecnologias Snapshot e NetApp FlexClone, oferece benefícios como:</block>
  <block id="4dcdaba06a92b8fecfdc823643a71723" category="list-text">Backup e restauração rápidos.</block>
  <block id="aee746a577a1baebdc33197fb5f3a279" category="list-text">Clones com uso eficiente de espaço.</block>
  <block id="b96bb0cd2ebc0389b6670602ac80d983" category="list-text">A capacidade de construir um sistema de recuperação de desastres rápido e eficaz.</block>
  <block id="9e060ad00fced94f2616dd71fbc49f76" category="paragraph">Você pode preferir escolher os parceiros premium de backup da NetApp, como o Veeam Software e a CommVault, nas seguintes circunstâncias:</block>
  <block id="0ee17b3b55ea2b0af3d90985bc347775" category="list-text">Gerenciamento de workloads em um ambiente heterogêneo</block>
  <block id="88fbde7bbe0274fbe9e7ce01c563d03c" category="list-text">Armazenamento de backups na nuvem ou em fita para retenção de longo prazo</block>
  <block id="445e3e0cce7f959696dde65b3be27843" category="list-text">Suporte para uma ampla gama de versões e tipos de SO</block>
  <block id="21c5d67cc22beaf7d7c9c84c8deaabbe" category="paragraph">O plugin SnapCenter para PostgreSQL é um plugin compatível com a comunidade e a configuração e documentação estão disponíveis na loja de automação NetApp. Com o SnapCenter, o usuário pode fazer backup do banco de dados, clonar e restaurar dados remotamente.</block>
  <block id="c4f52498c0db572381512887d7584e53" category="summary">Bancos de dados PostgreSQL e snapshots de armazenamento</block>
  <block id="0b9d99167191c5d9ad23ca07bc6a9b38" category="paragraph">Os backups baseados em snapshot com PostgreSQL exigem a configuração de snapshots para datafiles, arquivos WAL e ARQUIVOS WAL arquivados para fornecer recuperação completa ou pontual.</block>
  <block id="8c6a53edc4449a4cc3983d47ecffa851" category="paragraph">Para bancos de dados PostgreSQL, o tempo médio de backup com snapshots está no intervalo de alguns segundos a alguns minutos. Essa velocidade de backup é 60 a 100 vezes mais rápida do que<block ref="35679fc424d9eec0c30f38459fd9b322" prefix=" " category="inline-code"></block> outras abordagens de backup baseadas no sistema de arquivos.</block>
  <block id="c798632224ae09152f66f60e0edc757e" category="paragraph">Os snapshots no storage do NetApp podem ser consistentes com falhas e com aplicações. Um snapshot consistente com falhas é criado no storage sem silenciar o banco de dados, enquanto um snapshot consistente com aplicativos é criado enquanto o banco de dados está no modo de backup. O NetApp também garante que os snapshots subsequentes sejam backups incrementais para sempre, a fim de promover a economia de storage e a eficiência da rede.</block>
  <block id="d0e369216eeac8de66e915909364970a" category="paragraph">Como os snapshots são rápidos e não afetam o desempenho do sistema, você pode agendar vários snapshots diariamente em vez de criar um único backup diário, como acontece com outras tecnologias de backup de streaming. Quando uma operação de restauração e recuperação é necessária, o tempo de inatividade do sistema é reduzido por dois recursos principais:</block>
  <block id="316eb8adba4d16a34c92eaf9db381b9e" category="list-text">A tecnologia de recuperação de dados NetApp SnapRestore significa que a operação de restauração é executada em segundos.</block>
  <block id="c128c475c12703e37685edd6db8144bc" category="list-text">Objetivos agressivos do ponto de restauração (RPOs) significam que menos logs do banco de dados devem ser aplicados e a recuperação avançada também é acelerada.</block>
  <block id="9b9f26085ff7149d4dbb916b1db0f121" category="paragraph">Para fazer backup do PostgreSQL, você deve garantir que os volumes de dados sejam protegidos simultaneamente com O WAL (Consistency-group) e os logs arquivados. Enquanto você estiver usando a tecnologia Snapshot para copiar ARQUIVOS WAL, certifique-se de executar<block ref="a3b8c8ee15ba60bfb2b999195d2b4e7d" prefix=" " category="inline-code"></block> para liberar todas as entradas WAL que devem ser arquivadas. Se você lavar as ENTRADAS WAL durante a restauração, precisará apenas parar o banco de dados, desmontar ou excluir o diretório de dados existente e executar uma operação SnapRestore no armazenamento. Depois que a restauração for concluída, você pode montar o sistema e trazê-lo de volta ao seu estado atual. Para recuperação pontual, você também pode restaurar logs DO WAL e do arquivo; em seguida, o PostgreSQL decide o ponto mais consistente e recupera-o automaticamente.</block>
  <block id="8e8d6187572eace409fee5bf2dbb7cf9" category="paragraph">Os grupos de consistência são um recurso no ONTAP e são recomendados quando há vários volumes montados em uma única instância ou em um banco de dados com vários espaços de tabela. Um snapshot de grupo de consistência garante que todos os volumes sejam agrupados e protegidos. Um grupo de consistência pode ser gerenciado de forma eficiente a partir do Gerenciador de sistemas do ONTAP e até mesmo cloná-lo para criar uma cópia de instância de um banco de dados para fins de teste ou desenvolvimento.</block>
  <block id="383a6a5241ecfc558b9fec1d7cff5239" category="summary">PostgreSQL tablespaces</block>
  <block id="d6d544de56c329d9f68bb176c6245e7c" category="paragraph">Dois espaços de tablespaces são criados automaticamente quando o cluster de banco de dados é inicializado.</block>
  <block id="6df924905e21856e4e8b8f936767cdd6" category="paragraph">O<block ref="bd676cbef0d168a62a062c8709af1824" prefix=" " category="inline-code"></block> espaço de tabela é usado para catálogos de sistemas compartilhados. O<block ref="3224684b8e7208962a73daeb0bb24110" prefix=" " category="inline-code"></block> espaço de tabela é o espaço de tabela padrão dos bancos de dados template1 e template0. Se a partição ou o volume em que o cluster foi inicializado ficar sem espaço e não puder ser estendido, um espaço de tabela pode ser criado em uma partição diferente e usado até que o sistema possa ser reconfigurado.</block>
  <block id="364c9d7b9593277eee9477befaf9f66b" category="paragraph">Um índice que é muito usado pode ser colocado em um disco rápido e altamente disponível, como um dispositivo de estado sólido. Além disso, uma tabela que armazena dados arquivados que raramente são usados ou não críticos ao desempenho pode ser armazenada em um sistema de disco mais lento e menos caro, como unidades SAS ou SATA.</block>
  <block id="9bfe8d8e1117bd1d4b8597220e3f166e" category="paragraph">As tablespaces são uma parte do cluster do banco de dados e não podem ser tratadas como uma coleção autônoma de arquivos de dados. Eles dependem dos metadados contidos no diretório de dados principal e, portanto, não podem ser anexados a um cluster de banco de dados diferente ou fazer backup individualmente. Da mesma forma, se você perder um espaço de tabela (por meio da exclusão de arquivos, falha de disco, etc.), o cluster do banco de dados pode se tornar ilegível ou incapaz de iniciar. Colocar um espaço de tabela em um sistema de arquivos temporário como um disco RAM corre o risco de a confiabilidade de todo o cluster.</block>
  <block id="7d9573b1ed3543ec6ea42c81830dc27c" category="paragraph">Depois que ele é criado, um espaço de tabela pode ser usado a partir de qualquer banco de dados se o usuário solicitante tiver Privileges suficiente. PostgreSQL usa links simbólicos para simplificar a implementação de espaços de tabela. O PostgreSQL adiciona uma linha à<block ref="4a926dc6e7549c49a13755513af41e67" prefix=" " category="inline-code"></block> tabela (uma tabela abrangente) e atribui um novo identificador de objeto (OID) a essa linha. Finalmente, o servidor usa o OID para criar um link simbólico entre o cluster e o diretório fornecido. O diretório<block ref="8e3da386e945c59fb1e1cd1d7a47697c" prefix=" " category="inline-code"></block> contém links simbólicos que apontam para cada um dos espaços de tablespaces não incorporados definidos no cluster.</block>
  <block id="7d334ca369e4a752ec91b1503183f0ed" category="summary">Soluções para SAP HANA e AnyDB</block>
  <block id="1ac73696f4529e3901b0d4e5430365cb" category="doc">SAP HANA e SAP com AnyDB</block>
  <block id="2c1b27a986b5e37a810d61f72b23ee4b" category="paragraph">As práticas recomendadas para configuração, gerenciamento e automação de soluções SAP podem ser encontradas na página soluções SAP da NetApp.</block>
  <block id="ee1e67308b27672a8f54eace4c615a98" category="paragraph">Por favor, clique <block ref="c95e4a3e1de9e00fefc4bf8a7ce42893" category="inline-link-macro-rx"></block> para mais.</block>
  <block id="ff1d278a485c443dc5d8fc9f10f1a702" category="doc">NetApp HCI para infraestrutura de desktop virtual com o VMware Horizon 7 - capacite seus usuários avançados com gráficos 3DD.</block>
  <block id="e3162938e0d7b1bbc74111cc5b5871c5" category="paragraph">O TR-4792 fornece orientação sobre o uso do nó de computação NetApp H615C para cargas de trabalho gráficas 3D em um ambiente VMware Horizon equipado com unidades de processamento gráfico (GPUs) da NVIDIA e software de virtualização. Também fornece os resultados dos testes preliminares do SPECviewperf 13 para o H615C.</block>
  <block id="1de37c09602b46db5de57a946efe2768" category="paragraph"><block ref="1de37c09602b46db5de57a946efe2768" category="inline-link-macro-rx"></block></block>
  <block id="43d609906e5ac2fd9406eddd67d6f82a" category="summary">Guia de fortalecimento da segurança para ferramentas do ONTAP para VMware vSphere, pontos de acesso do usuário.</block>
  <block id="c015e2af845448c5e88873c4e51c8cac" category="paragraph">A instalação das Ferramentas do ONTAP para VMware vSphere cria e usa três tipos de usuários:</block>
  <block id="6399e228248ba3e1f084750197938b67" category="list-text">Usuário do sistema: A conta de usuário raiz</block>
  <block id="2a408bd40a0a3130a390340955a699ef" category="list-text">Usuário do aplicativo: O usuário administrador, usuário de manutenção e contas de usuário de banco de dados</block>
  <block id="5d212a60c02bc59306c8863b31342276" category="list-text">Usuário de suporte: A conta de usuário diag</block>
  <block id="3c2b7b0ce42bb5eb8141643a9729f4ee" category="section-title">1. Utilizador do sistema</block>
  <block id="b277c4882e7365ab0ac88d56cd6154b3" category="paragraph">O usuário System(root) é criado pela instalação de ferramentas ONTAP no sistema operacional subjacente (Debian).</block>
  <block id="155b9191864da17a7eaaf07b64d596d8" category="list-text">Um usuário padrão do sistema "root" é criado no Debian pela instalação de ferramentas do ONTAP. Seu padrão é desabilitado e pode ser habilitado em uma base ad-hoc através do console 'aint'.</block>
  <block id="159efbffccd1957bc8c4c78b2a74c085" category="section-title">2. Utilizador da aplicação</block>
  <block id="170cab8b15d5b37a17e43144afe7308d" category="paragraph">O usuário do aplicativo é nomeado como um usuário local nas ferramentas do ONTAP. Estes são usuários criados no aplicativo de ferramentas do ONTAP. A tabela abaixo lista os tipos de usuários de aplicativos:</block>
  <block id="e01ca242f9b1bef82800de4c209149c7" category="cell">*Usuário*</block>
  <block id="f14c276c07197ebef1394a5a219087a1" category="cell">*Descrição*</block>
  <block id="9eb92414db7b53ac16645af9b0f64e58" category="cell">Usuário Administrador</block>
  <block id="ccf6887baccb4288ae3579b56fac8d2a" category="cell">Ele é criado durante a instalação das ferramentas do ONTAP e o usuário fornece as credenciais ao implantar as ferramentas do ONTAP. Os usuários têm a opção de alterar a 'senha' no console 'não'. A senha expirará em 90 dias e espera-se que os usuários alterem a mesma.</block>
  <block id="55df75b800db0f96de770b3c38f676b4" category="cell">Utilizador de manutenção</block>
  <block id="a2bc121b09cae43d6c478870f5298ae5" category="cell">Ele é criado durante a instalação das ferramentas do ONTAP e o usuário fornece as credenciais ao implantar as ferramentas do ONTAP. Os usuários têm a opção de alterar a 'senha' no console 'não'. Este é um usuário de manutenção e é criado para executar as operações do console de manutenção.</block>
  <block id="b124032a093d41b9efbb43f40c538bcb" category="cell">Utilizador da base de dados</block>
  <block id="86a670227d3e81e8fa34eb4aede3129a" category="section-title">3. Usuário do suporte (usuário diag)</block>
  <block id="e482d8f0e37161e7916c7a78d2cf7210" category="paragraph">Durante a instalação das ferramentas do ONTAP, um usuário de suporte é criado. Esse usuário pode ser usado para acessar as ferramentas do ONTAP em caso de qualquer problema ou falha no servidor e para coletar logs. Por padrão, esse usuário está desativado, mas pode ser habilitado em uma base adhoc através do console 'mint'. É importante notar que este utilizador será automaticamente desativado após um determinado período de tempo.</block>
  <block id="14a73da2f5fe352620bed1b49a3319ed" category="summary">Guia de fortalecimento da segurança para ferramentas do ONTAP para VMware vSphere, proteção de segurança de rede contra ataques dos.</block>
  <block id="8f7e7bd942f453f0550dc4f907e88810" category="paragraph">Por padrão, o número máximo de solicitações simultâneas por usuário é 48. O usuário raiz nas ferramentas do ONTAP pode alterar esse valor dependendo dos requisitos de seu ambiente. *Este valor não deve ser definido para um valor muito alto, pois isso fornece um mecanismo contra ataques de negação de serviço (dos).*</block>
  <block id="99c1088ea27d16b42c6b45d794f59d3f" category="paragraph">Os usuários podem alterar o número máximo de sessões simultâneas e outros parâmetros suportados no arquivo *_/opt/NetApp/vscserver/etc/dosfilterParams.json_*.</block>
  <block id="5e7c907630f5a432ac6b39f0b8c04c28" category="paragraph">Podemos configurar o filtro seguindo os seguintes parâmetros:</block>
  <block id="a35f2f4ccb228969a85b8719ea25b047" category="list-text">*_delayMS_*: O atraso em milissegundos dado a todas as solicitações acima do limite de taxa antes de serem consideradas. Dê -1 apenas para rejeitar o pedido.</block>
  <block id="f1b9d5fde713093a3a80f140d1439d37" category="list-text">*_estrangulems_*: Quanto tempo para sincronizar a espera pelo semáforo.</block>
  <block id="aa363bec6acd7600aedeee5377470bde" category="list-text">*_maxRequestMs_*: Quanto tempo para permitir que essa solicitação seja executada.</block>
  <block id="351b695725caafd647abb749c50a7e6f" category="list-text">*_ipWhitelist_*: Uma lista separada por vírgulas de endereços IP que não serão limitados por taxa. (Isso pode ser vCenter, ESXi e SRA IPs)</block>
  <block id="058e1fe7e6afcd3bcff86482a583976b" category="list-text">*_maxRequestsPerSec_*: O número máximo de solicitações de uma conexão por segundo.</block>
  <block id="1c1496a21f967d57b50fe5ebb0e62125" category="paragraph">*Valores padrão no arquivo _dosfilterParams_:*</block>
  <block id="9d5c13d45bbf74999764cfe8d4798562" category="summary">Guia de fortalecimento da segurança para ferramentas do ONTAP para VMware vSphere, gerenciamento de certificados HTTPS.</block>
  <block id="d6a1787b51b08315bfcc44f3a9bb4b2f" category="paragraph">Por padrão, as ferramentas do ONTAP usam um certificado autoassinado criado automaticamente durante a instalação para proteger o acesso HTTPS à IU da Web. As ferramentas do ONTAP oferecem os seguintes recursos:</block>
  <block id="1eddd0f3479da31541c39e5ddddfa930" category="list-text">Regenere o certificado HTTPS</block>
  <block id="61bf3033b18d202012951f5bf7be4fa9" category="paragraph">Durante a instalação das ferramentas do ONTAP, um certificado de CA HTTPS é instalado e o certificado é armazenado no keystore. O usuário tem a opção de regenerar o certificado HTTPS por meio do console de manutenção.</block>
  <block id="b363a018e3596ec66080579ce5bd4c2d" category="paragraph">As opções acima podem ser acessadas no console _mant_ navegando até _'Application Configuration' → 'Re-Generate certificates'._</block>
  <block id="8f1b6f904292913013b1f6e578d7b074" category="summary">Guia de fortalecimento da segurança para ferramentas do ONTAP para VMware vSphere, verificação de integridade.</block>
  <block id="aeeb9f5277554716592480db544d25f3" category="paragraph">Existem dois métodos disponíveis para os clientes verificarem a integridade de seus pacotes de instalação de ferramentas ONTAP.</block>
  <block id="126ba7383e25522e071a963ddd6f220f" category="list-text">Verificando as somas de verificação</block>
  <block id="deccc645a0c8869a44e645f2f4247dbd" category="list-text">Verificando a assinatura</block>
  <block id="e5f3970dd7fabab1726b53d58d636de2" category="paragraph">As somas de verificação são fornecidas nas páginas de download dos pacotes de instalação do OTV. Os usuários devem verificar as somas de verificação dos pacotes baixados em relação à soma de verificação fornecida na página de download.</block>
  <block id="7452fe022f94726684aeea655673eb0f" category="section-title">Verificando a assinatura das ferramentas ONTAP OVA</block>
  <block id="373d060b52f94a014177952dcca0c4e9" category="paragraph">O pacote de instalação do vApp é entregue na forma de um tarball. Este tarball contém certificados intermediários e raiz para o dispositivo virtual, juntamente com um arquivo README e um pacote OVA. O arquivo README orienta os usuários sobre como verificar a integridade do pacote vApp OVA.</block>
  <block id="48fefdb76906b256f183e6f68b23eba1" category="paragraph">Os clientes também devem fazer o upload do certificado raiz e intermediário fornecido no vCenter versão 7.0U3E e superior. Para versões do vCenter entre 7.0.1 e 7,0.U3E, a funcionalidade de verificação de certificado não é suportada pela VMware. Os clientes não precisam carregar nenhum certificado para o vCenter versões 6.x.</block>
  <block id="84a005842347a9560b170cfcd79c5203" category="section-title">Carregar o certificado raiz confiável para o vCenter</block>
  <block id="57f60da4817dc5d71c45890bb182781e" category="list-text">Faça login com o VMware vSphere Client no vCenter Server.</block>
  <block id="72282f16a7aca6b61acfc6fe27ce55c7" category="list-text">Especifique o nome de usuário e a senha para o administrador ou outro membro do grupo Administradores de logon único do vCenter. Se você especificou um domínio diferente durante a instalação, faça login como administrador.</block>
  <block id="43a75b176810226695d2db6f52c87b73" category="list-text">Se o sistema solicitar, insira as credenciais do vCenter Server.</block>
  <block id="5f51c5b3cb2f48fd1d670bf384d1006d" category="list-text">Em certificados raiz confiáveis, clique em Adicionar.</block>
  <block id="55c3b759c54a437c7ced6432f1c62de0" category="list-text">Clique em Procurar e selecione a localização do ficheiro .pem do certificado (OTV_OVA_INTER_ROOT_CERT_Chain.pem).</block>
  <block id="8acdedaaa4134bb6ae49472b4bc268a7" category="list-text">Clique em Adicionar. O certificado é adicionado à loja.</block>
  <block id="e2200da08ea15bdea0f97dbfc4e9f1c7" category="inline-link-macro">Adicione um certificado raiz confiável ao armazenamento de certificados</block>
  <block id="6eeecddd909e7e017ba2732e46dc739c" category="paragraph"><block ref="b8e45b03638af10d852f253eba7e63e3" category="inline-link-macro-rx"></block>Consulte para obter mais informações. Ao implantar um vApp (usando o arquivo OVA), a assinatura digital do pacote vApp pode ser verificada na página 'Detalhes de revisão'. Se o pacote vApp baixado for original, a coluna 'Publisher' exibe 'certificado confiável' (como na captura de tela a seguir).</block>
  <block id="a13b63a149750821fb588cd3cb41c209" category="inline-image-macro">Certificado confiável</block>
  <block id="a83d8109f7a0cf9c4a04c65c40ecd354" category="paragraph"><block ref="a83d8109f7a0cf9c4a04c65c40ecd354" category="inline-image-macro-rx" type="image"></block></block>
  <block id="61dc5ac976a8bd4a8744d8890305d26e" category="section-title">Verificando a assinatura das ferramentas ONTAP ISO e SRA tar.gz</block>
  <block id="d4f26c1c073b64ba200e3fa71762c256" category="paragraph">A NetApp compartilha seu certificado de assinatura de código com os clientes na página de download do produto, juntamente com os arquivos zip do produto para OTV-ISO e SRA.tgz.</block>
  <block id="a7ac1e7561da5cc70126cfea891de159" category="paragraph">A partir do certificado de assinatura de código, os usuários podem extrair a chave pública como abaixo:</block>
  <block id="5f4345a6f62f7a3926b2c3d92f5574f6" category="paragraph">Em seguida, a chave pública deve ser usada para verificar a assinatura para iso e tgz produto zip como abaixo:</block>
  <block id="81eeab9506186e2dca8faefa78d54067" category="paragraph">Exemplo:</block>
  <block id="f21dd7ffc271f1301878c3078a59692d" category="summary">Guia de fortalecimento da segurança para ferramentas do ONTAP para VMware vSphere, banner de login.</block>
  <block id="4b7ad38343c4b2010cf81e6b2933e186" category="doc">Banner de login</block>
  <block id="ae20daf991a940f9de7033ff0a1af410" category="paragraph">Depois que o usuário concluir o login através do canal SSH, o seguinte texto é exibido:</block>
  <block id="c6666237b03fcb86e315a0a06e73b6ef" category="summary">Guia de fortalecimento da segurança para ferramentas do ONTAP para VMware vSphere, criptografia TLS mútua para conexões de gerenciamento de storage.</block>
  <block id="53893182b7e17fb2da37935ee3ffda55" category="paragraph">As versões 9,7 e posteriores do ONTAP suportam comunicação TLS mútua. A partir das Ferramentas do ONTAP para VMware e vSphere 9,12, o TLS mútuo é usado para comunicação com clusters recém-adicionados (dependendo da versão do ONTAP).</block>
  <block id="1be712dee4c47804142318ffb739e46b" category="paragraph">Para todos os sistemas de armazenamento adicionados anteriormente: Durante uma atualização, todos os sistemas de armazenamento de dados adicionados serão auto-confiáveis e os mecanismos de autenticação baseados em certificado serão configurados.</block>
  <block id="d39adf53eaace0fbba30d4e13760a974" category="paragraph">Como na captura de tela abaixo, a página de configuração do cluster mostrará o status de TLS mútuo (autenticação baseada em certificado), configurado para cada cluster.</block>
  <block id="c036889d83926f57571c8b12e4f7fb6f" category="inline-image-macro">image2mm, largura 468mm, altura 158mm</block>
  <block id="095064767a4b9cadb4016dfc2788237c" category="paragraph"><block ref="095064767a4b9cadb4016dfc2788237c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="53f061d401dd80027634ccca2a19cd8d" category="section-title">*Cluster Add*</block>
  <block id="7ce4b2757e70979f49bcf8f64ba36363" category="paragraph">Durante o fluxo de trabalho de adição de cluster, se o cluster que está sendo adicionado suportar MTLS, o MTLS será configurado por padrão. O usuário não precisa fazer nenhuma configuração para isso. A captura de tela abaixo mostra a tela apresentada ao usuário durante a adição do cluster.</block>
  <block id="3c1556a297200019d3a0b8045c0956b9" category="inline-image-macro">Adicionar sistema de armazenamento, largura de 450mm, altura de 400mm</block>
  <block id="3a225aabc3c5c25670ad0b4d131da24f" category="paragraph"><block ref="3a225aabc3c5c25670ad0b4d131da24f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="987de6e025f6af1fc4451710295ca76f" category="inline-image-macro">Adicionar sistema de armazenamento, largura de 468mm, altura de 416mm</block>
  <block id="576a9128888c73fc82869b3ae173c7d2" category="paragraph"><block ref="576a9128888c73fc82869b3ae173c7d2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="307eba22b8070bb93e642827620f8588" category="paragraph"><block ref="307eba22b8070bb93e642827620f8588" category="inline-image-macro-rx" type="image"></block></block>
  <block id="71cfed326a2cabd3b505c6580123a459" category="inline-image-macro">Adicionar sistema de armazenamento, largura de 468mm, altura de 516mm</block>
  <block id="a3a8f9da50b3f15d69f3186129f159f6" category="paragraph"><block ref="a3a8f9da50b3f15d69f3186129f159f6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3b3ebbeea272602ddec07bb77e34668a" category="section-title">Cluster Edit (Editar cluster)</block>
  <block id="d2562e450657937f981a45d9d18ff4ec" category="paragraph">Durante a operação de edição de cluster, existem dois cenários:</block>
  <block id="500bcb89776517849e2e07073aad4eca" category="list-text">Se o certificado ONTAP expirar, o usuário terá que obter o novo certificado e enviá-lo.</block>
  <block id="edf2227e3378b5b0864ef73e58d39d77" category="list-text">Se o certificado OTV expirar, o usuário pode regenerá-lo marcando a caixa de seleção.</block>
  <block id="6db8cdf80049c7cf629fe6f8f6e3a9c0" category="list-text">_Gerar um novo certificado de cliente para o ONTAP._</block>
  <block id="acba923a9524c642724d6ff34f5dac93" category="inline-image-macro">Modificar o sistema de armazenamento, largura 468, altura 461</block>
  <block id="6a59df9970674c274e20b1d91be2df8a" category="paragraph"><block ref="6a59df9970674c274e20b1d91be2df8a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="75545011d3e6abe8a2cd8cd5bc21c6fd" category="paragraph"><block ref="75545011d3e6abe8a2cd8cd5bc21c6fd" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9afb15056a8bc8b4402d55eba2274dad" category="summary">Guia de fortalecimento da segurança para ferramentas do ONTAP para a configuração do VMware vSphere, NTP.</block>
  <block id="48edbd8a951efb0ad617f7868b27a6c0" category="paragraph">Às vezes, problemas de segurança podem ocorrer devido a discrepâncias nas configurações de tempo de rede. É importante garantir que todos os dispositivos dentro de uma rede tenham configurações de tempo precisas para evitar esses problemas.</block>
  <block id="a55d703ea2930e8e72e94ce11c3297ab" category="section-title">*Virtual Appliance*</block>
  <block id="5a65f4c9ca6d99f573528348d36914fa" category="paragraph">Você pode configurar o(s) servidor(s) NTP a partir do console de manutenção no dispositivo virtual. Os usuários podem adicionar os detalhes do servidor NTP em _Configuração do sistema_&gt; _Adicionar novo servidor NTP_ opção</block>
  <block id="90ab4fc7a1c530bceac36bda71efbc5f" category="paragraph">Por padrão, o serviço para NTP é ntpd. Este é um serviço legado e não funciona bem para máquinas virtuais em certos casos.</block>
  <block id="6801ecdb823d018c7370042d27b5ee2c" category="section-title">*Debian*</block>
  <block id="dc3bb5166d38d2aec53765aca7c0d24c" category="paragraph">No Debian, o usuário pode acessar o arquivo /etc/NTP.conf para obter detalhes do servidor ntp.</block>
  <block id="3698338a95ad1801e25ed154adaf1a70" category="summary">Guia de fortalecimento da segurança para ferramentas do ONTAP para VMware vSphere, visão geral e introdução.</block>
  <block id="47d29daaa26fbfa9c9a069d4cd023ac1" category="doc">Guia de fortalecimento da segurança para as ferramentas do ONTAP para VMware vSphere</block>
  <block id="fe0e23a929284a636c245a362ada6472" category="paragraph">O guia de proteção de segurança para as ferramentas do ONTAP para VMware vSphere fornece um conjunto abrangente de instruções para configurar as configurações mais seguras.</block>
  <block id="fec65f0c33739368ce5845fadb6cb880" category="paragraph">Estes guias aplicam-se aos aplicativos e ao SO convidado do próprio aparelho.</block>
  <block id="5aaf8fc9424d7872cf500fb7adcb3b97" category="summary">Guia de fortalecimento da segurança para ferramentas do ONTAP para VMware vSphere, configuração de política de senha.</block>
  <block id="339ce1d4220ba7045e3a35ef35279ad3" category="doc">Políticas de senha</block>
  <block id="53477738359cebc12d4e01727ee8b5e7" category="paragraph">Os usuários que implantarem ferramentas do ONTAP pela primeira vez ou atualizarem para a versão 9,12 ou posterior precisarão seguir a política de senha forte para o administrador e os usuários do banco de dados. Durante o processo de implantação, novos usuários serão solicitados a inserir suas senhas. Para usuários brownfield atualizando para a versão 9,12 ou posterior, a opção de seguir a política de senha forte estará disponível no console de manutenção.</block>
  <block id="7afd9be20a239f83f98bdbc7f90512ef" category="list-text">Uma vez que o usuário faça login no console de manutenção, as senhas serão verificadas em relação ao conjunto de regras complexas e, se for encontrado que não foi seguido, o usuário será solicitado a redefinir o mesmo.</block>
  <block id="1e048d74f3d9375186833526a00f4309" category="list-text">A validade padrão da senha é de 90 dias e após 75 dias o usuário começará a receber a notificação para alterar a senha.</block>
  <block id="dbb73ef3f8e9b61d387a809281a654cc" category="list-text">É necessário definir uma nova senha em cada ciclo, o sistema não receberá a última senha como a nova senha.</block>
  <block id="210b05d5e7375bcb02bcf09a873bbda6" category="list-text">Sempre que um usuário fizer login no console de manutenção, ele verificará as políticas de senha, como as capturas de tela abaixo, antes de carregar o Menu Principal:</block>
  <block id="bc66b4fce20ef49b05e4a54f053e65a6" category="inline-image-macro">Menu principal, largura de 468mm, altura de 116mm</block>
  <block id="4661acb75237098be364b3c05d7d9b7c" category="paragraph"><block ref="4661acb75237098be364b3c05d7d9b7c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8f09c69f731d4d6f2e8d6135082aa8e4" category="list-text">Se não for encontrado seguindo a política de senha ou sua configuração de atualização a partir das ferramentas ONTAP 9,11 ou antes. Em seguida, o utilizador verá o seguinte ecrã para repor a palavra-passe:</block>
  <block id="4499d4bfb9610056781e2e61956dd0ca" category="inline-image-macro">Tela de redefinição de senha, largura de 468mm, altura de 116mm</block>
  <block id="a84278f7bf3ee281e39e467fca1fe454" category="paragraph"><block ref="a84278f7bf3ee281e39e467fca1fe454" category="inline-image-macro-rx" type="image"></block></block>
  <block id="47e6664ac0a72e1d719cfc288383b4f8" category="list-text">Se o usuário tentar definir senha fraca ou fornecer a última senha novamente, o usuário verá o seguinte erro:</block>
  <block id="fe04952c38b6a9a7db1a75bbb4905232" category="inline-image-macro">Erro de senha fraco, largura de 468 mm, altura de 101 mm</block>
  <block id="2c59de9ea5183e73d5fa6382fa7f3fc1" category="paragraph"><block ref="2c59de9ea5183e73d5fa6382fa7f3fc1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="641cc5f60c71fe9f9a2e15c5cc680ec3" category="summary">Guia de fortalecimento da segurança para ferramentas do ONTAP para VMware vSphere, portas e protocolos TCP</block>
  <block id="7c7c4cc4771d6114aa8b4d38f5817a85" category="doc">Portas e protocolos</block>
  <block id="80dd7fd00106118cf9c10abf911b7111" category="paragraph">Aqui estão listadas as portas e protocolos necessários que permitem a comunicação entre as ferramentas do ONTAP para o servidor VMware vSphere e outras entidades, como sistemas de storage gerenciados, servidores e outros componentes.</block>
  <block id="d40dfcfdaecc4e8015535acd5de00398" category="section-title">Portas de entrada e saída necessárias para o OTV</block>
  <block id="0406f8902379502d1eba01f043c232b7" category="paragraph">A tabela a seguir descreve os detalhes da porta aberta.</block>
  <block id="5732d3577c35dfcce968ba967a9a6149" category="cell">*Número da porta TCP v4/V6*</block>
  <block id="e71a4b7488a97c0e5d8b3ab3efe619e4" category="cell">*Direção*</block>
  <block id="bc437eb0df24b836c84a74f47b391093" category="cell">*Função*</block>
  <block id="0c95054981de037de06e544a52eb3613" category="cell">8143</block>
  <block id="a8e6fe5b9e68f30a146cefebaa7edcc3" category="cell">de entrada</block>
  <block id="d16c4afdc5f340936b747baf91efc843" category="cell">Conexões HTTPS para API REST</block>
  <block id="5bd529d5b07b647a8863cf71e98d651a" category="cell">8043</block>
  <block id="1f4deeb2f64336d4ff65ea3d2b4ffe2f" category="cell">Conexões HTTPS</block>
  <block id="cb4b69eb9bd10da82c15dca2f86a1385" category="cell">9060</block>
  <block id="576fe92cf4e45714b61ed10e5c856aa5" category="cell">Esta porta deve ser aberta para permitir que um cliente se conete ao servidor de API do ONTAP Tools.</block>
  <block id="b6d767d2f8ed5d21a44b0e5886680cb9" category="cell">22</block>
  <block id="f4e339608b243f9b57b78ffaf061b498" category="cell">SSH (Desativado por padrão)</block>
  <block id="d82d678e9583c1f5f283ec56fbf1abb7" category="cell">9080</block>
  <block id="ef34781e03f49b5db5dd8fa267c4c41b" category="cell">Conexões HTTPS - VP e SRA - conexões internas somente de loopback</block>
  <block id="a44ba9086b2b83ccf2baf7c678723449" category="cell">9083</block>
  <block id="4e31bd5bdc8239bb7c98471d3500d951" category="cell">Conexões HTTPS - VP e SRA usados para SOAP em conexões HTTPS</block>
  <block id="abea47ba24142ed16b7d8fbf2c740e0d" category="cell">1162</block>
  <block id="4a0724da5c6f4e4817663ae822550800" category="cell">Pacotes de intercetação SNMP VP</block>
  <block id="7e6b20d014d1c659e4eaf20dc2dcd7eb" category="cell">8443</block>
  <block id="aaa2d7fe63bee55de8ffca52cb61fbd5" category="cell">Plug-in remoto</block>
  <block id="5cce8dede893813f879b873962fb669f" category="cell">1527</block>
  <block id="91c15b8eb529bf2100c10383d1010a1e" category="cell">apenas interno</block>
  <block id="25fa62922a9b3c1c2763bbf88014e217" category="cell">Porta de banco de dados Derby, apenas entre este computador e ele mesmo, conexões externas não aceitas - somente conexões internas</block>
  <block id="c68bd9055776bf38d8fc43c0ed283678" category="cell">8150</block>
  <block id="b482bc4bf0e383b0858c5d9eb0e96ba9" category="cell">O serviço de integridade de log é executado na porta</block>
  <block id="13f3cf8c531952d72e5847c4183e6910" category="cell">443</block>
  <block id="1ef2b5426b0824e93e33753fa87ddbf5" category="cell">bidirecional</block>
  <block id="e4b8a8d8761aab7733e317b585d5d606" category="cell">Usado para conexões com clusters ONTAP</block>
  <block id="9956361dfa33899fc0efed6ee3946512" category="section-title">Controlar o acesso remoto ao banco de dados Derby</block>
  <block id="58b7326b56820f4b18dfd73dc9707831" category="paragraph">Os administradores podem acessar o banco de dados derby com os seguintes comandos. Ele pode ser acessado através da VM local das ferramentas do ONTAP, bem como de um servidor remoto com as seguintes etapas:</block>
  <block id="296068c08046bbf197300e38c4e851cb" category="paragraph">*[.Underline</block>
  <block id="10046bc1eb8463e6ca6ae51bd3b7a574" category="inline-image-macro">Derby, largura de 468mm, altura de 136mm</block>
  <block id="36434da35edb72a1f85cbbcc1ff2b197" category="paragraph"><block ref="36434da35edb72a1f85cbbcc1ff2b197" category="inline-image-macro-rx" type="image"></block></block>
  <block id="562596399deefc1e2a6cc32eb489976c" category="summary">Guia de fortalecimento da segurança para ferramentas do ONTAP para VMware vSphere.</block>
  <block id="704c7fc6c4d40b9af6aafb7cf9b44022" category="paragraph">Para impedir o acesso não autorizado, é configurado um tempo limite de inatividade, que faz logout automaticamente de usuários inativos por um determinado período durante o uso de recursos autorizados. Isso garante que somente usuários autorizados possam acessar os recursos e ajuda a manter a segurança.</block>
  <block id="80f9ebebc8f94450338d28bcb4a2164d" category="inline-link">Configure o valor de tempo limite do vSphere Client</block>
  <block id="3748702da26b5718f1f7c769ce58b009" category="list-text">Por padrão, as sessões do vSphere Client são encerradas após 120 minutos de tempo ocioso, exigindo que o usuário faça login novamente para continuar usando o cliente. Você pode alterar o valor do tempo limite editando o arquivo webclient.properties.você pode configurar o tempo limite do vSphere Client<block ref="ec8715bde1a929a6f64160d5372f4574" category="inline-link-rx"></block></block>
  <block id="e4306c4cf124046d8f90518752cd5021" category="list-text">As ferramentas do ONTAP têm um tempo de logout de sessão da web-cli de 30 minutos.</block>
  <block id="6c5f0256b71da4e103acbeed0dfcc379" category="summary">Este documento descreve os aspetos de segurança do plug-in do SnapCenter para VMware.</block>
  <block id="46e61d6e7c848d43ddcede8efd36c3d8" category="doc">Plug-in do SnapCenter VMware vSphere</block>
  <block id="ae9e79ac4b60eba67cf1c7508417b42c" category="paragraph">O plug-in do NetApp SnapCenter para a engenharia de software VMware vSphere usa as seguintes atividades de desenvolvimento seguro:</block>
  <block id="39e5fc9eb192f011ab14dae6c2974c4e" category="list-text">*Modelagem de ameaças.* O objetivo da modelagem de ameaças é descobrir falhas de segurança em um recurso, componente ou produto no início do ciclo de vida do desenvolvimento de software. Um modelo de ameaça é uma representação estruturada de todas as informações que afetam a segurança de um aplicativo. Em essência, é uma visão da aplicação e do seu ambiente através da lente da segurança.</block>
  <block id="b25a1098aff7d0c5ee590f1e1a114bb9" category="list-text">*Teste dinâmico de segurança de aplicativos (DAST).* Tecnologias projetadas para detetar condições vulneráveis em aplicativos em seu estado de execução. O DAST testa as interfaces HTTP e HTML expostas de aplicações web-enable.</block>
  <block id="6cc1fee6b4fc48755d78e93170bbed93" category="list-text">*Moeda de código de terceiros.* Como parte do desenvolvimento de software e do uso de software de código aberto (OSS), é importante abordar vulnerabilidades de segurança que podem estar associadas ao OSS que foi incorporado ao seu produto. Este é um esforço contínuo, uma vez que a versão do componente OSS pode ter uma vulnerabilidade recentemente descoberta relatada a qualquer momento.</block>
  <block id="db7bc87c89c1ee76d313865a32fc0e06" category="list-text">*Verificação de vulnerabilidades.* O objetivo da verificação de vulnerabilidades é detetar vulnerabilidades de segurança comuns e conhecidas nos produtos NetApp antes de serem lançadas aos clientes.</block>
  <block id="87bd0fb9b4198f33535e0e1888a809f5" category="list-text">* Teste de penetração.* O teste de penetração é o processo de avaliação de um sistema, aplicativo da Web ou rede para encontrar vulnerabilidades de segurança que possam ser exploradas por um invasor. Os testes de penetração (testes de caneta) na NetApp são conduzidos por um grupo de empresas terceirizadas aprovadas e confiáveis. Seu escopo de teste inclui o lançamento de ataques contra um aplicativo ou software como intrusos hostis ou hackers usando métodos ou ferramentas de exploração sofisticados.</block>
  <block id="3fd4fd8640d78da436f762569919841f" category="list-text">*Atividade de resposta a incidentes de Segurança do produto.* Vulnerabilidades de segurança são descobertas interna e externamente para a empresa e podem representar um sério risco para a reputação da NetApp se não forem abordadas em tempo hábil. Para facilitar esse processo, uma equipe de resposta a incidentes de Segurança do produto (PSIRT) relata e rastreia as vulnerabilidades.</block>
  <block id="7e98fc3ea1ec077cfd1727a58e9c9020" category="section-title">Recursos de segurança do produto</block>
  <block id="e91db3b3278f7bd95cc704d74c5c9597" category="paragraph">O plug-in do NetApp SnapCenter para VMware vSphere inclui os seguintes recursos de segurança em cada versão:</block>
  <block id="4abd7d1d5d223683d3346671efb7e89c" category="list-text">*Acesso restrito ao shell.* O SSH é desativado por padrão, e logins únicos só são permitidos se estiverem ativados a partir do console da VM.</block>
  <block id="8c264fa5ca2c588d960d98bd30cbc897" category="list-text">*Aviso de acesso no banner de login.* O banner de login a seguir é exibido depois que o usuário insere um nome de usuário no prompt de login:</block>
  <block id="399875025e8e96cc13102a4dd72f2434" category="paragraph">*AVISO:* o acesso não autorizado a este sistema é proibido e será processado por lei. Ao acessar este sistema, você concorda que suas ações podem ser monitoradas se houver suspeita de uso não autorizado.</block>
  <block id="0d6633ada3a9803e206b2359d859e892" category="paragraph">Depois que o usuário concluir o login pelo canal SSH, a seguinte saída é exibida:</block>
  <block id="677528ad13d460c058ac50e8a62092cf" category="list-text">*Controle de acesso baseado em função (RBAC).* Dois tipos de controles RBAC estão associados às ferramentas do ONTAP:</block>
  <block id="b883bf79639dfce77e395b8458ee69e4" category="list-text">Privileges nativo do vCenter Server.</block>
  <block id="721796b1cb3468f0daf819180184d460" category="inline-link">Controle de acesso baseado em função (RBAC)</block>
  <block id="1d08c46b7567a29be0690a92b9722a58" category="list-text">Privileges específico do plug-in do VMware vCenter. Para obter mais informações,<block ref="f351263ad3706bd0a472039400dece78" category="inline-link-rx"></block>consulte .</block>
  <block id="acab4c655c4a7b4db67fc07e22b86222" category="list-text">*Canais de comunicação criptografados.* Toda a comunicação externa acontece por HTTPS usando TLS.</block>
  <block id="600d4f98483fae8e58054f976d7e0c0e" category="list-text">* Exposição mínima do porto.* Apenas as portas necessárias estão abertas no firewall.</block>
  <block id="47a37e2d5fc8b7c936ad9b2b7a569a08" category="paragraph">A tabela a seguir fornece os detalhes da porta aberta.</block>
  <block id="10bd16a816f831080065e807daa36a9a" category="cell">Número da porta TCP v4/V6</block>
  <block id="86408593c34af77fdd90df932f8b5261" category="cell">Função</block>
  <block id="edf0320adc8658b25ca26be5351b6c4a" category="cell">8144</block>
  <block id="d4a973e303ec37692cc8923e3148eef7" category="cell">8080</block>
  <block id="2c25c3d66f80eeaa8d6e5a144c6f942e" category="cell">Conexões HTTPS para GUI OVA</block>
  <block id="14b3e670eec63cc0cc456fd904bbfbd9" category="cell">SSH (desativado por padrão)</block>
  <block id="16fc18d787294ad5171100e33d05d4e2" category="cell">3306</block>
  <block id="4cbf9c234f6b34c242a110cb993252bd" category="cell">MySQL (somente conexões internas; conexões externas desativadas por padrão)</block>
  <block id="29ab4efbdb7c727c81ee1382593bc5e2" category="cell">Nginx (serviços de proteção de dados)</block>
  <block id="89f152cad33314315b4995ed1ca71535" category="inline-link">Como criar e/ou importar um certificado SSL para o plug-in SnapCenter para VMware vSphere (SCV)</block>
  <block id="450adc59e39f23172756ac9369494a2d" category="list-text">*Suporte para certificados assinados pela Autoridade de Certificação (CA).* O plug-in do SnapCenter para VMware vSphere oferece suporte ao recurso de certificados assinados pela CA. <block ref="9f83d87d5d9f604d96288df21d450fac" category="inline-link-rx"></block>Consulte .</block>
  <block id="05a1aa8021df4579874c4eeb8788e5c9" category="list-text">*Políticas de senha.* As seguintes políticas de senha estão em vigor:</block>
  <block id="f82f7513742f08b9d2784923213bdc75" category="list-text">As senhas não são registradas em nenhum arquivo de log.</block>
  <block id="83040c348e071499488a8128db207545" category="list-text">As senhas não são comunicadas em texto simples.</block>
  <block id="bc319862df3312f423a50fece7730db9" category="list-text">As senhas são configuradas durante o próprio processo de instalação.</block>
  <block id="2c87609dbbc3630573c64e271de8207d" category="list-text">Todas as informações de credenciais são armazenadas usando hash SHA256.</block>
  <block id="0f1a6fa0a65f9d5c3c4a16b070104d7a" category="list-text">*Imagem base do sistema operacional.* O produto é fornecido com o sistema operacional base Debian para OVA com acesso restrito e acesso shell desativado. Isso reduz a ocupação física do ataque. Todos os sistemas operacionais baseados em versões do SnapCenter são atualizados com os patches de segurança mais recentes disponíveis para cobertura máxima de segurança.</block>
  <block id="83cd5867ba912e517fa1100299fd1cf3" category="paragraph">A NetApp desenvolve recursos de software e patches de segurança em relação ao plug-in do SnapCenter para o dispositivo VMware vSphere e, em seguida, os lança aos clientes como uma plataforma de software agrupada. Como esses dispositivos incluem dependências específicas do sistema sub-operacional Linux, bem como nosso software proprietário, a NetApp recomenda que você não faça alterações no sistema sub-operacional porque isso tem um alto potencial para afetar o dispositivo NetApp. Isto pode afetar a capacidade do NetApp de suportar o aparelho. A NetApp recomenda testar e implantar nossa versão de código mais recente para dispositivos porque eles são lançados para corrigir quaisquer problemas relacionados à segurança.</block>
  <block id="93b94e62ad8cb02a1d1a7b0944a5445d" category="summary">Este documento discute a segurança do produto para as ferramentas do ONTAP para VMware vSphere.</block>
  <block id="ed9018b2e8611a3d2c03bb6a205b9715" category="doc">Ferramentas do ONTAP para VMware vSphere</block>
  <block id="820b71b9a8a55fe48690a5f973c5480e" category="paragraph">A engenharia de software com as ferramentas ONTAP para VMware vSphere emprega as seguintes atividades de desenvolvimento seguro:</block>
  <block id="9f16ab3a50bca32d19c4729319035c8d" category="list-text">*Teste Dinâmico de Segurança de aplicativos (DAST).* Essa tecnologia foi projetada para detetar condições vulneráveis em aplicativos em seu estado de execução. O DAST testa as interfaces HTTP e HTML expostas de aplicações web-enable.</block>
  <block id="267bed0525e4dab477e4c24ca5a1794e" category="list-text">*Moeda de código de terceiros.* Como parte do desenvolvimento de software com software de código aberto (OSS), você deve resolver vulnerabilidades de segurança que podem estar associadas a qualquer OSS incorporado em seu produto. Este é um esforço contínuo porque uma nova versão do OSS pode ter uma vulnerabilidade descoberta recentemente relatada a qualquer momento.</block>
  <block id="1a4c104571630526efc77b84e82380fe" category="list-text">* Teste de penetração.* O teste de penetração é o processo de avaliação de um sistema, aplicativo da Web ou rede para encontrar vulnerabilidades de segurança que possam ser exploradas por um invasor. Os testes de penetração (testes de caneta) na NetApp são conduzidos por um grupo de empresas terceirizadas aprovadas e confiáveis. Seu escopo de teste inclui o lançamento de ataques contra um aplicativo ou software semelhante a intrusos hostis ou hackers usando métodos ou ferramentas de exploração sofisticados.</block>
  <block id="ecdc76c84c9674a3148f3d464298469c" category="paragraph">As ferramentas do ONTAP para VMware vSphere incluem os seguintes recursos de segurança em cada versão.</block>
  <block id="dff88c2ef0b49b09246ffd6f9ec55195" category="list-text">* Login banner.* O SSH é desativado por padrão e só permite logins únicos se ativado a partir do console da VM. O banner de login a seguir é exibido depois que o usuário insere um nome de usuário no prompt de login:</block>
  <block id="2d8330ed99c80a842ffbd1362e038e5e" category="paragraph">Depois que o usuário concluir o login através do canal SSH, o seguinte texto é exibido:</block>
  <block id="ac38773d017495a97d5b88f242578cb8" category="list-text">Privileges nativo do vCenter Server</block>
  <block id="31cedac82fef311cb790a12f96897223" category="list-text">Privileges específico do plug-in do vCenter. Para obter detalhes,<block ref="e5f6920797dbff91ef59367270a82669" category="inline-link-rx"></block> consulte .</block>
  <block id="5d32469f8a65b884a8f70abf95fe485a" category="list-text">*Canais de comunicação criptografados.* Toda a comunicação externa acontece por HTTPS usando a versão 1,2 do TLS.</block>
  <block id="69fc9fe9cbb7709e97a433352aecf77d" category="cell">N.o da porta TCP v4/V6</block>
  <block id="02674a4ef33e11c879283629996c8ff8" category="cell">Direção</block>
  <block id="5852f8019b572f4cdef5bab783fa799f" category="cell">Conexões HTTPS usadas para SOAP em conexões https esta porta deve ser aberta para permitir que um cliente se conete ao servidor API de ferramentas ONTAP.</block>
  <block id="fe01ac95967cd8cb5f5b5669b685277a" category="cell">Conexões HTTPS - VP e SRA usados para SOAP em conexões https</block>
  <block id="60135f95267c6e0711bf5a2858dfff2f" category="cell">Porta de banco de dados Derby, apenas entre este computador e ele mesmo, conexões externas não aceitas -- somente conexões internas</block>
  <block id="bf6184406d1e18fffc86ecf770fbb391" category="inline-link">artigo da kb</block>
  <block id="fedac49792829de4ff38fcf7a3846faa" category="list-text">*Suporte para certificados assinados pela autoridade de certificação (CA).* As ferramentas do ONTAP para VMware vSphere oferecem suporte a certificados assinados pela CA. Consulte este<block ref="0903a062b2072644a9b744a7fece4216" category="inline-link-rx"></block> documento para obter mais informações.</block>
  <block id="9fca19988370da2a459b24505e9d23d5" category="list-text">*Registo de auditoria.* Os pacotes de suporte podem ser baixados e são extremamente detalhados. As ferramentas do ONTAP Registram todas as atividades de login e logout do usuário em um arquivo de log separado. As chamadas de API VASA são registradas em um log de auditoria VASA dedicado (local cxf.log).</block>
  <block id="7d60a2806aedd934b75cce55d6693689" category="list-text">*Políticas de senha.* As seguintes políticas de senha são seguidas:</block>
  <block id="853c2ea85b86882d0ea73b606a9800a4" category="list-text">O histórico de senhas é um parâmetro configurável.</block>
  <block id="b3d3877bc96752ae50a409c72597d47a" category="list-text">A idade mínima da senha é definida para 24 horas.</block>
  <block id="fb0bdec50022a37424a405b53da7c9c8" category="list-text">O preenchimento automático dos campos de senha está desativado.</block>
  <block id="3a04f054be8ad983ea82fd5079519810" category="list-text">As ferramentas do ONTAP criptografam todas as informações de credenciais armazenadas usando hash SHA256.</block>
  <block id="3e4627f6667f830baceaaf35890b575a" category="summary">Para saber mais sobre as informações descritas neste documento, consulte os seguintes documentos e/ou sites.</block>
  <block id="092bf78f9c97ba171b8232ddff585392" category="doc">Informações adicionais</block>
  <block id="7d5b957cd473f6eaf5ad335a9c63c4ff" category="paragraph">Para saber mais sobre as informações descritas neste documento, consulte os seguintes documentos e/ou sites:</block>
  <block id="1eed6756a7834e04fb7716ee8d830425" category="inline-link-macro"><block ref="1eed6756a7834e04fb7716ee8d830425" category="inline-link-rx"></block></block>
  <block id="8983ee0717807e5385f3c8b2c70a177c" category="list-text">TR-4597: VMware vSphere for ONTAP <block ref="0bff808225ac084b8184e7670c17aa52" category="inline-link-macro-rx"></block></block>
  <block id="0e4a75553a081fffff029a37e55f5d71" category="inline-link-macro"><block ref="0e4a75553a081fffff029a37e55f5d71" category="inline-link-rx"></block></block>
  <block id="1f7ff87198d4a8563ac0d42354d47052" category="list-text">TR-4400: VMware vSphere Virtual volumes com ONTAP <block ref="57ea579fe6c0d333a496008248ad03e2" category="inline-link-macro-rx"></block></block>
  <block id="ef8c76bd50596fa93881a13dac3f23b3" category="inline-link-macro"><block ref="ef8c76bd50596fa93881a13dac3f23b3" category="inline-link-rx"></block></block>
  <block id="6e5923e0b2d91653ee7dd35aa5f48141" category="list-text">TR-4015 Guia de práticas recomendadas de configuração do SnapMirror para ONTAP 9 <block ref="6a851721cd10ebeb2f9cfa107f963956" category="inline-link-macro-rx"></block></block>
  <block id="c88037eb28ae3cceb0e32c2cd3c322d7" category="inline-link-macro"><block ref="c88037eb28ae3cceb0e32c2cd3c322d7" category="inline-link-rx"></block></block>
  <block id="1f82b18dcba5f32a085bc502cdd0c6b7" category="summary">Com o ONTAP, o conceito de máquina virtual de storage (SVM) fornece segmentação rigorosa em ambientes multitenant seguros.</block>
  <block id="7520e12a140ccf3de279fe2fd48889e4" category="doc">Práticas recomendadas de implantação</block>
  <block id="b3fd5cebc3e5891cccea8f8df97003e0" category="paragraph">As seções a seguir descrevem as práticas recomendadas de implantação com o ONTAP e o VMware SRM.</block>
  <block id="1b4574c516231b685bb37b013b789b06" category="section-title">Layout e segmentação do SVM para SMT</block>
  <block id="446e04546ec0567eeeeef8e07368ab40" category="paragraph">Com o ONTAP, o conceito de máquina virtual de storage (SVM) fornece segmentação rigorosa em ambientes multitenant seguros. Os usuários do SVM em um SVM não podem acessar ou gerenciar recursos de outro. Dessa forma, você pode utilizar a tecnologia ONTAP criando SVMs separadas para diferentes unidades de negócios que gerenciam seus próprios fluxos de trabalho SRM no mesmo cluster para maior eficiência geral de storage.</block>
  <block id="f98c1d223f34b2fdaf90eab1a3bc6a25" category="paragraph">Considere o gerenciamento do ONTAP usando contas com escopo SVM e LIFs de gerenciamento de SVM para aprimorar não apenas os controles de segurança, mas também a performance. O desempenho é inerentemente maior ao usar conexões com escopo SVM, pois o SRA não é necessário para processar todos os recursos em um cluster inteiro, incluindo recursos físicos. Em vez disso, ele só precisa entender os ativos lógicos que são abstraídos para o SVM específico.</block>
  <block id="97399fb37deca0d463aa5c7dc8d064a6" category="section-title">Práticas recomendadas para gerenciamento de sistemas ONTAP 9</block>
  <block id="18f8b81b7fb7ea92f333e127583df17c" category="paragraph">Como mencionado anteriormente, você pode gerenciar clusters do ONTAP usando credenciais de escopo do cluster ou SVM e LIFs de gerenciamento. Para um desempenho ideal, você pode considerar o uso de credenciais com escopo SVM sempre que não estiver usando vVols. No entanto, ao fazer isso, você deve estar ciente de alguns requisitos, e que você perde alguma funcionalidade.</block>
  <block id="6e62430b92a7c5a0b8512436b163a10d" category="list-text">Economias de espaço agregado devido à eficiência de storage podem não ser relatadas.</block>
  <block id="93d86aa51e0909549d1b1210f887aef3" category="list-text">Quando suportado, os espelhos de partilha de carga não podem ser atualizados.</block>
  <block id="647d380b52e259fe7ed2e2582bc54b27" category="list-text">O log do EMS pode não ser realizado em sistemas ONTAP gerenciados com credenciais de escopo da SVM.</block>
  <block id="a2132633bc2804871caed9697d50a10d" category="summary">Suporte a recursos, limites e vVols com ferramentas ONTAP.</block>
  <block id="ce4df831657d2621e80bbef9271c33cd" category="paragraph">Com a transição do dispositivo virtual legado, as ferramentas do ONTAP trazem uma grande variedade de novos recursos, limites mais altos e novo suporte a vVols.</block>
  <block id="116d20fc387d73c8e4a86e7998913947" category="section-title">Versões mais recentes do vSphere e do Site Recovery Manager</block>
  <block id="7cb1700928c008eb817bc79250cc9002" category="section-title">Suporte para IPv6</block>
  <block id="ea9aacd1495949730de8eeab11e66459" category="paragraph">IPv6 agora é suportado com as seguintes limitações:</block>
  <block id="4a4842d7448ef71eb69b013e560b18bb" category="section-title">Maior escala</block>
  <block id="96cb4d41ca97bd9d3d446984d3170a57" category="paragraph">Um novo recurso muito aguardado é o SnapMirror Synchronous (SM-S) com o ONTAP 9.5 e posterior, que fornece uma solução de replicação de dados granular com RPO zero de volume para suas aplicações de missão crítica. O SM-S requer as ferramentas ONTAP 9,8 ou posterior.</block>
  <block id="b9832b10a87d0c3793ed3b413ee1d839" category="section-title">Compatível com API REST</block>
  <block id="3eb0aeddd8b10d858bd2028c6f983308" category="summary">Práticas recomendadas operacionais para o storage VMware SRM e ONTAP</block>
  <block id="d3b26e9021e83573a3d2a9050400a33a" category="doc">Práticas recomendadas operacionais</block>
  <block id="52d04863ac62a6fa67e1b49a31086928" category="paragraph">As seções a seguir descrevem as práticas recomendadas operacionais para o storage VMware SRM e ONTAP.</block>
  <block id="f02207fb26160d7e47cf5ea35d07df03" category="section-title">Armazenamentos de dados e protocolos</block>
  <block id="c5cd657df037c277c37216b73efb0b08" category="list-text">Se possível, sempre use ferramentas do ONTAP para provisionar armazenamentos de dados e volumes. Isso garante que volumes, caminhos de junção, LUNs, grupos, políticas de exportação e outras configurações sejam configurados de maneira compatível.</block>
  <block id="4d15db58f26b374b36c283df6b5a5fc1" category="list-text">O SRM dá suporte a iSCSI, Fibre Channel e NFS versão 3 com ONTAP 9 ao usar replicação baseada em array por meio do SRA. O SRM não dá suporte à replicação baseada em array para NFS versão 4,1 com datastores tradicionais ou vVols.</block>
  <block id="61f54ceeb0338787a2ee2d801cbc62cd" category="list-text">Para confirmar a conectividade, verifique sempre se é possível montar e desmontar um novo datastore de teste no local de DR do cluster do ONTAP de destino. Teste cada protocolo que você pretende usar para a conetividade do datastore. Uma prática recomendada é usar as ferramentas do ONTAP para criar seu datastore de teste, já que ele está fazendo toda a automação do datastore, conforme indicado pelo SRM.</block>
  <block id="aa131b86ebd9f719bab1aba612ae3c3f" category="list-text">O SRM tem melhor desempenho quando o número de datastores e, portanto, os grupos de proteção são minimizados em seus planos de recuperação. Portanto, você deve considerar a otimização para a densidade da VM em ambientes protegidos pelo SRM, onde o rto é de importância fundamental.</block>
  <block id="afab42482b97a8b43c62320c373ded74" category="list-text">Use o DRS (Distributed Resource Scheduler) para ajudar a equilibrar a carga nos clusters ESXi protegidos e de recuperação. Lembre-se de que, se você planeja fazer o failback, ao executar uma reproteção, os clusters anteriormente protegidos se tornarão os novos clusters de recuperação. O DRS ajudará a equilibrar a colocação em ambas as direções.</block>
  <block id="8ed6c5d9143eeb92cf75bb8a08bb7819" category="list-text">Sempre que possível, evite usar a personalização de IP com o SRM, pois isso pode aumentar seu rto.</block>
  <block id="6d717f70d89096b731dfc63d7a1379e1" category="section-title">Sobre os pares de array</block>
  <block id="e2e7245b1b3cf4a13a6b703ead49ebee" category="paragraph">Um gerenciador de array é criado para cada par de array. Com as ferramentas SRM e ONTAP, cada emparelhamento de array é feito com o escopo de uma SVM, mesmo que você esteja usando credenciais de cluster. Isso permite segmentar fluxos de trabalho de DR entre locatários com base em quais SVMs eles foram atribuídos a gerenciar. Você pode criar vários gerenciadores de array para um determinado cluster, e eles podem ser assimétricos. Você pode fazer fan-out ou fan-out entre diferentes clusters do ONTAP 9. Por exemplo, você pode fazer a replicação do SVM-A e do SVM-B no Cluster-1 para SVM-C no Cluster-2, SVM-D no Cluster-3 ou vice-versa.</block>
  <block id="2219228418c053eb593ce0a1f318da47" category="paragraph">Ao configurar pares de matrizes no SRM, deve sempre adicioná-los no SRM da mesma forma que os adicionou às Ferramentas do ONTAP, ou seja, devem utilizar o mesmo nome de utilizador, palavra-passe e LIF de gestão. Esse requisito garante que o SRA se comunique adequadamente com o array. A captura de tela a seguir ilustra como um cluster pode aparecer nas Ferramentas do ONTAP e como ele pode ser adicionado a um gerenciador de array.</block>
  <block id="06b2d4b91b5c9eaa8c20a1c270f95b3c" category="inline-image-macro">cluster</block>
  <block id="6c0893d9a45aaff00c1ef0daf0867ada" category="paragraph"><block ref="6c0893d9a45aaff00c1ef0daf0867ada" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3b34135c8c4d2b14ceb7ebf595f00193" category="section-title">Sobre os grupos de replicação</block>
  <block id="c727c1020d3128dd7495a6e3e6f23736" category="paragraph">Uma consideração final para grupos de replicação é que cada um é, por sua natureza, um grupo de consistência lógica (não deve ser confundido com grupos de consistência SRM). Isso ocorre porque todas as VMs no volume são transferidas juntas usando o mesmo snapshot. Portanto, se você tiver VMs que precisam ser consistentes umas com as outras, considere armazená-las no mesmo FlexVol.</block>
  <block id="9f8a350a2113ea4be6b4e5e5112514a3" category="section-title">Sobre grupos de proteção</block>
  <block id="df77671ab2743af7f1d1457c200eb12c" category="paragraph">Os grupos de proteção definem VMs e datastores em grupos que são recuperados juntos do site protegido. O local protegido é onde as VMs configuradas em um grupo de proteção existem durante operações normais de estado estacionário. É importante notar que, embora o SRM possa exibir vários gerenciadores de matriz para um grupo de proteção, um grupo de proteção não pode abranger vários gerenciadores de matriz. Por esse motivo, você não deve estender arquivos de VM entre armazenamentos de dados em diferentes SVMs.</block>
  <block id="b148467d645c3613c1c7a2607764c515" category="section-title">Sobre planos de recuperação</block>
  <block id="fd28cd9834ad3aa213c4fec2881064b5" category="paragraph">Os planos de recuperação definem quais grupos de proteção são recuperados no mesmo processo. Vários grupos de proteção podem ser configurados no mesmo plano de recuperação. Além disso, para permitir mais opções para a execução de planos de recuperação, um único grupo de proteção pode ser incluído em vários planos de recuperação.</block>
  <block id="77aa84394124509e5e4006dcfd18789f" category="paragraph">Os planos de recuperação permitem que os administradores do SRM definam fluxos de trabalho de recuperação atribuindo VMs a um grupo de prioridades de 1 (mais alto) a 5 (mais baixo), sendo 3 (médio) o padrão. Dentro de um grupo de prioridade, as VMs podem ser configuradas para dependências.</block>
  <block id="030d749269f8866de516a551b0286001" category="paragraph">A NetApp recomenda fortemente que você trabalhe com suas equipes de aplicações para entender a ordem das operações necessárias em um cenário de failover e para construir seus planos de recuperação adequadamente.</block>
  <block id="cebb1167d3e78885137c837f0abf8026" category="section-title">Failover de teste</block>
  <block id="6ae8acfc86f5df3426d525fb95767506" category="paragraph">O NetApp também recomenda confirmar ocasionalmente a funcionalidade do aplicativo in-Guest, especialmente depois de reconfigurar o armazenamento de VM.</block>
  <block id="bd47371bcd8b3d08d6b4b15481b08d93" category="paragraph">Quando uma operação de recuperação de teste é executada, uma rede privada de bolhas de teste é criada no host ESXi para as VMs. No entanto, essa rede não é conetada automaticamente a nenhum adaptador de rede físico e, portanto, não fornece conetividade entre os hosts ESXi. Para permitir a comunicação entre VMs que estão sendo executadas em diferentes hosts ESXi durante o teste de DR, uma rede privada física é criada entre os hosts ESXi no local de DR. Para verificar se a rede de teste é privada, a rede de bolhas de teste pode ser separada fisicamente ou usando VLANs ou marcação de VLAN. Essa rede deve ser segregada da rede de produção porque, à medida que as VMs são recuperadas, elas não podem ser colocadas na rede de produção com endereços IP que podem entrar em conflito com os sistemas de produção reais. Quando um plano de recuperação é criado no SRM, a rede de teste criada pode ser selecionada como a rede privada para conetar as VMs durante o teste.</block>
  <block id="2be58fc410ddf2ba9c350135a617944a" category="paragraph">Depois que o teste tiver sido validado e não for mais necessário, execute uma operação de limpeza. A limpeza em execução retorna as VMs protegidas ao seu estado inicial e redefine o plano de recuperação para o estado Pronto.</block>
  <block id="6f07b53963ee80903f0f13654de2cc3a" category="section-title">Considerações sobre failover</block>
  <block id="9d33d94019b4a595a1ea232926a4da1b" category="paragraph">Há várias outras considerações quando se trata de falhar em um local, além da ordem de operações mencionada neste guia.</block>
  <block id="74abdd5cb502cd65bcf1d7ca484ab0c2" category="paragraph">Um problema que você pode ter que lidar com as diferenças de rede entre sites. Alguns ambientes podem ser capazes de usar os mesmos endereços IP de rede no local principal e no local de DR. Essa capacidade é referida como uma LAN virtual (VLAN) estendida ou configuração de rede estendida. Outros ambientes podem ter um requisito para usar endereços IP de rede diferentes (por exemplo, em VLANs diferentes) no local principal em relação ao local de DR.</block>
  <block id="9b8890fe5b1ab29543118b12a7bd0a07" category="inline-link-macro">Opções NSX-T com SRM</block>
  <block id="25154023650451d6cc971fc54bff8898" category="paragraph">A VMware oferece várias maneiras de resolver esse problema. Por um lado, tecnologias de virtualização de rede como o VMware NSX-T Data Center abstraem toda a pilha de rede das camadas 2 a 7 do ambiente operacional, permitindo soluções mais portáteis. Saiba mais <block ref="3e6a2bd8e1acf69d423b7944c6543271" category="inline-link-macro-rx"></block>sobre o .</block>
  <block id="4da3f855cd505741909cfd49d743e68e" category="paragraph">O SRM também lhe dá a capacidade de alterar a configuração de rede de uma VM à medida que ela é recuperada. Essa reconfiguração inclui configurações como endereços IP, endereços de gateway e configurações de servidor DNS. Diferentes configurações de rede, que são aplicadas a VMs individuais à medida que são recuperadas, podem ser especificadas nas configurações da propriedade de uma VM no plano de recuperação.</block>
  <block id="b56336aa967325217297d8725b64eb0b" category="inline-link-macro">Documentação da VMware</block>
  <block id="d32598436410006707b2ad1d79395f02" category="paragraph">Para configurar o SRM para aplicar diferentes configurações de rede a várias VMs sem ter que editar as propriedades de cada uma no plano de recuperação, a VMware fornece uma ferramenta chamada DR-ip-Customizer. Saiba como usar este utilitário, <block ref="837c7339284b78d4fd5550c5d0fb1a68" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="3c8c527afa8ce5009c8f707f7fd4fabf" category="section-title">Reproteger</block>
  <block id="3b496038cb575fc404f8b0783e570f7a" category="paragraph">Após uma recuperação, o local de recuperação se torna o novo local de produção. Como a operação de recuperação quebrou a replicação do SnapMirror, o novo local de produção não fica protegido de nenhum desastre futuro. Uma prática recomendada é proteger o novo local de produção para outro local imediatamente após uma recuperação. Se o local de produção original estiver operacional, o administrador da VMware poderá usar o local de produção original como um novo local de recuperação para proteger o novo local de produção, invertendo efetivamente o sentido de proteção. A reproteção está disponível apenas em falhas não catastróficas. Portanto, os vCenter Servers originais, os servidores ESXi, os servidores SRM e os bancos de dados correspondentes devem ser eventualmente recuperáveis. Se eles não estiverem disponíveis, um novo grupo de proteção e um novo plano de recuperação devem ser criados.</block>
  <block id="2bf236f8aceaaff2b305848df524c42e" category="paragraph">Uma operação de failback é fundamentalmente um failover em uma direção diferente do anterior. Como prática recomendada, você verifica se o site original está de volta aos níveis aceitáveis de funcionalidade antes de tentar failback ou, em outras palavras, failover para o site original. Se o local original ainda estiver comprometido, você deve atrasar o failback até que a falha seja suficientemente remediada.</block>
  <block id="cb03753531bad31391d7156433b98ae6" category="paragraph">Outra prática recomendada de failback é sempre executar um failover de teste após concluir a reproteção e antes de fazer seu failback final. Isso verifica se os sistemas no local original podem concluir a operação.</block>
  <block id="900a3b65ea54b6dcff72ed0d6ac66fdf" category="section-title">Reproteger o site original</block>
  <block id="e409450ce49f3558b068c69a77a9623a" category="paragraph">Após o failback, você deve confirmar com todas as partes interessadas que seus serviços foram devolvidos ao normal antes de executar o reprotect novamente,</block>
  <block id="12d059a2c7519f2e3497b30a71121503" category="paragraph">A execução do reprotect After failback coloca essencialmente o ambiente de volta ao estado em que estava no início, com a replicação do SnapMirror sendo executada novamente do local de produção para o local de recuperação.</block>
  <block id="2d90ac09cbf108bddad31dd341f8614e" category="doc">VMware Site Recovery Manager com ONTAP</block>
  <block id="e3445c3aa798f5ad98665e33d34dd952" category="paragraph">As práticas recomendadas complementam outros documentos, como guias e ferramentas de compatibilidade. Eles são desenvolvidos com base em testes de laboratório e extensa experiência de campo por engenheiros e clientes da NetApp. Em alguns casos, as melhores práticas recomendadas podem não ser a opção certa para o seu ambiente; no entanto, geralmente são as soluções mais simples que atendem às necessidades da maioria dos clientes.</block>
  <block id="87a7b114355b836acefe833c497611bb" category="paragraph">Depois, você pode executar failover de teste no data center de um fornecedor de serviços de nuvem com espaço físico de storage quase zero graças ao FlexClone. Proteger sua organização agora pode custar menos do que nunca.</block>
  <block id="89fafdb11a7e8cd8abebb1d4df053dad" category="doc">Topologias de replicação</block>
  <block id="be01acd2f018d38f9446f06b99ee4a2a" category="paragraph">No ONTAP 9, os componentes físicos de um cluster são visíveis para os administradores de cluster, mas não são visíveis diretamente para os aplicativos e hosts que usam o cluster. Os componentes físicos fornecem um pool de recursos compartilhados a partir do qual os recursos lógicos do cluster são construídos. As aplicações e os hosts acessam dados somente por meio de SVMs que contêm volumes e LIFs.</block>
  <block id="6f55124e085dbeb640e4cb8ad2c97905" category="list-text">Um SVM pode controlar LUNs e volumes que abrangem vários nós em um cluster.</block>
  <block id="39d9903201320a83d45d3b36d512f051" category="cell">Prática recomendada</block>
  <block id="2e4472d35f80aa8b7eca52ae3dd43dc6" category="section-title">Layouts SnapMirror suportados</block>
  <block id="4e749568996a3331860532ac7a470fdb" category="inline-image-macro">Layout da relação do SnapMirror</block>
  <block id="3d2c169d59a49a498b2d7e714c5a6ce2" category="paragraph"><block ref="3d2c169d59a49a498b2d7e714c5a6ce2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="706bdd824ec69e00026180eaf2801d2e" category="paragraph"><block ref="706bdd824ec69e00026180eaf2801d2e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ba1aebb9b3c7be6b408863c12bbc2844" category="paragraph"><block ref="ba1aebb9b3c7be6b408863c12bbc2844" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ea07c4b81c3f00ae8bbef49ac8562d1c" category="paragraph"><block ref="ea07c4b81c3f00ae8bbef49ac8562d1c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="86cf5bd2bdb1b1d67f8f907f41099509" category="section-title">Layouts do Array Manager compatíveis</block>
  <block id="12a757dd793cbe082927530094a72d26" category="inline-image-macro">pares de array</block>
  <block id="263506cdbbc7c35e461fc5f1044b9c79" category="paragraph"><block ref="263506cdbbc7c35e461fc5f1044b9c79" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1ceb46f3e1c6c7995de4ec5f05601227" category="section-title">Esquemas não suportados</block>
  <block id="b26873df0260bdc332a7511f6823cf63" category="inline-image-macro">Configurações não suportadas</block>
  <block id="120528a3f7d5a39fdd0d67fb0e2b94a4" category="paragraph"><block ref="120528a3f7d5a39fdd0d67fb0e2b94a4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="160a69c7a04198d870353b06dbf714a9" category="paragraph"><block ref="160a69c7a04198d870353b06dbf714a9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="742a3ab0c9a97e5a438c8edfb1b271d2" category="paragraph"><block ref="742a3ab0c9a97e5a438c8edfb1b271d2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3f88384b0d5cdcdc25895c644126c1b0" category="section-title">Cascata de SnapMirror</block>
  <block id="d0a05359b36f0932509cfa007b46e853" category="inline-image-macro">Cascata de relacionamentos SnapMirror</block>
  <block id="2057708d80974a7573d92b3e0d8a9258" category="paragraph"><block ref="2057708d80974a7573d92b3e0d8a9258" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8bd15e818d377a0a5cf6ebc429555f79" category="section-title">SnapMirror e SnapVault</block>
  <block id="7878dfbf4b6ad3bc60d095cf89d79202" category="admonition">O NetApp SRA suporta o<block ref="e7d3e049f94ce3ff8a47f209f012173d" prefix=" " category="inline-code"></block> tipo de política.</block>
  <block id="883e69a285ae2d5fd23c80cd29285804" category="paragraph">SnapVault foi reconstruído a partir do zero para ONTAP 8,2. Embora antigos usuários do Data ONTAP 7-Mode devam encontrar semelhanças, grandes melhorias foram feitas nesta versão do SnapVault. Um grande avanço é a capacidade de preservar eficiências de storage de dados primários durante transferências SnapVault.</block>
  <block id="9bc21373e0e299579a7ac86dcd4f513d" category="paragraph">Uma mudança arquitetônica importante é que o in ONTAP 9 replica no nível de volume em vez de no nível de qtree, como é o caso do SnapVault 7-Mode SnapVault. Essa configuração significa que a origem de um relacionamento do SnapVault deve ser um volume e esse volume deve ser replicado para seu próprio volume no sistema secundário do SnapVault.</block>
  <block id="d447048519c85a2fb3bea0790cd109fb" category="paragraph">Em um ambiente em que o SnapVault é usado, os snapshots nomeados especificamente são criados no sistema de storage primário. Dependendo da configuração implementada, os instantâneos nomeados podem ser criados no sistema principal por um agendamento do SnapVault ou por um aplicativo como o NetApp Active IQ Unified Manager. Os instantâneos nomeados que são criados no sistema primário são replicados para o destino SnapMirror e, a partir daí, são abobadados para o destino SnapVault.</block>
  <block id="5bc66b9c84b3f7cc0b375e729376b68d" category="inline-link">TR-4015 Guia de práticas recomendadas de configuração do SnapMirror para ONTAP 9.</block>
  <block id="0d510e96259254d285c6aaeb8458f45d" category="paragraph">Para obter as informações mais recentes sobre o SnapMirror e o SnapVault for ONTAP 9, consulte<block ref="32e7c991f675bf983c547a2a174c2caf" category="inline-link-rx"></block></block>
  <block id="657a41cce55646ab17754ac1427970af" category="paragraph">A figura a seguir mostra uma configuração em cascata SnapMirror to SnapVault. Se o destino do SnapVault estiver no local de DR ou em um local terciário que não seja afetado por uma interrupção no local primário, o ambiente poderá ser reconfigurado para permitir que os backups continuem após o failover.</block>
  <block id="cd92dffb12f75e4b81ad67d8668ae698" category="inline-image-macro">SnapMirror para SnapVault cascata</block>
  <block id="13ece5df0d16f65585acbfb9ebad113c" category="paragraph"><block ref="13ece5df0d16f65585acbfb9ebad113c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c74d71595c83ecb05581a89554ca8bb2" category="inline-image-macro">SnapMirror para SnapVault cascata reversa</block>
  <block id="5bb35c000e450925b37eff3feca75a24" category="paragraph"><block ref="5bb35c000e450925b37eff3feca75a24" category="inline-image-macro-rx" type="image"></block></block>
  <block id="63fd1f18d5d53fa97fd05a7fd96090b4" category="section-title">Uso de Qtrees em ambientes do Site Recovery Manager</block>
  <block id="345cb3f040f9f7f3f1a4261ed260aa79" category="section-title">Ambientes FC e iSCSI mistos</block>
  <block id="a60b166c2b69b4fdfbb733dc2193668a" category="paragraph">Com os protocolos SAN compatíveis (FC, FCoE e iSCSI), o ONTAP 9 fornece serviços LUN, ou seja, a capacidade de criar e mapear LUNs para hosts conectados. Como o cluster consiste em vários controladores, há vários caminhos lógicos gerenciados pela e/S multipath em qualquer LUN individual. O acesso de unidade lógica assimétrica (ALUA) é usado nos hosts para que o caminho otimizado para um LUN seja selecionado e seja ativado para transferência de dados. Se o caminho otimizado para qualquer LUN mudar (por exemplo, porque o volume que contém é movido), o ONTAP 9 reconhece e ajusta-se automaticamente para essa alteração sem interrupções. Se o caminho otimizado ficar indisponível, o ONTAP poderá alternar para qualquer outro caminho disponível sem interrupções.</block>
  <block id="32fd58743bd2ce579949a47db1b95ca8" category="summary">A replicação do vVols com o VASA oferece funcionalidade única em comparação com o SRA e os armazenamentos de dados tradicionais.</block>
  <block id="56687c1a324f03f5d1429500efea710e" category="doc">Solução de problemas do SRM ao usar a replicação vVols</block>
  <block id="ef74d715544e3b067a6bec3218ac5044" category="paragraph">Ao solucionar problemas, é benéfico entender os novos fluxos de trabalho, listados abaixo:</block>
  <block id="47f0942d341ee10381b2eff35089d75d" category="list-text">QueryReplicationPeer: Descobre os acordos de replicação entre dois domínios de falha.</block>
  <block id="136a299aae29998a147852cb0cba5b4a" category="list-text">QueryFaultDomain: Descobre a hierarquia do domínio de falha.</block>
  <block id="c071098c5df923c31f6245e4db2f3861" category="list-text">QueryReplicationGroup: Descobre os grupos de replicação presentes nos domínios de origem ou destino.</block>
  <block id="792cfe9ad3a3dc8528080a262e92989a" category="list-text">SyncReplicationGroup: Sincroniza os dados entre origem e destino.</block>
  <block id="39afb1e1e3b180a6230e07bb8571667e" category="list-text">QueryPointInTimeReplica: Descobre as réplicas de ponto no tempo em um destino.</block>
  <block id="9fb25fe2ff084dc9ccfb99eaccba7212" category="list-text">TestFailoverReplicationGroupStart: Inicia o failover de teste.</block>
  <block id="bd4e1dacaca4c37a53b5286b6ae0239d" category="list-text">TestFailoverReplicationGroupStop: Termina o failover de teste.</block>
  <block id="887f376a43cf9de1d6e14a8d69e588f6" category="list-text">PromoteReplicationGroup: Promove um grupo atualmente em teste para produção.</block>
  <block id="17ab16c5c0786ff381e6a085318bad9b" category="list-text">PrepareFailoverReplicationGroup: Prepara-se para uma recuperação de desastres.</block>
  <block id="665dd64ebcc4016bda94e0e8020d8c8e" category="list-text">FailoverReplicationGroup: Executa recuperação de desastres.</block>
  <block id="6936cf00e30b7cd4421225113a023c3e" category="list-text">ReverseReplicateGroup: Inicia a replicação reversa.</block>
  <block id="61ac8950a043e6998b458d4f8171154c" category="list-text">QueryMatchingContainer: Localiza contentores (junto com hosts ou grupos de replicação) que podem satisfazer uma solicitação de provisionamento com uma determinada política.</block>
  <block id="05c9efdc056d2af4640bc441ab61b53a" category="list-text">QueryResourceMetadata: Descobre os metadados de todos os recursos do provedor VASA, a utilização de recursos pode ser retornada como uma resposta para a função queryMatchingContainer.</block>
  <block id="01fa56986f885c588b1be8c206623de8" category="paragraph">O erro mais comum visto ao configurar a replicação do vVols é uma falha ao descobrir as relações do SnapMirror. Isso ocorre porque os volumes e as relações SnapMirror são criadas fora do escopo das Ferramentas do ONTAP. Portanto, é uma prática recomendada sempre garantir que sua relação com o SnapMirror esteja totalmente inicializada e que você tenha executado uma redescoberta nas Ferramentas do ONTAP em ambos os sites antes de tentar criar um armazenamento de dados vVols replicado.</block>
  <block id="b2891bc898f2a418aa349b623568299e" category="summary">O Active IQ Unified Manager capacita o monitoramento e a solução de problemas de storage e desempenho do NetApp em seu ambiente VMware vSphere.</block>
  <block id="5ecb6b24c169667ff1a176768115659e" category="doc">Active IQ Unified Manager</block>
  <block id="c95fa5b56a01e5c1a80c540c1ab1a750" category="paragraph">O Active IQ Unified Manager fornece visibilidade das VMs em sua infraestrutura virtual e permite monitorar e solucionar problemas de storage e performance em seu ambiente virtual.</block>
  <block id="be75250c2f30870dc1e359b4ade2a767" category="paragraph">Uma implantação típica de infraestrutura virtual no ONTAP tem vários componentes espalhados pelas camadas de computação, rede e storage. Qualquer atraso de desempenho em uma aplicação de VM pode ocorrer devido a uma combinação de latências enfrentadas pelos vários componentes nas respetivas camadas.</block>
  <block id="d1734f6f2e65a1488896f74695db5254" category="paragraph">A captura de tela a seguir mostra a exibição máquinas virtuais do Active IQ Unified Manager.</block>
  <block id="e88c947a5d8f4c0daec271a8595604a7" category="inline-image-macro">Visualização de máquinas virtuais do Active IQ Unified Manager</block>
  <block id="9078040b61fc8a9bd0215e8f35ff788c" category="paragraph"><block ref="9078040b61fc8a9bd0215e8f35ff788c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2118336fa447fcc0f213cb8c40c516af" category="paragraph">O Unified Manager apresenta o subsistema subjacente de um ambiente virtual em uma visualização topológica para determinar se ocorreu um problema de latência no nó de computação, na rede ou no storage. A visualização também destaca o objeto específico que causa o atraso de desempenho para tomar medidas corretivas e solucionar o problema subjacente.</block>
  <block id="d8a78b994fcd4e04901203a2e7bc6414" category="paragraph">A captura de tela a seguir mostra a topologia expandida do AIQUM.</block>
  <block id="0ef2f850d3f17cacfbd404bade7eed5b" category="inline-image-macro">AIQUM topologia expandida</block>
  <block id="75817aa97084cb93e0292a1f0549551f" category="paragraph"><block ref="75817aa97084cb93e0292a1f0549551f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="00cdd3f66e02711548cf72d579ec0df8" category="summary">O SnapCenter permite criar políticas de backup que podem ser aplicadas a vários trabalhos. Essas políticas podem definir agendamento, retenção, replicação e outros recursos. Elas continuam permitindo a seleção opcional de snapshots consistentes com VM, o que aproveita a capacidade do hipervisor de silenciar a I/o antes de tirar um snapshot da VMware.</block>
  <block id="99a66df20e19a8e18fae37a7f714750a" category="doc">Clonagem de VM e datastore</block>
  <block id="2438f6a80b933cf058ad052d26ac0703" category="paragraph">Clonar um objeto de storage permite criar rapidamente cópias para uso adicional, como provisionamento de VMs adicionais, operações de backup/recuperação etc.</block>
  <block id="fe12a277656562082ad50b980c227a84" category="paragraph">No vSphere, você pode clonar uma VM, um disco virtual, um vVol ou um datastore. Depois de clonado, o objeto pode ser ainda mais personalizado, muitas vezes por meio de um processo automatizado. O vSphere é compatível com clones de cópia completa, bem como clones vinculados, onde ele controla as alterações separadamente do objeto original.</block>
  <block id="883a97a36ab0c59ec785b03161a1cc32" category="paragraph">Os clones vinculados são ótimos para economizar espaço, mas aumentam a quantidade de e/S que o vSphere lida com a VM, afetando a performance dessa VM e, talvez, o host geral. É por isso que os clientes da NetApp costumam usar clones baseados em sistema de storage para obter o melhor dos dois mundos: Uso eficiente do storage e maior performance.</block>
  <block id="17e1a153b5d05c5a642c93ba9ce3c6de" category="paragraph">A figura a seguir mostra a clonagem de ONTAP.</block>
  <block id="8e00c91ecf143f76c94e3aa1668fc92b" category="inline-image-macro">Clonagem de ONTAP</block>
  <block id="9c7295440be885852a164f5880627146" category="paragraph"><block ref="9c7295440be885852a164f5880627146" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0452707f6213531bbf4f41e5f16cdead" category="paragraph">A clonagem pode ser descarregada para sistemas que executam o ONTAP por meio de vários mecanismos, normalmente no nível de VM, vVol ou datastore. Estes incluem o seguinte:</block>
  <block id="d957242cd67db8ffccec78d93c14449d" category="list-text">VVols usando o fornecedor de APIs do NetApp vSphere para reconhecimento de armazenamento (VASA). Os clones do ONTAP são usados para dar suporte aos snapshots do VVol gerenciados pelo vCenter que são eficientes em termos de espaço com efeito de e/S mínimo para criá-los e excluí-los. As VMs também podem ser clonadas usando o vCenter, e elas também são descarregadas para o ONTAP, seja em um único datastore/volume ou entre datastores/volumes.</block>
  <block id="f3968368501d882b3969da59138db6e2" category="paragraph">Você também pode clonar um volume ou LUN diretamente no ONTAP para clonar um armazenamento de dados. Com os datastores NFS, a tecnologia FlexClone pode clonar um volume inteiro, e o clone pode ser exportado do ONTAP e montado pelo ESXi como outro datastore. Para armazenamentos de dados VMFS, o ONTAP pode clonar um LUN em um volume ou volume inteiro, incluindo um ou mais LUNs nele. Um LUN que contém um VMFS deve ser mapeado para um grupo de iniciadores ESXi (igroup) e, em seguida, demarcado pelo ESXi para ser montado e usado como um datastore regular. Para alguns casos de uso temporário, um VMFS clonado pode ser montado sem uma nova assinatura. Depois que um datastore é clonado, as VMs dentro dele podem ser registradas, reconfiguradas e personalizadas como se fossem VMs clonadas individualmente.</block>
  <block id="2d506b6088a383ccf08479b0f80c0ff4" category="paragraph">Em alguns casos, recursos licenciados adicionais podem ser usados para aprimorar a clonagem, como o SnapRestore para backup ou o FlexClone. Essas licenças são frequentemente incluídas em pacotes de licenças sem nenhum custo adicional. É necessária uma licença FlexClone para as operações de clonagem da Vevolve, bem como para dar suporte a snapshots gerenciados de uma VVol (que são descarregados do hipervisor para a ONTAP). Uma licença do FlexClone também pode melhorar certos clones baseados em VAAI quando usados em um datastore/volume (cria cópias instantâneas com uso eficiente de espaço em vez de cópias em bloco). Ele também é usado pelo SRA ao testar a recuperação de uma réplica de DR e SnapCenter para operações de clone, além de pesquisar cópias de backup para restaurar arquivos individuais.</block>
  <block id="a4ec3dfc79c8493b1e9fcaee6b06b5a8" category="summary">A ONTAP tem amplo suporte para a nuvem híbrida.</block>
  <block id="0ce8b0e3e0d7dc7f39c62fb74a28b3bf" category="doc">Backup e migração para a nuvem</block>
  <block id="4fe11b4a91ff38ec9933009a15dd5b0b" category="paragraph">Outro ponto forte da ONTAP é o amplo suporte à nuvem híbrida, unindo sistemas na nuvem privada local com funcionalidades de nuvem pública. Aqui estão algumas soluções de nuvem da NetApp que podem ser usadas em conjunto com o vSphere:</block>
  <block id="bfdc61fd18bd1a23d9660561bc8999b7" category="list-text">*Cloud Volumes ONTAP.* O software de gerenciamento de dados NetApp Cloud Volumes ONTAP oferece controle, proteção, flexibilidade e eficiência aos seus dados na nuvem escolhida. O Cloud Volumes ONTAP é um software de gerenciamento de dados nativo da nuvem desenvolvido com base no storage ONTAP. Use em conjunto com o Cloud Manager para implantar e gerenciar instâncias do Cloud Volumes ONTAP em conjunto com seus sistemas ONTAP locais. Aproveite os recursos avançados de SAN nas e iSCSI, juntamente com o gerenciamento de dados unificado, incluindo snapshots e replicação SnapMirror.</block>
  <block id="99c6c4d349151c1f4a6694e424aef741" category="inline-link">Armazene mais snapshots de suas VMs</block>
  <block id="01fa297dbdab5aceb83a45a98161efe0" category="list-text">*FabricPool.* O FabricPool oferece disposição em camadas rápida e fácil para dados do ONTAP. Os blocos inativos podem ser migrados para um armazenamento de objetos em nuvens públicas ou em um armazenamento de objetos StorageGRID privado e são recuperados automaticamente quando os dados do ONTAP são acessados novamente. Ou use a categoria objeto como um terceiro nível de proteção para dados que já são gerenciados pelo SnapVault. Com essa abordagem, você pode<block ref="60d027dbb3c3f076cbb70c6b246eb433" category="inline-link-rx"></block> fazer isso em sistemas de storage ONTAP primário e/ou secundário.</block>
  <block id="1a7072854c9dd945a98f4314b3f77408" category="list-text">*ONTAP Select.* Use o storage definido por software da NetApp para estender sua nuvem privada pela Internet para instalações e escritórios remotos, onde você pode usar o ONTAP Select para oferecer suporte a serviços de bloco e arquivos, bem como os mesmos recursos de gerenciamento de dados do vSphere que você tem em seu data center empresarial.</block>
  <block id="79aec220098057ef8c0e46281a45d6c2" category="paragraph">Ao projetar suas aplicações baseadas em VM, considere a mobilidade futura na nuvem. Por exemplo, em vez de colocar arquivos de aplicativos e dados em conjunto, use uma exportação de LUN ou NFS separada para os dados. Isso permite que você migre a VM e os dados separadamente para os serviços de nuvem.</block>
  <block id="b1e1676a19b222da72a55b95aa86d3e9" category="paragraph">Para um mergulho profundo em mais tópicos de segurança, consulte os seguintes recursos.</block>
  <block id="1a523ba4ece9125275b92ebb41e3cf23" category="inline-link-macro">Documentação do Cloud Volumes ONTAP</block>
  <block id="e4501a9ef639002a658af0113906add9" category="list-text"><block ref="e4501a9ef639002a658af0113906add9" category="inline-link-macro-rx"></block></block>
  <block id="7436b418bed093768e360d32105591d2" category="inline-link-macro">Documentação do ONTAP Select</block>
  <block id="82fe32c89de73116e2188701ca735c39" category="list-text"><block ref="82fe32c89de73116e2188701ca735c39" category="inline-link-macro-rx"></block></block>
  <block id="c756b6b1ba6b752239a8d49eda5ad2a4" category="inline-link-macro">Documentação de backup e recuperação do BlueXP</block>
  <block id="f99b2e5828a20fe99efc9b8c25b42d83" category="list-text"><block ref="f99b2e5828a20fe99efc9b8c25b42d83" category="inline-link-macro-rx"></block></block>
  <block id="b044111e167403664c9e3432eca1f25a" category="inline-link-macro">Documentação de recuperação de desastres do BlueXP</block>
  <block id="ec39a9c8e559c87efc4a1ac3c8dfd136" category="list-text"><block ref="ec39a9c8e559c87efc4a1ac3c8dfd136" category="inline-link-macro-rx"></block></block>
  <block id="f5c286d9dc4cdaffcb8e5c86388e6ed8" category="list-text"><block ref="f5c286d9dc4cdaffcb8e5c86388e6ed8" category="inline-link-macro-rx"></block></block>
  <block id="4dab2f9796b0af6304d00e21e2b9dfb4" category="inline-link-macro">VMware Cloud na AWS</block>
  <block id="560d5b2cd40977bd7b77b31d7088f657" category="list-text"><block ref="560d5b2cd40977bd7b77b31d7088f657" category="inline-link-macro-rx"></block></block>
  <block id="e6aa20b5d3923ee0466f5d7e7bfed821" category="inline-link-macro">O que é o Azure NetApp Files?</block>
  <block id="810dc5c2e801b56b11325dd2aca0775c" category="list-text"><block ref="810dc5c2e801b56b11325dd2aca0775c" category="inline-link-macro-rx"></block></block>
  <block id="9789f0612fda153726aa8ad87265e4b9" category="inline-link-macro">Solução Azure VMware</block>
  <block id="f068ad668d317d445bc0da61125c318f" category="list-text"><block ref="f068ad668d317d445bc0da61125c318f" category="inline-link-macro-rx"></block></block>
  <block id="8cb69aa5b1609d0a39f0fcd576c07df6" category="inline-link-macro">Google Cloud VMware Engine</block>
  <block id="dadb2f85467c159b9d8387744cdd0ce6" category="list-text"><block ref="dadb2f85467c159b9d8387744cdd0ce6" category="inline-link-macro-rx"></block></block>
  <block id="e6288bb2b93ca74537fbff66317f01d9" category="inline-link-macro">O que é o Google Cloud NetApp volumes?</block>
  <block id="e19aa8cca2f701dba5fc123376bebdb5" category="list-text"><block ref="e19aa8cca2f701dba5fc123376bebdb5" category="inline-link-macro-rx"></block></block>
  <block id="0d761ccb2787bad60b77ac971f6d3914" category="summary">Esta página descreve as práticas recomendadas para a implementação do ONTAP FlexGroup volumes em um ambiente VMware vSphere.</block>
  <block id="ee1ef6cf0f3971b44eb2abcac958fb8d" category="doc">Volumes FlexGroup</block>
  <block id="adc6ae60e2ce9c7497e70727d5232a2d" category="paragraph">Use o ONTAP e o FlexGroup volumes com o VMware vSphere para armazenamentos de dados simples e dimensionáveis que aproveitam todo o poder de um cluster ONTAP inteiro.</block>
  <block id="55e0e7799b68cd76cf68be0ee82fef7b" category="section-title">Descarga de cópia</block>
  <block id="0db4fc806176bc768d44fa59cf3c36aa" category="paragraph">É possível que, se você usar a clonagem do VAAI, mas não clonar o suficiente para manter o cache aquecido, seus clones podem não ser mais rápidos do que uma cópia baseada em host. Se for esse o caso, você pode ajustar o tempo limite do cache para melhor atender às suas necessidades.</block>
  <block id="dd9bd4a686bdeb1c7f11dc3cd0cda75f" category="paragraph">Considere o seguinte cenário:</block>
  <block id="6b277580cb59b13790b36344e827e22f" category="list-text">Você criou um novo FlexGroup com 8 constituintes</block>
  <block id="32efd8b10cc3b73c344f4c7e6c4b741e" category="list-text">O tempo limite do cache para o novo FlexGroup é definido para 160 minutos</block>
  <block id="879f959734466d50681eae9b95e7e591" category="paragraph">Nesse cenário, os primeiros 8 clones a serem concluídos serão cópias completas, não clones de arquivos locais. Qualquer clonagem adicional dessa VM antes que o tempo limite de 160 segundos expire usará o mecanismo de clone de arquivo dentro de cada constituinte de uma forma round-robin para criar cópias quase imediatas distribuídas uniformemente pelos volumes constituintes.</block>
  <block id="1e8e371d8058e71f2444bc0cd42517eb" category="paragraph">Cada novo trabalho clone que um volume recebe repõe o tempo limite. Se um volume constituinte no exemplo FlexGroup não receber uma solicitação de clone antes do tempo limite, o cache para essa VM específica será limpo e o volume precisará ser preenchido novamente. Além disso, se a origem do clone original mudar (por exemplo, você atualizou o modelo), então o cache local em cada componente será invalidado para evitar qualquer conflito. Como dito anteriormente, o cache é ajustável e pode ser configurado para corresponder às necessidades do seu ambiente.</block>
  <block id="189aae773e13462525f07e99fcd9e90f" category="inline-link">VAAI: Como o armazenamento em cache funciona com o FlexGroup volumes?</block>
  <block id="0f98175ace2dd0d56e47961b22b2544b" category="paragraph">Em ambientes onde você não consegue aproveitar ao máximo o cache FlexGroup, mas ainda exige clonagem rápida entre volumes, considere o uso de vVols. A clonagem entre volumes com vVols é muito mais rápida do que usar datastores tradicionais e não depende de um cache.</block>
  <block id="6bcf203b609d41b14c06e319cede61d7" category="section-title">Definições de QoS</block>
  <block id="9ab9903a16c07ff38214a043719957fd" category="paragraph">A configuração do QoS no nível FlexGroup usando o Gerenciador de sistema do ONTAP ou o shell do cluster é suportada, no entanto, não fornece reconhecimento de VM ou integração do vCenter.</block>
  <block id="d9450aaad95d69e8cc75ddc0a69a9026" category="paragraph">O QoS (IOPS máx/min) pode ser definido em VMs individuais ou em todas as VMs em um datastore na IU do vCenter ou por meio de APIs REST usando ferramentas do ONTAP. A configuração de QoS em todas as VMs substitui todas as configurações separadas por VM. As configurações não se estendem a VMs novas ou migradas no futuro; defina a QoS nas novas VMs ou reaplique QoS a todas as VMs no datastore.</block>
  <block id="f32c3edaacea72c0ddb30ecf0135c4de" category="section-title">Métricas</block>
  <block id="ed7927d72c6154d79bedf6b19ea8fc83" category="paragraph">O ONTAP 9.8 também adicionou novas métricas de performance baseadas em arquivos (IOPS, taxa de transferência e latência) para o FlexGroup Files, e essas métricas podem ser visualizadas nas ferramentas do ONTAP para os relatórios de VM e painel do VMware vSphere. O plug-in das ferramentas do ONTAP para VMware vSphere também permite que você defina regras de qualidade do serviço (QoS) usando uma combinação de IOPS máximo e/ou mínimo. Eles podem ser configurados em todas as VMs em um datastore ou individualmente para VMs específicas.</block>
  <block id="43fc84d75bb64307120a48d004166174" category="inline-link-macro">Datastores e protocolos - NFS</block>
  <block id="b43cf2a2c13b864c3b2547368e95b2c5" category="list-text">Use as ferramentas do ONTAP para criar datastores do FlexGroup para garantir que o FlexGroup seja criado de forma otimizada e que as políticas de exportação sejam configuradas para corresponder ao seu ambiente vSphere. No entanto, depois de criar o volume FlexGroup com as ferramentas do ONTAP, você descobrirá que todos os nós do cluster do vSphere estão usando um único endereço IP para montar o datastore. Isso pode resultar em um gargalo na porta de rede. Para evitar esse problema, desmonte o datastore e remonte-o usando o assistente padrão do vSphere datastore usando um nome DNS de round-robin que carrega o balanceamento entre LIFs no SVM. Depois de remontar, as ferramentas do ONTAP poderão gerenciar o datastore novamente. Se as ferramentas do ONTAP não estiverem disponíveis, use os padrões do FlexGroup e crie sua política de exportação seguindo as diretrizes do <block ref="1dcda1ccb6404fd747bdfa52cd9e0cc2" category="inline-link-macro-rx"></block>.</block>
  <block id="689367b2abf9b4f7fdef5f8589689dbc" category="list-text">Ao dimensionar um armazenamento de dados do FlexGroup, lembre-se de que o FlexGroup consiste em vários volumes FlexVol menores que criam um namespace maior. Como tal, dimensione o datastore para ter pelo menos 8x (assumindo os componentes 8 padrão) o tamanho do seu maior arquivo VMDK mais 10-20% de espaço livre não utilizado para permitir flexibilidade no rebalanceamento. Por exemplo, se você tiver um VMDK de 6TB TB no seu ambiente, dimensione o datastore do FlexGroup não menor que 52,8TB TB (6x8 a 10%).</block>
  <block id="622b235a9123d972c612737c81eb55a1" category="inline-link-macro">NFSv3 nLigue o recurso ao NetApp e VMware</block>
  <block id="315f464c64861565200e97577a6eabde" category="list-text">O plug-in do SnapCenter para VMware vSphere versão 4,4 e posterior oferece suporte ao backup e à recuperação de VMs em um datastore FlexGroup no sistema de storage primário. A VCS 4,6 adiciona suporte ao SnapMirror para datastores baseados em FlexGroup. Usar snapshots e replicação baseados em array é a maneira mais eficiente de proteger seus dados.</block>
  <block id="2ab367df5e87b988bc086e5ee534793e" category="summary">Esta página descreve as práticas recomendadas para a implementação do VMware vSphere com armazenamentos de dados conectados a ONTAP e NFS.</block>
  <block id="0e768c8183bcbfc87718f59d9dfd61eb" category="inline-link-macro">armazenamentos de dados</block>
  <block id="14f3c0fa1399e57b5998b528cc5f3515" category="paragraph">O ONTAP é, entre muitas outras coisas, um array nas com escalabilidade horizontal de classe empresarial. O ONTAP capacita o VMware vSphere com acesso simultâneo a datastores conectados a NFS de muitos hosts ESXi, excedendo muito os limites impostos aos sistemas de arquivos VMFS. O uso do NFS com o vSphere oferece alguns benefícios de visibilidade da eficiência de storage e facilidade de uso, como mencionado na <block ref="72b655a9973dbed02099f5e63762d591" category="inline-link-macro-rx"></block>seção.</block>
  <block id="743fa5a7bc7d4ba215b096e34779d298" category="paragraph">As práticas recomendadas a seguir são recomendadas ao usar o ONTAP NFS com vSphere:</block>
  <block id="ae4c5baa79e370d8f601cc7082f8123e" category="list-text">Como não há conversão automática de datastore entre NFSv3 e NFSv4,1, crie um novo datastore NFSv4,1 e use o Storage vMotion para migrar VMs para o novo datastore.</block>
  <block id="8c93fb3ff528165613797962f5a0ed9c" category="list-text">Protocolo de acesso: nfs (que inclui nfs3 e nfs4)</block>
  <block id="bd6cc42f9cd65cca72cbd56d2f4bf43d" category="list-text">Regra de Acesso RO: Sys</block>
  <block id="0bbc71e6a4ea49af70dd616d3807e524" category="list-text">UID anónimo</block>
  <block id="6670a317619282ec228a9ef492af0a76" category="list-text">Os volumes do armazenamento de dados NFS são juntados do volume raiz do SVM. Portanto, o ESXi também precisa ter acesso ao volume raiz para navegar e montar volumes do armazenamento de dados. A política de exportação para o volume raiz e para quaisquer outros volumes em que a junção do volume do datastore esteja aninhada, deve incluir uma regra ou regras para os servidores ESXi concedendo acesso somente leitura. Aqui está uma política de exemplo para o volume raiz, também usando o plug-in VAAI:</block>
  <block id="80e6a4f964e826c69c1c62bd5ea67590" category="list-text">Regra de acesso RW: Nunca (melhor segurança para o volume raiz)</block>
  <block id="f96625174b4a06d13267f9b0a5a96d59" category="list-text">Superusuário: Sys (também necessário para o volume raiz com VAAI)</block>
  <block id="4c571520a8128d1692fc709ffbfb2b1e" category="list-text">Use as ferramentas do ONTAP para VMware vSphere (a prática recomendada mais importante):</block>
  <block id="23aa7b9aeed3fba2a1ec43e630313af7" category="list-text">Ao criar datastores para clusters VMware com o plug-in, selecione o cluster em vez de um único servidor ESX. Essa opção o aciona para montar automaticamente o datastore em todos os hosts do cluster.</block>
  <block id="928562eb576ed6ae31cb1a149d3e751a" category="list-text">Quando não estiver usando as ferramentas do ONTAP para VMware vSphere, use uma única política de exportação para todos os servidores ou para cada cluster de servidores onde é necessário controle de acesso adicional.</block>
  <block id="7bccab0fa4c0864835c645c9fde7ebf6" category="list-text">Embora o ONTAP ofereça uma estrutura de namespace de volume flexível para organizar volumes em uma árvore usando junções, essa abordagem não tem valor para o vSphere. Ele cria um diretório para cada VM na raiz do datastore, independentemente da hierarquia do namespace do storage. Assim, a prática recomendada é simplesmente montar o caminho de junção para volumes para vSphere no volume raiz do SVM, que é como as ferramentas do ONTAP para VMware vSphere provisionam datastores. Não ter caminhos de junção aninhados também significa que nenhum volume é dependente de qualquer volume que não seja o volume raiz e que tirar um volume off-line ou destruí-lo, mesmo intencionalmente, não afeta o caminho para outros volumes.</block>
  <block id="ea6fc1288f1d3b21238d29ff28cb867a" category="list-text">Um tamanho de bloco de 4K é bom para partições NTFS em datastores NFS. A figura a seguir mostra a conectividade de um host vSphere para um datastore ONTAP NFS.</block>
  <block id="e54433644e830ed1503561b778e9ded4" category="paragraph">A tabela a seguir lista as versões de NFS e os recursos compatíveis.</block>
  <block id="9fb9dac7513c7ef8452aade8a52ad40d" category="cell">Recursos do vSphere</block>
  <block id="5b12ee0369243579651edca43ff65c85" category="cell">NFSv3</block>
  <block id="de841868c2911da76b8ae2da9fa3166d" category="cell">NFSv4.1</block>
  <block id="64e3cc476958b05086721cd6070004cf" category="cell">VMotion e Storage vMotion</block>
  <block id="93cba07454f06a4a960172bbd6e2a435" category="cell">Sim</block>
  <block id="05807e454c19f244770adae059b3c330" category="cell">Alta disponibilidade</block>
  <block id="45a75e44a713fdf94dbf1dbaa0749188" category="cell">Tolerância de falhas</block>
  <block id="f1e3446c69e4d87279ff7863482f9dcb" category="cell">DRS</block>
  <block id="6ca09f98e8925b2cb78bbf24eccc0186" category="cell">Perfis de host</block>
  <block id="ec8420797e3b089812499cce4047ded8" category="cell">Armazenamento DRS</block>
  <block id="bafd7322c6e97d25b6299b5d6fe8920b" category="cell">Não</block>
  <block id="7c19bf1cbe62a87a42857ef0b4fe22ae" category="cell">Controle de e/S de storage</block>
  <block id="56d43ad1a280ada5e16fd2960ae44b32" category="cell">SRM</block>
  <block id="d595c8f30866b71ea121ced5cde66b1d" category="cell">Volumes virtuais</block>
  <block id="6ad5114acf73f68a85c72f11646920cb" category="cell">Aceleração de hardware (VAAI)</block>
  <block id="ad37ded9046268d8e5ea7cb253bb5dda" category="cell">Autenticação Kerberos</block>
  <block id="45701e6ef9bc09dca07f8f4abe661dc6" category="cell">Sim (aprimorado com o vSphere 6,5 e posterior para oferecer suporte a AES, krb5i)</block>
  <block id="76969a36155d2f41fc6cc3bd3faff244" category="cell">Suporte multipathing</block>
  <block id="bd90e11d4c9fc73f37adda8029276215" category="summary">Esta página descreve as práticas recomendadas para a implementação de uma solução de storage ONTAP em um ambiente VMware vSphere.</block>
  <block id="efd0bde36323238fec688b9cdf0c75a3" category="doc">SAN (FC, FCoE, NVMe/FC, iSCSI), RDM</block>
  <block id="8982d243303f9d1a8c2470b7d55278e6" category="list-text">Com datastores VMFS</block>
  <block id="9a0098c8c1be287e8d1da1aaf3bd2e59" category="list-text">Com mapeamento de dispositivo bruto (RDM)</block>
  <block id="1a85c0d242c43eb56cc500e60d323331" category="paragraph">O VMFS é um sistema de arquivos em cluster de alto desempenho que fornece datastores que são pools de armazenamento compartilhado. Armazenamentos de dados VMFS podem ser configurados com LUNs acessados usando FC, iSCSI, FCoE ou namespaces NVMe acessados usando os protocolos NVMe/FC ou NVMe/TCP. O VMFS permite que o armazenamento seja acessado simultaneamente por cada servidor ESX em um cluster. O tamanho máximo de LUN é geralmente 128TB, começando com ONTAP 9.12.1P2 (e anterior com sistemas ASA); portanto, um datastore VMFS 5 ou 6 de tamanho máximo de 64TB pode ser criado usando um único LUN.</block>
  <block id="8466b1e5abb4751e931c5feb1af4e469" category="inline-link">TR-4080</block>
  <block id="4157f0c23fc104508f492dc846f187f3" category="list-text">O SLM está ativado por predefinição. A menos que você esteja usando portsets, nenhuma configuração adicional é necessária.</block>
  <block id="ed0e76ed86e852bd7317a09d856ec4e8" category="paragraph">Outras práticas recomendadas a considerar:</block>
  <block id="93586ad57931e0f16fff61cdba9d77df" category="list-text">Certifique-se de que é criada uma interface lógica (LIF) para cada SVM em cada nó no cluster do ONTAP para obter disponibilidade e mobilidade máximas. A prática recomendada de SAN ONTAP é usar duas portas físicas e LIFs por nó, uma para cada malha. O ALUA é usado para analisar caminhos e identificar caminhos otimizados ativos (diretos) versus caminhos não otimizados ativos. O ALUA é usado para FC, FCoE e iSCSI.</block>
  <block id="b3cebb7381bddbabb1e950a46d264190" category="list-text">Para redes iSCSI, use várias interfaces de rede VMkernel em sub-redes de rede diferentes com agrupamento NIC quando vários switches virtuais estiverem presentes. Você também pode usar várias NICs físicas conetadas a vários switches físicos para fornecer HA e maior taxa de transferência. A figura a seguir fornece um exemplo de conectividade multipath. No ONTAP, configure um grupo de interface de modo único para failover com dois ou mais links conetados a dois ou mais switches ou use LACP ou outra tecnologia de agregação de links com grupos de interface multimodo para fornecer HA e os benefícios da agregação de links.</block>
  <block id="2968b9f3c141bf23bc73d0e6e15a174a" category="list-text">Se o CHAP (Challenge-Handshake Authentication Protocol) for usado no ESXi para autenticação de destino, ele também deve ser configurado no ONTAP usando a CLI <block ref="199c9b970eacf1c35d84a383b7ceb210" prefix="(" category="inline-code"></block>) ou com o Gerenciador de sistema (edite a segurança do iniciador em armazenamento &gt; SVMs &gt; Configurações da SVM &gt; Protocolos &gt; iSCSI).</block>
  <block id="d31f2e075df4ca75ca0874fa08f74b12" category="list-text">Use as ferramentas do ONTAP para o VMware vSphere para criar e gerenciar LUNs e grupos de pessoas. O plug-in determina automaticamente as WWPNs de servidores e cria grupos apropriados. Ele também configura LUNs de acordo com as melhores práticas e os mapeia para os grupos corretos.</block>
  <block id="de78559e8aed2cd62fbf852f73dc58c2" category="inline-link">modo de compatibilidade física e virtual</block>
  <block id="905221150fdd103b5241870a0a1f2c42" category="list-text">Use RDMs com cuidado porque eles podem ser mais difíceis de gerenciar e também usam caminhos, que são limitados como descrito anteriormente. Os LUNs ONTAP suportam ambos<block ref="27e1f8e5a88cfbb2836b083145b004c9" category="inline-link-rx"></block> os RDMs.</block>
  <block id="636da39a2033c6179a718983c5ce1222" category="inline-link">Guia de configuração de host ONTAP NVMe/FC</block>
  <block id="81ef6507a13da5635951bc5b533deb59" category="inline-link">TR-4684</block>
  <block id="15483b0826bb9a4b11d1c89af2029c5c" category="list-text">Para saber mais sobre como usar o NVMe/FC com o vSphere 7,0, consulte este<block ref="6b4ed262d14e47ef641cd57b65c32c38" category="inline-link-rx"></block> e<block ref="7a29b2f31035a451d5b068728d2b79a7" category="inline-link-rx"></block>.a figura a seguir mostra a conectividade multipath de um host vSphere para um LUN ONTAP.</block>
  <block id="7dbbfa4d228c6ffe9a64c938bc057b0d" category="inline-image-macro">conectividade multipath</block>
  <block id="4525956d57ef52f4b2a4f341fbeec28e" category="paragraph"><block ref="4525956d57ef52f4b2a4f341fbeec28e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="043d75b2a25cf6f38bccaf9211c5bcc5" category="summary">Esta página descreve as práticas recomendadas para a implementação de uma solução de storage ONTAP em um ambiente VMware vSphere.</block>
  <block id="830d984ea50f71fa76636d0524167a3a" category="doc">Visão geral dos recursos do vSphere datastore e do protocolo</block>
  <block id="a7c815fafe60ae637d38216fa6300395" category="list-text">FCP</block>
  <block id="26bcb9f1cb6f391f4b2c18e676bb458d" category="list-text">NVMe/FC</block>
  <block id="8b7c42123642e2e4ea7dd426aeb2de58" category="list-text">NVMe/TCP</block>
  <block id="e4e1c13bb0b14f6cb7608cbecea948ef" category="list-text">ISCSI</block>
  <block id="f7d773fd2896401c143676940bc001fc" category="list-text">NFS v3</block>
  <block id="0b99b245267ef194ca3b9f6e694b0983" category="list-text">NFS v4.1</block>
  <block id="9da73946f1bc3be4a41898d06c9d2e8b" category="cell">Capacidade/funcionalidade</block>
  <block id="6151632541dcd80356c6c76b34d69d0c" category="cell">NVMe-of</block>
  <block id="520d0db389f362bf79ef56ca0af3dcab" category="cell">Formato</block>
  <block id="99a3142584ca8ad0a3afadeaa6f2ef69" category="cell">VMFS ou mapeamento de dispositivo bruto (RDM)</block>
  <block id="26aae26f61844ac20ab7b04ba6f5c515" category="cell">VMFS ou RDM</block>
  <block id="18263a30df8afc60a733e59c60676ac0" category="cell">VMFS</block>
  <block id="8dc6d0c66219ddb809322c0d248e55e6" category="cell">Número máximo de armazenamentos de dados ou LUNs</block>
  <block id="aa23f9914ce1939ea7a4d479edfdc915" category="cell">1024 LUNs por host</block>
  <block id="1af3b27207afc48a363629a315d76b59" category="cell">1024 LUNs por servidor</block>
  <block id="0705fd627c25b5fba17cd9a022ed7d72" category="cell">256 Namespeces por servidor</block>
  <block id="51c0dc217976e27de06e262947947a62" category="cell">Tamanho máximo do datastore</block>
  <block id="856c997f909830b8249756c07dc9452b" category="cell">64 TB</block>
  <block id="b4fb1d41fedaec79072964cbb4d16e3d" category="cell">Tamanho máximo do arquivo do datastore</block>
  <block id="d10549beb2f7bd1e91e5ef8965edd84a" category="cell">62 TB</block>
  <block id="18301e675ce7d51c23071d7b135edbdc" category="cell">62TB com ONTAP 9.12.1P2 e posterior</block>
  <block id="9aa56a79640231adaec83bc53e59c929" category="cell">Profundidade de fila ideal por LUN ou sistema de ficheiros</block>
  <block id="c7dfde106afbb4e1d55096403af252e0" category="cell">64-256</block>
  <block id="ca6e77250a239af7b4aed9a1ac058825" category="cell">Negociação automática</block>
  <block id="6104c8ef7be4222a76596ab6a22bb422" category="inline-link-macro">Host ESXi recomendado e outras configurações do ONTAP</block>
  <block id="760f70bd45ae12af9fa6bee90f402eeb" category="cell">Consulte NFS.MaxQueueDepth em <block ref="1f38ac07598dbb4b06912539aafa4211" category="inline-link-macro-rx"></block>.</block>
  <block id="edc5121cb9b42a76b718b8ece9d67437" category="paragraph">A tabela a seguir lista as funcionalidades relacionadas ao armazenamento VMware suportadas.</block>
  <block id="130b78bfd6c9b050a912fec77e285e3f" category="cell">Capacidade/recurso</block>
  <block id="6c1a84b789b54fd42511ce582be94d21" category="cell">VMotion</block>
  <block id="e95b58d02782c970bb339c6cc587ff39" category="cell">Storage vMotion</block>
  <block id="0486e0e3dc3e86859f43b6d8e32b8071" category="cell">VMware HA</block>
  <block id="8be6bd7f20474cbefdd496cb9fd495ca" category="cell">Storage Distributed Resource Scheduler (SDRS)</block>
  <block id="28c2f8ab9cdbf296aa4261bc3c58ba0d" category="cell">Microsoft Cluster Service (MSCS) ou cluster de failover em uma VM</block>
  <block id="aa7f77e663b832d5b0e544c5511e680c" category="cell">Não suportado</block>
  <block id="aa18abedec09bd4f85e612c307e2eaa6" category="cell">Tolerância de falhas</block>
  <block id="e11f298a5bd5344d2d975b5157c27b69" category="cell">Não**</block>
  <block id="17d495427086fa21259b9df40b27e00a" category="cell">VMs com thin Provisioning (discos virtuais)</block>
  <block id="4ee7af004efef335d6a14c60ee758f5e" category="cell">Sim esta configuração é o padrão para todas as VMs no NFS quando não estiver usando o VAAI.</block>
  <block id="13bc264ff420559de4156ec40980a4b9" category="cell">Multipathing nativo da VMware</block>
  <block id="b69cd5a82aaf0c524a71d46ec6fdd29c" category="cell">O entroncamento de sessão NFS v4,1 requer ONTAP 9.14,1 e posterior</block>
  <block id="a06819d91a165d0491c5816c54b41234" category="paragraph">A tabela a seguir lista os recursos de gerenciamento de armazenamento ONTAP compatíveis.</block>
  <block id="f8d61013f1a3bbf1342f4ced3279c7cf" category="cell">Deduplicação de dados</block>
  <block id="72167540968147afed9deb59f0e9fe00" category="cell">Economia no array</block>
  <block id="9a5473a6abaea16b736f096913a749be" category="cell">Economia no datastore</block>
  <block id="5caeb11c4ed379b808d7f7cdca7cfbf0" category="cell">Datastore ou RDM</block>
  <block id="8a5227cc82d14862956938caffc1acf2" category="cell">Armazenamento de dados</block>
  <block id="b71ba22dcd42deceac87150206f7bd12" category="cell">Redimensione o datastore</block>
  <block id="c6b792bfd7aac8067d36337e67d11545" category="cell">Cresça apenas</block>
  <block id="29e23534878bb63341e0b689426b7fb0" category="cell">Crescer, crescer com crescimento automático e diminuir</block>
  <block id="76021405cc62a4b8c542e7f65e3d24ed" category="cell">Plug-ins do SnapCenter para Windows, aplicações Linux (no convidado)</block>
  <block id="c0b3c629432c82a9e8500242abb35eaf" category="cell">Monitoramento e configuração de host usando as ferramentas do ONTAP para VMware vSphere</block>
  <block id="5a915a8215e9a66bcff0f034e8adff18" category="cell">Provisionamento usando as ferramentas do ONTAP para VMware vSphere</block>
  <block id="6495c7cda42bf1b80bc1c2af6166ef58" category="paragraph">A tabela a seguir lista os recursos de backup suportados.</block>
  <block id="bf22a1b5bc2b72a75825094826a942de" category="cell">SRM suportado por backups replicados</block>
  <block id="60d3f7d9f265eb34e826da352cb545be" category="cell">Volume SnapMirror</block>
  <block id="fabf31a57c142c986c5d88cb089b3d7b" category="cell">Acesso à imagem VMDK</block>
  <block id="d7605580ecad0fcb4528789d74cdcad5" category="cell">Acesso ao nível do arquivo VMDK</block>
  <block id="4e3d259d82a536e12c5c9c948b62e26a" category="cell">Granularidade NDMP</block>
  <block id="90d45e02e50c81603c36a4e4ad3649d9" category="cell">Datastore ou VM</block>
  <block id="8339c514e73f5cced3b83d504d60441b" category="inline-link">Configuração para Cluster de failover do Windows Server</block>
  <block id="54b3e11ce37eaaa9884f4086e72dd2be" category="section-title">Selecionar um protocolo de armazenamento</block>
  <block id="0212b4e8bc965dcd8a7ff771dd96bf21" category="paragraph">Os seguintes fatores podem ser úteis para considerar uma escolha de protocolo:</block>
  <block id="774f1348caf3e145710073eb634c4fa1" category="list-text">* Facilidade de configuração.* Além da configuração inicial da malha FC (switches e cabeamento adicionais, zoneamento e verificação de interoperabilidade de HBA e firmware), os protocolos de bloco também exigem criação e mapeamento de LUNs e descoberta e formatação pelo SO convidado. Depois que os volumes NFS são criados e exportados, eles são montados pelo host ESXi e prontos para uso. O NFS não tem nenhuma qualificação especial de hardware ou firmware para gerenciar.</block>
  <block id="530c759326761c6ac026b313985b255f" category="list-text">*Transparência do espaço de armazenamento.* A utilização do storage geralmente é mais fácil de ver em ambientes NFS porque o thin Provisioning devolve economia imediatamente. Da mesma forma, a economia de deduplicação e clonagem ficam imediatamente disponíveis para outras VMs no mesmo armazenamento de dados ou para outros volumes do sistema de storage. Normalmente, a densidade da VM também é maior em um armazenamento de dados NFS, o que pode melhorar a economia de deduplicação e reduzir os custos de gerenciamento com menos armazenamentos de dados para gerenciar.</block>
  <block id="16ee928b12bc598bf52b0f312879ec95" category="section-title">Layout do datastore</block>
  <block id="8c761039ef4dd69451490b849ace1f82" category="list-text">Evite o uso de utilitários de desfragmentação no sistema operacional convidado, pois isso não oferece nenhum benefício de desempenho e afeta a eficiência de armazenamento e o uso de espaço instantâneo. Considere também desativar a indexação de pesquisa no SO convidado para desktops virtuais.</block>
  <block id="14abb814748566a24367c4459a54840b" category="list-text">A ONTAP liderou o setor com recursos de eficiência de storage inovadores, permitindo que você aproveite ao máximo seu espaço em disco utilizável. Os sistemas AFF levam essa eficiência ainda mais longe com a deduplicação e a compactação in-line padrão. Os dados são deduplicados em todos os volumes de um agregado. Portanto, você não precisa mais agrupar sistemas operacionais semelhantes e aplicativos semelhantes em um único datastore para maximizar a economia.</block>
  <block id="446548f2b1301893641e29657fc7fe53" category="inline-link-macro">Bancos de dados Oracle no ONTAP</block>
  <block id="6cda576d2fd323c1a728b7ac67d6034f" category="list-text">Os discos de primeira classe (ou discos virtuais aprimorados) permitem discos gerenciados pelo vCenter, independentemente de uma VM com o vSphere 6,5 e posterior. Embora gerenciados principalmente pela API, eles podem ser úteis com o vVols, especialmente quando gerenciados por ferramentas OpenStack ou Kubernetes. Eles são suportados pelo ONTAP, bem como pelas ferramentas do ONTAP para VMware vSphere.</block>
  <block id="71318121439b39fdf872bb0bd57494f2" category="section-title">Migração de datastore e VM</block>
  <block id="e8824ce2062c6d1fc536163f7b8940bd" category="paragraph">Ao migrar VMs de um datastore existente em outro sistema de storage para o ONTAP, veja algumas práticas a serem lembradas:</block>
  <block id="73b729fbc964c7d78dd90b64aaaeb785" category="list-text">Use o Storage vMotion para mover o volume de suas máquinas virtuais para o ONTAP. Essa abordagem não só não causa interrupções às VMs em execução, como também permite que recursos de eficiência de storage da ONTAP, como deduplicação e compactação, processem os dados à medida que migram. Considere usar os recursos do vCenter para selecionar várias VMs da lista de inventário e, em seguida, agendar a migração (use a tecla Ctrl enquanto clica em ações) em um momento apropriado.</block>
  <block id="ef7f5a0b4e0866202a92874cc85a2fd2" category="list-text">As máquinas virtuais que precisam de uma migração mais cuidadosa incluem bancos de dados e aplicativos que usam armazenamento anexado. Em geral, considere o uso das ferramentas do aplicativo para gerenciar a migração. Para Oracle, considere usar ferramentas Oracle como RMAN ou ASM para migrar os arquivos do banco de dados. Consulte<block ref="74eec9db95a0d18126c677c2dcc1d6f1" category="inline-link-rx"></block> para obter mais informações. Da mesma forma, para o SQL Server, considere usar ferramentas do SQL Server Management Studio ou do NetApp, como o SnapManager para SQL Server ou SnapCenter.</block>
  <block id="9fb2cc2ced88ce872ef16c37d8284360" category="paragraph">O plug-in também ajuda a usar outras ferramentas do ONTAP em ambientes vSphere. Ele permite instalar o plug-in NFS para VMware VAAI, que permite descarga de cópia para o ONTAP para operações de clonagem de VM, reserva de espaço para arquivos de disco virtual espessos e descarga de snapshot ONTAP.</block>
  <block id="6161d374e9022f89382fd63b4be15aa1" category="section-title">Rede geral</block>
  <block id="8c796e9ce33123891311630e9843b227" category="paragraph">A configuração das configurações de rede ao usar o vSphere com sistemas executando o ONTAP é simples e semelhante a outras configurações de rede. Aqui estão algumas coisas a considerar:</block>
  <block id="e817ecc2f82a2b78d828ec8704031da3" category="inline-link-macro">Ligação direta em rede</block>
  <block id="70901a02a148fd2dfc1ff5736f4f5336" category="list-text">Separe o tráfego de rede de armazenamento de outras redes. Uma rede separada pode ser obtida usando uma VLAN dedicada ou switches separados para armazenamento. Se a rede de armazenamento partilhar caminhos físicos, como uplinks, poderá necessitar de portas de QoS ou uplink adicionais para garantir uma largura de banda suficiente. Não conete os hosts diretamente ao storage; use os switches para ter caminhos redundantes e permitir que o VMware HA funcione sem intervenção. <block ref="2d54da766c3f840b00eab5923273fca5" category="inline-link-macro-rx"></block>Consulte para obter informações adicionais.</block>
  <block id="7c4904daaa282388097ad83bf382e1a5" category="list-text">Os frames grandes podem ser usados se desejado e suportados pela sua rede, especialmente ao usar iSCSI. Se forem usados, certifique-se de que estejam configurados de forma idêntica em todos os dispositivos de rede, VLANs e assim por diante no caminho entre o armazenamento e o host ESXi. Caso contrário, você pode ver problemas de desempenho ou conexão. A MTU também deve ser definida de forma idêntica no switch virtual ESXi, na porta VMkernel e também nas portas físicas ou grupos de interface de cada nó ONTAP.</block>
  <block id="8b6e7f43d1d697e8f99164f0aa2ab1b6" category="inline-link">TR-4182</block>
  <block id="730a8287f758961d602b1b050bbe2751" category="list-text">Quando os storages ESXi e ONTAP estão conetados a redes de armazenamento Ethernet, a NetApp recomenda configurar as portas Ethernet às quais esses sistemas se conetam como portas de borda de protocolo de árvore de expansão rápida (RSTP) ou usando o recurso Cisco PortFast. A NetApp recomenda ativar o recurso de tronco de porta de árvore de expansão rápida em ambientes que usam o recurso Cisco PortFast e que têm entroncamento de VLAN 802,1Q habilitado para o servidor ESXi ou para os storages ONTAP.</block>
  <block id="ac4976538e1fc8726f77afc202561afc" category="list-text">A NetApp recomenda as seguintes práticas recomendadas para agregação de links:</block>
  <block id="c7949782ad094d3ffc126bee722642a3" category="list-text">Use switches que suportam agregação de links de portas em dois chassis de switch separados usando uma abordagem de grupo de agregação de links de vários gabinetes, como o Virtual PortChannel (VPC) da Cisco.</block>
  <block id="19d137845c7f6687c99b386dfad0aa97" category="list-text">Desative o LACP para portas de switch conetadas ao ESXi a menos que você esteja usando dvSwitches 5,1 ou posterior com o LACP configurado.</block>
  <block id="9dc1904e0c3ace141704b477cd9b345d" category="inline-link">Gerenciamento de rede</block>
  <block id="68ecdb0d7a96e68318a53d12e9fab5b5" category="list-text">Use o LACP para criar agregados de link para sistemas de storage ONTAP com grupos de interface multimodo dinâmico com hash de porta ou IP. <block ref="b87480ad0ff34784c4be1445a72a3aaf" category="inline-link-rx"></block>Consulte para obter mais orientações.</block>
  <block id="3b407fe7c9654197902b1dd26af6dc81" category="list-text">Use uma política de agrupamento de hash IP no ESXi ao usar agregação de link estático (por exemplo, EtherChannel) e vSwitches padrão ou agregação de link baseada em LACP com switches distribuídos vSphere. Se a agregação de links não for usada, use "Rota baseada no ID de porta virtual de origem".</block>
  <block id="2432030fc6183a1a6c52cf5e93f3e9ae" category="paragraph">A tabela a seguir fornece um resumo dos itens de configuração de rede e indica onde as configurações são aplicadas.</block>
  <block id="7d74f3b92b19da5e606d737d339a9679" category="cell">Item</block>
  <block id="1aa66ef3a8e34a7a538960a80d2e1e31" category="cell">ESXi</block>
  <block id="bbc155fb2b111bf61c4f5ff892915e6b" category="cell">Interrutor</block>
  <block id="6c3a6944a808a7c0bbb6788dbec54a9f" category="cell">Nó</block>
  <block id="75ba8d70e3692ba200f0e0df37b4d2ae" category="cell">Endereço IP</block>
  <block id="ee6c0f25c2881cc69947a2ef23be5b8c" category="cell">VMkernel</block>
  <block id="d6f0876f76c273b8962b749c36153157" category="cell">Agregação de links</block>
  <block id="fabd320b3b2249377e53e93099e27657" category="cell">Switch virtual</block>
  <block id="b1b40427c8eb8d0a083ddb16e250325b" category="cell">Não*</block>
  <block id="9881f82f0dd89588831f9d1682bd5492" category="cell">VLAN</block>
  <block id="5fc0d231160fa9650ea5c877f146bbe6" category="cell">Grupos de portas VMkernel e VM</block>
  <block id="39a3e05f380e583ae2887c79c7443f11" category="cell">Controle de fluxo</block>
  <block id="220071ab44b426f80ef21f1c552c363c" category="cell">NIC</block>
  <block id="6f2c08412f489e52a17a30217f50b3c1" category="cell">Spanning tree</block>
  <block id="4b1c0df98ba3f3d1681c3c3dbdc97746" category="cell">MTU (para quadros jumbo)</block>
  <block id="7d6feaf896df4a937157d4ee5b91f4e1" category="cell">Switch virtual e porta VMkernel (9000)</block>
  <block id="0110e50bd8629573701e73a4ba8b056f" category="cell">Sim (definido para máx.)</block>
  <block id="061ff5255adf00e4ae68469f43a7bf55" category="cell">Sim (9000)</block>
  <block id="bcc0e5a3e08cd34e80692195d056b06d" category="cell">Grupos de failover</block>
  <block id="a4d1a66a448e327c12d3e287098a31d5" category="cell">Sim (criar)</block>
  <block id="465d5674eb6808b997037470f4dace73" category="cell">Sim (selecione)</block>
  <block id="ba78d695573c8d4f1205452c675fa539" category="paragraph">*Os LIFs SVM se conetam a portas, grupos de interfaces ou interfaces VLAN que têm VLAN, MTU e outras configurações. No entanto, as configurações não são gerenciadas no nível da SVM.</block>
  <block id="50ecdab93bf5a2f1bfb4cd8f81b9bd3d" category="paragraph">**Esses dispositivos têm endereços IP próprios para gerenciamento, mas esses endereços não são usados no contexto da rede de armazenamento ESXi.</block>
  <block id="7e7397a7b79323762c61941fc0e6b5f9" category="doc">Proteção de dados</block>
  <block id="61823c0f572643e0ce2e4edcb74cae51" category="paragraph">Use snapshots para fazer cópias rápidas da VM ou do armazenamento de dados sem afetar a performance e enviá-las para um sistema secundário usando o SnapMirror para proteção de dados externa a mais longo prazo. Essa abordagem minimiza o espaço de armazenamento e a largura de banda da rede, armazenando apenas informações alteradas.</block>
  <block id="1556ba0bf6ea4783cda0ff40e96f0265" category="paragraph">A figura a seguir mostra um exemplo de implantação do SnapCenter.</block>
  <block id="570bfadf5783125790b6c87f55842fb2" category="inline-image-macro">Implantação de SnapCenter</block>
  <block id="71ca4878111d253f9883f471e5de9594" category="paragraph"><block ref="71ca4878111d253f9883f471e5de9594" category="inline-image-macro-rx" type="image"></block></block>
  <block id="650062685b0df8284f1b87f62fa3f9f3" category="inline-link">TR-4128</block>
  <block id="c90946faf2ed37e17d936e0b3acde7a7" category="summary">Há uma demanda cada vez maior para criptografar dados em repouso, indo além dos dados tradicionais para todos os tipos de dados armazenados.</block>
  <block id="af63597853dc0983258c8f86a12aae0b" category="doc">Criptografia para dados do vSphere</block>
  <block id="63a07ab9352c9297cea3894d6cd41c3f" category="paragraph">Hoje, há cada vez mais demandas para proteger dados em repouso por meio da criptografia. Embora o foco inicial tenha sido em informações financeiras e de saúde, há um interesse crescente em proteger todas as informações, sejam elas armazenadas em arquivos, bancos de dados ou outros tipos de dados.</block>
  <block id="937a352e0f824ff55e4cd50c8e3b051e" category="paragraph">Existem várias abordagens para proteger os dados de aplicativos virtualizados em execução no VMware vSphere. Uma abordagem é proteger os dados com software dentro da VM no nível do SO convidado. Os hipervisores mais recentes, como o vSphere 6,5, agora oferecem suporte à criptografia no nível da VM como outra alternativa. No entanto, a criptografia do software NetApp é simples e fácil e tem esses benefícios:</block>
  <block id="6eda79cc710edc32583cf567b00e7672" category="list-text">*Nenhum efeito na CPU do servidor virtual.* Alguns ambientes de servidor virtual precisam de cada ciclo de CPU disponível para seus aplicativos, mas os testes mostraram que até 5x recursos de CPU são necessários com criptografia no nível do hipervisor. Mesmo que o software de criptografia ofereça suporte ao conjunto de instruções AES-NI da Intel para descarregar a carga de trabalho de criptografia (como a criptografia do software NetApp), essa abordagem pode não ser viável devido à exigência de novas CPUs que não são compatíveis com servidores mais antigos.</block>
  <block id="c216121021de8554d33503ef6616b256" category="list-text">*Nenhum efeito na eficiência de armazenamento.* Técnicas de eficiência de storage, como deduplicação e compactação, são amplamente utilizadas atualmente e são essenciais para usar a Mídia de disco flash de maneira econômica. No entanto, os dados criptografados geralmente não podem ser desduplicados ou compatados. O hardware e a criptografia de storage da NetApp operam em um nível mais baixo e permitem o uso total dos recursos de eficiência de storage da NetApp líderes do setor, ao contrário de outras abordagens.</block>
  <block id="5f9aa8333f218d1c21e67c8608a48672" category="list-text">*Criptografia granular fácil do datastore.* Com a criptografia de volume NetApp, cada volume recebe sua própria chave AES de 256 bits. Se você precisar alterá-lo, você pode fazê-lo com um único comando. Essa abordagem é ótima se você tiver vários locatários ou precisar provar criptografia independente para diferentes departamentos ou aplicativos. Essa criptografia é gerenciada no nível do datastore, o que é muito mais fácil do que gerenciar VMs individuais.</block>
  <block id="e6bd708199eed7d8bf33ef8308be0b3e" category="inline-link-macro">Relatórios técnicos de segurança</block>
  <block id="fb7f6edb08c080e81bd91a922a9d08f8" category="list-text"><block ref="fb7f6edb08c080e81bd91a922a9d08f8" category="inline-link-macro-rx"></block></block>
  <block id="ff8c9f0959eb84d21416835c3f9c89d6" category="inline-link-macro">Guias de proteção de segurança</block>
  <block id="589b1ebfaed268e1548717208be6131f" category="list-text"><block ref="589b1ebfaed268e1548717208be6131f" category="inline-link-macro-rx"></block></block>
  <block id="e44de13cc4b452eccde9961bbe9da42b" category="inline-link-macro">Documentação do produto de segurança e criptografia de dados do ONTAP</block>
  <block id="c76e848365d3a2199dfced47ddbf8690" category="list-text"><block ref="c76e848365d3a2199dfced47ddbf8690" category="inline-link-macro-rx"></block></block>
  <block id="5dd57c2a315d3af44c2eb40eefc47111" category="doc">Configuração de rede</block>
  <block id="66149c951df015fb5f7aa252fa92bf64" category="paragraph">A configuração das configurações de rede ao usar o vSphere com sistemas executando o ONTAP é simples e semelhante a outras configurações de rede.</block>
  <block id="66507f357c74ee12194270cfe053b98d" category="paragraph">Aqui estão algumas coisas a considerar:</block>
  <block id="30254a2bb3e4b3b958b06d08c724e7db" category="list-text">Use o LACP para criar agregados de link para sistemas de storage ONTAP com grupos de interface multimodo dinâmico com hash IP.</block>
  <block id="d608421cceb8e4c584a2a32d9127879e" category="list-text">Use uma política de agrupamento de hash IP no ESXi.</block>
  <block id="ab906277df9ce070b1e11724f8ccf589" category="list-text">Use uma única interface lógica (LIF) para cada SVM em cada nó no cluster do ONTAP. As recomendações anteriores de um LIF por datastore não são mais necessárias. Embora o acesso direto (LIF e datastore no mesmo nó) seja o melhor, não se preocupe com o acesso indireto porque o efeito de desempenho geralmente é mínimo (microssegundos).</block>
  <block id="8dc90de75c19a4114217f443b0ca2866" category="inline-image-macro">Conectividade de um host vSphere para um datastore ONTAP NFS</block>
  <block id="36b9a8da16a1d2fad06b788e662b7c4a" category="paragraph"><block ref="36b9a8da16a1d2fad06b788e662b7c4a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="59cfc5aaa0678bcb883492b4397c71b8" category="cell">Sim (ONTAP 9.14,1)</block>
  <block id="bb6d2d52dfe07f9662232c444256aece" category="paragraph">Um host usando iSCSI ou NVMe/TCP pode ser conetado diretamente a um sistema de storage e operar normalmente. A razão é pathing. Conexões diretas a dois controladores de storage diferentes resultam em dois caminhos independentes para o fluxo de dados. A perda de caminho, porta ou controlador não impede que o outro caminho seja usado.</block>
  <block id="3436a7073ac9f4071820b6720a7789fc" category="section-title">FC Direct Connect</block>
  <block id="d96a9839a4f7a8d356a868bd23816516" category="summary">O ONTAP é uma solução de storage líder para ambientes VMware vSphere há quase duas décadas e continua adicionando recursos inovadores para simplificar o gerenciamento e reduzir custos. Este documento apresenta a solução ONTAP para vSphere, incluindo as informações mais recentes sobre produtos e as melhores práticas, para simplificar a implantação, reduzir riscos e simplificar o gerenciamento.</block>
  <block id="09b616c445ab7efa8240062532e526e4" category="doc">VMware vSphere com ONTAP</block>
  <block id="48e29772cebbf1133d022577e278d5c1" category="admonition">Esta documentação substitui os relatórios técnicos publicados anteriormente _TR-4597: VMware vSphere for ONTAP_</block>
  <block id="bfa7e7fc7c6bf4cc4e4c5c74b09763eb" category="paragraph">As práticas recomendadas complementam outros documentos, como guias e listas de compatibilidade. Eles são desenvolvidos com base em testes de laboratório e extensa experiência de campo por engenheiros e clientes da NetApp. Elas podem não ser as únicas práticas suportadas que funcionam em todos os ambientes, mas são geralmente as soluções mais simples que atendem às necessidades da maioria dos clientes.</block>
  <block id="9ed4a475dd3705157a9fed8811f63ce2" category="inline-link">Ferramenta de Matriz de interoperabilidade do NetApp</block>
  <block id="e08175c6fa64cba68719dea85ebd9d34" category="inline-link">Guia de compatibilidade da VMware</block>
  <block id="a110ecc6d4ce7014019c560e5fedf572" category="paragraph">Há muitos motivos pelos quais dezenas de milhares de clientes escolheram o ONTAP como sua solução de storage para o vSphere, como um sistema de storage unificado compatível com protocolos SAN e nas, recursos robustos de proteção de dados usando snapshots com uso eficiente de espaço e diversas ferramentas para ajudar você a gerenciar dados de aplicações. O uso de um sistema de storage separado do hipervisor permite descarregar várias funções e maximizar seu investimento nos sistemas de host vSphere. Essa abordagem não só garante que os recursos de host estejam focados nas cargas de trabalho dos aplicativos, mas também evita efeitos aleatórios de desempenho nos aplicativos das operações de storage.</block>
  <block id="7a61ec7965eebc0b5486cb78f096c770" category="list-text">*E muito mais.* Aproveite a performance extrema dos arrays NetApp AFF A-Series para acelerar sua infraestrutura virtualizada e gerenciar custos. Aproveite operações totalmente ininterruptas, desde a manutenção até os upgrades até a substituição completa do seu sistema de storage, usando clusters ONTAP com escalabilidade horizontal. Proteger dados em repouso com os recursos de criptografia do NetApp sem custo adicional. Certifique-se de que o desempenho atenda aos níveis de serviço de negócios por meio de recursos de qualidade de serviço refinados. Todos eles fazem parte da ampla variedade de recursos fornecidos com o ONTAP, o software de gerenciamento de dados empresariais líder do setor.</block>
  <block id="f1d1eddd608fe98b6fa2bc3436ce81d0" category="doc">VVols e gerenciamento baseado em políticas de storage</block>
  <block id="871db14a81b3510676400538c6f07073" category="paragraph">Vale a pena dar uma olhada nessa abordagem para ver como ela pode otimizar suas operações de storage de virtualização e evitar muito trabalho trivial.</block>
  <block id="44d75bdf4feecabe2de10427870ae623" category="paragraph">O SCP suporta QoS mínimo e/ou máximo para vVols de dados de uma VM. A QoS mínima é suportada apenas em sistemas AFF. As ferramentas do ONTAP para VMware vSphere incluem um painel que exibe o desempenho granular da VM e a capacidade lógica para vVols em sistemas ONTAP.</block>
  <block id="4240fa68f6d9919e6d039c4038175025" category="paragraph">A figura a seguir mostra as ferramentas do ONTAP para o painel vVols do VMware vSphere 9,8.</block>
  <block id="852ee2d26adc87d2379ffeb9287f7642" category="inline-image-macro">Ferramentas do ONTAP para o painel vVols do VMware vSphere 9,8</block>
  <block id="12947c7ceaf237f27fd206edb07cc0c1" category="paragraph"><block ref="12947c7ceaf237f27fd206edb07cc0c1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="50e0e66922b3b12510a128829d1fdc70" category="paragraph">Após a definição do perfil de funcionalidade de storage, ele pode ser usado para provisionar VMs usando a política de storage que identifica seus requisitos. O mapeamento entre a política de armazenamento de VM e o perfil de capacidade de armazenamento de dados permite que o vCenter exiba uma lista de datastores compatíveis para seleção. Essa abordagem é conhecida como gerenciamento baseado em políticas de storage.</block>
  <block id="794b6e2fc393d40a552fc58975920cb0" category="paragraph">O VASA fornece a tecnologia para consultar o armazenamento e retornar um conjunto de recursos de armazenamento ao vCenter. Os fornecedores do VASA fornecem a tradução entre as APIs e construções do sistema de storage e as APIs da VMware que são entendidas pelo vCenter. O fornecedor VASA da NetApp para ONTAP é oferecido como parte das ferramentas da ONTAP para a VM do dispositivo VMware vSphere, e o plug-in do vCenter fornece a interface para provisionar e gerenciar datastores vVol, bem como a capacidade de definir perfis de capacidade de armazenamento (SCPs).</block>
  <block id="dad160104969c39365dd2cd4c98dd300" category="inline-link-macro">TR-4400</block>
  <block id="6e2c48e84c0d02dd4e236da05038bd9a" category="paragraph">O ONTAP dá suporte aos armazenamentos de dados VMFS e NFS VVol. O uso do vVols com armazenamentos de dados SAN traz alguns dos benefícios do NFS, como granularidade no nível da VM. Aqui estão algumas práticas recomendadas a serem consideradas e você pode encontrar informações adicionais em<block ref="7be3ce63e842612697a6d91b19b8afcd" category="inline-link-macro-rx"></block>:</block>
  <block id="bd490c925219bcb312338a370589bf70" category="list-text">Um datastore da VVol pode consistir em vários volumes FlexVol em vários nós dos clusters. A abordagem mais simples é um único datastore, mesmo quando os volumes têm capacidades diferentes. O SPBM garante que um volume compatível seja usado para a VM. No entanto, todos os volumes precisam fazer parte de um único SVM do ONTAP e acessá-los usando um único protocolo. Um LIF por nó para cada protocolo é suficiente. Evite o uso de várias versões do ONTAP em um único datastore da vVol porque as funcionalidades do storage podem variar entre lançamentos.</block>
  <block id="0cc956d6da91fefae9dad9b2c8c9519b" category="list-text">Use as ferramentas do ONTAP para o plug-in do VMware vSphere para criar e gerenciar datastores da evolução. Além de gerenciar o datastore e seu perfil, ele cria automaticamente um endpoint de protocolo para acessar os vVols, se necessário. Se os LUNs forem usados, observe que os PES de LUN são mapeados usando IDs de LUN 300 e superiores. Verifique se a configuração do sistema avançado do host ESXi<block ref="ce913b4e625461a33f54f9e4ac38c2d7" prefix=" " category="inline-code"></block> permite um número de ID LUN maior que 300 (o padrão é 1.024). Execute esta etapa selecionando o host ESXi no vCenter, a guia Configurar e localize<block ref="ce913b4e625461a33f54f9e4ac38c2d7" prefix=" " category="inline-code"></block> na lista de Configurações avançadas do sistema.</block>
  <block id="fac85f355a1eb47127ef1b94e7603924" category="list-text">Não instale nem migre o provedor VASA, o vCenter Server (baseado em appliance ou Windows) ou as ferramentas do ONTAP para o próprio VMware vSphere em um datastore vVols, porque eles são mutuamente dependentes, limitando sua capacidade de gerenciá-los no caso de uma interrupção de energia ou outra interrupção do data center.</block>
  <block id="dd76252ea7a50def2a98f218cb1505b4" category="inline-link">Artigo da KB</block>
  <block id="15ef75dd3d20b8278c16cd01a708e13e" category="list-text">Faça backup da VM do provedor VASA regularmente. No mínimo, crie instantâneos por hora do armazenamento de dados tradicional que contém o Fornecedor VASA. Para obter mais informações sobre como proteger e recuperar o provedor VASA, consulte este<block ref="9d642870dca1748c69f7aa0b6fb95a89" category="inline-link-rx"></block>.</block>
  <block id="2d2d2e356f9ab117b7d2a58d42cc5988" category="paragraph">A figura a seguir mostra os componentes do vVols.</block>
  <block id="436b5d96360742275889cb237fe2ab70" category="inline-image-macro">Componentes do vVols</block>
  <block id="1706c14e85f152d61bab2f65d32810a1" category="paragraph"><block ref="1706c14e85f152d61bab2f65d32810a1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="be0ec3d9251292dd856ea0924ecc6873" category="doc">Qualidade do serviço (QoS)</block>
  <block id="f3c4f211a4831f8f7c223705b0fccd5d" category="paragraph">Os limites de taxa de transferência são úteis no controle de níveis de serviço, no gerenciamento de cargas de trabalho desconhecidas ou para testar aplicativos antes da implantação para garantir que eles não afetem outras cargas de trabalho em produção. Eles também podem ser usados para restringir uma carga de trabalho bully depois que ela é identificada.</block>
  <block id="5ab12aefceb83851b73081a686bd30ab" category="section-title">Suporte à política de QoS ONTAP</block>
  <block id="bfcd75cb17a665212ae0889e787a7330" category="paragraph">Os sistemas que executam o ONTAP podem usar o recurso de QoS de storage para limitar a taxa de transferência em Mbps e/ou e/os por segundo (IOPS) para diferentes objetos de storage, como arquivos, LUNs, volumes ou SVMs inteiras.</block>
  <block id="8aa45e69fd8330d5e4d2f6e16309ff41" category="paragraph">Níveis mínimos de serviço baseados em IOPS também são compatíveis para fornecer desempenho consistente para objetos SAN no ONTAP 9.2 e para objetos nas no ONTAP 9.3.</block>
  <block id="534ecd446aac2f9c809eef9064f44aab" category="paragraph">O limite máximo de taxa de transferência de QoS em um objeto pode ser definido em Mbps e/ou IOPS. Se ambos forem usados, o primeiro limite atingido é imposto pelo ONTAP. Um workload pode conter vários objetos e uma política de QoS pode ser aplicada a um ou mais workloads. Quando uma política é aplicada a vários workloads, os workloads compartilham o limite total da política. Objetos aninhados não são suportados (por exemplo, arquivos dentro de um volume não podem ter sua própria política). Os mínimos de QoS só podem ser definidos em IOPS.</block>
  <block id="040f184b126879657b253b6d258661d9" category="paragraph">As ferramentas a seguir estão disponíveis no momento para gerenciar políticas de QoS do ONTAP e aplicá-las a objetos:</block>
  <block id="de134183bea5df515a6756a539ce6f18" category="list-text">CLI do ONTAP</block>
  <block id="8e23e05fc0865e950d6a3581e0dd8ce9" category="list-text">OnCommand Workflow Automation</block>
  <block id="8cc4e713850f67a131e9dbf8b997f61e" category="list-text">Kit de ferramentas do NetApp PowerShell para ONTAP</block>
  <block id="fcdb48d0d22627e4910a8352c80bd87a" category="list-text">Ferramentas do ONTAP para o provedor VMware vSphere VASA</block>
  <block id="1d4614aca13104c98d5d8cc2d415b941" category="paragraph">Para atribuir uma política de QoS a um LUN, incluindo VMFS e RDM, o ONTAP SVM (exibido como SVM), caminho de LUN e número de série podem ser obtidos no menu sistemas de armazenamento na página inicial de ferramentas do ONTAP para VMware vSphere. Selecione o sistema de storage (SVM) e, em seguida, objetos relacionados &gt; SAN. Use essa abordagem ao especificar QoS usando uma das ferramentas do ONTAP.</block>
  <block id="98d229565d14d4d286f57a588a784c1e" category="inline-link-macro">Visão geral do gerenciamento e monitoramento de desempenho</block>
  <block id="b7629a90716592b8dcae7480ad66d224" category="paragraph"><block ref="de4b907e949a377b72cd0f0b0595d155" category="inline-link-macro-rx"></block>Consulte para obter mais informações.</block>
  <block id="81eba6b819a671b6c8962061afd13a78" category="section-title">Armazenamentos de dados NFS que não são vVols</block>
  <block id="5bafceb9f14cf4b07086992cd31326a5" category="paragraph">Uma política de QoS do ONTAP pode ser aplicada a todo o datastore ou arquivos VMDK individuais dentro dele. No entanto, é importante entender que todas as VMs em um datastore NFS tradicional (não vVols) compartilham uma fila de e/S comum de um determinado host. Se qualquer VM for estrangulada por uma política de QoS do ONTAP, isso resultará na prática em que toda e/S desse datastore parecerá ser estrangulada para esse host.</block>
  <block id="1520a4910ffa6efc27379931cc307d0b" category="paragraph">*Exemplo:* * você configura um limite de QoS no VM1.vmdk para um volume que é montado como um armazenamento de dados NFS tradicional pelo host esxi-01. * O mesmo host (esxi-01) está usando vm2.vmdk e está no mesmo volume. * Se VM1.vmdk for estrangulado, então vm2.vmdk também parecerá ser estrangulado, pois compartilha a mesma fila de e/S com VM1.vmdk.</block>
  <block id="5c60617d5730a7a614bfa0383a2affbd" category="admonition">Isso não se aplica ao vVols.</block>
  <block id="caf18b31d986fc095c3c0cd6a1f19f9e" category="paragraph">A partir do vSphere 6,5, você pode gerenciar limites granulares de arquivos em datastores não vVols utilizando o Storage Policy-Based Management (SPBM) com Storage I/o Control (SIOC) v2.</block>
  <block id="c28029445f9803e209550517678387a9" category="paragraph">Consulte os links a seguir para obter mais informações sobre como gerenciar o desempenho com as políticas SIOC e SPBM.</block>
  <block id="8bef032522908e987555b77fb50dbb85" category="inline-link-macro">Regras baseadas no host do SPBM: SIOC v2</block>
  <block id="98a7507b3e8be801707c07e336bc5506" category="inline-link-macro">Gerencie os recursos de e/S de storage com o vSphere</block>
  <block id="37b0c263c77e85e59d9f00438e870fa4" category="paragraph"><block ref="ea373db41b8c05446b96b46f4bbe1141" category="inline-link-macro-rx"></block> <block ref="c5badf4fd27434d786395fe52801b533" category="inline-link-macro-rx"></block></block>
  <block id="e6defd03e0f49585b6d47614713e97f7" category="paragraph">Para atribuir uma política de QoS a um VMDK no NFS, observe as seguintes diretrizes:</block>
  <block id="cd6af799ac31b0fbf81bcbba1d3d6bf1" category="list-text">A política deve ser aplicada ao<block ref="3b9aef0680339707b430261c2f800255" prefix=" " category="inline-code"></block> que contém a imagem de disco virtual real, não ao<block ref="aa26c73336ecfd98ed727b3e249c7f90" prefix=" " category="inline-code"></block> (arquivo de descritor de disco virtual) ou<block ref="092eb4dd2ca488962f4c22b3e8cc4ca0" prefix=" " category="inline-code"></block> (arquivo de descritor de VM).</block>
  <block id="2175e0e29bc4b213fa8b9c7afd591b6b" category="list-text">Não aplique políticas a outros arquivos VM, como arquivos de swap virtuais <block ref="aa33c3c1850a3f99cec7426e2c411d08" prefix="(" category="inline-code"></block>).</block>
  <block id="8230e9b5c1e9862fedb2c69f7cc5d3d1" category="list-text">Ao usar o cliente da Web vSphere para encontrar caminhos de arquivo (datastore &gt; Files), esteja ciente de que ele combina as informações do<block ref="f149d7424e10a266ec998ca5b32b81bb" prefix=" " category="inline-code"></block> e e<block ref="4a78be158c13cd6b2dc2100a80bb7070" prefix=" " category="inline-code"></block> simplesmente mostra um arquivo com o nome do<block ref="4a78be158c13cd6b2dc2100a80bb7070" prefix=" " category="inline-code"></block> , mas o tamanho do<block ref="f149d7424e10a266ec998ca5b32b81bb" prefix=" " category="inline-code"></block>. Adicione<block ref="4fc4e556dbb9dcede037ccd80fabd784" prefix=" " category="inline-code"></block> ao nome do arquivo para obter o caminho correto.</block>
  <block id="9aa28dc739b66a86d9f73ba24b9dd4c2" category="paragraph">Os armazenamentos de dados do FlexGroup oferecem recursos aprimorados de QoS ao usar as ferramentas do ONTAP para VMware vSphere 9,8 e posterior. Você pode facilmente definir QoS em todas as VMs em um datastore ou em VMs específicas. Consulte a seção FlexGroup deste relatório para obter mais informações. Esteja ciente de que as limitações de QoS mencionadas anteriormente com armazenamentos de dados NFS tradicionais ainda se aplicam.</block>
  <block id="b5380e34617914719b059f6d55b97b66" category="section-title">Armazenamentos de dados VMFS</block>
  <block id="b74c42e3de8c5b901769e263bf236711" category="paragraph">Usando LUNs ONTAP, as políticas de QoS podem ser aplicadas ao FlexVol volume que contém LUNs ou LUNs individuais, mas não arquivos VMDK individuais, porque o ONTAP não tem conhecimento do sistema de arquivos VMFS.</block>
  <block id="e122a7a507ac1f580cc5b9f2632a851c" category="section-title">Armazenamentos de dados vVols</block>
  <block id="be1ca5bcad3b34c08e2b2d7bfc8a95e3" category="paragraph">A QoS mínima e/ou máxima pode ser facilmente definida em VMs individuais ou VMDKs sem afetar qualquer outra VM ou VMDK usando o gerenciamento baseado em políticas de storage e vVols.</block>
  <block id="f5ac983ee93a7017d283971566bc828e" category="paragraph">Ao criar o perfil de capacidade de storage para o contêiner da VVol, especifique um valor máximo e/ou mínimo de IOPS sob a capacidade de desempenho e, em seguida, faça referência a esse SCP com a política de armazenamento da VM. Use essa política ao criar a VM ou aplicar a diretiva a uma VM existente.</block>
  <block id="1f23e960871a0a77a49731a6b47646c5" category="inline-link-macro">VMware vSphere Virtual volumes (vVols) com o ONTAP</block>
  <block id="b78488659ce8aad3288a0ad7f27c84fb" category="admonition">O vVols requer o uso de ferramentas do ONTAP para VMware vSphere, que funciona como o provedor VASA para ONTAP. <block ref="2486a36e844a24e9d1cf22351b1f1514" category="inline-link-macro-rx"></block>Consulte para obter as práticas recomendadas do vVols.</block>
  <block id="77bb2ba950959bd3f1c55da523ace0be" category="section-title">QoS ONTAP e VMware SIOC</block>
  <block id="58da89a03db394d8f73b6516f5a75882" category="paragraph">O ONTAP QoS e o VMware vSphere Storage I/o Control (SIOC) são tecnologias complementares que o vSphere e os administradores de storage podem usar em conjunto para gerenciar a performance de VMs vSphere hospedadas em sistemas executando o ONTAP. Cada ferramenta tem suas próprias forças, como mostrado na tabela a seguir. Devido aos diferentes escopos do VMware vCenter e do ONTAP, alguns objetos podem ser vistos e gerenciados por um sistema e não pelo outro.</block>
  <block id="5ad234cb2cde4266195252a23ca7d84e" category="cell">Propriedade</block>
  <block id="b8b8d1ba8fa345f03438a90f29af5784" category="cell">QoS ONTAP</block>
  <block id="c2a4cb962db2a4a6782b69864f0e411c" category="cell">VMware SIOC</block>
  <block id="aa628d5a66888444926b4dc042458200" category="cell">Quando ativo</block>
  <block id="688b10fcfff927dee65634e3b3636064" category="cell">A política está sempre ativa</block>
  <block id="a981c4aa67c29ff2d36fc614d8b28808" category="cell">Ativo quando existe contenção (latência do datastore sobre o limite)</block>
  <block id="f46e64a82c96db56f3d6657d4fb53f00" category="cell">Tipo de unidades</block>
  <block id="878b4223bb85b95d8caf0429d9406cd5" category="cell">IOPS, Mbps</block>
  <block id="3e189a34f422a141311dad231f9ad5b5" category="cell">IOPS, compartilhamentos</block>
  <block id="7367a0ec46339213625cbc77d56a9572" category="cell">Escopo do vCenter ou do aplicativo</block>
  <block id="1faff19290bb64ce8ff6bc1220496881" category="cell">Vários ambientes do vCenter, outros hipervisores e aplicações</block>
  <block id="1e664a3cc0ab109fcabcc81b488cebb1" category="cell">Servidor vCenter único</block>
  <block id="ebccc9f5c939841d86e5382988dfcc47" category="cell">Definir QoS na VM?</block>
  <block id="cddd0980ce99890d2ea90288f6b03117" category="cell">VMDK somente em NFS</block>
  <block id="928629d8a2a889f5274cad9940a06da0" category="cell">VMDK em NFS ou VMFS</block>
  <block id="305e85b992089534091855224f60cf75" category="cell">Definir QoS no LUN (RDM)?</block>
  <block id="e798014243cf5682e7fb3aaf4ee7cecf" category="cell">Definir QoS no LUN (VMFS)?</block>
  <block id="8743b08c4d707cd145a4e7acce189480" category="cell">Sim (o datastore pode ser estrangulado)</block>
  <block id="9cd021ea9d3c88de723fe9a2e50a2380" category="cell">Definir QoS no volume (armazenamento de dados NFS)?</block>
  <block id="c352b53c32380efcf4436926da6d0414" category="cell">Definir QoS no SVM (locatário)?</block>
  <block id="5dad340ee8f9e8fa9b65bf86a9fd5341" category="cell">Abordagem baseada em políticas?</block>
  <block id="b31c76176f26196c6379a9bcce212d99" category="cell">Sim. Pode ser compartilhado por todas as cargas de trabalho na política ou aplicado na íntegra a cada workload na política.</block>
  <block id="1ff33557bad923d68973872cacf2e43a" category="cell">Sim, com o vSphere 6,5 e posterior.</block>
  <block id="d5f1465492190ee9d30a09b36f64f4b7" category="cell">Licença necessária</block>
  <block id="4cec76d82991abd453484c23f7e3788a" category="cell">Incluído com ONTAP</block>
  <block id="6bb36803f4670824ff9ebdf665654829" category="cell">Enterprise Plus</block>
  <block id="400cc516a4a40acd605aef2cfd4ba4c0" category="section-title">Programador de recursos distribuídos do VMware Storage</block>
  <block id="d4d4b5b65bebf236590d70c702a6ba6b" category="paragraph">O VMware Storage Distributed Resource Scheduler (SDRS) é um recurso do vSphere que coloca as VMs no armazenamento com base na latência de e/S atual e no uso do espaço. Em seguida, ele move a VM ou VMDKs sem interrupções entre os armazenamentos de dados em um cluster de datastore (também chamado de pod), selecionando o melhor datastore no qual colocar a VM ou VMDKs no cluster do datastore. Um cluster de datastore é um conjunto de datastores semelhantes que são agregados em uma única unidade de consumo da perspetiva do administrador do vSphere.</block>
  <block id="0785fa6b3221e7345916be824259dc2f" category="paragraph">Ao usar SDRS com ferramentas do ONTAP para VMware vSphere, primeiro você deve criar um datastore com o plug-in, usar o vCenter para criar o cluster do datastore e, em seguida, adicionar o datastore a ele. Após a criação do cluster do datastore, armazenamentos de dados adicionais podem ser adicionados ao cluster do datastore diretamente do assistente de provisionamento na página Detalhes.</block>
  <block id="b028cce2007c32457c41f20d2954c0c2" category="paragraph">Outras práticas recomendadas da ONTAP para SDRS incluem o seguinte:</block>
  <block id="d11eff5be5178b7ba95b06270611ffc8" category="list-text">Todos os armazenamentos de dados no cluster devem usar o mesmo tipo de armazenamento (como SAS, SATA ou SSD), ser todos os armazenamentos de dados VMFS ou NFS e ter as mesmas configurações de replicação e proteção.</block>
  <block id="76db7ce67615bbc16da685df79ed0aa9" category="list-text">Considere usar SDRS no modo padrão (manual). Essa abordagem permite que você analise as recomendações e decida se as aplicará ou não. Esteja ciente desses efeitos das migrações VMDK:</block>
  <block id="97f4ed95cb52bb29629002a25cb5039f" category="list-text">Quando OS SDRS migram VMDKs entre armazenamentos de dados, qualquer economia de espaço da clonagem ou deduplicação do ONTAP é perdida. Você pode executar novamente a deduplicação para recuperar essas economias.</block>
  <block id="38f492286c3edf236c76e993ce0f0bf2" category="list-text">Depois que OS SDRS movem VMDKs, o NetApp recomenda recriar os snapshots no datastore de origem porque o espaço é bloqueado pela VM que foi movida.</block>
  <block id="09a99cbc4fb85d10c7af970e79032a05" category="list-text">Mover VMDKs entre armazenamentos de dados no mesmo agregado tem poucos benefícios, e OS SDRS não têm visibilidade de outras cargas de trabalho que possam compartilhar o agregado.</block>
  <block id="e7649bfbacc438bf8e20ba3564db4bdd" category="paragraph">Em seguida, ele move a VM ou VMDKs sem interrupções entre os armazenamentos de dados em um cluster de datastore (também chamado de pod), selecionando o melhor datastore no qual colocar a VM ou VMDKs no cluster do datastore. Um cluster de datastore é um conjunto de datastores semelhantes que são agregados em uma única unidade de consumo da perspetiva do administrador do vSphere.</block>
  <block id="8692ff2ea8c35b5c4c7cea90481e416c" category="summary">Este documento categoriza e enumera as configurações recomendadas de armazenamento e rede.</block>
  <block id="ff6fdc6e7749c69219fc26d54c625bd5" category="paragraph">A NetApp desenvolveu um conjunto de configurações de host ESXi ideais para protocolos NFS e Block. Orientações específicas também são fornecidas para configurações de multipathing e tempo limite de HBA para o comportamento adequado com o ONTAP com base nos testes internos do NetApp e VMware.</block>
  <block id="678582eb0cbbe0e063e618d230b63223" category="cell">* Configuração do host*</block>
  <block id="dfe49b73bd7e747701b49f9ed21ea2d6" category="cell">*Valor recomendado NetApp*</block>
  <block id="edceae57d92287f4f6200f94d3259cd0" category="cell">*Reinicialização necessária*</block>
  <block id="dc3a6955a23583876d020db0f6b80d4d" category="cell">*Configuração Avançada do ESXi*</block>
  <block id="73663d0d00956f0632e4ae75d811d53f" category="cell">VMFS3.HardwareAcceleratedLocking</block>
  <block id="59b1aceaef0203fdc32e11df232b16e6" category="cell">Manter padrão (1)</block>
  <block id="1b50110aedae4d8d2043a4eb9beb20af" category="cell">VMFS3.EnableBlockDelete</block>
  <block id="316084648bbafe451240702bd19c6ee9" category="cell">VMFS3.EnableVMFS6Unmap</block>
  <block id="befd90cd01403237f6fdf296822efbee" category="inline-link-macro">VMware vSphere APIs: Integração de array (VAAI)</block>
  <block id="571cc1d48c6d1ff3cf7e3a54cb035753" category="cell">*Configurações NFS*</block>
  <block id="c3b49a515dd0046685e06092642aa139" category="cell">NET.TcpipHeapSize</block>
  <block id="875f6b98e20edfecb56f9013d00987f6" category="cell">VSphere 6,0 ou posterior, definido como 32. Todas as outras configurações NFS, definidas como 30</block>
  <block id="504e96cc79e7efe30a8271cea152d9d1" category="cell">NET.TcpipHeapMax</block>
  <block id="b44c4aa4ed40a2c01a89549bc8746cbd" category="cell">Defina como 512MB para a maioria das versões do vSphere 6.X. Defina como padrão (1024MB) para 6.5U3, 6.7U3 e 7,0 ou posterior.</block>
  <block id="5f1e7b6431061565550e292d05c73588" category="cell">NFS.MaxVolumes</block>
  <block id="baee97fad9d55c529dc7a7eb07fd1ba4" category="cell">VSphere 6,0 ou posterior, defina como 256 todas as outras configurações NFS definidas como 64.</block>
  <block id="3058676a1cf088aa4a73312ac36f2a58" category="cell">NFS41.MaxVolumes</block>
  <block id="62c07f94c64184ee5d530e4c0917093f" category="cell">VSphere 6,0 ou posterior, definido como 256.</block>
  <block id="e18600af98c17fae10fdba0dc89979ed" category="cell">1</block>
  <block id="be7707fa525d0124489c9fe3072f78de" category="cell">VSphere 6,0 ou posterior, definido como 128</block>
  <block id="18e1fb6924459470760771b20ab0c379" category="cell">NFS.HeartbeatMaxFailures</block>
  <block id="138989cbe5dd3a4997662e0f65c17878" category="cell">Definido como 10 para todas as configurações NFS</block>
  <block id="1aa26eb281359ba3b9a9a4b83a09ed46" category="cell">Frequência NFS.HeartbeatFrequency</block>
  <block id="7ea6e8664542e3beb1aea10425efb4db" category="cell">Definido como 12 para todas as configurações NFS</block>
  <block id="eb4182715f8cde98563dc59ea36461d3" category="cell">NFS.HeartbeatTimeout</block>
  <block id="45aa5481fa55802a29a96aefd2f5dab1" category="cell">Definido como 5 para todas as configurações NFS.</block>
  <block id="54a08b15243d9078d3b5a47f8242da6f" category="cell">Descrição: Sunrpc.MaxConnPerIP</block>
  <block id="c0b3fd5512c2093847f753f398290f30" category="cell">*Configurações FC/FCoE*</block>
  <block id="2e556ad678160413b32dcca55c7d1f5f" category="cell">Política de seleção de caminho</block>
  <block id="fb62337a3ef32f4701b639339a4ceb33" category="cell">Defina como RR (round robin) quando os caminhos FC com ALUA são usados. Defina como FIXO para todas as outras configurações. Definir esse valor como RR ajuda a fornecer balanceamento de carga em todos os caminhos ativos/otimizados. O VALOR FIXO é para configurações mais antigas e não-ALUA e ajuda a impedir e/S de proxy Em outras palavras, ele ajuda a evitar que a e/S vá para o outro nó de um par de HA (high-availability) em um ambiente com Data ONTAP operando no modo 7D.</block>
  <block id="117704664d6cada78ac3107380f63d23" category="cell">Disk.QFullSampleSize</block>
  <block id="0e82e1f81de2159b0e9bee0b7be00dc9" category="cell">Defina como 32 para todas as configurações. Definir este valor ajuda a evitar erros de e/S.</block>
  <block id="f66a3c183f0e736240b77f8b755c880e" category="cell">Disk.QFullThreshold</block>
  <block id="bdd8c1d08eabb5e1923ed8f0c4b10ba4" category="cell">Defina como 8 para todas as configurações. Definir este valor ajuda a evitar erros de e/S.</block>
  <block id="19c08de7404551288e1274186e039ef4" category="cell">Tempos limite Emulex FC HBA</block>
  <block id="b4dbfc2d52627e923cbb563a31ff756d" category="cell">Use o valor padrão.</block>
  <block id="d46cddda4da7ec11f17472d11df95b68" category="cell">Tempos limite do QLogic FC HBA</block>
  <block id="19b5aaf3e2cb86809996ca63a2a416b0" category="cell">*Definições iSCSI*</block>
  <block id="2aa077454308383f1e82025427cd7362" category="cell">Defina como RR (round robin) para todos os caminhos iSCSI. Definir esse valor como RR ajuda a fornecer balanceamento de carga em todos os caminhos ativos/otimizados.</block>
  <block id="0340eb1bcbfc6cd3c62b8a878d8d643b" category="cell">Defina como 32 para todas as configurações. Definir este valor ajuda a evitar erros de e/S</block>
  <block id="891c10448731ad57490b9a932dabfff8" category="inline-link-macro">VMware KB 86331</block>
  <block id="fb55ee99c04280ac638757869929785d" category="paragraph">As ferramentas do ONTAP também especificam certas configurações padrão ao criar volumes e LUNs do ONTAP FlexVol:</block>
  <block id="3f7502a5f109d7a73706aba1c0741a4b" category="cell">*Ferramenta ONTAP*</block>
  <block id="485577e97e8efcd504fc8e8b13e613f1" category="cell">*Predefinição*</block>
  <block id="5938fe448c8661febcef3f4e779e3adb" category="cell">Reserva de snapshot (-percentagem-Snapshot-space)</block>
  <block id="7218aec62575561a6de1cae8d5658390" category="cell">Reserva fracionária (-reserva fracionária)</block>
  <block id="3a7e09ff0fa38663ffe6d91324ea75d9" category="cell">Atualização da hora de acesso (-atime-update)</block>
  <block id="f8320b26d30ab433c5a54546d21f414c" category="cell">Falso</block>
  <block id="e93200d5b0d16915bf04236790544b2f" category="cell">Leitura mínima (-min-readahead)</block>
  <block id="c877d89702fdd14e51b02028a20c7d07" category="cell">Instantâneos programados</block>
  <block id="00d23a76e43b46dae9ec7aa9dcbebb32" category="cell">Ativado</block>
  <block id="f65fd63b63c9e9f25bf6bc141e83de34" category="cell">Garantia de volume</block>
  <block id="c2410aebdf425dabcc65e546e506b03e" category="cell">Nenhum (thin Provisioning)</block>
  <block id="f97c03bf3e9580446d70d479f5aad1e0" category="cell">Tamanho automático do volume</block>
  <block id="d89f4f8b1d7c18847b88b46142f61535" category="cell">grow_shrink</block>
  <block id="ace72ec54e17777d27eb8bdb9d57e782" category="cell">Reserva de espaço LUN</block>
  <block id="b9f5c797ebbf55adccdd8539a65a0241" category="cell">Desativado</block>
  <block id="514aa7792a71ab4ab677eb2385131aae" category="cell">Alocação de espaço LUN</block>
  <block id="dbe1e98b00264bd496095ed5c95f9350" category="section-title">Configurações de multipath para desempenho</block>
  <block id="de9f44b08eec22d6b405acff2c925d56" category="paragraph">Embora não esteja configurado atualmente pelas ferramentas ONTAP disponíveis, o NetApp sugere estas opções de configuração:</block>
  <block id="01d954fb2edbf283d121f0651b04de83" category="section-title">Documentação adicional</block>
  <block id="40db5019ed68654f4eb2cf21ec5021db" category="inline-link">Use o VMware vSphere 7.x com o ONTAP</block>
  <block id="30d85838b9488ee908d075559c8978cd" category="inline-link">Use o VMware vSphere 8.x com o ONTAP</block>
  <block id="000c9205416c1ea85f6841a7ca379c17" category="inline-link">Para NVMe-of, mais detalhes podem ser encontrados em Configuração de host NVMe-of para ESXi 7.x com ONTAP</block>
  <block id="5a27e6dbe6279e323aec51d205b2b455" category="inline-link">Para NVMe-of, mais detalhes podem ser encontrados em Configuração de host NVMe-of para ESXi 8.x com ONTAP</block>
  <block id="92515b597b8c0784d6000b89ee47c5fd" category="doc">Storage unificado</block>
  <block id="bf0dee50832ba16a28008161612fd476" category="paragraph">O ONTAP unifica o storage por meio de uma abordagem simplificada definida por software para gerenciamento seguro e eficiente, performance aprimorada e escalabilidade otimizada. Essa abordagem aprimora a proteção de dados e permite o uso eficaz de recursos de nuvem.</block>
  <block id="c89f9fd1a8019dc4d7a2559a982d3aa8" category="inline-link-macro">Visão geral da configuração do S3</block>
  <block id="d6154a0901f9ca6bb5d8fb15c113581e" category="paragraph"><block ref="d6154a0901f9ca6bb5d8fb15c113581e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a6848cf51eef6140971685faf5c7a111" category="paragraph">No mundo vSphere, essa abordagem também pode significar um sistema unificado para infraestrutura de desktop virtual (VDI), juntamente com a infraestrutura de servidor virtual (VSI). Os sistemas que executam o ONTAP geralmente são mais baratos para VSI do que os arrays empresariais tradicionais e ainda têm recursos avançados de eficiência de storage para lidar com a VDI no mesmo sistema. O ONTAP também unifica uma variedade de Mídia de armazenamento, de SSDs a SATA, e pode estender isso facilmente para a nuvem. Não é necessário comprar um array flash para obter desempenho, um array SATA para arquivos e sistemas separados para a nuvem. ONTAP une todos eles.</block>
  <block id="e9e0f5f2c513c7138ea70b4c929d6fef" category="inline-link-macro">Virtualização de storage</block>
  <block id="8eb06904cba6440e6130ac3e32b68aba" category="paragraph">*OBSERVAÇÃO:* para obter mais informações sobre SVMs, armazenamento unificado e acesso ao cliente, consulte <block ref="9e7286a7ad3ab81fa024704c7a52e505" category="inline-link-macro-rx"></block> no Centro de Documentação do ONTAP 9.</block>
  <block id="50b6e1c7f2e81842d993d8ce88acc979" category="summary">O ONTAP dá suporte a todos os principais protocolos de storage usados para virtualização, como iSCSI, Fibre Channel (FC), Fibre Channel over Ethernet (FCoE) ou memória não volátil Express sobre Fibre Channel (NVMe/FC) para ambientes SAN, além de NFS (v3 e v4,1) e SMB ou S3 para conexões de convidado. Os clientes são livres para escolher o que funciona melhor para o seu ambiente e podem combinar protocolos conforme necessário em um único sistema.</block>
  <block id="ee8cc65cae83009c275cd4748f4c58ae" category="doc">Ferramentas de virtualização para ONTAP</block>
  <block id="e08c666b5127e745f8aacbacfce37dcf" category="list-text">*Fornecedor VASA para ONTAP.* O provedor VASA para ONTAP oferece suporte à estrutura VMware vStorage APIs for Storage Awareness (VASA). Ele é fornecido como parte das ferramentas do ONTAP para o VMware vSphere como um único dispositivo virtual para facilitar a implantação. O provedor VASA coneta o vCenter Server com o ONTAP para auxiliar no provisionamento e monitoramento do armazenamento de VM. Ele permite o suporte do VMware Virtual volumes (vVols), o gerenciamento de perfis de funcionalidades de storage e o desempenho individual de vVols de VM, além de alarmes para monitorar a capacidade e a conformidade com os perfis.</block>
  <block id="a1c13ec555198266776a3a7b904810dd" category="paragraph">A figura a seguir mostra as ferramentas do ONTAP para vSphere.</block>
  <block id="43f38d7beb04aa98b65d2317c2f1659f" category="inline-image-macro">Ferramentas do ONTAP para vSphere</block>
  <block id="aa5b1d896aebe8a04ceac7c2a16b2cd3" category="paragraph"><block ref="aa5b1d896aebe8a04ceac7c2a16b2cd3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="dd55e255500b9ec15305dc69dfa0e15b" category="section-title">Plug-in NFS para VMware VAAI</block>
  <block id="d3ba101543fc97ba1dd9272c87bf65da" category="doc">Volumes virtuais (vVols) e gerenciamento baseado em políticas de storage (SPBM)</block>
  <block id="fda9c21a4aefd4a1f42ad0b195e6ef0a" category="inline-link-macro">TR-4400: VMware vSphere Virtual volumes com ONTAP</block>
  <block id="0ecd760f5e697e57a60b2f1597be9d54" category="admonition">Para obter mais informações sobre o VMware vSphere Virtual volumes, SPBM e ONTAP, <block ref="2e6ec19fbf81081d6cc68364fb2fb656" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="cacba1b456347ce8f32c7f5ed0d81e64" category="doc">Implantando o storage vVols</block>
  <block id="3db9849d9f30bfc6e05c4e0b36d28848" category="section-title">Migração de VMs de datastores tradicionais para vVols</block>
  <block id="58f2a764a13ec89d3c5ead5343e75637" category="section-title">Gerenciamento de VMs com políticas</block>
  <block id="a4332a81dbc3a9888be608dea640cd3d" category="section-title">Criando políticas de armazenamento de VM</block>
  <block id="2ce0d6ec59cca7e0b6e0bdc389301e63" category="inline-link-macro">Implante a VM usando a Política de storage</block>
  <block id="e65bde48b0a84fcc60d957de90c3a128" category="list-text">A alteração dos recursos de performance, como IOPS mín. E máx., requer alguma atenção à configuração específica.</block>
  <block id="7de504873f20af5c8ce6dadd2f79b29a" category="list-text">As ferramentas do ONTAP criam políticas individuais de QoS não compartilhadas com versões atualmente suportadas do ONTAP. Portanto, cada VMDK individual receberá sua própria alocação de IOPs.</block>
  <block id="63a33ddbd2c3ccd2daac06020248049f" category="section-title">Reaplicar a política de armazenamento de VM</block>
  <block id="57a033c33a8be6110be46b2914cc4989" category="doc">Usando vVols com ONTAP</block>
  <block id="21247c4392dc3c243f693dbf5b762553" category="section-title">Produtos e Documentação</block>
  <block id="94ef809dc16e728151bda996f8b4f8aa" category="inline-image-macro">ONTAP Tools arquitetura do provedor VASA, 240</block>
  <block id="d78de3410d86d345a548abdf67aff375" category="paragraph"><block ref="d78de3410d86d345a548abdf67aff375" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5e5421e75636200787a4449a2cdaa1f1" category="section-title">Instalação do produto</block>
  <block id="72333dadacbc964761fb14f718f6d411" category="section-title">Documentação do produto</block>
  <block id="e0644c46fdc2ced2c094f7db15e15a8a" category="paragraph">A documentação a seguir está disponível para ajudá-lo a implantar ferramentas do ONTAP.</block>
  <block id="be11c74c1dd7f307bb80183a90dc2067" category="section-title">Comece agora</block>
  <block id="7d0ee6fed10d3d4e5c9ee496729ab519" category="inline-link">Notas de lançamento</block>
  <block id="3d7fe3e43f9f24fffe5ed0d546d12f13" category="inline-link">Implantar ferramentas do ONTAP</block>
  <block id="a2fa58344be7fbd9a2be0320a8df0f77" category="inline-link">Atualizar as ferramentas do ONTAP</block>
  <block id="21e2a89d708329706ec6ed3fc989a1f6" category="section-title">Use as ferramentas do ONTAP</block>
  <block id="317bbf73ff27c5f981628c8fb83ebf22" category="inline-link">Configurar controles de acesso baseados em função</block>
  <block id="641e9457539249e880725760f91d5ee2" category="inline-link">Configurar a alta disponibilidade</block>
  <block id="04edeb5424c826c14a69edb777edf395" category="section-title">Proteja e gerencie armazenamentos de dados</block>
  <block id="6799b6ec743f9159edf3b43790210a11" category="inline-link">Como executar uma recuperação de desastres do provedor VASA - Guia de resolução</block>
  <block id="dd5138e8a4207a5b2fde43b411a4b5e1" category="section-title">Painel do Fornecedor VASA</block>
  <block id="cd47dd01745339787e4c7300389401f2" category="section-title">Práticas recomendadas</block>
  <block id="72e0ee397942f7233122887584f94b8b" category="paragraph">O uso do ONTAP vVols com o vSphere é simples e segue os métodos do vSphere publicados (consulte trabalhando com volumes virtuais no vSphere Storage na documentação da sua versão do ESXi). Aqui estão algumas práticas adicionais a serem consideradas em conjunto com o ONTAP.</block>
  <block id="9ae938622297e9d4b14dd0006a8f0bf4" category="paragraph">*Limites*</block>
  <block id="b4f52a4fd0b07c9d904b95fc98a1cd45" category="inline-link">Máximos de configuração</block>
  <block id="83583580d98b69cb8317f9b285f3c8df" category="paragraph">*Use as ferramentas do ONTAP para extensões de IU do VMware vSphere ou APIs REST para provisionar armazenamentos de dados vVols* *e Protocol Endpoints*.*</block>
  <block id="e8d5f9dc0bff953a9e59755813c7e8bf" category="paragraph">*Nunca armazene o dispositivo ONTAP Tools ou o vCenter Server Appliance (VCSA) em um datastore vVols que eles estejam gerenciando.*</block>
  <block id="ab8d352870fb5334773c7177d3d5dcd1" category="paragraph">*Evite operações vVols em diferentes versões do ONTAP.*</block>
  <block id="8b2bcef781b7e1f6d64739147d50aae7" category="paragraph">Funcionalidades de storage compatíveis, como QoS, personalidade e muito mais, mudaram em várias versões do fornecedor VASA, e algumas dependem do lançamento do ONTAP. Usar versões diferentes em um cluster ONTAP ou mover vVols entre clusters com versões diferentes pode resultar em alarmes de conformidade ou comportamento inesperado.</block>
  <block id="bd57f4f74ca087a92a48b23d45753729" category="paragraph">O fornecedor de ferramentas ONTAP VASA cuida do gerenciamento de grupos FCP e iSCSI, bem como subsistemas NVMe no ONTAP com base em iniciadores descobertos de hosts ESXi gerenciados. No entanto, ele não se integra com switches Fibre Channel para gerenciar o zoneamento. O zoneamento deve ser feito de acordo com as melhores práticas antes que qualquer provisionamento possa ocorrer. O seguinte é um exemplo de zoneamento de iniciador único para quatro sistemas ONTAP:</block>
  <block id="6b14e3f4a37881185acf7a766f8f6272" category="paragraph">Zoneamento do iniciador único:</block>
  <block id="cd7bf0e1e61341c1aa3fa23401af8a27" category="inline-image-macro">Zoneamento de iniciador único com quatro nós, 400</block>
  <block id="17ccf64e30cb518fd7ca87ce752ad738" category="paragraph"><block ref="17ccf64e30cb518fd7ca87ce752ad738" category="inline-image-macro-rx" type="image"></block></block>
  <block id="58b5cd2a94730c2e044c14891f1e0e87" category="paragraph">Consulte os seguintes documentos para obter mais práticas recomendadas:</block>
  <block id="51591d05b7e084ba8e5ae7f63172177e" category="inline-link">_TR-4080 melhores práticas para SAN ONTAP 9_ moderna</block>
  <block id="fc9e4d789d968936f8ff5ae5a99847e0" category="paragraph"><block ref="fc9e4d789d968936f8ff5ae5a99847e0" category="inline-link-rx"></block></block>
  <block id="c1723e6a0e1d3dd28232b33e0cb6e61d" category="inline-link">_TR-4684 implementação e configuração de SANs modernas com NVMe-of_</block>
  <block id="d748a2834a7220eef4ec4775a51632f9" category="paragraph"><block ref="d748a2834a7220eef4ec4775a51632f9" category="inline-link-rx"></block></block>
  <block id="80dad10df0d1a031764e7c648c46aa23" category="paragraph">*Considere usar o máximo de IOPS para controlar VMs desconhecidas ou testar.*</block>
  <block id="93e4f73afe8b787b33161ec273ca087f" category="paragraph">Disponível pela primeira vez no provedor VASA 7,1, o IOPS máximo pode ser usado para limitar as IOPS a uma evolução específica para uma carga de trabalho desconhecida, a fim de evitar impactos em outras cargas de trabalho mais críticas. Consulte a Tabela 4 para obter mais informações sobre o gerenciamento de desempenho.</block>
  <block id="ee3cbda1c3c4a14ae024478c7ada6d11" category="paragraph">*Siga todas as melhores práticas de protocolo.*</block>
  <block id="4e0d7e0587bf99c9b7a64a84fd42f6bd" category="paragraph">Consulte os outros guias de práticas recomendadas da NetApp e da VMware específicos do protocolo selecionado. Em geral, não existem outras alterações além das já mencionadas.</block>
  <block id="97f87e9ab1d660463c63beb8745fd9e5" category="paragraph">* Exemplo de configuração de rede usando vVols sobre NFS v3*</block>
  <block id="6a2c1ac1da51eca0c1a65afffab8dfab" category="inline-image-macro">Configuração de rede usando vVols em NFS v3.500</block>
  <block id="c80b3cc8b5013bd4039769fb0f783e60" category="paragraph"><block ref="c80b3cc8b5013bd4039769fb0f783e60" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f98dd9d12416a648450df8c99d10878a" category="summary">Esta é uma visão geral do VMware vSphere Virtual volumes (vVols) com o ONTAP</block>
  <block id="674c41ba00ec77fc9d294abbba7e7b7d" category="paragraph">O ONTAP é uma solução de storage líder para ambientes VMware vSphere há mais de duas décadas e continua adicionando recursos inovadores para simplificar o gerenciamento e reduzir custos.</block>
  <block id="918febfed3d070cf1250909e5cdcf31d" category="paragraph">Este documento abrange os recursos do ONTAP para volumes virtuais do VMware vSphere (vVols), incluindo as informações mais recentes sobre produtos e casos de uso, juntamente com as práticas recomendadas e outras informações para simplificar a implantação e reduzir erros.</block>
  <block id="ae7454da5e20b82b7fe67eb1ff88c923" category="admonition">Essa documentação substitui os relatórios técnicos publicados anteriormente _TR-4400: VMware vSphere Virtual volumes (vVols) com o ONTAP_</block>
  <block id="d30f04665be7a6d9663004b1b5e61a9a" category="paragraph">As práticas recomendadas complementam outros documentos, como guias e listas de compatibilidade. Eles são desenvolvidos com base em testes de laboratório e extensa experiência de campo por engenheiros e clientes da NetApp. Eles podem não ser as únicas práticas que funcionam ou são suportadas, mas são geralmente as soluções mais simples que atendem às necessidades da maioria dos clientes.</block>
  <block id="cc713c330b9c4e00d3ed7233bc54a889" category="section-title">Visão geral dos volumes virtuais (vVols)</block>
  <block id="cbf0aa9daeb855e4eace1a3bdc474ce2" category="paragraph">Existem vários componentes a ter em conta:</block>
  <block id="919601826e1d58bccaaab76d787871d2" category="cell">Este é o componente de software que lida com a comunicação entre o VMware vSphere e o sistema de storage. Para o ONTAP, o provedor VASA é executado em um dispositivo conhecido como ferramentas ONTAP para VMware vSphere (ferramentas ONTAP para abreviação). As ferramentas do ONTAP também incluem um plug-in do vCenter, um adaptador de replicação de armazenamento (SRA) para o VMware Site Recovery Manager e um servidor de API REST para criar sua própria automação. Depois que as ferramentas do ONTAP são configuradas e registradas no vCenter, há pouca necessidade de interagir diretamente com o sistema ONTAP, já que quase todas as suas necessidades de armazenamento podem ser gerenciadas diretamente na IU do vCenter ou por meio da automação da API REST.</block>
  <block id="3b2cd9018385f55c53c9a8b756df8bb5" category="cell">O endpoint do protocolo é um proxy para e/S entre os hosts ESXi e o datastore vVols. O Fornecedor ONTAP VASA cria-os automaticamente, seja um LUN de ponto de extremidade de protocolo (4MB GB de tamanho) por FlexVol volume do armazenamento de dados vVols ou um ponto de montagem NFS por interface NFS (LIF) no nó de storage que hospeda um FlexVol volume no armazenamento de dados. O host ESXi monta esses pontos finais do protocolo diretamente em vez de LUNs e arquivos de disco virtuais individuais da Vevolve. Não é necessário gerenciar os endpoints do protocolo à medida que são criados, montados, desmontados e excluídos automaticamente pelo Provedor VASA, juntamente com quaisquer grupos de interface ou políticas de exportação necessárias.</block>
  <block id="71afca0aa1a505ea2ac3ce5a1a681549" category="paragraph">Novidade no vSphere 8: Ao usar o NVMe sobre Fabrics (NVMe-of) com vVols, o conceito de endpoint de protocolo não é mais relevante no ONTAP. Em vez disso, um PE virtual é instanciado automaticamente pelo host ESXi para cada grupo ANA assim que a primeira VM é ativada. O ONTAP cria automaticamente grupos ANA para cada FlexVol volume usado pelo datastore.</block>
  <block id="8202498953d2ebcf9968c37a7e47f4f6" category="paragraph">Uma vantagem adicional ao usar o NVMe-of para vVols é que não há solicitações de vinculação necessárias do Fornecedor VASA. Em vez disso, o host ESXi lida internamente com a funcionalidade de vinculação do VPE. Isso reduz a oportunidade de uma tempestade de Vevolve para impactar o serviço.</block>
  <block id="70532c0374111d897ef1176b34b6396c" category="inline-link">NVMe e Virtual volumes</block>
  <block id="50ec55042a7f4e8c2c66219ac096cfb3" category="inline-link">vmware.com</block>
  <block id="113c9d4e642d1ba4cc469267fb7fd0de" category="paragraph">Para obter mais informações, consulte a.<block ref="f8d477cd77073d731aafe4f52026608a" category="inline-link-rx"></block><block ref="1f1565cca975c4a703345d21e7f273b8" category="inline-link-rx"></block></block>
  <block id="937251054fa0c1a7b946f8928cc857b9" category="section-title">Gerenciamento baseado em políticas</block>
  <block id="e0795f8b847058e171dec5a519757ece" category="image-alt">Implante a máquina virtual usando a política de armazenamento</block>
  <block id="941431bc1cecb0ec5e89e78e9a5a96fc" category="section-title">Conformidade com a política de storage da VM</block>
  <block id="bfd6dec22a6a1724ff1b67f1f289cdfc" category="image-alt">Conformidade com a política de armazenamento de máquinas virtuais</block>
  <block id="273eb98a312e607888044e87e0210015" category="section-title">Suporte para NetApp vVols</block>
  <block id="ee82b7a98212a75a2397dd9c5f9b1ab4" category="paragraph">A ONTAP tem suportado a especificação VASA desde o seu lançamento inicial em 2012. Embora outros sistemas de armazenamento NetApp possam suportar VASA, este documento se concentra nas versões atualmente suportadas do ONTAP 9.</block>
  <block id="669b30b7e6d5ef1d862fe65880b816a8" category="paragraph">Além do ONTAP 9 nos sistemas AFF, ASA e FAS, o NetApp oferece suporte a cargas de trabalho VMware no ONTAP Select, Amazon FSX for NetApp com VMware Cloud na AWS, Azure NetApp Files com solução Azure VMware, Cloud Volumes Service com o VMware Engine e NetApp Private Storage na Equinix, mas a funcionalidade específica pode variar de acordo com o provedor de serviços e a conetividade de rede disponível. O acesso dos convidados do vSphere aos dados armazenados nessas configurações, bem como ao Cloud Volumes ONTAP também está disponível.</block>
  <block id="9fe1fd556b933358881222d5c3da127c" category="paragraph">No momento da publicação, os ambientes de hyperscaler são limitados apenas aos armazenamentos de dados tradicionais NFS v3. Portanto, o vVols só está disponível com sistemas ONTAP no local ou sistemas conectados na nuvem que oferecem todos os recursos de sistemas no local, como os hospedados por parceiros e fornecedores de serviços da NetApp no mundo todo.</block>
  <block id="274bc582ca884fc158ea9ac9f79f9067" category="inline-link">Documentação do produto ONTAP</block>
  <block id="5ca60fe92dec435059ba5acefa4ce2c9" category="paragraph">_Para obter mais informações sobre o ONTAP,<block ref="8a9b15dc18a16e0b1acfa438e27f6aa6" category="inline-link-rx"></block> consulte _</block>
  <block id="3dffa984dadf9ff0006ee9cebd3b04b9" category="inline-link-macro">TR-4597</block>
  <block id="afd715f07b1ec06fe77bf23a2d7bf185" category="paragraph">_Para obter mais informações sobre as práticas recomendadas do ONTAP e do VMware vSphere, <block ref="5dbb4949ffa7cb97fe4eaffc517a1111" category="inline-link-macro-rx"></block>consulte _</block>
  <block id="d3fb76da5fbbcd6fa32e40910b5b9a47" category="section-title">Benefícios de usar vVols com ONTAP</block>
  <block id="6a74f7c0a9021e009a9c030e54084978" category="paragraph">Conforme abordado na seção 1,2, o gerenciamento baseado em políticas permite que as VMs sejam provisionadas e gerenciadas posteriormente usando políticas pré-definidas. Isso pode ajudar as operações DE TI de várias maneiras:</block>
  <block id="e0eb51b6d319e14c2fbfc1f628021a26" category="list-text">*Aumente a velocidade.* As ferramentas do ONTAP eliminam a necessidade de o administrador do vCenter abrir tickets com a equipe de storage para atividades de provisionamento de storage. No entanto, as funções de RBAC das ferramentas do ONTAP no vCenter e no sistema ONTAP ainda permitem que equipes independentes (como equipes de storage) ou atividades independentes da mesma equipe restrinjam o acesso a funções específicas, se desejado.</block>
  <block id="3f4dbd6687bd0d55bf69fe5fdd0137c4" category="list-text">*Provisionamento mais inteligente.* Os recursos do sistema de storage podem ser expostos por meio das APIs VASA, permitindo que os fluxos de trabalho de provisionamento aproveitem recursos avançados sem que o administrador da VM precise entender como gerenciar o sistema de storage.</block>
  <block id="a13fcc9220d042cae454e9ac073636ca" category="list-text">*Provisionamento mais rápido.* Diferentes recursos de storage podem ser suportados em um único armazenamento de dados e selecionados automaticamente, conforme apropriado, para uma VM com base na política de VM.</block>
  <block id="eb4c052226108afebf26e670208b9a55" category="list-text">*Evite erros.* As políticas de storage e VM são desenvolvidas com antecedência e aplicadas conforme necessário, sem precisar personalizar o storage sempre que uma VM é provisionada. Os alarmes de conformidade são gerados quando as funcionalidades de storage são desviadas das políticas definidas. Como mencionado anteriormente, as SCPs tornam o provisionamento inicial previsível e repetível, ao mesmo tempo que basear as políticas de armazenamento de VM nos SCPs garante um posicionamento preciso.</block>
  <block id="551e3b0a48f99995daac658b17a1de62" category="list-text">* Melhor gerenciamento de capacidade. * As ferramentas VASA e ONTAP possibilitam visualizar a capacidade de armazenamento até o nível de agregado individual, se necessário, e fornecem várias camadas de alertas no evento que a capacidade começa a ficar baixa.</block>
  <block id="f9878e32fdf258284c007eaae38773cd" category="section-title">Gerenciamento granular de VM na SAN moderna</block>
  <block id="7e673a7c12cc256f29bcd7b2028d9d5a" category="paragraph">Os sistemas de STORAGE SAN que usam Fibre Channel e iSCSI foram os primeiros a serem suportados pelo VMware para ESX, mas não têm a capacidade de gerenciar arquivos e discos individuais de VM a partir do sistema de storage. Em vez disso, os LUNs são provisionados e o VMFS gerencia os arquivos individuais. Isso dificulta o sistema de storage gerenciar diretamente a performance, a clonagem e a proteção de storage de VM individuais. O vVols traz granularidade de storage que os clientes que usam o storage NFS já aproveitam, com os recursos de SAN robustos e de alta performance do ONTAP.</block>
  <block id="25a46370807e0eab0dfe3853abfb9b6e" category="paragraph">Agora, com as ferramentas vSphere 8 e ONTAP para VMware vSphere 9,12 e posterior, os mesmos controles granulares usados pelo vVols para protocolos baseados em SCSI legados agora estão disponíveis na moderna SAN Fibre Channel usando NVMe over Fabrics para obter desempenho ainda maior em escala. Com a atualização 1 do vSphere 8,0, agora é possível implantar uma solução NVMe completa usando vVols sem conversão de e/S na pilha de storage do hipervisor.</block>
  <block id="f61f57f748f5f0b52c7f11f1f1bd43f0" category="section-title">Maiores funcionalidades de descarga de storage</block>
  <block id="911fa02c34dda38cd69be06e524ed9d0" category="inline-link">Garantia de eficiência</block>
  <block id="3170031d77f241bc872afcb490c0a806" category="paragraph">Embora a VAAI ofereça uma variedade de operações que são descarregadas para o armazenamento, existem algumas lacunas que são abordadas pelo Provedor VASA. O SAN VAAI não consegue descarregar snapshots gerenciados da VMware para o sistema de storage. O NFS VAAI pode descarregar snapshots gerenciados pela VM, mas há limitações colocadas uma VM com snapshots nativos de storage. Como o vVols usa LUNs, namespaces ou arquivos individuais para discos de máquina virtual, o ONTAP pode clonar os arquivos ou LUNs de forma rápida e eficiente para criar snapshots granular de VM que não exigem mais arquivos delta. O NFS VAAI também não dá suporte a operações de descarregamento de clones para migrações de storage vMotion hot (ativado). A VM deve ser desligada para permitir a descarga da migração ao usar o VAAI com datastores NFS tradicionais. O fornecedor VASA nas ferramentas do ONTAP permite clones quase instantâneos com eficiência de armazenamento para migrações quentes e frias, e também suporta cópias quase instantâneas para migrações entre volumes de vVols. Devido a esses benefícios significativos de eficiência de storage, você pode aproveitar ao máximo os workloads vVols no<block ref="9d1af7a9d4f98887e53c1a9bedbce044" category="inline-link-rx"></block> programa. Da mesma forma, se os clones entre volumes que usam VAAI não atenderem aos seus requisitos, você provavelmente poderá resolver seus desafios de negócios graças às melhorias na experiência de cópia com vVols.</block>
  <block id="a8567b4dc683947384ef2e1dd0fc6ac1" category="section-title">Casos de uso comuns para vVols</block>
  <block id="48e535b80538b088fd868fde9372715c" category="paragraph">Além desses benefícios, também vemos esses casos de uso comuns para o storage da evolução:</block>
  <block id="441f01ec38e91fad1b235a0e7422a178" category="list-text">*Provisionamento sob demanda de VMs*</block>
  <block id="bd652a918164d8fa5176b5f9b92c2e61" category="list-text">IaaS provedor de serviços ou nuvem privada.</block>
  <block id="4fbc1141a40f5259e3ab1545de52b1ea" category="list-text">*Discos de primeira Classe (FCDs)*</block>
  <block id="e83f2e4e8676ee8faac4d6af599fd7e7" category="list-text">Volumes persistentes do VMware Tanzu Kubernetes Grid [TKG].</block>
  <block id="b2b81490f2245d3d566e0ccc6a29cfc2" category="list-text">Fornecer serviços semelhantes ao Amazon EBS através do gerenciamento de ciclo de vida independente do VMDK.</block>
  <block id="2511e4e8cbb72027ae20f24008d4b939" category="list-text">*Provisionamento sob demanda de VMs temporárias*</block>
  <block id="eeb1044cc319a5d53503e45dbf762291" category="list-text">Laboratórios de teste/desenvolvimento</block>
  <block id="858d314810762abccaa7baf230e3dc18" category="list-text">Ambientes de treinamento</block>
  <block id="ab7bbc294bf0f0354980a3014e8f4219" category="section-title">Benefícios comuns com vVols</block>
  <block id="ccd6ea8c57e93a5401d07aab9c60f371" category="paragraph">Quando usados em seu pleno benefício, como nos casos de uso acima, o vVols fornece as seguintes melhorias específicas:</block>
  <block id="1c21847cdc5616af138ba0c03aad7adb" category="list-text">Os vVols são a tecnologia de armazenamento ideal ao usar o TKG com o vSphere CSI, fornecendo classes de armazenamento discretas e capacidades gerenciadas pelo administrador do vCenter.</block>
  <block id="d5f068caef73978a5483badd927a7e98" category="list-text">Os serviços do Amazon EBS podem ser fornecidos por meio de FCDs porque um FCD VMDK, como o nome sugere, é um cidadão de primeira classe no vSphere e tem um ciclo de vida que pode ser gerenciado independentemente de VMs às quais ele pode ser anexado.</block>
  <block id="7e7040600922b2a78715f856613a3c08" category="doc">Protegendo vVols</block>
  <block id="e6364c2f5314a32cd95be04b4c2112e6" category="paragraph">As seções a seguir descrevem os procedimentos e as práticas recomendadas para o uso do VMware vVols com storage ONTAP.</block>
  <block id="de92c927f248723e4668aec459709995" category="section-title">Alta disponibilidade do fornecedor VASA</block>
  <block id="f4d4cb8868f07cad16bd7de7e36c5201" category="paragraph">O Fornecedor NetApp VASA é executado como parte do dispositivo virtual juntamente com o plug-in do vCenter e o servidor de API REST (anteriormente conhecido como o console de armazenamento virtual [VSC]) e o adaptador de replicação de armazenamento. Se o provedor VASA não estiver disponível, as VMs que usam vVols continuarão a ser executadas. No entanto, novos datastores vVols não podem ser criados e o vVols não pode ser criado ou vinculado pelo vSphere. Isso significa que as VMs que usam vVols não podem ser ativadas, uma vez que o vCenter não poderá solicitar a criação da vVol de swap. E as VMs em execução não podem usar o vMotion para migração para outro host porque os vVols não podem ser vinculados ao novo host.</block>
  <block id="3958bf41787d7fcc6a9f8dd9348c947f" category="paragraph">O VASA Provider 7,1 e posterior suportam novos recursos para garantir que os serviços estejam disponíveis quando necessário. Inclui novos processos watchdog que monitorizam o fornecedor VASA e os serviços de base de dados integrados. Se detetar uma falha, ele atualiza os arquivos de log e reinicia os serviços automaticamente.</block>
  <block id="1acc458c695b0d3dfbf588309801fda2" category="paragraph">Proteção adicional deve ser configurada pelo administrador do vSphere usando os mesmos recursos de disponibilidade usados para proteger outras VMs de missão crítica contra falhas no software, hardware do host e rede. Nenhuma configuração adicional é necessária no dispositivo virtual para usar esses recursos; basta configurá-los usando abordagens padrão do vSphere. Eles foram testados e são suportados pelo NetApp.</block>
  <block id="ff43afff832597ff45e5abeab2826ccf" category="inline-link">Ferramentas do ONTAP para documentação do VMware vSphere (Configurar alta disponibilidade para ferramentas do ONTAP)</block>
  <block id="d516ca4c9c18446a82d9fc9ee85bd955" category="paragraph">O vSphere High Availability é facilmente configurado para reiniciar uma VM em outro host no cluster de host em caso de falha. A tolerância a falhas do vSphere fornece maior disponibilidade criando uma VM secundária que é continuamente replicada e pode assumir o controle a qualquer momento. Informações adicionais sobre esses recursos estão disponíveis no<block ref="b6d78cbf1d5afb52929c529b32a350ad" category="inline-link-rx"></block>, bem como na documentação do VMware vSphere (procure disponibilidade do vSphere em ESXi e vCenter Server).</block>
  <block id="97ba24d475ff6fdc7743099992cc301f" category="paragraph">O ONTAP provedor VASA faz o backup automático da configuração do vVols em tempo real para sistemas ONTAP gerenciados, onde as informações do vVols são armazenadas nos metadados do FlexVol volume. Caso o ONTAP Tools Appliance fique indisponível por qualquer motivo, você pode implantar uma nova ferramenta de forma fácil e rápida e importar a configuração. Consulte este artigo da KB para obter mais informações sobre as etapas de recuperação do provedor VASA:</block>
  <block id="9462790a7557a7eb2fe9daad4b875817" category="paragraph"><block ref="9462790a7557a7eb2fe9daad4b875817" category="inline-link-rx"></block></block>
  <block id="029a7740ecd792264454f9dbe194e980" category="section-title">Replicação do vVols</block>
  <block id="c7b26217fd0c9041b6f779a0f669de5c" category="paragraph">Muitos clientes da ONTAP replicam seus armazenamentos de dados tradicionais para sistemas de storage secundário usando o NetApp SnapMirror e, em seguida, usam o sistema secundário para recuperar VMs individuais ou um local inteiro em caso de desastre. Na maioria dos casos, os clientes usam uma ferramenta de software para gerenciar isso, como um produto de software de backup, como o plug-in do NetApp SnapCenter para VMware vSphere ou uma solução de recuperação de desastres, como o Gerenciador de recuperação de site da VMware (juntamente com o adaptador de replicação de armazenamento nas ferramentas do ONTAP).</block>
  <block id="bc6303e4538280b1b01d45a5f7d20039" category="paragraph">Esse requisito para uma ferramenta de software é ainda mais importante para gerenciar a replicação do vVols. Embora alguns aspectos possam ser gerenciados por recursos nativos (por exemplo, os snapshots gerenciados do vVols da VMware são descarregados para o ONTAP, que usa clones rápidos e eficientes de arquivos ou LUN), em geral, a orquestração é necessária para gerenciar a replicação e a recuperação. Os metadados sobre o vVols são protegidos pelo ONTAP, bem como pelo Fornecedor VASA, mas é necessário um processamento adicional para usá-los em um local secundário.</block>
  <block id="c6a26835eb364bad22b16cb127b74135" category="paragraph">As ferramentas do ONTAP 9.7.1 em conjunto com a versão 8,3 do VMware Site Recovery Manager (SRM) adicionou suporte para orquestração do fluxo de trabalho de migração e recuperação de desastres aproveitando a tecnologia NetApp SnapMirror.</block>
  <block id="8142fcf496d02a58ce02a17558db863e" category="paragraph">Atualmente, o VMware SRM é a única solução de automação de recuperação de desastres e migração para vVols suportada pelo NetApp, e as ferramentas ONTAP verificarão a existência de um servidor SRM 8,3 ou posterior registrado no vCenter antes de permitir a replicação do vVols, embora seja possível aproveitar as APIS REST do ONTAP Tools para criar seus próprios serviços.</block>
  <block id="7d8e8eced8d8b1a50f20640ffb5d363a" category="section-title">Replicação do vVols com o SRM</block>
  <block id="1910dc5a02cb649cc24df5670c631e34" category="paragraph"><block ref="1910dc5a02cb649cc24df5670c631e34" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c95aede1de7a41511c9d962deba49054" category="section-title">Suporte à MetroCluster</block>
  <block id="3f15bb720adb42bd521a2ce1cb3a2974" category="paragraph">Embora as ferramentas do ONTAP não sejam capazes de acionar um switchover do MetroCluster, ele oferece suporte a sistemas NetApp MetroCluster para vVols que suportam volumes em uma configuração uniforme de cluster de storage metro do vSphere (vmsc). O switchover de um sistema MetroCluster é Tratado da maneira normal.</block>
  <block id="cde16c5ee89c209c821e120caf65bb81" category="paragraph">Embora o NetApp SnapMirror Business Continuity (SM-BC) também possa ser usado como base para uma configuração vmsc, ele não é atualmente suportado com vVols.</block>
  <block id="c859f5cd725cb2d1b163e4b066bede9a" category="paragraph">Consulte estes guias para obter mais informações sobre o NetApp MetroCluster:</block>
  <block id="e5e0fb3ae5564674a6548ade7c601578" category="inline-link">_Arquitetura e design da solução IP MetroCluster TR-4689_</block>
  <block id="e64de4e49a37e62ff7f8c37e859bbeb9" category="paragraph"><block ref="e64de4e49a37e62ff7f8c37e859bbeb9" category="inline-link-rx"></block></block>
  <block id="0229efec9dc9b9a7fdf144b025157176" category="inline-link">_TR-4705 arquitetura e design da solução NetApp MetroCluster_</block>
  <block id="6aee4b78ffdfaf193918978472d660a7" category="paragraph"><block ref="6aee4b78ffdfaf193918978472d660a7" category="inline-link-rx"></block></block>
  <block id="876341bac548f230eb390348e8b075ad" category="inline-link">_VMware KB 2031038 suporte ao VMware vSphere com NetApp MetroCluster_</block>
  <block id="5e68486fffeebad2ed145408dc250367" category="paragraph"><block ref="5e68486fffeebad2ed145408dc250367" category="inline-link-rx"></block></block>
  <block id="50c323f7050912164118ba47eab75888" category="section-title">Visão geral do vVols Backup</block>
  <block id="6751e706567f4773c4f3138b4de51a0f" category="paragraph">Existem várias abordagens para proteger VMs, como usar agentes de backup in-Guest, anexar arquivos de dados da VM a um proxy de backup ou usar APIs definidas como VMware VADP. O vVols pode ser protegido usando os mesmos mecanismos e muitos parceiros da NetApp suportam backups de VM, incluindo vVols.</block>
  <block id="416d27c872769e934ac8a49ec98ccb53" category="paragraph">Como mencionado anteriormente, os snapshots gerenciados do VMware vCenter são descarregados para ONTAP clones de arquivo/LUN rápidos e eficientes em termos de espaço. Eles podem ser usados para backups rápidos e manuais, mas são limitados pelo vCenter a um máximo de 32 snapshots. Você pode usar o vCenter para tirar snapshots e reverter conforme necessário.</block>
  <block id="8f3d5ae5bd7d8922841975ccd84b8526" category="paragraph">A partir do plug-in SnapCenter para VMware vSphere (SCV) 4,6, quando usado em conjunto com as ferramentas ONTAP 9,10 e posteriores, adiciona suporte para backup e recuperação consistentes com falhas de VMs baseadas em vVols, utilizando snapshots ONTAP FlexVol volume com suporte para replicação SnapMirror e SnapVault. Suporte para até 1023 instantâneos por volume. O SCV também pode armazenar mais snapshots com retenção mais longa em volumes secundários usando o SnapMirror com uma política de cofre-espelho.</block>
  <block id="1429a9379faa8e82f8b198e93eebdf61" category="paragraph">O suporte ao vSphere 8,0 foi introduzido com o SCV 4,7, que usou uma arquitetura de plug-in local isolada. O suporte ao vSphere 8.0U1 foi adicionado ao SCV 4,8, que fez a transição completa para a nova arquitetura de plug-in remoto.</block>
  <block id="de1d77d00dae616276b6ceb6296a18f2" category="section-title">Backup do vVols com o plug-in do SnapCenter para VMware vSphere</block>
  <block id="02f41838319aab980999b60967d7fd53" category="paragraph">Com o NetApp SnapCenter, agora você pode criar grupos de recursos para vVols com base em tags e/ou pastas para aproveitar automaticamente os snapshots baseados no FlexVol do ONTAP para VMs baseadas em vVols. Isso permite que você defina serviços de backup e recuperação que protegerão as VMs automaticamente à medida que elas são provisionadas dinamicamente em seu ambiente.</block>
  <block id="4549a2943666c4815098331d30a872da" category="paragraph">O plug-in do SnapCenter para VMware vSphere é implantado como um dispositivo autônomo registrado como uma extensão do vCenter, gerenciado por meio da IU do vCenter ou por meio de APIs REST para automação de serviços de backup e recuperação.</block>
  <block id="26e2418d177df1dddb008e455ce28752" category="section-title">Arquitetura da SnapCenter</block>
  <block id="416d0d3efc5f3919abcdaaa2364738d9" category="paragraph"><block ref="416d0d3efc5f3919abcdaaa2364738d9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c32197281aa44f57ae568a9a42c7b3b6" category="paragraph">Como os outros plugins do SnapCenter ainda não suportam vVols no momento desta escrita, vamos nos concentrar no modelo de implantação independente neste documento.</block>
  <block id="6750052f2c0fb06d80a8efd7cb871190" category="paragraph">Como o SnapCenter usa snapshots do ONTAP FlexVol, não há sobrecarga no vSphere, nem há nenhuma penalidade de desempenho como se pode ver nas VMs tradicionais que usam snapshots gerenciados do vCenter. Além disso, como a funcionalidade do SCV é exposta por meio de APIs REST, ele facilita a criação de fluxos de trabalho automatizados usando ferramentas como VMware Aria Automation, Ansible, Terraform e praticamente qualquer outra ferramenta de automação capaz de usar APIs REST padrão.</block>
  <block id="0c889d77d71512ceb7241bd0f6d6ca23" category="inline-link">Visão geral das APIs REST</block>
  <block id="35eab4195b135718da016e20979f9031" category="paragraph">Para obter informações sobre APIS REST do SnapCenter, consulte<block ref="33852d6f529e96c0b816da3945bcb1e5" category="inline-link-rx"></block></block>
  <block id="4ee2d383554981f4ea8eff4f35db6832" category="inline-link">Plug-in do SnapCenter para APIs REST do VMware vSphere</block>
  <block id="63ae61e98eec102c39264a819a3c522e" category="paragraph">Para obter informações sobre o plug-in do SnapCenter para APIs REST do VMware vSphere, consulte<block ref="40a6c7462de67e21480b7a31e406f8f9" category="inline-link-rx"></block></block>
  <block id="bdf03d5c2a7086b6c916dc96d06a0a6c" category="paragraph">As práticas recomendadas a seguir podem ajudá-lo a aproveitar ao máximo sua implantação do SnapCenter.</block>
  <block id="60af6a4208b610da54a63a7e3658d5a5" category="list-text">O SCV oferece suporte ao vCenter Server RBAC e ao ONTAP RBAC e inclui funções do vCenter predefinidas que são criadas automaticamente para você quando o plug-in é registrado. Você pode ler mais sobre os tipos compatíveis de RBAC<block ref="a8ef9d6a500bd8288101245a3828ddb1" category="inline-link-rx"></block></block>
  <block id="0ed0835259b5b8c4b0f0910e7bfe2b17" category="list-text">Use a IU do vCenter para atribuir acesso a contas com menos privilégios usando as funções predefinidas descritas<block ref="17b3487f3493b9c198e03f92348bfca0" category="inline-link-rx"></block>.</block>
  <block id="d53326766687d6bc7fa2e28ee177e809" category="list-text">Se você usar o SCV com o servidor SnapCenter, deverá atribuir a função _SnapCenterAdmin_.</block>
  <block id="61ba6cb0b6021c205d41ed7f6fc1eb71" category="list-text">ONTAP RBAC refere-se à conta de usuário usada para adicionar e gerenciar os sistemas de storage usados pela SCV. O ONTAP RBAC não se aplica a backups baseados em vVols. Leia mais sobre ONTAP RBAC e SCV<block ref="e4e865178d3962f87ac5cef3d6d68942" category="inline-link-rx"></block>.</block>
  <block id="1c89ba258526186ea0ec98325b61371b" category="list-text">Replique seus conjuntos de dados de backup para um segundo sistema usando o SnapMirror para réplicas completas de volumes de origem. Como mencionado anteriormente, você também pode usar políticas de espelhamento de cofre para retenção de dados de backup a longo prazo, independentemente das configurações de retenção de snapshot do volume de origem. Ambos os mecanismos são suportados com vVols.</block>
  <block id="9792eeb3b91469abf77746b005d82d77" category="list-text">Como o SCV também requer ferramentas do ONTAP para a funcionalidade vVols do VMware vSphere, verifique sempre a ferramenta de Matriz de interoperabilidade (IMT) do NetApp para obter compatibilidade de versões específicas</block>
  <block id="71c989bd68059e2ddfa4200c60b736c7" category="list-text">Se você estiver usando a replicação do vVols com o VMware SRM, lembre-se de sua política de RPO e agendamento de backup</block>
  <block id="604eb779cbb9af378f7bda71633b5b31" category="list-text">Crie suas políticas de backup com configurações de retenção que atendem aos objetivos do ponto de restauração (RPOs) definidos pela organização</block>
  <block id="067ff91a08d3ff453b59d81993b96182" category="list-text">Configure as configurações de notificação em seus grupos de recursos para ser notificado sobre o status quando os backups são executados (veja a figura 10 abaixo)</block>
  <block id="c3add00693172bbbb4dd864bf0ad9116" category="section-title">Opções de notificação do grupo de recursos</block>
  <block id="28c6217e46797f76e427c591070cf50c" category="paragraph"><block ref="28c6217e46797f76e427c591070cf50c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6eae9510711f8df8f55a15e1761875d9" category="section-title">Comece a usar a SCV usando esses documentos</block>
  <block id="235a656535515ab3518937c09836e60d" category="inline-link">Saiba mais sobre o plug-in do SnapCenter para VMware vSphere</block>
  <block id="79eb02d2a96cc634df87bec5bd511bbe" category="paragraph"><block ref="79eb02d2a96cc634df87bec5bd511bbe" category="inline-link-rx"></block></block>
  <block id="04e7bb0411c1c8f56ca4fc8000c62ad8" category="inline-link">Implante o plug-in do SnapCenter para VMware vSphere</block>
  <block id="d4ba0aa084ae1145248006481c881d29" category="paragraph"><block ref="d4ba0aa084ae1145248006481c881d29" category="inline-link-rx"></block></block>
  <block id="647fe6e64f77a1f54f9bb61154ab2a4f" category="summary">Mais recursos do vVols</block>
  <block id="231cf4c70d866b616c21baddaeed0696" category="doc">Solução de problemas</block>
  <block id="87e6f97c8ec2f31df616ef84401ffaf4" category="paragraph">Existem vários recursos de solução de problemas disponíveis com informações adicionais.</block>
  <block id="fff460b039580a1bd42725a397b4c8be" category="inline-link">_Site de suporte da NetApp_</block>
  <block id="897515b5a8a03f8d5cbed44fd47ef9f3" category="paragraph"><block ref="897515b5a8a03f8d5cbed44fd47ef9f3" category="inline-link-rx"></block></block>
  <block id="4020fd07f5ee2361dd23956e6a334ffd" category="paragraph">A documentação adicional da solução está disponível aqui:</block>
  <block id="8059304404c995bd8a349056e7d40e32" category="inline-link">_Soluções NetApp para virtualização com VMware da Broadcom_</block>
  <block id="cc5363f91541e771ebd890b2330cb8ba" category="paragraph"><block ref="cc5363f91541e771ebd890b2330cb8ba" category="inline-link-rx"></block></block>
  <block id="baf17f6d2396be5fd3676baf863a331f" category="section-title">Solução de problemas do produto</block>
  <block id="9d6d7fa1a5253698556ac2b0cda2207d" category="paragraph">Os vários componentes das ferramentas do ONTAP, como o plug-in do vCenter, o provedor VASA e o adaptador de replicação de armazenamento, estão todos documentados juntos no repositório de documentos do NetApp. No entanto, cada um tem uma subseção separada da base de dados de Conhecimento e pode ter procedimentos específicos de solução de problemas. Estes abordam os problemas mais comuns que podem ser encontrados com o Fornecedor VASA.</block>
  <block id="ae2a93a809929192ecc7b468f234af84" category="section-title">Problemas de UI do provedor VASA</block>
  <block id="92a2b5cb9c6906035c2864fa225e1940" category="inline-link">artigo</block>
  <block id="69aecee18a55993c779487758eb051cc" category="paragraph">Ocasionalmente, o Cliente Web do vCenter vSphere encontra problemas com os componentes do Serenity, fazendo com que os itens do menu Fornecedor VASA para ONTAP não sejam exibidos. Consulte Resolução de problemas de Registro do provedor VASA no Guia de implantação ou nesta base de conhecimento<block ref="c8979f1604396ce5570d07774ba255f0" category="inline-link-rx"></block>.</block>
  <block id="03cc611b90575ea37b55959adaa1c754" category="section-title">Falha no provisionamento do armazenamento de dados do vVols</block>
  <block id="281b890be0e8280eea1aebb82de90961" category="paragraph">Ocasionalmente, os serviços do vCenter podem ter tempo limite ao criar o armazenamento de dados do vVols. Para corrigi-lo, reinicie o serviço vmware-sps e reinstale o datastore vVols usando os menus do vCenter (Storage &gt; New datastore). Isso é coberto em falhas de provisionamento de armazenamento de dados do vVols com o vCenter Server 6,5 no Guia de administração.</block>
  <block id="3152add163cd8aaf116a259d85ebf8fb" category="section-title">A atualização do Unified Appliance falha ao montar o ISO</block>
  <block id="ffaa56a3f5a1157f2eb3955773bb41da" category="paragraph">Devido a um bug no vCenter, o ISO usado para atualizar o dispositivo unificado de uma versão para a próxima pode não ser montado. Se o ISO puder ser anexado ao dispositivo no vCenter, siga o processo nesta base de conhecimento<block ref="9839383ed04f777c0132b57ad0cb14ac" category="inline-link-rx"></block> para resolver.</block>
  <block id="1a795345e422d7dbcca8fe38671a9371" category="summary">Diretrizes de projeto e implementação do vMSC.</block>
  <block id="b73deaadc37ea1c7a13ad17af6730c42" category="doc">Diretrizes de projeto e implementação do vMSC</block>
  <block id="3512760e2d3fc1a9dd2116e83bb0cada" category="paragraph">Este documento descreve as diretrizes de design e implementação do vMSC com sistemas de storage ONTAP.</block>
  <block id="556669df5b5073ab3d2ddcf638e942d9" category="section-title">Configuração de armazenamento NetApp</block>
  <block id="7f4d4fbe08a8a895671d05c4a82b0c85" category="inline-link">Documentação do MetroCluster</block>
  <block id="002eb41870df47521a2b59424d251f60" category="inline-link">Visão geral da continuidade dos negócios da SnapMirror</block>
  <block id="447566f62201eb825a1f6fb7a570873f" category="paragraph">Depois de configurar o MetroCluster, administrá-lo é como gerenciar um ambiente ONTAP tradicional. É possível configurar máquinas virtuais de storage (SVMs) usando várias ferramentas, como a interface de linha de comando (CLI), o System Manager ou o Ansible. Uma vez configurados os SVMs, crie interfaces lógicas (LIFs), volumes e números de unidades lógicas (LUNs) no cluster que será usado para operações normais. Esses objetos serão replicados automaticamente para o outro cluster usando a rede de peering de cluster.</block>
  <block id="57166da54d8751e1ed084f00b3f169e3" category="section-title">Crie um cluster do vSphere HA</block>
  <block id="829006223e7bdcfd478d2261f1d5ac40" category="inline-link">Como criar e configurar clusters no vSphere Client em docs.vmware.com</block>
  <block id="2bbae4763835d2e2dd123c1b4b0ae73d" category="paragraph">A criação de um cluster do vSphere HA é um processo de várias etapas totalmente documentado em<block ref="dd51ccd863dd3c9fbca770681f8e68a9" category="inline-link-rx"></block>. Em suma, primeiro você deve criar um cluster vazio e, usando o vCenter, você deve adicionar hosts e especificar o vSphere HA e outras configurações do cluster.</block>
  <block id="d50e63b9f70efedde8dc093be8ec12b2" category="inline-link">Práticas recomendadas do VMware vSphere Metro Storage Cluster</block>
  <block id="950954623b197b80e3ebb95b0adcc3de" category="paragraph">Para configurar um cluster de HA, execute as seguintes etapas:</block>
  <block id="1073102bd8c6cbd17340f2a19043583f" category="list-text">Conete-se à IU do vCenter.</block>
  <block id="ebf69ea3a3e34739bde13d589e85ef10" category="list-text">Em hosts e clusters, navegue até o data center onde você deseja criar seu cluster de HA.</block>
  <block id="d8fd85bbc0cd4746e5d80e291696b86c" category="list-text">Clique com o botão direito do rato no objeto do data center e selecione novo cluster. Em noções básicas, certifique-se de que você ativou o vSphere DRS e o vSphere HA. Conclua o assistente.</block>
  <block id="d94a770977f68948a4930f4a2edbabb9" category="image-alt">Novo cluster</block>
  <block id="f4f59bf1e324854573172ca2b5070d45" category="list-text">Selecione o cluster e vá para a guia configurar. Selecione vSphere HA e clique em Edit.</block>
  <block id="329c69e52a7de6215aa4dbfa19940f2d" category="list-text">Em Monitoramento de host, selecione a opção Ativar monitoramento de host.</block>
  <block id="f5c7047b98efcb8c7eef2db6ef31faf4" category="image-alt">Ativar a opção de monitorização de anfitrião</block>
  <block id="9fc231ac455a53f2fabc59f29ab537ad" category="list-text">Enquanto ainda estiver na guia falhas e respostas, em Monitoramento de VM, selecione a opção somente Monitoramento de VM ou a opção Monitoramento de VM e aplicativo.</block>
  <block id="239aaf78fcb42b02d3709057d2a7978a" category="image-alt">Monitoramento de VM</block>
  <block id="58aea8c81a7e8b8160584574af309fbb" category="list-text">Em Controle de admissão, defina a opção de controle de admissão HA para reserva de recursos de cluster; use 50% CPU/MEM.</block>
  <block id="a7765f8868404f7c3cb890ce051f7de4" category="image-alt">Controle de admissão</block>
  <block id="3f059eee365aa5c64c0be1d6dba81d69" category="list-text">Selecione DRS e clique EM editar.</block>
  <block id="7b5f9be03fd1421a9da56c2c7677ad69" category="list-text">Defina o nível de automação para manual, a menos que seja necessário pelas suas aplicações.</block>
  <block id="a8ee10582e28e3623629963a88ff5ec9" category="image-alt">vmsc 3 5</block>
  <block id="256164bb48582e5267e408f2e67e1939" category="inline-link">docs.vmware.com</block>
  <block id="91fb89f03b846483f7108d3f1bfb0156" category="list-text">Ativar a proteção de componentes VM,<block ref="fc88c93ad20ad804a211f4e6fea63e56" category="inline-link-rx"></block> consulte a .</block>
  <block id="d64ed3e9c10229648e069f56e32f4c8e" category="cell">Resposta</block>
  <block id="f3c1d0e4118d5d9501e1a7aeed19d224" category="cell">Falha do host</block>
  <block id="45d583cd5692c76d45e96536edce2a0e" category="cell">Reinicie as VMs</block>
  <block id="1c3a7ae924920b573baede481becd22f" category="cell">Isolamento de host</block>
  <block id="2e011e74abc75a2823c627b7ee9e22a7" category="cell">Armazenamento de dados com perda permanente de dispositivo (PDL)</block>
  <block id="49476a1ad365d5f8deb36464de7fe33b" category="cell">Desligue e reinicie as VMs</block>
  <block id="e7bbd35db169028c75e7c8ae655bf6ae" category="cell">Datastore com todos os caminhos para baixo (APD)</block>
  <block id="e7480b00a5e3efd904a08ca88804de45" category="cell">Hóspede não é coração batendo</block>
  <block id="e8896c595f3effde37ef29d7c6233703" category="cell">Repor as VMs</block>
  <block id="59695df3d45a3a21b8ff0bf57fda6a2b" category="cell">Política de reinicialização da VM</block>
  <block id="a150f56b87fd99bf9bf019f8447ba68b" category="cell">Determinado pela importância da VM</block>
  <block id="370a480458a8c63a838940f1241e14ee" category="cell">Resposta para isolamento do host</block>
  <block id="11f30f9be08cd4f9e500290222ddc552" category="cell">Encerre e reinicie as VMs</block>
  <block id="fb53fafa45c0de9bd41d368c7455c9f1" category="cell">Resposta para datastore com PDL</block>
  <block id="d7c3b9f5568eb60f08076b29490afcaf" category="cell">Resposta para datastore com APD</block>
  <block id="423b2d98eae113ae3391aa0b12f11935" category="cell">Desligar e reiniciar as VMs (conservadoras)</block>
  <block id="132bbe6dbceb01227dba5ab04db7202b" category="cell">Atraso para failover de VM para APD</block>
  <block id="8d15ed7d27d83ed6229a66b1f44b7696" category="cell">3 minutos</block>
  <block id="8c7b0644547f0ee3fe537e8ba441566d" category="cell">Resposta para recuperação APD com tempo limite APD</block>
  <block id="4dea08318b2824f845e9b889a6e17778" category="cell">Sensibilidade de monitoramento da VM</block>
  <block id="f535a28adc173e28610c129d0dc578ae" category="cell">Predefinição alta</block>
  <block id="83164803a765d1ea1f10d50dfdd26130" category="section-title">Configurar datastores para Heartbearing</block>
  <block id="22c81b09ec3086b2dce8f68867a221e0" category="paragraph">O vSphere HA usa datastores para monitorar hosts e máquinas virtuais quando a rede de gerenciamento falhou. Você pode configurar como o vCenter seleciona armazenamentos de dados Heartbeat. Para configurar armazenamentos de dados para batimentos cardíacos, execute as seguintes etapas:</block>
  <block id="64809e5386c9dc53f894f772f27d1b44" category="list-text">Na seção Heartbearing do datastore, selecione usar datastores na Lista especificada e elogiar automaticamente, se necessário.</block>
  <block id="fc66ba7317ceb4220dc88aa267db085d" category="list-text">Selecione os datastores que você deseja que o vCenter use em ambos os sites e pressione OK.</block>
  <block id="f2c634ca704e26f96be1723db6dda32a" category="image-alt">Uma captura de tela de uma Descrição do computador gerada automaticamente</block>
  <block id="1d2b14769d080b9214d9e407dfc92a64" category="section-title">Configurar opções avançadas</block>
  <block id="a9316d69e5abcfaffc56fc8f5e645412" category="paragraph">Os eventos de isolamento ocorrem quando os hosts dentro de um cluster de HA perdem a conetividade com a rede ou com outros hosts no cluster. Por padrão, o vSphere HA usará o gateway padrão para sua rede de gerenciamento como endereço de isolamento padrão. No entanto, você pode especificar endereços de isolamento adicionais para o host fazer ping para determinar se uma resposta de isolamento deve ser acionada. Adicione dois IPs de isolamento que podem fazer ping, um por local. Não utilize o IP do gateway. A configuração avançada do vSphere HA usada é das.isolationaddress. Você pode usar endereços IP do ONTAP ou Mediator para esse fim.</block>
  <block id="eaa1dfe3982e06655ce64e240c139b81" category="paragraph">Afinidade do VMware DRS para NetApp MetroCluster</block>
  <block id="e32221c52eb3b0bbeb3ca79aad6c90f6" category="paragraph">Nesta seção, criamos grupos DRS para VMs e hosts para cada site/cluster no ambiente MetroCluster. Em seguida, configuramos regras VM/Host para alinhar a afinidade do host da VM com os recursos de armazenamento local. Por exemplo, as VMs do Site A pertencem ao grupo VM sitea_vms e os hosts do Site A pertencem ao grupo de hosts sitea_hosts. Em seguida, nas regras VM/Host, declaramos que o sitea_vms deve ser executado em hosts no sitea_hosts.</block>
  <block id="5546466ab10e5cbfbc4b286cd60b8b4a" category="section-title">_Melhor prática_</block>
  <block id="5bfa0d712f66aef47f8a2ea582bc0b72" category="list-text">O NetApp recomenda altamente a especificação *deve ser executada em hosts no Grupo* em vez da especificação *deve ser executada em hosts no Grupo*. No caso de uma falha de host de um local, as VMs do local A precisam ser reiniciadas em hosts no local B por meio do vSphere HA, mas a última especificação não permite que o HA reinicie VMs no local B porque é uma regra geral. A especificação anterior é uma regra suave e será violada em caso de HA, permitindo assim disponibilidade em vez de desempenho.</block>
  <block id="3a5159fa23e450460f03e5a885a6c51c" category="paragraph">*[NOTA]</block>
  <block id="cc6a363013bd2a8c1e05304f1c6abd79" category="inline-link">Monitoramento e desempenho do vSphere</block>
  <block id="124de7d2bc72d75be9e481c1cc56ada2" category="section-title">Crie grupos de hosts DRS</block>
  <block id="0759e9476d3bf1868f88356025adafb2" category="paragraph">Para criar grupos de hosts DRS específicos ao local A e local B, execute as seguintes etapas:</block>
  <block id="a69dff3dd4b284f60243dfd62fa4e57f" category="list-text">No cliente da Web vSphere, clique com o botão direito do Mouse no cluster no inventário e selecione Configurações.</block>
  <block id="a130b4af254ead99e9ea83044e54ea1d" category="list-text">Clique em VM/Host Groups.</block>
  <block id="1bb250fbf1946dd1bd7ad228032f8803" category="list-text">Clique em Adicionar.</block>
  <block id="62c4d1538f957af2951f2c93ee191d0b" category="list-text">Digite o nome do grupo (por exemplo, sitea_hosts).</block>
  <block id="df22605898fc890edbcb2a126aa202ce" category="list-text">No menu tipo, selecione Grupo anfitrião.</block>
  <block id="57c0028584902f6cee210dcc13bc9745" category="list-text">Clique em Adicionar e selecione os hosts desejados no site A e clique em OK.</block>
  <block id="583e6d8c3b1006b0561d4b360e58994f" category="list-text">Repita estas etapas para adicionar outro grupo de hosts para o local B.</block>
  <block id="18d0ad44a1e563aaf9f5871e32535a6c" category="list-text">Clique em OK.</block>
  <block id="154964ee7fc6d3261ec55811b0ff9972" category="section-title">Crie grupos de VM DRS</block>
  <block id="40c1eaba5f178f243c57b595b6af4d5e" category="paragraph">Para criar grupos de VM DRS específicos para o local A e o local B, execute as seguintes etapas:</block>
  <block id="9a209a741c26968fc13ed8192523df15" category="list-text">Digite o nome do grupo (por exemplo, sitea_vms).</block>
  <block id="f947c7c9f173289b1c2565b3297095f0" category="list-text">No menu tipo, selecione Grupo VM.</block>
  <block id="40a2a21a084c8d16395113cb79a19ebb" category="list-text">Clique em Adicionar e selecione as VMs desejadas no local A e clique em OK.</block>
  <block id="e2e7af699096077fe178ebf021fb2273" category="section-title">Criar regras de host de VM</block>
  <block id="0a6075f3d3fdbe7c133268face0f5c82" category="paragraph">Para criar regras de afinidade do DRS específicas ao local A e ao local B, execute as seguintes etapas:</block>
  <block id="df4f9bcca0ceb7a67ba25d886a18743b" category="list-text">Clique em VM/Host Rules.</block>
  <block id="876a25c102b5c301814921d1a9c0e625" category="list-text">Digite o nome da regra (por exemplo, sitea_Affinity).</block>
  <block id="d4b5f57f4e2bd5c357ad9b1fbdc2cf8e" category="list-text">Verifique se a opção Ativar regra está marcada.</block>
  <block id="d1169f525bd934df7f1a7e3bcf401997" category="list-text">No menu tipo, selecione máquinas virtuais para hosts.</block>
  <block id="77328c16c697ce1d6c036c3f950e7542" category="list-text">Selecione o grupo VM (por exemplo, sitea_vms).</block>
  <block id="b36943ce975d4c5c6e9481a4ca396270" category="list-text">Selecione o grupo Host (por exemplo, sitea_hosts).</block>
  <block id="32fbcb32cfae9a0656233943c28f7c94" category="list-text">Repita estas etapas para adicionar outra VM/regra de host para o local B.</block>
  <block id="488f70e76f3c9ddf155b693e31c5a1e1" category="paragraph">Para configurar um cluster de datastore para cada site, execute as seguintes etapas:</block>
  <block id="1dfbc2b980c0b56a5d9889c6d9a25460" category="list-text">Usando o cliente da Web vSphere, navegue até o data center em que o cluster HA reside em Storage.</block>
  <block id="dfc332b252ad3de167b6a336d7e70d46" category="list-text">Clique com o botão direito do rato no objeto do data center e selecione armazenamento &gt; novo cluster do datastore.</block>
  <block id="829b62dbd6a4923b66591b2bff38ed5b" category="list-text">Selecione o cluster HA e clique em Next (seguinte).</block>
  <block id="e5bd6e5564d38885fef18a28e48861b4" category="image-alt">Cluster DE HA</block>
  <block id="30fe6cfa0a4c5fb23fccfe149cefc006" category="list-text">Selecione os datastores pertencentes ao site A e clique em Avançar.</block>
  <block id="4ea461b22638db4c94aa076d62a2065f" category="list-text">Reveja as opções e clique em concluir.</block>
  <block id="7b79e97caff76847cf350f1197c49953" category="list-text">Repita essas etapas para criar o cluster do datastore do site B e verifique se somente os datastores do site B estão selecionados.</block>
  <block id="d8f83b09bd6b864f22076c109cfaae66" category="section-title">Disponibilidade do vCenter Server</block>
  <block id="605b8c1efcf2de9164e5d5425c67bdcd" category="paragraph">Os dispositivos do vCenter Server (VCSAs) devem ser protegidos com o vCenter HA. O vCenter HA permite implantar dois VCSAs em um par de HA ativo-passivo. Um em cada domínio de falha. Você pode ler mais sobre o vCenter HA no<block ref="173ca8434bdf39dd0a60efe576d066cd" category="inline-link-rx"></block>.</block>
  <block id="2f58fa882a22b5af5f0741f03abaf611" category="summary">Cluster de armazenamento do vSphere Metro com o ONTAP</block>
  <block id="a58c81d13cac4e9b37bba2bd7fc3a93d" category="paragraph">O hypervisor vSphere líder do setor da VMware pode ser implantado como um cluster estendido chamado vSphere Metro Storage Cluster (vMSC).</block>
  <block id="e3224e391e08365c1593c07b9fe99cfa" category="section-title">Soluções de disponibilidade contínua para ambientes vSphere</block>
  <block id="d3e911c902a6b066f9c31d471d16fb21" category="paragraph">Para criar um cluster VMware HA/DRS em dois locais, os hosts ESXi são usados e gerenciados por um vCenter Server Appliance (VCSA). As redes de gerenciamento vSphere, vMotion e máquinas virtuais são conetadas por meio de uma rede redundante entre os dois sites. O vCenter Server que gerencia o cluster HA/DRS pode se conetar aos hosts ESXi em ambos os sites e deve ser configurado usando o vCenter HA.</block>
  <block id="da76be2bc20d4e043d9a2019b817214f" category="inline-link">Como criar e configurar clusters no vSphere Client</block>
  <block id="e02f3e9258a23204655bd512ec53911d" category="paragraph"><block ref="c06ae090600e7aa086edfa28514435e7" category="inline-link-rx"></block>Consulte para configurar o vCenter HA.</block>
  <block id="7564f732469e12963d8b416572cf4efb" category="section-title">O que é o vSphere Metro Storage Cluster?</block>
  <block id="38910d3dab2318849fd5f1a1dfbe0152" category="inline-link">Guia de compatibilidade do VMware Storage</block>
  <block id="838b66b875df1b432ac420a98cba3db6" category="paragraph">Se você quiser obter mais informações sobre as diretrizes de design do vSphere Metro Storage Cluster, consulte a seguinte documentação:</block>
  <block id="07aaf2aebfd07b8763284018d1ebbf57" category="inline-link">Suporte ao VMware vSphere com o NetApp MetroCluster</block>
  <block id="a4a5fd5b00daf98bd381d80257378acd" category="list-text"><block ref="a4a5fd5b00daf98bd381d80257378acd" category="inline-link-rx"></block></block>
  <block id="c3dc11e39d996a00b095022f4e56583d" category="inline-link">Suporte ao VMware vSphere com o NetApp SnapMirror Business Continuity</block>
  <block id="8f675397d9c0ef95aa8b3f0ada9d601a" category="list-text"><block ref="f53214cfd764fa0267c92323be0d7337" category="inline-link-rx"></block> (Agora conhecido como SnapMirror ative Sync)</block>
  <block id="b553530def78406c0977f70d5e90b9e8" category="list-text">Stretch MetroCluster</block>
  <block id="2d90abe978ed8084d304295ad0a8c8fd" category="list-text">Fabric MetroCluster</block>
  <block id="b03023e82bda6a71adc49c4834e3b6ab" category="paragraph">A seguir ilustra um diagrama de topologia de alto nível do Stretch MetroCluster.</block>
  <block id="119be031ef4485d20c7683d291d0e9f6" category="inline-link">Documentação do MetroCluster</block>
  <block id="ad9122c6d75ebaa024669fde1c0bdfb8" category="paragraph"><block ref="d8a206747dbcec13122724b2aee18957" category="inline-link-rx"></block>Consulte para obter informações específicas sobre design e implantação do MetroCluster.</block>
  <block id="b47354fcd7d17ab4fbb3283f71677efe" category="paragraph">O SnapMirror ative Sync também pode ser implantado de duas maneiras diferentes.</block>
  <block id="314084a577b998d8089dff72c98c58b0" category="list-text">Assimétrico</block>
  <block id="2fa76de41291847c8d191ea664c53395" category="summary">Saiba mais sobre o cluster de armazenamento do vSphere Metro com o ONTAP</block>
  <block id="f24ef4a42850a2b3e3d77e610ae46fee" category="doc">Resiliência para eventos planejados e não planejados</block>
  <block id="4bce11924453ef2ee7e40109f79dc66d" category="paragraph">O NetApp MetroCluster e o SnapMirror ative Sync são ferramentas poderosas que melhoram a alta disponibilidade e as operações ininterruptas do hardware NetApp e do software ONTAP.</block>
  <block id="d267775072875ddbb24c16a41c22d8a2" category="paragraph">O MetroCluster e o SnapMirror ative Sync oferecem três métodos básicos para a continuidade dos dados em caso de eventos planejados ou não planejados:</block>
  <block id="1d3027d09fc1db3087f05f2163af2cb7" category="list-text">Componentes redundantes para proteção contra falha de componente único</block>
  <block id="f3b83f3b77289efe3b53cf537b7b77f5" category="list-text">Takeover de HA local para eventos que afetam um único controlador</block>
  <block id="b6ed0cba165f6f9664dc1e57ac3419ec" category="list-text">Proteção completa do local – retomada rápida do serviço movendo o armazenamento e o acesso do cliente do cluster de origem para o cluster de destino</block>
  <block id="16afcbe8821dfa582521cd62c1ec130d" category="paragraph">Isso significa que as operações continuam sem problemas em caso de falha de um único componente e retornam automaticamente à operação redundante quando o componente com falha é substituído.</block>
  <block id="8fab78e8b214cad43d962b802bf568f8" category="paragraph">Todos os clusters do ONTAP, exceto clusters de nó único (normalmente versões definidas por software, como o ONTAP Select, por exemplo), têm recursos de HA incorporados, chamados de takeover e giveback. Cada controlador no cluster é emparelhado com outro controlador, formando um par de HA. Esses pares garantem que cada nó esteja conetado localmente ao storage.</block>
  <block id="83e1749664841043ce8b1e894769a201" category="paragraph">O takeover é um processo automatizado no qual um nó assume o storage do outro para manter os serviços de dados. Giveback é o processo reverso que restaura a operação normal. O takeover pode ser planejado, como ao executar a manutenção de hardware ou atualizações de ONTAP, ou não planejado, resultante de um pânico de nó ou falha de hardware.</block>
  <block id="0b0403a9258293da1f6a5fc84d24a18e" category="inline-link">Visão geral do gerenciamento do par HA</block>
  <block id="cf654073ce9eb8f38d3f05292ed83cc5" category="paragraph">O switchover do local com o MetroCluster ocorre quando um local está off-line ou como uma atividade planejada para manutenção em todo o local. O local restante assume a propriedade dos recursos de storage (discos e agregados) do cluster off-line, e os SVMs no site com falha são colocados on-line e reiniciados no local de desastre, preservando sua identidade completa para acesso ao cliente e ao host.</block>
  <block id="d9c9eb44a58ee1ce90daa68527aa8930" category="summary">Cenários de falha para vMSC com MCC</block>
  <block id="e7c7574b0826c9074f480de76c889ba8" category="paragraph">As seções a seguir descrevem os resultados esperados de vários cenários de falha com sistemas vMSC e NetApp MetroCluster.</block>
  <block id="c8a2eebb480fef69e6ed917ea7f7a9d3" category="section-title">Falha de caminho de storage único</block>
  <block id="b99e8e694b032f593bbd01f6205b4a98" category="paragraph">Nesse cenário, se componentes como a porta HBA, a porta de rede, a porta do switch de dados front-end ou um cabo FC ou Ethernet falharem, esse caminho específico para o dispositivo de armazenamento será marcado como morto pelo host ESXi. Se vários caminhos forem configurados para o dispositivo de storage fornecendo resiliência na porta HBA/rede/switch, o ESXi executará idealmente um switchover de caminho. Durante esse período, as máquinas virtuais permanecem em execução sem serem afetadas, pois a disponibilidade para o armazenamento é tratada fornecendo vários caminhos para o dispositivo de armazenamento.</block>
  <block id="d235766de3bd77aa4983181862c135d7" category="admonition">Não há nenhuma mudança no comportamento do MetroCluster neste cenário, e todos os datastores continuam intactos de seus respetivos sites.</block>
  <block id="80fc15dd1deb985234440745e8a78d4c" category="paragraph">Em ambientes em que os volumes NFS/iSCSI são usados, a NetApp recomenda ter pelo menos dois uplinks de rede configurados para a porta NFS vmkernel no vSwitch padrão e o mesmo no grupo de portas em que a interface NFS vmkernel é mapeada para o vSwitch distribuído. O agrupamento de NIC pode ser configurado em ativo-ativo ou ativo-standby.</block>
  <block id="0c8694e8ef7f8935edbfac605753bc95" category="paragraph">Além disso, para iSCSI LUNs, multipathing deve ser configurado vinculando as interfaces vmkernel aos adaptadores de rede iSCSI. Para obter mais informações, consulte a documentação de armazenamento do vSphere.</block>
  <block id="0fc808fdb968eb089fbc5124c0a8e15a" category="paragraph">Em ambientes em que LUNs de Fibre Channel são usados, a NetApp recomenda ter pelo menos dois HBAs, o que garante resiliência no nível de HBA/porta. O NetApp também recomenda um iniciador único para o zoneamento de destino único como a melhor prática para configurar o zoneamento.</block>
  <block id="238c3d1c7bf8b5b42237392383a4c7ab" category="paragraph">O VSC (Virtual Storage Console) deve ser usado para definir políticas de multipathing porque define políticas para todos os dispositivos de armazenamento NetApp novos e existentes.</block>
  <block id="217811709dfb096c78e73934de01271c" category="section-title">Falha única do host ESXi</block>
  <block id="93bc89a0478478dd84d8159a18f6c1a2" category="image-alt">Uma única falha de host.</block>
  <block id="15023af3b440b4004f509e961bfe1e30" category="paragraph">Nesse cenário, se houver uma falha do host ESXi, o nó mestre no cluster do VMware HA deteta a falha do host, já que ele não recebe mais batimentos cardíacos da rede. Para determinar se o host está realmente inativo ou apenas uma partição de rede, o nó mestre monitora os batimentos cardíacos do datastore e, se eles estiverem ausentes, ele executa uma verificação final fazendo ping nos endereços IP de gerenciamento do host com falha. Se todas essas verificações forem negativas, o nó principal declara que este host é um host com falha e todas as máquinas virtuais que estavam sendo executadas nesse host com falha são reinicializadas no host sobrevivente no cluster.</block>
  <block id="9a11158d52f71012ae8722b09bf8bf29" category="paragraph">Se as regras de afinidade de host e VM DRS tiverem sido configuradas (as VMs no grupo VM sitea_vms devem executar hosts no grupo host sitea_hosts), o mestre HA primeiro verifica se há recursos disponíveis no local A. se não houver hosts disponíveis no local A, o mestre tentará reiniciar as VMs nos hosts no local B.</block>
  <block id="7922c92ff860eb0508dc8cc8aae3ffdd" category="paragraph">É possível que as máquinas virtuais sejam iniciadas nos hosts ESXi no outro site se houver uma restrição de recursos no site local. No entanto, as regras de afinidade de host e VM DRS definidas corrigirão se alguma regra for violada migrando as máquinas virtuais de volta para qualquer host ESXi sobrevivente no site local. Nos casos em que o DRS é definido como manual, o NetApp recomenda chamar o DRS e aplicar as recomendações para corrigir o posicionamento da máquina virtual.</block>
  <block id="387b5a49326be3a47e081682e75e19b4" category="paragraph">Não há nenhuma mudança no comportamento do MetroCluster neste cenário e todos os datastores continuam intactos de seus respetivos sites.</block>
  <block id="a11ffa7d20dab792fe5aa9c27017493e" category="section-title">Isolamento do host ESXi</block>
  <block id="17e01652089acd413e26ea89cf98a2b8" category="image-alt">Isolamento do host ESXi</block>
  <block id="8a4b746274e9d7129602d54434624806" category="paragraph">Nesse cenário, se a rede de gerenciamento do host ESXi estiver inativa, o nó mestre no cluster HA não receberá nenhum heartbeats e, portanto, esse host fica isolado na rede. Para determinar se ele falhou ou está isolado apenas, o nó principal começa a monitorar o batimento cardíaco do datastore. Se estiver presente, o host é declarado isolado pelo nó mestre. Dependendo da resposta de isolamento configurada, o host pode optar por desligar, desligar as máquinas virtuais ou até mesmo deixar as máquinas virtuais ligadas. O intervalo padrão para a resposta de isolamento é de 30 segundos.</block>
  <block id="a070f7923919fed39772c5d3f91bf482" category="section-title">Falha no compartimento de disco</block>
  <block id="4f90d34a41c7ebc83024a5e3ca35ff3a" category="image-alt">Falha em um compartimento de disco único.</block>
  <block id="14d627875de76f84985b8a3b27c96633" category="list-text">Durante esse período, não há impactos nas operações de e/S da máquina virtual, mas há desempenho degradado porque os dados estão sendo acessados do compartimento de disco remoto por meio de links ISL.</block>
  <block id="1c872dcd4bcebb1d7567f383901dfc0d" category="section-title">Falha no controlador de storage único</block>
  <block id="68badb604dbd29653979fdc7083cbffe" category="paragraph">Nesse cenário, um dos dois controladores de storage falha em um local. Como há um par de HA em cada local, uma falha de um nó aciona o failover automaticamente para o outro nó. Por exemplo, se o nó A1 falhar, o storage e os workloads serão transferidos automaticamente para o nó A2. As máquinas virtuais não serão afetadas porque todos os plexos permanecem disponíveis. Os segundo nós do local (B1 e B2) não são afetados. Além disso, o vSphere HA não tomará nenhuma ação porque o nó mestre no cluster ainda estará recebendo os batimentos cardíacos da rede.</block>
  <block id="0ac25682ea568511724f2e0819127d89" category="image-alt">Falha de nó único</block>
  <block id="e7b4c0523308b3fd46189b6ab4867fe5" category="paragraph">Se o failover fizer parte de um desastre contínuo (nó A1 faz failover para A2) e houver uma falha subsequente de A2 ou a falha completa do local A, o switchover após um desastre pode ocorrer no local B.</block>
  <block id="7b590b52d9f3d4d40cda67758ff92ba1" category="section-title">Avarias na ligação InterSwitch</block>
  <block id="9df08f82abe35d87c6f7c96b18dab755" category="section-title">Falha de ligação InterSwitch na rede de gestão</block>
  <block id="ed0711cbc7a050952e0e370bab079bff" category="image-alt">Falha do link do InterSwitch na rede de gerenciamento</block>
  <block id="a32c6c77bb8d407cf5825aec175bab4b" category="paragraph">Nesse cenário, se os links ISL na rede de gerenciamento de host front-end falharem, os hosts ESXi no local A não poderão se comunicar com hosts ESXi no local B. isso levará a uma partição de rede porque os hosts ESXi em um determinado local não poderão enviar os batimentos cardíacos da rede para o nó mestre no cluster HA. Como tal, haverá dois segmentos de rede por causa da partição e haverá um nó mestre em cada segmento que protegerá as VMs de falhas de host dentro do site específico.</block>
  <block id="290cbdcb6abb203d45786213f3c43662" category="admonition">Durante esse período, as máquinas virtuais permanecem em execução e não há alteração no comportamento do MetroCluster nesse cenário. Todos os armazenamentos de dados continuam intactos de seus respetivos sites.</block>
  <block id="628309883a8d1307131d205b200c56ae" category="section-title">Falha na ligação InterSwitch na rede de armazenamento</block>
  <block id="a9da7e2a43bcea673a22b949355e619d" category="image-alt">Falha de ligação InterSwitch na rede de armazenamento</block>
  <block id="625db96c5ee1e9b5197b6cb3c1715021" category="paragraph">Nesse cenário, se os links ISL na rede de armazenamento de back-end falharem, os hosts no local A perderão acesso aos volumes de armazenamento ou LUNs do cluster B no local B e vice-versa. As regras do VMware DRS são definidas para que a afinidade do local de armazenamento de host facilite a execução das máquinas virtuais sem impactos no local.</block>
  <block id="8d9609f32cbee8fa5080f95d71a2a142" category="paragraph">Durante esse período, as máquinas virtuais permanecem em execução em seus respetivos sites e não há alteração no comportamento do MetroCluster nesse cenário. Todos os armazenamentos de dados continuam intactos de seus respetivos sites.</block>
  <block id="719831bfdda20be14c04e2b165cce85e" category="paragraph">Se, por algum motivo, a regra de afinidade foi violada (por exemplo, VM1, que deveria ser executado a partir do site A, onde seus discos residem em nós de cluster local A, está sendo executado em um host no local B), o disco da máquina virtual será acessado remotamente por meio de links ISL. Devido à falha do link ISL, o VM1 em execução no local B não seria capaz de gravar em seus discos porque os caminhos para o volume de armazenamento estão inativos e essa máquina virtual específica está inativa. Nessas situações, o VMware HA não toma nenhuma ação, uma vez que os hosts estão enviando batimentos cardíacos ativamente. Essas máquinas virtuais precisam ser manualmente desligadas e ligadas em seus respetivos sites. A figura a seguir ilustra uma VM que viola uma regra de afinidade DRS.</block>
  <block id="09ba89b1ea49214c15fbf8ea6f129cb0" category="image-alt">Uma VM que viola uma regra de afinidade DRS não consegue gravar em discos após falha do ISL</block>
  <block id="49f26967af2ad76cacf7888cbeeb0590" category="section-title">Todas as falhas do InterSwitch ou completa partição do data center</block>
  <block id="bc331d84348670dff6731555166fa378" category="paragraph">Neste cenário, todos os links ISL entre os sites estão inativos e ambos os sites são isolados uns dos outros. Como discutido em cenários anteriores, como falha de ISL na rede de gerenciamento e na rede de armazenamento, as máquinas virtuais não são afetadas em falha completa de ISL.</block>
  <block id="3543d47d1f3a8dc6989a32f62ce3ea77" category="image-alt">Todas as falhas ISL ou partição completa do data center</block>
  <block id="3a096ef571101010add81b37081d3276" category="paragraph">A NetApp recomenda determinar se alguma máquina virtual violou as regras do DRS. Todas as máquinas virtuais executadas a partir de um site remoto ficarão inativas, uma vez que não poderão acessar o datastore, e o vSphere HA reiniciará essa máquina virtual no site local. Depois que os links ISL estiverem novamente online, a máquina virtual que estava sendo executada no local remoto será morta, uma vez que não pode haver duas instâncias de máquinas virtuais executando com os mesmos endereços MAC.</block>
  <block id="87e9384cb464ff9a4ce385fc59a178a2" category="image-alt">Uma partição de data center onde VM1 violou uma regra de afinidade DRS</block>
  <block id="0951e388ebea20c49e71af25ef84947d" category="section-title">Falha de ligação InterSwitch em ambas as malhas no NetApp MetroCluster</block>
  <block id="715cbc6f6bcf5da6b73f10233847d3a1" category="paragraph">Quaisquer gravações que ocorram depois de todos os ISLs estarem inativos não serão espelhadas para o outro site. Um switchover em caso de desastre, enquanto a configuração estiver nesse estado, incorreria, portanto, na perda dos dados que não haviam sido sincronizados. Neste caso, a intervenção manual é necessária para a recuperação após a mudança. Se for provável que nenhum ISLs esteja disponível por um período prolongado, um administrador pode optar por encerrar todos os serviços de dados para evitar o risco de perda de dados se for necessário um switchover em caso de desastre. A execução dessa ação deve ser ponderada contra a probabilidade de um desastre exigir mudança antes de pelo menos uma ISL ficar disponível. Alternativamente, se os ISLs estiverem falhando em um cenário em cascata, um administrador pode acionar um switchover planejado para um dos sites antes que todos os links tenham falhado.</block>
  <block id="89f375bfe8be0893bf175b89ce754b8e" category="image-alt">Falha do link do InterSwitch em ambas as telas no NetApp MetroCluster.</block>
  <block id="bc813a6fdbbeebf4d230b7e33d8c3a76" category="section-title">Falha na ligação do cluster de peered</block>
  <block id="77130a0b52e4379c6b6667cf7f8e155c" category="image-alt">Uma falha na ligação do cluster em contacto com o grupo</block>
  <block id="9dc32d7afddc9a265c5c2713db55fc70" category="section-title">Falha no local completo</block>
  <block id="d0d6a03c382bc5412f1822e5c97d5142" category="paragraph">Em um local completo Um cenário de falha, os hosts ESXi no local B não receberão o heartbeat da rede dos hosts ESXi no local A porque estão inoperantes. O mestre de HA no local B verificará se os batimentos cardíacos do armazenamento de dados não estão presentes, declarará que os hosts no local A estão com falha e tentará reiniciar o local Uma máquina virtual no local B. durante esse período, o administrador de storage executa um switchover para retomar os serviços dos nós com falha no local sobrevivente, o que restaurará todos os serviços de armazenamento do Local A no local B. após o local A volumes ou LUNs estarem disponíveis no local B, o agente de HA tentará reiniciar o local B.</block>
  <block id="23e5761401326cc21bcf9d108b9e3e7f" category="paragraph">Se a tentativa do agente mestre do vSphere HA de reiniciar uma VM (que envolve registrá-la e ligá-la) falhar, a reinicialização será novamente tentada após um atraso. O atraso entre reinicializações pode ser configurado até um máximo de 30 minutos. O vSphere HA tenta reiniciar para um número máximo de tentativas (seis tentativas por padrão).</block>
  <block id="9a18dc3c2c9a217a632ca45b5b93a004" category="admonition">O mestre de HA não inicia as tentativas de reinicialização até que o gerente de colocação encontre um armazenamento adequado, portanto, no caso de uma falha completa no local, isso seria depois que o switchover foi executado.</block>
  <block id="085a4a3eba6c30fa589bfee20eb0c294" category="paragraph">Se o local A tiver sido substituído, uma falha subsequente de um dos nós do local B sobreviventes pode ser tratada de forma otimizada pelo failover para o nó sobrevivente. Neste caso, o trabalho de quatro nós agora está sendo executado por apenas um nó. A recuperação neste caso consistiria em realizar um giveback para o nó local. Em seguida, quando o local A é restaurado, uma operação de switchback é executada para restaurar a operação de estado estável da configuração.</block>
  <block id="2b9b713afb0d80ef371a0b55e58366b6" category="image-alt">Falha completa no local</block>
  <block id="823bd5c6c005e340599d915e134d851c" category="summary">Visão geral da solução VMware vSphere</block>
  <block id="be26d39d86de44047c65c1fed157d529" category="paragraph">O vCenter Server Appliance (VCSA) é o poderoso sistema de gerenciamento centralizado e um painel único para o vSphere, que permite que os administradores operem os clusters ESXi com eficiência. Ele facilita as principais funções, como provisionamento de VM, operação vMotion, alta disponibilidade (HA), Agendador de recursos distribuídos (DRS), Tanzu Kubernetes Grid e muito mais. Ele é um componente essencial em ambientes de nuvem da VMware e deve ser projetado pensando na disponibilidade de serviços.</block>
  <block id="8ba8694e23f6560a60d85c4de549122b" category="section-title">Alta disponibilidade do vSphere</block>
  <block id="01036edb3159652090a3f7149fe1ce2f" category="paragraph">Cluster do vSphere HA recuperando VMs do servidor com falha.</block>
  <block id="15496c3917565cea1f21bbc7e6eba996" category="image-alt">Diagrama vMSC</block>
  <block id="dcff37ab37f2cb6a72aeb3c30e3ed5aa" category="section-title">Detecção de falha do host</block>
  <block id="7069d861b63dd4095cfb7b2ee30587f5" category="paragraph">Assim que o cluster de HA é criado, todos os hosts do cluster participam das eleições, e um dos hosts se torna um mestre. Cada escravo executa o batimento cardíaco da rede para o mestre, e o mestre, por sua vez, executa o batimento cardíaco da rede em todos os hosts escravos. O host mestre de um cluster do vSphere HA é responsável por detetar a falha de hosts escravos.</block>
  <block id="73b629afd8ef39d8d0147696412538c8" category="paragraph">Dependendo do tipo de falha detetada, as máquinas virtuais que estão sendo executadas nos hosts podem precisar ser reexecutadas.</block>
  <block id="e12cf4015a45ff29f1f84ae1a3ee0390" category="paragraph">Em um cluster do vSphere HA, três tipos de falha de host são detetados:</block>
  <block id="4eac346eb6cdd3a1a98ee9bc71ebccaa" category="list-text">Falha - Um host pára de funcionar.</block>
  <block id="3875a4c584a7715edf4a221ce53d45fc" category="list-text">Isolamento - Um host se torna isolado na rede.</block>
  <block id="82fba11358d642111efbcf36273159f2" category="list-text">Partição - Um host perde a conetividade de rede com o host mestre.</block>
  <block id="5f72ceebd161159fe623ff01ac0cf1b4" category="paragraph">O host principal monitora os hosts escravos no cluster. Esta comunicação é feita através da troca de batimentos cardíacos de rede a cada segundo. Quando o host mestre deixa de receber esses batimentos cardíacos de um host escravo, ele verifica a presença de host antes de declarar que o host falhou. A verificação de vivacidade que o host mestre executa é determinar se o host escravo está trocando heartbeats com um dos datastores. Além disso, o host principal verifica se o host responde aos pings ICMP enviados para seus endereços IP de gerenciamento para detetar se ele é meramente isolado de seu nó mestre ou completamente isolado da rede. Ele faz isso fazendo ping no gateway padrão. Um ou mais endereços de isolamento podem ser especificados manualmente para melhorar a confiabilidade da validação de isolamento.</block>
  <block id="0456a7ce7bf92fb68980571fdd2defa1" category="paragraph">A NetApp recomenda especificar um mínimo de dois endereços de isolamento adicionais e que cada um desses endereços seja local. Isso aumentará a confiabilidade da validação de isolamento.</block>
  <block id="19c262cd1e1bb07c491e359333f04a29" category="section-title">Resposta de isolamento do host</block>
  <block id="620b4ae663a26c98656d1c81bec1a6c2" category="paragraph">Antes que o HA inicie a resposta de isolamento, ele primeiro verifica se o agente mestre do vSphere HA possui o datastore que contém os arquivos de configuração da VM. Caso contrário, o host não acionará a resposta de isolamento, porque não há mestre para reiniciar as VMs. O host verificará periodicamente o estado do datastore para determinar se ele é reivindicado por um agente do vSphere HA que detém a função mestre.</block>
  <block id="6bd7b146f345eefac88b336a89aa3754" category="paragraph">Uma condição de split-brain pode ocorrer se um host ficar isolado ou particionado do host master do vSphere HA e o mestre não conseguir se comunicar por meio de datastores de heartbeat ou por ping. O mestre declara o host isolado morto e reinicia as VMs em outros hosts no cluster. Uma condição de split-brain agora existe porque existem duas instâncias da máquina virtual em execução, apenas uma das quais pode ler ou gravar os discos virtuais. As condições de split-brain agora podem ser evitadas configurando a VM Component Protection (VMCP).</block>
  <block id="df05a421ed8ba49f97f18dc085495ee4" category="section-title">Proteção de componentes VM (VMCP)</block>
  <block id="1418d127ee81cc7f3e114029e9ba6856" category="paragraph">Um dos aprimoramentos de recursos do vSphere 6, relevantes para o HA, é o VMCP. O VMCP fornece proteção aprimorada contra todas as condições de APD (caminhos para baixo) e PDL (perda permanente de dispositivo) para bloco (FC, iSCSI, FCoE) e armazenamento de arquivos (NFS).</block>
  <block id="fc35e15d00ef5b037a1a56c77ef3e17c" category="section-title">Perda permanente de dispositivo (PDL)</block>
  <block id="967b20f28092443585be2b9649d0ba93" category="paragraph">PDL é uma condição que ocorre quando um dispositivo de armazenamento falha permanentemente ou é removido administrativamente e não se espera que retorne. A matriz de armazenamento NetApp emite um código SCSI Sense para ESXi declarando que o dispositivo é perdido permanentemente. Na seção condições de falha e resposta da VM do vSphere HA, você pode configurar o que a resposta deve ser depois que uma condição de PDL é detetada.</block>
  <block id="6d623de2ea8c5007def6f2349d9ad8b9" category="section-title">Todos os caminhos para baixo (APD)</block>
  <block id="15d2d9b1f25022e7080482582e155265" category="paragraph">APD é uma condição que ocorre quando um dispositivo de armazenamento se torna inacessível para o host e nenhum caminho para o array está disponível. O ESXi considera isso um problema temporário com o dispositivo e espera que ele fique disponível novamente.</block>
  <block id="f89caca297ba86d190d90ef30c409ccf" category="paragraph">Quando uma condição APD é detetada, um temporizador é iniciado. Após 140 segundos, a condição APD é oficialmente declarada e o dispositivo é marcado como APD time out. Quando os 140 segundos tiverem passado, o HA começará a contar o número de minutos especificado no atraso para o APD de failover da VM. Quando o tempo especificado tiver passado, o HA reiniciará as máquinas virtuais afetadas. Você pode configurar o VMCP para responder de forma diferente, se desejado (Desativado, Eventos de problemas ou Desligar e reiniciar VMs).</block>
  <block id="76d29c3c5f57a16a7f080459356c3793" category="paragraph">Conservador refere-se à probabilidade de que o HA seja capaz de reiniciar VMs. Quando definido como Conservador, o HA só reiniciará a VM afetada pelo APD se souber que outro host pode reiniciá-la. No caso de agressivo, o HA tentará reiniciar a VM, mesmo que não saiba o estado dos outros hosts. Isso pode fazer com que as VMs não sejam reiniciadas se não houver nenhum host com acesso ao datastore em que ele está localizado.</block>
  <block id="580bc3953adcf3e3a20c5497f67f8b2c" category="paragraph">O NetApp recomenda configurar a resposta para recuperação do APD após o tempo limite do APD para Desativado.</block>
  <block id="a067a9a0e98c97f62fba4698bde30edc" category="section-title">Implementação do VMware DRS para NetApp MetroCluster</block>
  <block id="b9e04f46a88c8139fbb91780a2ff9064" category="paragraph">Se você criar uma regra de afinidade DRS para o cluster, poderá especificar como o vSphere aplica essa regra durante um failover de máquina virtual.</block>
  <block id="f903d43a0acb7412db93e8201ab12be3" category="paragraph">Existem dois tipos de regras que você pode especificar o comportamento de failover do vSphere HA:</block>
  <block id="a96c8bab3a450bb828e3093d16f7e32c" category="list-text">As regras de anti-afinidade da VM forçam as máquinas virtuais especificadas a permanecerem separadas durante as ações de failover.</block>
  <block id="1fa3a04279011cbc6001c96c0f6f27fb" category="list-text">As regras de afinidade de host da VM colocam máquinas virtuais especificadas em um host específico ou em um membro de um grupo definido de hosts durante ações de failover.</block>
  <block id="225e3f7204b6e5bf6cd388af7bb16eb4" category="paragraph">Usando regras de afinidade de host de VM no VMware DRS, pode-se ter uma separação lógica entre o local A e o local B para que a VM seja executada no host no mesmo local do array configurado como o controlador de leitura/gravação primário para um determinado datastore. Além disso, as regras de afinidade de host da VM permitem que as máquinas virtuais permaneçam locais para o armazenamento, o que, por sua vez, verifica a conexão da máquina virtual em caso de falhas de rede entre os sites.</block>
  <block id="db03e2255e35df6fa9719c800850c397" category="paragraph">A seguir está um exemplo de grupos de hosts de VM e regras de afinidade.</block>
  <block id="c4b0e8af5e898d44e394489b0c629abb" category="image-alt">Grupos de hosts de VM e regras de afinidade</block>
  <block id="b3c45603f3738ac1e1f8e1e87569c00c" category="section-title">Implementação do VMware Storage DRS com o NetApp MetroCluster</block>
  <block id="4669dbcf4d42583b3fae1c79fa228078" category="paragraph">O controle de e/S de armazenamento é habilitado por padrão nos clusters DRS habilitados para Storage DRS. O controle de e/S de armazenamento permite que um administrador controle a quantidade de e/S de armazenamento que é alocada a máquinas virtuais durante períodos de congestionamento de e/S, o que permite que máquinas virtuais mais importantes tenham preferência sobre máquinas virtuais menos importantes para alocação de recursos de e/S.</block>
  <block id="f06483bf36a941eebbb2f78a89b6bf68" category="paragraph">O Storage DRS usa o Storage vMotion para migrar as máquinas virtuais para diferentes datastores dentro de um cluster de datastore. Em um ambiente NetApp MetroCluster, a migração de uma máquina virtual precisa ser controlada nos datastores desse site. Por exemplo, a máquina virtual A, em execução em um host no local A, deve idealmente migrar dentro dos armazenamentos de dados do SVM no local A. se não o fizer, a máquina virtual continuará operando, mas com desempenho degradado, uma vez que a leitura/gravação do disco virtual será do local B através de links entre sites.</block>
  <block id="62e4eb800d20b46085ccb975da78bafe" category="sidebar">O ONTAP é a base para o gerenciamento e a proteção de dados em muitas tecnologias de banco de dados e aplicações empresariais. As páginas a seguir fornecem orientação sobre as práticas recomendadas e os procedimentos de implementação para aplicativos e infraestrutura empresariais e ONTAP.</block>
  <block id="df7423789cebcf51de121abdae4181c3" category="sidebar">ONTAP e aplicações empresariais</block>
  <block id="bbc2d665b02dc421c5c756db4b973610" category="sidebar">Microsoft Hyper-V</block>
  <block id="672553790d8814b967eb8623e754ea84" category="sidebar">Diretrizes de implantação e práticas recomendadas de storage</block>
  <block id="78898e52fcbdc5337204a384f2456d4f" category="sidebar">Microsoft SQL Server</block>
  <block id="4f60acc41a8bf3fa75e7f74768637787" category="sidebar">Proteção de dados do Microsoft SQL Server</block>
  <block id="7636ae91f443b605f05bed59d7d57a02" category="sidebar">Recuperação de desastres do Microsoft SQL Server</block>
  <block id="b8529ff730dcf8dd2178d72de271dc4d" category="sidebar">Bancos de dados de código aberto</block>
  <block id="bb9a5a6fadabab849d2e87f0898d7601" category="sidebar">MariaDB e MySQL no ONTAP</block>
  <block id="5ad2a11eceac3ebd7cbf3b534ebdb1db" category="sidebar">PostgreSQL no ONTAP</block>
  <block id="c30dd1a85cf86d95b11c1a08f70130ce" category="sidebar">Banco de dados Oracle</block>
  <block id="4948dede9f4e7c3dfe48c38f7902f6e5" category="sidebar">Oracle no ONTAP</block>
  <block id="d71074394b511143c8d1108e74a81abb" category="sidebar">Proteção de dados Oracle</block>
  <block id="90426ba53f908049843b3ea392578d04" category="sidebar">Recuperação de desastres Oracle</block>
  <block id="f4d8825927d11df25770df5e00d6a52e" category="sidebar">Migração Oracle</block>
  <block id="86083f3ea21c2385b4f013aae3c57858" category="sidebar">SAP HANA</block>
  <block id="677f2e7e550075f7bbbdac91e0918f2f" category="sidebar">Soluções SAP</block>
  <block id="1b83f2b1c0b7fb3af048c2a59624fe3b" category="sidebar">SAP HANA com AFF e FC</block>
  <block id="6ab3c3f05076d213f0b1feff267607c6" category="sidebar">SAP HANA com AFF e NFS</block>
  <block id="56079badd056a19303cc26e6a4fcc7e0" category="sidebar">VMware</block>
  <block id="f07084a11252c9bca97503ea9a627c89" category="sidebar">Volumes virtuais (vVols) com ONTAP</block>
  <block id="a9da618400fb93b20c20f5343efaefa7" category="sidebar">Cluster de armazenamento Metro do VMware vSphere com o ONTAP</block>
  <block id="b0dae11b82e63781abdc8f893c41b3c0" category="sidebar">Aplicações empresariais</block>
  <block id="999bc6b18351bbe817d26f559ba408ae" category="sidebar">SAP</block>
  <block id="2d2eef88dbdd0c34bde24e2632d9944f" category="sidebar">SAP HANA e AnyDB</block>
  <block id="e3f530e977d74053c6d70eb84886e756" category="sidebar">Épico</block>
  <block id="faeaec9eda6bc4c8cb6e1a9156a858be" category="sidebar">Disponibilidade</block>
  <block id="4289ad5c614f8037a8810e869b56facd" category="sidebar">Consolidação</block>
  <block id="bc967dc2d57e6eff184a821bf7577a80" category="sidebar">Dimensionamento</block>
  <block id="86a69bd2f501f95ed83bb7014fac7e30" category="sidebar">Snapshots e clonagem</block>
  <block id="58bc025e75c4b3fd1adf3ea672dd4424" category="sidebar">Arquitetura e design épicos</block>
  <block id="92672a7a2b909945fbfa9f44f057c7a1" category="sidebar">Dimensionamento</block>
  <block id="41b36522e1e1020bad35b072e2f4caeb" category="sidebar">Requisitos de storage</block>
  <block id="ddb04c3c1835c48b34dced1c453450e9" category="sidebar">Configuração e práticas recomendadas</block>
  <block id="3e23b54348b2b8424e24a426570dc9f2" category="sidebar">Utilitários do host</block>
  <block id="6e19e43ad6dccde81e8d288a0c9ce380" category="sidebar">Configuração de LUN e volume</block>
  <block id="a2ddb4431dcf2a898d386c1f3b82c926" category="sidebar">Serviços de arquivos</block>
  <block id="9985b4390c40137573e6da05caf85874" category="sidebar">Protocolos</block>
  <block id="894445e8ea6df545bfbc4247797a2162" category="sidebar">Dimensionamento do storage</block>
  <block id="c5865855c43d734069987786177edd98" category="sidebar">Hyper-V</block>
  <block id="230dea8fdf5e53eb32282fb3f8d4d9f6" category="sidebar">Diretrizes de implantação e práticas recomendadas de storage</block>
  <block id="60aa20a9330bfedece833eb6496e61dc" category="sidebar">Implante o Nano Server</block>
  <block id="0726f4e9c3c98564af638f1b4cd17a9e" category="sidebar">Implantar a migração do Hyper-V Live fora de um ambiente em cluster</block>
  <block id="1bbd09497cd931a02f8dc0ee3cfcf19d" category="sidebar">Implantar a réplica do Hyper-V fora de um ambiente em cluster</block>
  <block id="832a116d7f9184d8880a539553a0cb52" category="sidebar">Implantar a réplica do Hyper-V em um ambiente em cluster</block>
  <block id="249fd7d68098688fab42436eed51be7d" category="sidebar">Configuração do banco de dados</block>
  <block id="3423582eed75b4bd6632c18238fd78e4" category="sidebar">Configuração de banco de dados para Microsoft SQL Server</block>
  <block id="77641f4a3e4406855e878235cbd89b87" category="sidebar">Configuração CPU</block>
  <block id="d5363ae19ecaede49e2ced297df7737a" category="sidebar">Configuração da memória</block>
  <block id="7d219314ccabde6609510141bb175a6c" category="sidebar">Instância compartilhada versus instância dedicada</block>
  <block id="a42cf9beb4788dddb7d317e05cc08e23" category="sidebar">Arquivos de banco de dados e grupos de arquivos</block>
  <block id="31a8d85b6a44cffc2c7dfc6387696f31" category="sidebar">Diretório de log</block>
  <block id="500c09aa1bb9af431f2c18348e69bfd0" category="sidebar">Arquivos tempdb</block>
  <block id="051c025eb3cc7303bf3116bffdb7e95d" category="sidebar">Arquitetura da MetroCluster</block>
  <block id="a1930436e8ea74adaf54ff76d868829b" category="sidebar">SQL Server com MetroCluster</block>
  <block id="33673f825b847c6610f7c7115da0bbde" category="sidebar">Site preferido</block>
  <block id="57848b20be1bd330229089d2e136d982" category="sidebar">Topologia de rede</block>
  <block id="3a1c15502275494d5a57fe7f225fa951" category="sidebar">SQL Server com SM-as</block>
  <block id="5ba8ee2f32815884475d1f2244ba16a6" category="sidebar">Cenários de falha</block>
  <block id="4c5d94eb4dc4bff93f6a96a08ab7b244" category="sidebar">Segurança dos dados</block>
  <block id="62a004b95946bb97541afa471dcca73a" category="sidebar">MySQL</block>
  <block id="ea9cdfcbfcf1906c15b6779f0f327028" category="sidebar">Configuração de banco de dados para MySQL</block>
  <block id="5713a921d815fd7d19875846450f8ea8" category="sidebar">Estrutura de ficheiros</block>
  <block id="13d80777c8fd43e555c1f5b1b72d7ef0" category="sidebar">Configuração de host</block>
  <block id="308f8f580d0248ac023557cfd4b10d83" category="sidebar">Configuração de host para MySQL</block>
  <block id="7f1a6761f7160e33a32105202e47303b" category="sidebar">Conteinerização</block>
  <block id="5ecd4a6f4aedfdd45cce80a18b1a7942" category="sidebar">Mesas de slot</block>
  <block id="dac8ea4fbfd87a535663c227b91f50e3" category="sidebar">Agendadores de e/S.</block>
  <block id="a6a9695e1464f5554c0006c55facfadf" category="sidebar">Descritores de arquivo</block>
  <block id="830f353b3e6055499fac447b16b0c935" category="sidebar">Configuração de armazenamento para MySQL</block>
  <block id="0353522b39b87d54d40d3f09ec668851" category="sidebar">Configuração ONTAP</block>
  <block id="cf91513c6fc63cebe4b63a6647238d6d" category="sidebar">RAID</block>
  <block id="83db97189c47f7bb4edd879e8756f6e6" category="sidebar">Limites de capacidade</block>
  <block id="af81930661b267e8f1e68c4d66e9ee56" category="sidebar">Failover e switchover</block>
  <block id="5a4517368fb2ab5498fc2108c2ea64c5" category="sidebar">Configuração de banco de dados para Oracle Database</block>
  <block id="dfd1f50170457b961c15bb13ad7e3bed" category="sidebar">Arquivos de dados e refazer tamanhos de blocos</block>
  <block id="d3cc759510a3aba837fc8efeb2e24b91" category="sidebar">db_file_multiblock_read_count</block>
  <block id="49f83bf3a15b8626eb91fde93c6b1788" category="sidebar">Oracle RAC</block>
  <block id="e483c0ecf3a2b1a60f886d4a5ac553ff" category="sidebar">Configuração de host para Oracle Database</block>
  <block id="7e6bb0931a72759d39514aa924b420bc" category="sidebar">AIX</block>
  <block id="b1fd823d262032e04291313f72be9452" category="sidebar">HP-UX</block>
  <block id="edc9f0a5a5d57797bf68e37364743831" category="sidebar">Linux</block>
  <block id="6bb83af717367dd4a47f75801ae7a2b0" category="sidebar">Linux com ASMlib e AFD</block>
  <block id="bb79f96acbff544ded541446c9c7c894" category="sidebar">Microsoft Windows</block>
  <block id="eaf36c98b91893b7f79bd5184a23d377" category="sidebar">Solaris</block>
  <block id="06b078afa802a679ad4694d13a8a2495" category="sidebar">Configuração de rede para Oracle Database</block>
  <block id="619615da0f93507e22a6054ef2aea4f1" category="sidebar">Interfaces lógicas</block>
  <block id="aca8e861c6f30fe2d42d0310a387312b" category="sidebar">Configuração Ethernet</block>
  <block id="63a5b8bd41978e8124f9ccdfa9063e9e" category="sidebar">Configuração de FC SAN</block>
  <block id="97db606ac6781989ea3b189d7be28bf2" category="sidebar">Rede de conexão direta</block>
  <block id="f1991b28c5d48cb53798755acf9dfe62" category="sidebar">Configuração de armazenamento para Oracle Database</block>
  <block id="d84b41126744795c4ee82f7b256e7234" category="sidebar">FC SAN</block>
  <block id="8858bb6564a2efc189c9183c495ce545" category="sidebar">Alinhamento LUN</block>
  <block id="02bc4ad8a694d41c8b598dfbcb12f069" category="sidebar">Contagem de LUN e tamanho LUN</block>
  <block id="05a1ffdb277b8c7ac1dca78adae0017e" category="sidebar">Colocação de LUN</block>
  <block id="066f208a93617bd82090d42624ce63cc" category="sidebar">Redimensionamento LUN</block>
  <block id="9eeba6fd02cf3b6d8aee35e0ce9bf8fe" category="sidebar">LVM striping (distribuição LVM)</block>
  <block id="254f642527b45bc260048e30704edb39" category="sidebar">Configuração</block>
  <block id="f3a78e25ce9f95fc3c61ccc39f32fb4d" category="sidebar">Oracle Direct NFS (DNFS)</block>
  <block id="989cefa74de0e10a575103f446258d99" category="sidebar">Locações e bloqueios de NFS</block>
  <block id="0d695ec265a3b0b5e7e32e33ffe4ed22" category="sidebar">Armazenamento em cache NFS</block>
  <block id="8e86e0aee135afb67c6a1d3d6e0f3306" category="sidebar">Tamanhos de transferência NFS</block>
  <block id="60e002164f8988e984cf4a95b240f19d" category="sidebar">Oracle e NVFAIL</block>
  <block id="eb4d10d6eda7c9266cd36c4eb0a223cf" category="sidebar">Utilitário de gravação ASM</block>
  <block id="ea4c55be196897a16d86999f5c16d582" category="sidebar">Virtualização</block>
  <block id="337c62c6b6eb7319bae58701105e889c" category="sidebar">Disposição em camadas</block>
  <block id="297e2ac2ec0bd88ad598062f4c07ee45" category="sidebar">Políticas de disposição em camadas</block>
  <block id="9af6f452cd88c83f2bde555de8f93690" category="sidebar">Enviando dados para um armazenamento de objetos</block>
  <block id="08af6d4e6b562e2d0b418d7198f5a0f7" category="sidebar">Recuperando dados do armazenamento de objetos</block>
  <block id="02d01636975b3ae0c0ab22368cea8d54" category="sidebar">Estratégias de disposição em camadas</block>
  <block id="7fbd108e1fc6910c941094e95a677878" category="sidebar">Arquivos inteiros</block>
  <block id="eb43c2427eb06b9f561363863b4a4f0b" category="sidebar">Ficheiros parciais</block>
  <block id="1afe200fa26ba361f59b603b22ad6392" category="sidebar">Selecione ficheiros</block>
  <block id="9147e5e61a7b9260dec09f3a6eb3e5be" category="sidebar">Instantâneos</block>
  <block id="cc4e17c26faf6b70b383529b6215ba0f" category="sidebar">Interrupções de acesso ao armazenamento de objetos</block>
  <block id="183bdb28f19bee640319f68825827aea" category="sidebar">RPO, rto e SLAs</block>
  <block id="448d15345bb99c834095da225c529b8a" category="sidebar">Disponibilidade de dados</block>
  <block id="5869e10a9dea6d88d61bb10040557f35" category="sidebar">Integridade de dados</block>
  <block id="2172b5d51273924b537842b0db78bfd4" category="sidebar">Noções básicas de backup e recuperação</block>
  <block id="82ef718f4ebe0c276814ee3d51e33361" category="sidebar">SnapRestore</block>
  <block id="7b68149402c05a52968bda6af0435c8a" category="sidebar">Backups online baseados em snapshot</block>
  <block id="49ba0ee205d016d8236db9c1e8c130e5" category="sidebar">Backups otimizados para Storage Snapshot</block>
  <block id="9173402b63dc5f55506a692258f185e8" category="sidebar">SnapCenter e outras ferramentas</block>
  <block id="2c6d98297c340e390e0783220b038545" category="sidebar">Arquitetura física</block>
  <block id="13a854bdd11f8f57a0b25c00631f1430" category="sidebar">Arquitetura lógica</block>
  <block id="2623b589ddbc1cdb6184ba32aa06e83f" category="sidebar">NVFAIL</block>
  <block id="4abda684ecc952239d7800547dcf2995" category="sidebar">Oracle si no MetroCluster</block>
  <block id="4278792a47efb1e599476fe07109dca4" category="sidebar">Oracle RAC no MetroCluster</block>
  <block id="e30da740afd1eb5c7fc5ade391ee694d" category="sidebar">Configurações Oracle</block>
  <block id="3d9396f3fc3010d09439c0c007a897aa" category="sidebar">Instância única Oracle</block>
  <block id="87e1ed5a71c4eb8ff653400f9dd917a0" category="sidebar">Oracle RAC e tiebreakers</block>
  <block id="4a1483b5d5deb83e67e3184b05202d31" category="sidebar">Arquitetura de amostra</block>
  <block id="8b7786259860e64596ef2df3349d25e1" category="sidebar">Falha na interconexão RAC</block>
  <block id="d65b736af70982866f4f95287faab7ac" category="sidebar">Falha de comunicação do SnapMirror</block>
  <block id="9b7da52d3b31b3d0a034473609a069e5" category="sidebar">Falha total da interconexão de rede</block>
  <block id="1163a74136e40a05bc320e61f567a4df" category="sidebar">Falha do local</block>
  <block id="29a8ec19326654cdf89bb8516725720a" category="sidebar">Falha do mediador</block>
  <block id="38ea1deaf691187fc38ab915566310c5" category="sidebar">Restauração de serviço após falha</block>
  <block id="9132b772b1437e64c8acac2be79a7a0f" category="sidebar">Failovers manuais</block>
  <block id="e31593850dc03f8f10d036df5dc8633b" category="sidebar">Migração de banco de dados Oracle</block>
  <block id="5102abd5a9cc202678054b832caf678d" category="sidebar">Procedimentos</block>
  <block id="727bb4db430517995ca651c4f57b0c9f" category="sidebar">Mover ficheiro de dados</block>
  <block id="1495d3ed3ebff783c0f480b583372450" category="sidebar">Cópia de dados do host</block>
  <block id="d81ca5686c955ed50927409eb8c14bb0" category="sidebar">Importação LUN estrangeiro</block>
  <block id="2fea59b7e470acac5ec1589d504da14e" category="sidebar">Conclusão</block>
  <block id="e9cc85ef98d982c3c3e53d6b82293126" category="sidebar">Conversão de protocolo</block>
  <block id="fc53c036602508ed6c2afc18e2fbdf51" category="sidebar">Exemplos de scripts</block>
  <block id="fbbd0e8905df3950eca4d1d8f55881ad" category="sidebar">Notas adicionais</block>
  <block id="ac0465a970688dc3c326dcdd8fe2805e" category="sidebar">Otimização de desempenho e benchmarking</block>
  <block id="7cb9c3cd8b9873d39a1fe87c083cd55c" category="sidebar">Bloqueios de NFS obsoletos</block>
  <block id="399bd1ee587245ecac6f39beaa99886f" category="sidebar">PostgreSQL</block>
  <block id="394ad91b4701dbd32675896bed204755" category="sidebar">Configuração de host para PostgreSQL</block>
  <block id="61bcd96a2c1f8026527cbf2019d6e9a4" category="sidebar">Inicialização</block>
  <block id="f4f70727dc34561dfde1a3c529b6205c" category="sidebar">Definições</block>
  <block id="16a49d0bc0249ef3dd42949589a0ed4e" category="sidebar">Tablespaces</block>
  <block id="9852487272d9b2aa9026d0fddc0616fc" category="sidebar">Configuração de armazenamento para PostgreSQL</block>
  <block id="bc237072428e0e4c415160b898946d4c" category="sidebar">Proteção de dados para PostgreSQL</block>
  <block id="2d3298c651b356a82db5d664ce68e65e" category="sidebar">Proteção de dados nativos</block>
  <block id="0a7b1215fd0b9621d4d7300f88b2906c" category="sidebar">Software de proteção de dados</block>
  <block id="c0916addb4f26afa58c5a6df4f463fa5" category="sidebar">Storage unificado</block>
  <block id="c0032c6bab44eeeb6886c7a4aa67cf77" category="sidebar">Ferramentas de virtualização</block>
  <block id="1c77ac70000b6804e930748d5df7be5e" category="sidebar">Gerenciamento baseado em políticas de storage e volume virtual</block>
  <block id="217601d383b816e6a2548e57b5006f92" category="sidebar">Clonagem</block>
  <block id="8f2db90dd4a6fbd95ba8f0bc54fd6b27" category="sidebar">QoS</block>
  <block id="09b4a81ec7b05cbacc7cbfa13e006254" category="sidebar">Gerenciamento baseado em política de storage</block>
  <block id="2e8526cbe762cb1b8393d935a3b0bf16" category="sidebar">Definições recomendadas</block>
  <block id="10a764f91b59ce3c8931d55c2fd54222" category="sidebar">Implantação de storage vVols</block>
  <block id="8737a5d2bc43b0eb76ab5674d0fcb094" category="sidebar">Visão geral do SRM com ONTAP</block>
  <block id="76f6daa4bfab6ca8a7350e46d3d6718f" category="sidebar">Informações adicionais para o SRM</block>
  <block id="cc0f7f705e4495c607aea288505e31bf" category="sidebar">Visão geral do vMSC</block>
  <block id="de9a829f775bc333b77fdacbc333f7a1" category="sidebar">Solução vSphere HA</block>
  <block id="70b29c8dabeb7a16884003c35e163f96" category="sidebar">Projeto vMSC</block>
  <block id="6c4755219197ce467bf892a552c8663a" category="sidebar">Resiliência do vMSC</block>
  <block id="13376e3e9b02a56731aa64aeb10947b2" category="sidebar">Cenários vMSC com MCC</block>
  <block id="30f6724a02fc69093960468c0a2fbcd4" category="sidebar">Segurança do produto</block>
  <block id="3390e3575b3e341afa2b7172ff5b33a7" category="sidebar">Plug-in do SnapCenter para VMware vSphere</block>
  <block id="7fb0cadcdae6feac05c7b8274b97b3c7" category="sidebar">Visão geral do endurecimento das ferramentas do ONTAP</block>
  <block id="10b486896b1a91f5d38214dfb30c4263" category="sidebar">Verificando a integridade das ferramentas do ONTAP instalam pacotes</block>
  <block id="919e26ea009ce7fa2dcc499a27ccc6aa" category="sidebar">Pontos de acesso (usuários)</block>
  <block id="333dd505db0523536c6885f47456518c" category="sidebar">TLS mútuo</block>
  <block id="6a3f3799bc264d32568bb7169ddd515a" category="sidebar">Certificado HTTPS</block>
  <block id="bfdb89134acf30ff5da790924cefa0ac" category="sidebar">Tempo limite de inatividade</block>
  <block id="cb197b06aa92a742d01e256d58d3e34b" category="sidebar">Ataque DOS</block>
  <block id="d870a4bd29f74339732a958574d2c4eb" category="sidebar">Configuração NTP</block>
  <block id="d60999416cfb11e4fa51f3dbe7386d64" category="paragraph">O SM-as e o MetroCluster são semelhantes na funcionalidade geral, mas há diferenças importantes na maneira como a replicação RPO-0 foi implementada e como ela é gerenciada. O SnapMirror assíncrono e síncrono também pode ser usado como parte de um plano de recuperação de desastres, mas não foram desenvolvidos como tecnologias de repliação de HA.</block>
  <block id="e122442a5a5728cd45ffc4ddd170a36f" category="list-text">Uma configuração do MetroCluster é mais como um cluster integrado com nós distribuídos entre locais. O SM-as se comporta como dois clusters independentes que estão cooperando no fornecimento de LUNs replicados de forma síncrona RPO igual a 0.</block>
  <block id="dbbbd9519f58f000ae618fd3a3f2f38c" category="list-text">Os dados em uma configuração do MetroCluster só podem ser acessados de um determinado site a qualquer momento. Uma segunda cópia dos dados está presente no site oposto, mas os dados são passivos. Ele não pode ser acessado sem um failover do sistema de storage.</block>
  <block id="72d2ba33caf4a678d0b02c7a4a562662" category="list-text">O espelhamento de desempenho MetroCluster e SM-as ocorre em níveis diferentes. O espelhamento MetroCluster é executado na camada RAID. Os dados de baixo nível são armazenados em um formato espelhado usando SyncMirror. O uso do espelhamento é praticamente invisível nas camadas de LUN, volume e protocolo.</block>
  <block id="33613d29368b0b312d33bd204505f12b" category="list-text">Em contraste, o espelhamento SM-as ocorre na camada de protocolo. Os dois clusters são, no geral, clusters independentes. Depois que as duas cópias dos dados estiverem sincronizadas, os dois clusters só precisam espelhar gravações. Quando ocorre uma gravação em um cluster, ela é replicada para o outro cluster. A gravação só é reconhecida para o host quando a gravação for concluída em ambos os sites. Além desse comportamento de divisão de protocolo, os dois clusters são, de outra forma, clusters ONTAP normais.</block>
  <block id="c6ce2d48c3feb0ac105233b1d47d6785" category="list-text">A função principal do MetroCluster é a replicação em grande escala. É possível replicar um array inteiro com RPO igual a 0 e rto quase zero. Isso simplifica o processo de failover porque há apenas uma "coisa" a fazer failover e é dimensionado extremamente bem em termos de capacidade e IOPS.</block>
  <block id="22c8f7d4250a7117dcec5e795cf01979" category="list-text">Um dos principais casos de uso para SM-as é a replicação granular. Às vezes, você não quer replicar todos os dados como uma única unidade ou precisa ser capaz de falhar seletivamente em determinados workloads.</block>
  <block id="466f5e6d5af96a45aba533d742d1f30e" category="list-text">Outro importante caso de uso para SM-as é para operações ativas-ativas, em que você deseja que cópias totalmente utilizáveis de dados estejam disponíveis em dois clusters diferentes localizados em dois locais diferentes com características de desempenho idênticas e, se desejado, não é necessário estender a SAN entre locais. Você pode ter suas aplicações já em execução em ambos os locais, o que reduz o rto geral durante operações de failover.</block>
  <block id="3ab2196c18fe1cd72bf252059597387b" category="section-title">Sincronização ativa do NetApp MetroCluster e do SnapMirror</block>
  <block id="95da439be4f858e05c58cde4b5946324" category="paragraph">Para muitos clientes, a recuperação de desastres requer mais do que apenas a posse de uma cópia remota de dados. Para isso, ela exige a capacidade de usar esses dados rapidamente. A NetApp oferece duas tecnologias que atendem a essa necessidade: MetroCluster e SnapMirror ative Sync</block>
  <block id="3e6b18011054436086bb6cf813b0cb23" category="section-title">Comparação de SM-as e MCC</block>
  <block id="4ab72a69aa303ab33d610a6f6e594e68" category="section-title">Somas de verificação</block>
  <block id="0a4a3e3ef29b5fc4ea4e557f166532b4" category="paragraph">A sincronização ativa do SnapMirror (SM-as) é baseada no SnapMirror síncrono. Com o MetroCluster, cada controlador ONTAP é responsável por replicar os dados da unidade para um local remoto. Com o SnapMirror active Sync, você tem essencialmente dois sistemas ONTAP diferentes que mantêm cópias independentes dos seus dados LUN, mas cooperam para apresentar uma única instância desse LUN. Do ponto de vista do host, é uma única entidade LUN.</block>
  <block id="2f589372957b08ce09879b8a2ab6e58c" category="section-title">Ativar DNFS</block>
  <block id="1a89d30b5bb0e2de334e029001a92f8a" category="paragraph">O Oracle DNFS pode trabalhar com o NFSv3 sem necessidade de configuração além de ativar a biblioteca DNFS (consulte a documentação Oracle para o comando específico necessário), mas se o DNFS não conseguir estabelecer conetividade, ele pode reverter silenciosamente para o cliente NFS do kernel. Se isso acontecer, o desempenho pode ser gravemente afetado.</block>
  <block id="9cb0e5a02b9facf3c0e654f08ceceda4" category="paragraph">Se você deseja usar a multiplexação DNFS em várias interfaces, com NFSv4.X, ou usar criptografia, você deve configurar um arquivo oranfstab. A sintaxe é extremamente rigorosa. Pequenos erros no arquivo podem resultar em suspensão de inicialização ou ignorar o arquivo oranfstab.</block>
  <block id="3c04631b254b4b0e971a2c82517f50cb" category="paragraph">A única maneira de ter certeza de que o DNFS está operando como esperado é consultar as tabelas dnfs.</block>
  <block id="21986e459426718105f7dc1a16e88bd0" category="paragraph">Abaixo está um exemplo de arquivo oranfstab localizado em /etc. Este é um dos vários locais que um arquivo oranfstab pode ser colocado.</block>
  <block id="1d4338d2de6e933a6941c8605def3a39" category="paragraph">O primeiro passo é verificar se o DNFS está operacional para os sistemas de arquivos especificados:</block>
  <block id="75bc8bd82bedf61e91351f8667b97e13" category="paragraph">Essa saída indica que o DNFS está em uso com esses dois sistemas de arquivos, mas ele não significa que o oranfstab esteja operacional. Se um erro estivesse presente, o DNFS teria descoberto automaticamente os sistemas de arquivos NFS do host e você ainda poderá ver a mesma saída deste comando.</block>
  <block id="f4327e73856b2069e10b045605d3fbe9" category="paragraph">Multipathing pode ser verificado da seguinte forma:</block>
  <block id="99dc2d8bc11eb27fb0b920ca969e43e1" category="paragraph">Estas são as conexões que o DNFS está usando. Dois caminhos e canais são visíveis para cada entrada SVRNAME. Isso significa que o multipathing está funcionando, o que significa que o arquivo oranfstab foi reconhecido e processado.</block>
  <block id="d99de907aa06fa04c7b19ffceff68307" category="admonition">As seções a seguir são atuais a partir do ONTAP 9.15,1, mas o comportamento de leasing e bloqueio, bem como as opções de ajuste podem mudar de versão para versão. Se você precisar ajustar os tempos de leasing/bloqueio NFSv4, consulte o suporte da NetApp para obter as informações mais recentes.</block>
  <block id="4bf95f1ea9ecf4f42a7b323970405bb4" category="paragraph">Esse período de carência controla a recuperação de leasing durante alterações na interface de rede, mas há um segundo período de carência que controla a recuperação durante o failover de storage,<block ref="d75aeb1a8759ea7475fe0ddcd2058ca1" prefix=" " category="inline-code"></block>. Esta é uma opção de nível de nó.</block>
  <block id="0ba7c8a7759adb519c715ac93fdee2a6" category="paragraph">Por exemplo, se você precisasse frequentemente executar failovers de LIF e precisasse reduzir o período de carência, você mudaria<block ref="b1280b7c6d986647dff33b87ce276327" prefix=" " category="inline-code"></block>. Se você quisesse melhorar o tempo de retomada de e/S durante o failover da controladora, seria necessário alterar<block ref="d75aeb1a8759ea7475fe0ddcd2058ca1" prefix=" " category="inline-code"></block>o .</block>
  <block id="3f3edac1c3ed7bfad53f9d42b9a0c5a7" category="paragraph">Apenas altere estes valores com cautela e depois de compreender completamente os riscos e consequências. As pausas de e/S envolvidas com operações de failover e migração com o NFSv4.X não podem ser totalmente evitadas. Os períodos de bloqueio, leasing e carência fazem parte da RFC do NFS. Para muitos clientes, o NFSv3 é preferível porque os tempos de failover são mais rápidos.</block>
  <block id="167503c08e9285f5c4a4a61a0123897b" category="paragraph">O período de carência e o período de leasing estão ligados. Como mencionado acima, o tempo limite de leasing padrão é de 30 segundos, o que significa que NFSv4 clientes devem fazer check-in com o servidor pelo menos a cada 30 segundos ou perder seus arrendamentos e, por sua vez, seus bloqueios. O período de carência existe para permitir que um servidor NFS reconstrua dados de concessão/bloqueio e o padrão é de 45 segundos. O período de carência deve ser superior ao período de locação. Isso garante que um ambiente cliente NFS projetado para renovar contratos de arrendamento pelo menos a cada 30 segundos terá a capacidade de fazer check-in com o servidor após uma reinicialização. Um período de carência de 45 segundos garante que todos os clientes que esperam renovar seus arrendamentos pelo menos a cada 30 segundos definitivamente tenham a oportunidade de fazê-lo.</block>
  <block id="6be050126f2df5ae7cd944ce446241c2" category="paragraph">Se um tempo limite de 30 segundos não for aceitável, você pode optar por estender o período de locação.</block>
  <block id="38d530634a8d32e8775a37109fc08542" category="paragraph">Se você quiser aumentar o tempo limite de leasing para 60 segundos para suportar uma interrupção de rede de 60 segundos, você também terá que aumentar o período de carência. Isso significa que você terá pausas de e/S mais longas durante o failover de controladora.</block>
  <block id="ac76821692fdb2dae1d98babe804fb8f" category="paragraph">Isso normalmente não deve ser um problema. Os usuários típicos atualizam somente as controladoras ONTAP uma ou duas vezes por ano, e o failover não planejado devido a falhas de hardware é extremamente raro. Além disso, se você tivesse uma rede em que uma interrupção de rede de 60 segundos era uma possibilidade preocupante, e você precisasse do tempo limite da concessão para 60 segundos, provavelmente você não obteria o failover raro do sistema de storage, resultando em uma pausa de 61 segundos também. Você já reconheceu que tem uma rede que está pausando por mais de 60 segundos com bastante frequência.</block>
  <block id="3a80e1e29c96d0837b12aef65785a41a" category="doc">Parâmetros de configuração</block>
  <block id="4bb9f72180425717a416a5037a100cca" category="searchtitle">Estrutura de arquivos MySQL e InnoDB</block>
  <block id="9a41c04f55c43c1bfac6d1e3fb0992de" category="doc">NFSv3 mesas de slot</block>
  <block id="dce12836eeccf070f53590dc5d86633d" category="doc">Tamanhos de blocos</block>
  <block id="b4aa7c0127688b4c623685cfeed4ab97" category="searchtitle">Os clusters de aplicações do Oracle Real são cronometrados</block>
  <block id="6fae8d228f324e0e0a9c817b746b9bd0" category="doc">Tempos limite do RAC</block>
  <block id="b64e3a0dc81f710f886a442e1a397bb9" category="doc">Ferramentas de gerenciamento e automação de banco de dados</block>
  <block id="87921e5ee2cf87589874871f0d361694" category="doc">Disponibilidade do banco de dados</block>
  <block id="accd3900cbd3e4d55a38c8518052015c" category="doc">Somas de verificação e integridade de dados</block>
  <block id="5611150a7a2a706d09d267b466f083d6" category="paragraph">Com um storage array real, a integridade de dados é protegida pelo uso de somas de verificação em vários níveis. Se os dados estiverem corrompidos em uma rede baseada em IP, a camada TCP (Transmission Control Protocol) rejeita os dados do pacote e solicita a retransmissão. O protocolo FC inclui somas de verificação, assim como os dados SCSI encapsulados. Depois que ele está no array, o ONTAP tem proteção RAID e checksum. A corrupção pode ocorrer, mas, como na maioria dos arrays corporativos, ela é detetada e corrigida. Normalmente, uma unidade inteira falha, solicitando uma reconstrução RAID e a integridade do banco de dados não é afetada. Ainda é possível que bytes individuais em uma unidade sejam danificados por radiação cósmica ou células flash com falha. Se isso acontecer, a verificação de paridade falharia, a unidade falharia e uma reconstrução RAID começaria. Mais uma vez, a integridade dos dados não é afetada. A linha final de defesa é o uso de somas de verificação. Se, por exemplo, um erro de firmware catastrófico em uma unidade corrompeu dados de uma forma que de alguma forma não fosse detetado por uma verificação de paridade RAID, a soma de verificação não corresponderia e o ONTAP impediria a transferência de um bloco corrompido antes que o banco de dados Oracle pudesse recebê-lo.</block>
  <block id="cd985f59320d95026288fa5ff6dcf58a" category="doc">Backups online</block>
  <block id="9c030078e0f444e80ad1c24e215220a4" category="doc">Proteção de dados com o ONTAP</block>
  <block id="6bb9a5aec98309d1414b32f7e0751415" category="doc">Planejamento de proteção de dados</block>
  <block id="06db8225d3ec2b43755ddc9358302450" category="doc">Planejamento de rto, RPO e SLA</block>
  <block id="5d827e5d4c92779310224878dc408813" category="summary">DR de banco de dados Oracle com MetroCluster</block>
  <block id="f0b223afb696335287bc2ed9501b5b33" category="doc">Recuperação de desastres com o MetroCluster</block>
  <block id="67be2475945283126e261087dcc833b7" category="doc">MetroCluster e NVFAIL</block>
  <block id="13262509535baae73d0cc7ab06de1fc6" category="searchtitle">Oracle Extended RAC no MetroCluster</block>
  <block id="7993038617c805a663d50702c4494b68" category="doc">Oracle Extended RAC</block>
  <block id="75b233b87417347976ef489e09961c77" category="doc">Instância única Oracle</block>
  <block id="aa51324dbf5137dc80d29f127e7265f1" category="doc">Instância única Oracle</block>
  <block id="254742fbeffe659f98f802792b541c45" category="doc">Desempate do RAC</block>
  <block id="aeee9c92b22d6f18b8670c9f330ea7c9" category="doc">Falha total de interconetividade de rede</block>
  <block id="0ef819e6ae8a74f9c8ac0158a24b1627" category="doc">Restauração do serviço</block>
  <block id="8367f9ef79397d7d8f1367cb4392c602" category="summary">Sincronização ativa Oracle e SnapMirror - falha no local</block>
  <block id="5c8784e46ac32f6b1c9b78f954c1a473" category="summary">Sincronização ativa do SnapMirror - Falha de comunicação do SnapMirror</block>
  <block id="7ed82538ab967cd6e2949aa971158dc9" category="searchtitle">Oracle, SnapMirror ative Sync e o Mediador ONTAP</block>
  <block id="db2170f38b52c13c31e0572c709b6f8a" category="searchtitle">Visão geral da sincronização ativa do Oracle e do SnapMirror</block>
  <block id="e9a673980d8df30ed4173e4b7c4ecd2c" category="searchtitle">Site preferencial de sincronização ativa Oracle e SnapMirror</block>
  <block id="45d97b0c2ca342ad882153a1245f9897" category="doc">Site preferido para sincronização ativa do SnapMirror</block>
  <block id="0bb4536e921f4d96dd701c1afe746457" category="doc">ASMLib/AFD (controlador de filtro ASM)</block>
  <block id="3ee9e6a595247d1965be0d0c6cd0f22e" category="doc">Migração de arquivos de dados</block>
  <block id="a9761df551af398a0fc2974288502d8a" category="doc">Cópia de dados do host</block>
  <block id="d437e7d8b6513f91bbd58e0b1e08c90b" category="doc">Planejamento de migração</block>
  <block id="4c7e0d612a5f0e09f272083633991979" category="doc">Configuração TCP/IP e ethernet</block>
  <block id="9f2dc5f476d250d879dc58a583f93fd1" category="searchtitle">Configuração FC SAN para bancos de dados Oracle</block>
  <block id="08f606415b4ad7fb864651eac04fcd8e" category="searchtitle">Otimização e benchmarking de desempenho de banco de dados Oracle</block>
  <block id="b30e3ef968d39d109aea4a92750c9792" category="doc">Stale NFSv3 fechaduras</block>
  <block id="1d19e21de0f93b11f5ceb8b535a3afc2" category="doc">Gerenciamento de capacidade</block>
  <block id="8d409dbefa8e76403d7adf4cbd315d3d" category="doc">Failover/switchover da ONTAP</block>
  <block id="0f03a4e25b68a1a67d3be8f0d989ef8b" category="doc">Gerenciamento de desempenho com QoS ONTAP</block>
  <block id="555472a0fed2f80e0848845e538a08af" category="doc">Oracle Direct NFS (DNFS)</block>
  <block id="92d0288d9e0c6ed5ffd8dcd2e0900101" category="paragraph">No momento da escrita, o multipathing DNFS não funciona com o NFSv4,1 com versões recentes do Oracle Database. Um arquivo oranfstab que especifica NFSv4,1 como um protocolo só pode usar uma instrução de caminho único para uma determinada exportação. O motivo é que o ONTAP não oferece suporte ao entroncamento ClientID. Patches do banco de dados Oracle para resolver essa limitação podem estar disponíveis no futuro.</block>
  <block id="3fdf18c0210b51691df97c8be74021a3" category="doc">Utilitário de reclinação ASMRU (ASMRU)</block>
  <block id="d63f66214ae30c5b9b10653f1e503492" category="doc">Alinhamento LUN</block>
  <block id="38baeef7dc11ad9438aa5b211745d9f6" category="searchtitle">Redimensionamento de LUN de banco de dados Oracle e redimensionamento LVM</block>
  <block id="f447f8c9180e11bc4219ace93e7431fb" category="doc">Redimensionamento LUN e redimensionamento LVM</block>
  <block id="c8d869d733bd5299001f9d90b9f00d90" category="doc">Dimensionamento de LUN e contagem de LUN</block>
  <block id="4ee97146242ed12473141d7ecad00ee1" category="doc">Disposição em camadas do backup</block>
  <block id="e7cba09a05ca3e6ccdd30a1aa0a7d3af" category="doc">Disposição em camadas do log de arquivamento</block>
  <block id="c1affdf2bd2e606557f2bf12c69af8f8" category="doc">Disposição em camadas de arquivos parcial</block>
  <block id="3bf6f5a455b1889775d79713ad4e19ed" category="doc">Políticas de recuperação</block>
  <block id="636d94f9e0fb52c5d7560661b059b203" category="doc">Disposição do Snapshot em camadas</block>
  <block id="bf5f70c9080724ef27b09203705b1abc" category="doc">Disposição completa de arquivos em categorias</block>
  <block id="acf5662e9defb6f8df644e0d8b4caa28" category="doc">Parâmetros de inicialização</block>
  <block id="03095e209912bbf8e40f883c88befe49" category="searchtitle">Proteção de dados nativa do PostgreSQL</block>
  <block id="300e5ea4a0c7d02b8a4efeba5a1f6faf" category="doc">Proteção Ddta nativa</block>
  <block id="1c3ee6977dcad0709502549dd7b111f3" category="sidebar">Oracle DR com MetroCluster</block>
  <block id="662637dadb14be675de52ed993629bcd" category="paragraph">Para a consideração da profundidade da fila do SO do servidor, use um mínimo de oito LUNs (um LUN por volume) para um banco de dados. Aumente o número de LUNs pelo número de nós no cluster do ONTAP. Por exemplo, adicione 4 LUNs ao usar um cluster de 4 nós (2 par de HA). Para ambientes maiores, mais LUNs podem ser necessários; use o mesmo número de volumes (oito no total, distribuídos entre nós de storage) e adicione LUNs em várias de dois nós e volumes do cluster. Com essa abordagem, você escala facilmente seu ambiente Epic.</block>
  <block id="f73f987e4ea887ccfd1bf297bad46e22" category="paragraph">*Exemplo 1: Cluster ONTAP de 2 nós*</block>
  <block id="f08ea6531fe21723a28ec9f89ea3e451" category="paragraph">2 nós, 1 pares de HA, 8 volumes, 4 volumes por nó 8 LUNs, um LUN por volume adicionando 2 LUNs adicionais, um em node01 em volume01, um em Node02 em volume02.</block>
  <block id="fd52d4fb0b6e3cfb46cae3e012d26c20" category="paragraph">*Exemplo 2: Cluster ONTAP de 4 nós*</block>
  <block id="489d5412107ca7c901de568b7c7dcce3" category="paragraph">4 nós, 2 pares de HA, 8 volumes, 2 volumes por nó 8 LUNs, um LUN por volume adicionando 4 LUNs adicionais, um em node01 em volume01, um em Node02 em volume02, um em node03 em volume03 e um em node04 em volume04.</block>
  <block id="2feec0f4e37d9566d4cf292116430adb" category="paragraph">Se o servidor exigir mais armazenamento, a opção mais fácil é aumentar os LUNs que contêm volumes. A segunda opção é adicionar LUNs aos grupos de volume em múltiplos de dois de cada vez (um por volume por nó).</block>
  <block id="c338b7a4eb0c6f0bb88b444f6c195b01" category="admonition">Se estiver em um ambiente grande que exija mais de 4 nós ou 8 LUNs, consulte nossa equipe de aliança Epic para confirmar os designs de LUN. A equipe pode ser alcançada em NetApp.com.</block>
  <block id="e9afc81d3b8e2990f966bb247fa75a6b" category="list-text">Use 8 LUNs em volumes 8 para começar, adicionando 2 LUNs de cada vez, em todos os nós do cluster.</block>
  <block id="eb75aeb3b4b2b9734ba3e52f5483f0b2" category="inline-link-macro">Documentação do ONTAP</block>
  <block id="c5432110ad66f4e2e624118b88a48126" category="list-text">Criar LUNs no tamanho esperado para um crescimento de 3 anos. (Consulte o <block ref="2a57767dbf71d600f009b2fefab6360d" category="inline-link-macro-rx"></block> para obter os tamanhos máximos de LUN.)</block>
  <block id="4631d10aa7c8cd31e9dcf52425c327ee" category="paragraph">Seis protocolos são usados para conetar o VMware vSphere a datastores em um sistema que executa o ONTAP:</block>
  <block id="4dc791031dce7528180b933655b6f73e" category="paragraph">FCP, NVMe/FC, NVMe/TCP e iSCSI são protocolos de bloco que usam o vSphere Virtual Machine File System (VMFS) para armazenar VMs dentro de LUNs ONTAP ou namespaces NVMe contidos em um ONTAP FlexVol volume. O NFS é um protocolo de arquivos que coloca as VMs em armazenamentos de dados (que são simplesmente volumes ONTAP) sem a necessidade de VMFS. SMB (CIFS), iSCSI, NVMe/TCP ou NFS também podem ser usados diretamente de um sistema operacional convidado para o ONTAP.</block>
  <block id="6b8f0029ce30f9b4d5fe0def33875511" category="cell">FC</block>
  <block id="81761811d0f769f1e8ab81834167af5c" category="cell">Software de backup habilitado para VMware vStorage APIs for Data Protection (VADP)</block>
  <block id="50f09c99cf03d7efc83cfdc33047b54f" category="cell">Sim 1</block>
  <block id="bb3e0b0b29c5930728585f775194c32b" category="cell">2</block>
  <block id="b42c555e5ddbb6a4354369bbdd6b4513" category="cell">V3 apenas 2</block>
  <block id="cb928308729506b7eff5e7791a0ce0ba" category="list-text">Os sistemas operacionais Guest (SO) mais antigos precisavam de alinhamento com o sistema de storage para obter o melhor desempenho e eficiência de storage. No entanto, os sistemas operacionais modernos suportados por fornecedores de distribuidores Microsoft e Linux, como a Red Hat, não precisam mais de ajustes para alinhar a partição do sistema de arquivos com os blocos do sistema de armazenamento subjacente em um ambiente virtual. Se você estiver usando um sistema operacional antigo que pode exigir alinhamento, procure na base de conhecimento de suporte da NetApp artigos usando "alinhamento de VM" ou solicite uma cópia do TR-3747 de um Contato de vendas ou parceiro da NetApp.</block>
  <block id="2d95becf2e726f81e5f2c0c9447ec2ad" category="paragraph">Em geral, *a NetApp recomenda* o uso das ferramentas do ONTAP para a interface do VMware vSphere no vCenter para provisionar armazenamentos de dados tradicionais e vVols para garantir que as práticas recomendadas sejam seguidas.</block>
  <block id="3405fd91ec611e14ca0464a159e87d21" category="list-text">Quando os storages ESXi e ONTAP estão conetados a redes de armazenamento Ethernet, *a NetApp recomenda* configurar as portas Ethernet às quais esses sistemas se conetam como portas de borda de protocolo de árvore de expansão rápida (RSTP) ou usando o recurso Cisco PortFast. *A NetApp recomenda* ativar o recurso de tronco de porta de árvore de expansão rápida em ambientes que usam o recurso Cisco PortFast e que têm entroncamento de VLAN 802,1Q habilitado para o servidor ESXi ou os storages ONTAP.</block>
  <block id="96d48caf96811ccfa373aaf5fbe6f862" category="list-text">*A NetApp recomenda* as seguintes práticas recomendadas para agregação de links:</block>
  <block id="d4b27e1b61577e2e3dfeebd3b8129da5" category="list-text">Evite compartilhar volumes entre hosts. Por exemplo, embora seja possível criar 2 LUNs em um único volume e compartilhar cada LUN com um host diferente, isso deve ser evitado porque pode complicar o gerenciamento. No caso de executar várias instâncias do SQL Server no mesmo host, a menos que você esteja perto do limite de volume em um nó, evite o compartilhamento de volumes e, em vez disso, tenha um volume separado por instância por host para facilitar o gerenciamento de dados.</block>
  <block id="e3ea9105e22caf8aa06aee0279a968bb" category="list-text">Quando apropriado, configure uma política de dimensionamento automático de volume para ajudar a evitar condições fora do espaço.</block>
  <block id="72a9733bd5929d30a93ea680e0c3fad1" category="list-text">Colocar arquivos secundários de banco de dados (como parte de um grupo de arquivos) em volumes separados melhora o desempenho do banco de dados SQL Server. Essa separação só é válida se o arquivo do banco de dados<block ref="937f38432beb92fdba3d47780720bdf7" prefix=" " category="inline-code"></block> não compartilhar seu LUN com<block ref="937f38432beb92fdba3d47780720bdf7" prefix=" " category="inline-code"></block> outros arquivos.</block>
  <block id="82d9655a27436534991360ea4c0dc680" category="paragraph">O banco de dados tempdb pode ser muito utilizado. Além do posicionamento ideal de arquivos de banco de dados de usuários no ONTAP, o posicionamento de datafiles tempdb também é fundamental para reduzir a contenção de alocação. Tempdb deve ser colocado em disco separado e não compartilhado com datafiles do usuário.</block>
  <block id="5c4a7832da0e9f8799089fdc985bb9b3" category="list-text">O arquivo de dados tempdb deve ser criado com tamanho igual</block>
  <block id="20453a1c8627ad0bc536be210636fa41" category="paragraph">O script de exemplo a seguir modifica tempdb criando oito arquivos tempdb de tamanho igual e movendo tempdb para o ponto de montagem<block ref="ae6fbe62f3ddc46fa9a9885244d23675" prefix=" " category="inline-code"></block> do SQL Server 2012 e posterior.</block>
  <block id="3f808654ebfed6aae875b71a402ac91b" category="inline-link-macro">Aviso para ONTAP 9.16,1</block>
  <block id="afb530fcc81b2978f808bd5327a32c87" category="inline-link-macro">Aviso para ONTAP 9.16,0</block>
  <block id="d804afb237a517c556722013a1b8ec73" category="inline-link-macro">Aviso para ONTAP 9.15,1</block>
  <block id="5f016d328522d91c512269e0786e144d" category="inline-link-macro">Aviso para ONTAP 9.15,0</block>
  <block id="98ea16e049d26c017c083e3896766015" category="inline-link-macro">Aviso para ONTAP 9.14,1</block>
  <block id="2a0d0e639657d07a66d55606242f8863" category="inline-link-macro">Aviso para ONTAP 9.14,0</block>
  <block id="d13ca0508189923e4791d61e82518903" category="paragraph"><block ref="ee254fc53b05f67f41ce3314151253c2" category="inline-link-macro-rx"></block> <block ref="83cffbd8d99e434b2f5f3940f69ff8e4" category="inline-link-macro-rx"></block> <block ref="23ce2232a13ec581d8a1f356c5cc2645" category="inline-link-macro-rx"></block> <block ref="4d4f1ffb0dbcd5627ca696d020c34dce" category="inline-link-macro-rx"></block> <block ref="d16c9b11843460f788b4709fb5f6f9c0" category="inline-link-macro-rx"></block> <block ref="5032e7169b10b3f96d6c299a82923a0e" category="inline-link-macro-rx"></block> <block ref="f7a2b1db149ed9886af0ce846dbc3e14" category="inline-link-macro-rx"></block> <block ref="b349c509ad858348b30db7e73307e3aa" category="inline-link-macro-rx"></block> <block ref="0dce234dfded58bd461541473b86e42a" category="inline-link-macro-rx"></block> <block ref="9760ec4df13f0afbdfec88ae16c871ae" category="inline-link-macro-rx"></block> <block ref="b6dab2933dfb92cf0c1355707a4aec7c" category="inline-link-macro-rx"></block> <block ref="1b7c80b26162b03bd0addd587f70df55" category="inline-link-macro-rx"></block> <block ref="14faf912aa42102a6628af4551e02583" category="inline-link-macro-rx"></block> <block ref="a90f36d649d3be5d386cc3563ab044fb" category="inline-link-macro-rx"></block> <block ref="2cd65b4a044075cfd9ad4a91f42fdff4" category="inline-link-macro-rx"></block> <block ref="5e764cc3fdcc19ff667796e414159bdc" category="inline-link-macro-rx"></block> <block ref="561451f09c7bca700ea0d7833cd9e92e" category="inline-link-macro-rx"></block> <block ref="d23d341a344216fbf99a91152429d49c" category="inline-link-macro-rx"></block> <block ref="b35e8fbd7b0369b23734510994911ec4" category="inline-link-macro-rx"></block> <block ref="41d4305cf7a6acb595086f123121a781" category="inline-link-macro-rx"></block> <block ref="ea685649fabe77da53e843fec56f72b8" category="inline-link-macro-rx"></block></block>
  <block id="c9e7f99d53af8a795853cdf25af30b41" category="section-title">ONTAP Mediador para configurações MetroCluster IP</block>
  <block id="f6cab8e78e70dc1f9720a3ef038776e0" category="inline-link-macro">9.9.1 Aviso para o Mediador ONTAP para configurações MetroCluster IP</block>
  <block id="ebe991cfd03b446bbf8687699ccbd660" category="inline-link-macro">9,8 Aviso para o Mediador ONTAP para configurações MetroCluster IP</block>
  <block id="2db41096b15f25232cba7341c2140448" category="inline-link-macro">9,7 Aviso para o Mediador ONTAP para configurações MetroCluster IP</block>
  <block id="f81cc577527b8b7cad4405edd62a83d4" category="paragraph"><block ref="3e82164cf34143fb60c8ff9df8c41c0a" category="inline-link-macro-rx"></block> <block ref="d53517b81c95b1c10115cf953ff553c1" category="inline-link-macro-rx"></block> <block ref="b1bde49b948d4004f51f0cd5e9a9e990" category="inline-link-macro-rx"></block></block>
  <block id="7d90174e2cb3f5e3051541506c8587b4" category="list-text">Use as ferramentas do ONTAP para o VMware vSphere para provisionar armazenamentos de dados porque ele simplifica o gerenciamento de políticas de exportação automaticamente.</block>
  <block id="4ac7ffa40244bc8345591768f8411745" category="list-text">Use a função de montagem de plug-in para aplicar datastores existentes a novos servidores.</block>
  <block id="adf5380025d4004543deef73a471bbd5" category="inline-link-macro">NFSv3 nconnect recurso com NetApp e VMware</block>
  <block id="f9f508df0fe89d92476e598965812f69" category="list-text">Todas as versões do VMware vSphere com suporte no momento podem usar o NFS v3 e o v4,1. O suporte oficial para nconnect foi adicionado ao vSphere 8,0 update 2 for NFS v3 e à atualização 3 for NFS v4,1. Para o NFS v4,1, o vSphere continua a oferecer suporte ao entroncamento de sessão, autenticação Kerberos e autenticação Kerberos com integridade. É importante notar que o entroncamento de sessão requer o ONTAP 9.14,1 ou uma versão posterior. Você pode saber mais sobre o recurso nconnect e como ele melhora o desempenho em <block ref="8bbf9cc2e5403eec56b8cc2f4bd74d68" category="inline-link-macro-rx"></block>.</block>
  <block id="81439479f2f4c0fa8c28668334fa82bd" category="list-text">O valor máximo para nconnect no vSphere 8 é 4 e o valor padrão é 1. O limite máximo de valor no vSphere pode ser aumentado em uma base por host por meio de configurações avançadas, no entanto, geralmente não é necessário.</block>
  <block id="b279126f58fd7f43a55f5efc8596bcea" category="list-text">Um valor de 4 é recomendado para ambientes que exigem mais desempenho do que uma única conexão TCP pode fornecer.</block>
  <block id="9d676095b7ff8ea1b1779bc58fb32a92" category="list-text">Esteja ciente de que o ESXi tem um limite de 256 conexões NFS e cada conexão nconnect conta para esse total. Por exemplo, dois datastores com nconnect 4 contariam como oito conexões totais.</block>
  <block id="efdc45c7bd15d84f5bcb4df0560d6d3a" category="list-text">É importante testar o impacto no desempenho do nconnect no seu ambiente antes de implementar mudanças em grande escala em ambientes de produção.</block>
  <block id="d1801a2d87a0325c6c691a74f5d1ffef" category="list-text">Vale a pena notar que NFSv3 e NFSv4,1 usam diferentes mecanismos de bloqueio. O NFSv3 usa o bloqueio do lado do cliente, enquanto o NFSv4,1 usa o bloqueio do lado do servidor. Embora um volume ONTAP possa ser exportado através de ambos os protocolos, o ESXi pode montar apenas um datastore através de um protocolo. No entanto, isso não significa que outros hosts ESXi não possam montar o mesmo datastore através de uma versão diferente. Para evitar quaisquer problemas, é essencial especificar a versão do protocolo a ser usada durante a montagem, garantindo que todos os hosts usem a mesma versão e, portanto, o mesmo estilo de bloqueio. É essencial evitar misturar versões NFS entre hosts. Se possível, use perfis de host para verificar a conformidade.</block>
  <block id="c17658fd7af3bb19a0f047cb1e006186" category="list-text">As regras de política de exportação de NFS são usadas para controlar o acesso pelos hosts vSphere. Você pode usar uma diretiva com vários volumes (datastores). Com o NFS, o ESXi usa o estilo de segurança sys (UNIX) e requer a opção de montagem raiz para executar VMs. No ONTAP, essa opção é chamada de superusuário e, quando a opção superusuário é usada, não é necessário especificar o ID de usuário anônimo. Observe que regras de política de exportação com valores diferentes<block ref="ea72d12ecaa06afdb0c8a3b15e485e95" prefix=" " category="inline-code"></block> e<block ref="df809a941c1287d18c08bb5927b639dc" prefix=" " category="inline-code"></block> podem causar problemas de descoberta de SVM com ferramentas do ONTAP. Os endereços IP devem ser uma lista separada por vírgulas sem espaços dos endereços de porta vmkernel que montam os datastores. Aqui está uma regra de política de exemplo:</block>
  <block id="a001b05a0a70d03d708c133c88072a2b" category="list-text">Lista de nomes de host de correspondência de cliente, endereços IP, Netgroups ou domínios: 192.168.42.21,192.168.42.22</block>
  <block id="0106a8755025c8789c58f6ca3db3cd93" category="list-text">Regra de Acesso RO: Qualquer</block>
  <block id="1c66db8bac919c3f29211badf0369156" category="list-text">Regra de Acesso RW: Qualquer</block>
  <block id="193fc1ecf90841d52215e705d60caa7b" category="list-text">ID de usuário para o qual usuários anônimos são mapeados: 65534</block>
  <block id="f913a13d0c2cb8f8dd45dc1479901025" category="list-text">Tipos de segurança do superusuário: Qualquer</block>
  <block id="e44d8f7f976db169814f15c0e3c91250" category="list-text">Honra setuid bits em SETATTR: True</block>
  <block id="c154c7fcb68e62b069047ccff2521dc0" category="list-text">Permitir a criação de dispositivos: Verdadeiro</block>
  <block id="71168bd99a960bfb425e723f5750b3fc" category="list-text">Se o plug-in NFS NetApp for usado, o protocolo deve ser definido como<block ref="2521ef5d58fc027d3121662b7d8f9ac2" prefix=" " category="inline-code"></block> quando a regra de política de exportação for criada ou modificada. O protocolo NFSv4 é necessário para que a descarga de cópia VAAI funcione, e especificar o protocolo como<block ref="2521ef5d58fc027d3121662b7d8f9ac2" prefix=" " category="inline-code"></block> inclui automaticamente as versões NFSv3 e NFSv4. Isso é necessário mesmo que o tipo de armazenamento de dados seja criado como NFS v3.</block>
  <block id="dd68c690edda5e0630944465c5950d11" category="list-text">Protocolo de acesso: nfs</block>
  <block id="4d6306be791d29381011bb901e0351d5" category="list-text">Especificação correspondência Cliente: 192.168.42.21,192.168.42.22</block>
  <block id="62297138e048f9159339e4709b23cd2f" category="list-text">Como um LUN conetado iSCSI ou namespace NVMe/TCP acessado e controlado por um iniciador de software de um sistema operacional convidado VM</block>
  <block id="7eae63bf83e6298ab64a2dd5e2544df9" category="inline-link-macro">Ferramenta VMware Configuration Maximums</block>
  <block id="ee1c3928454779ec08bd2d50271b6621" category="admonition">Consulte a <block ref="ca32979bcc653e1966d3624ee8d76604" category="inline-link-macro-rx"></block>para obter os limites suportados mais atualizados no ESXi.</block>
  <block id="387b349695476180bf90cc1891288318" category="list-text">Verifique <block ref="1f38ac07598dbb4b06912539aafa4211" category="inline-link-macro-rx"></block>as configurações recomendadas pelo NetApp em colaboração com a VMware.</block>
  <block id="9c4a21e654649a6a5201381ce4ba6cbd" category="paragraph">As tabelas a seguir apresentam recursos tradicionais de datastore compatíveis com o vSphere com o ONTAP. Essas informações não se aplicam aos armazenamentos de dados vVols, mas geralmente se aplicam ao vSphere 6.x e versões posteriores usando versões compatíveis do ONTAP. Você também pode consultar o <block ref="ca32979bcc653e1966d3624ee8d76604" category="inline-link-macro-rx"></block> para versões específicas do vSphere para confirmar limites específicos.</block>
  <block id="27071f484b59aa9ce5f5cffcefefd481" category="paragraph">2 os armazenamentos de dados usando NVMe-of e NFS v4,1 exigem replicação do vSphere. A replicação baseada em array para NFS v4,1 não é atualmente suportada pelo SRM. Atualmente, a replicação baseada em array com NVMe-of não é compatível com as ferramentas do ONTAP para o adaptador de replicação de armazenamento (SRA) do VMware vSphere.</block>
  <block id="f992800e6b8aa5ca675e5d1c9fd9950c" category="summary">O SnapCenter permite criar políticas de backup que podem ser aplicadas a vários trabalhos. Essas políticas podem definir agendamento, retenção, replicação e outros recursos. Elas continuam permitindo uma seleção opcional de snapshots consistentes com VM, o que aproveita a capacidade do hipervisor de silenciar a I/o antes de tirar um snapshot da VMware.</block>
  <block id="0a99e5aa10081a6cc2cd756764a791f5" category="inline-link-macro">Limitações do Snapshot</block>
  <block id="aa4e326f7359bc14116e671e7002dd80" category="paragraph">O ONTAP oferece storage de bloco de classe empresarial para VMware vSphere usando iSCSI tradicional e Fibre Channel Protocol (FCP), bem como o protocolo de bloco de última geração, altamente eficiente e de alta performance, o NVMe over Fabrics (NVMe-of), com suporte a NVMe/FC e NVMe/TCP.</block>
  <block id="69ed4612751aa53c36bfb06723b9ac3c" category="inline-link-macro">Datastores e Protocolos - SAN</block>
  <block id="6ed827bb740ef6ae13ba33875f09bd4d" category="paragraph">Para obter as práticas recomendadas detalhadas para a implementação de protocolos de bloco para armazenamento de VM com o vSphere e o ONTAP, consulte <block ref="851570383af5746336da824a0a2590e1" category="inline-link-macro-rx"></block></block>
  <block id="080533926d0a5f93ded730459d8fe38e" category="paragraph">O vSphere permite que os clientes usem arrays NFS de classe empresarial para fornecer acesso simultâneo a datastores para todos os nós em um cluster ESXi. Como mencionado na <block ref="72b655a9973dbed02099f5e63762d591" category="inline-link-macro-rx"></block> seção, há alguns benefícios de visibilidade de eficiência de storage e facilidade de uso ao usar o NFS com vSphere.</block>
  <block id="d9243800afbb4af685507413cda85fb3" category="inline-link-macro">Datastores e Protocolos - NFS</block>
  <block id="5b17d236da497a1c9e5d89b42dfc8264" category="paragraph">Para obter as melhores práticas recomendadas, consulte <block ref="75fda850433b3639ed71701079d043be" category="inline-link-macro-rx"></block></block>
  <block id="d240aead1fe438e9f66d54e3cebb7e47" category="paragraph">Aqui estão as configurações de host recomendadas para todas as versões atualmente suportadas do ONTAP.</block>
  <block id="11d0e9e8442c67c812829427e008eb11" category="inline-link-macro">Recuperação de espaço para VMFS5 máquinas virtuais</block>
  <block id="fef769c2e7ba3ba16273c3c81c47ed9e" category="cell">Mantenha o padrão (0), mas pode ser alterado se necessário. Para obter mais informações, consulte <block ref="9b26e5c0136d6a9ffe3ef541d9621427" category="inline-link-macro-rx"></block></block>
  <block id="c99694bb5336dd37a10341183ec8a950" category="inline-link-macro">VMware KB 2069356</block>
  <block id="2f5a0569065e71943058f8fb26e3e8da" category="inline-link">Alterar parâmetros padrão para latência Round Robin</block>
  <block id="da151950bd7f77d4d82f31a151e48d86" category="paragraph">Para FCP e iSCSI com vSphere, mais detalhes podem ser encontrados em para FCP e iSCSI com vSphere 8, mais detalhes podem ser encontrados em <block ref="0b6ab7c7c874850b69a7bdde572cc0ce" category="inline-link-macro-rx"></block>para NVMe-of com vSphere 7. Para NVMe-of com vSphere 8, mais detalhes podem ser encontrados em <block ref="72dcc917faa9346f108bcba624c6b54f" category="inline-link-macro-rx"></block> para NVMe-of com vSphere 7<block ref="ad69e690a8561a2cf3328cde094252f4" category="inline-link-macro-rx"></block>. Mais detalhes podem ser encontrados em <block ref="6388c35b35c0c848de96298937e342cf" category="inline-link-macro-rx"></block></block>
  <block id="b565c40b717c5d84ecaff52fbb94903d" category="paragraph">Anunciado pela primeira vez em 2012, a NetApp foi um dos primeiros parceiros de design da VMware no desenvolvimento das APIs do VMware vSphere para conscientização de armazenamento (VASA), a base do gerenciamento baseado em políticas de armazenamento (SPBM) com storage arrays empresariais. Essa abordagem trouxe gerenciamento limitado de storage granular de VM para o storage VMFS e NFS.</block>
  <block id="e01da3b454da14823394d0b9b3fac1d6" category="section-title">Volumes virtuais (vVols)</block>
  <block id="b077cca6e6fd5e690157294fd7f87e08" category="paragraph">O vVols é uma arquitetura revolucionária de armazenamento que permite o gerenciamento granular do armazenamento de VM, permitindo que o armazenamento seja gerenciado não apenas por VM (incluindo metadados de VM), mas mesmo por VMDK. O vVols é um componente essencial da estratégia de Software Defined Data Center (SDDC) que forma a base do VMware Cloud Foundation (VCF), fornecendo uma arquitetura de armazenamento mais eficiente e escalável para ambientes virtualizados.</block>
  <block id="7dba0dd24357e8a19109bbbf7f689fb2" category="paragraph">Os vVols permitem que as VMs consumam o storage por VM, porque cada objeto de storage de VM é uma entidade exclusiva no NetApp ONTAP. Com os sistemas ASA R2 que não precisam mais de gerenciamento de volume, isso significa que cada objeto de armazenamento de VM é uma unidade de armazenamento exclusiva (SU) no storage e pode ser controlado de forma independente. Isso permite a criação de políticas de storage que podem ser aplicadas a VMs individuais ou VMDKs (e, portanto, SUS indivudual), fornecendo controle granular sobre serviços de storage, como performance, disponibilidade e proteção de dados.</block>
  <block id="f467f22eb6ec5b3e0694963b3f16ebc2" category="section-title">Gerenciamento baseado em políticas de storage (SPBM)</block>
  <block id="05ba8cf72b56cd6a89d699c0a922d186" category="paragraph">O SPBM fornece uma estrutura que serve como uma camada de abstração entre os serviços de armazenamento disponíveis para o seu ambiente de virtualização e os elementos de armazenamento provisionados por meio de políticas. Essa abordagem permite que os arquitetos de storage projetem pools de storage com recursos diferentes. Esses pools podem ser facilmente consumidos pelos administradores de VM. Os administradores podem, então, corresponder aos requisitos de carga de trabalho da máquina virtual aos pools de armazenamento provisionados. Essa abordagem simplifica o gerenciamento de storage e permite o uso mais eficiente dos recursos de storage.</block>
  <block id="4e1ae190f1f93f025754e7944927b697" category="paragraph">O SPBM é um componente chave do vVols, fornecendo uma estrutura baseada em políticas para gerenciar serviços de storage. As políticas são criadas pelos administradores do vSphere usando regras e recursos expostos pelo provedor VASA (VP) do fornecedor. É possível criar políticas para diferentes serviços de storage, como performance, disponibilidade e proteção de dados. As políticas podem ser atribuídas a VMs ou VMDKs individuais, fornecendo controle granular sobre os serviços de storage.</block>
  <block id="ac0bb89f2c9215fb6f1280fb1d88d213" category="section-title">NetApp ONTAP e vVols</block>
  <block id="1402ced4d3888a58c5af1059e38ea6b4" category="paragraph">A NetApp ONTAP lidera o setor de storage em escala de vVols, dando suporte a centenas de milhares de vVols em um único cluster*. Em contraste, os fornecedores de array empresarial e flash arrays menores dão suporte a apenas milhares de vVols por array. O ONTAP fornece uma solução de storage dimensionável e eficiente para ambientes VMware vSphere, com suporte ao vVols com um conjunto avançado de serviços de storage, incluindo deduplicação de dados, compactação, thin Provisioning e proteção de dados. O SPBM permite uma integração perfeita com ambientes VMware vSphere.</block>
  <block id="6070863553bff7655694da4be22f793e" category="paragraph">Mencionamos anteriormente que os administradores de VM podem consumir capacidade como pools de storage. Isso é feito por meio do uso de contêineres de storage que são representados no vSphere como armazenamentos de dados lógicos.</block>
  <block id="5db11f8fed5bd72f359ab9469069dffa" category="summary">Lista de verificação de instalação das ferramentas ONTAP 10</block>
  <block id="a5d727df2ce2d168bae39c78df4b9054" category="doc">Lista de verificação</block>
  <block id="7aed7b3182cbdda9aceb9c8f8b3c2dbe" category="paragraph">Use esta lista de verificação de instalação para garantir uma implantação bem-sucedida (atualizada para 10,3 e posterior).</block>
  <block id="06c2cea18679d64399783748fa367bdd" category="inline-image-macro">Um</block>
  <block id="1e90f607d380c9ee51b487edec3975fa" category="list-title"><block ref="58f667aaf05f87159670e12bd9bc076b" category="inline-image-macro-rx" type="image"></block> Planejamento inicial</block>
  <block id="5541521d8d465590f0919510f29154b2" category="inline-link">Limites de configuração para implantar as ferramentas do ONTAP para o VMware vSphere</block>
  <block id="225d03736b7d93585b216af68e8caa12" category="list-text">Determine o tamanho e o tipo de configuração de ferramentas do ONTAP de que o seu ambiente precisa. Consulte a<block ref="de0a48be1b1ae6c0ec73a4762c1d7abf" category="inline-link-rx"></block> para obter mais informações.</block>
  <block id="c56feb728c490e11ea8eba91afce9419" category="list-text">Determine se você usará o adaptador de replicação de armazenamento (SRA) das ferramentas ONTAP para o Gerenciador de recuperação de Site (SRM) ou recuperação de Site ao vivo (VLSR). Se assim for, terá de aceder à interface de gestão do servidor SRM/VLSR para instalar o SRA.</block>
  <block id="15ee84770ceab89b9fe30ec618843c01" category="inline-link">Crie um relacionamento de pares de cluster no ONTAP</block>
  <block id="bfbb5bcd0f88a18adcc2741da1b9063a" category="inline-link">Criar um relacionamento entre pares SVM entre clusters no ONTAP</block>
  <block id="d8a2601707345eab1d4df3e541d61f3c" category="list-text">Se você estiver usando a replicação do SnapMirror gerenciada por ferramentas do ONTAP (incluindo, entre outras, a sincronização ativa do SnapMirror), o administrador do ONTAP deve<block ref="f4be9e71a34420e69a7db6d0cf97d232" category="inline-link-rx"></block> e<block ref="42356490ef97c026f7c04a9cb9eeee7d" category="inline-link-rx"></block> antes de poder usar as ferramentas do ONTAP com o SnapMirror.</block>
  <block id="801ab24683a4a8c433c6eb40c48bcd9d" category="inline-link">Transferir</block>
  <block id="18f5114f4a595ad26525bf20f301ce19" category="list-text"><block ref="20462cf0cb6f4e0f9c91cc66c831d98e" category="inline-link-rx"></block> As ferramentas ONTAP OVA, e se necessário, o arquivo SRA tar.gz.</block>
  <block id="aada29daee1d64ed0fe907043855cb7e" category="inline-image-macro">Dois</block>
  <block id="770c8023395525bc05b5a8fc2e6efa8b" category="list-title"><block ref="54f425ce8d89f4ed6b8a546561af5d60" category="inline-image-macro-rx" type="image"></block> Provisione endereços IP e Registros DNS</block>
  <block id="08b0c7e27d2f1780fce59893f12e7642" category="list-text">ONTAP Tools Endereço da aplicação "______________ . __________ . __________ . ___________</block>
  <block id="6bb090d29a0e3de8cc001d02c1e8a7b3" category="list-text">Endereço de Serviços internos '__________ . __________ . __________ . ___________</block>
  <block id="e32a9122e97bf17560b53c6993301629" category="list-text">Nome de host DNS do nó "____________________________________________________________</block>
  <block id="1cb7943b8cf41289c8d5ae2c9f9ec310" category="list-text">Endereço IP do nó "______________ . __________ . __________ . ___________</block>
  <block id="2b5f3d5d41f4d2986a55a91aa934205c" category="list-text">Máscara de sub-rede "__________ . __________ . __________ . ___________</block>
  <block id="ed7c49acbcb0724e63d695ba272bcd1d" category="list-text">Gateway padrão '___________ . __________ . __________ . ___________</block>
  <block id="a637d19158a083f61d5e6d9df66998cb" category="list-text">Servidor DNS 1 ____________ . __________ . __________ . ___________</block>
  <block id="b7eed84956833fb9e8cbb126fb30803f" category="list-text">Servidor DNS 2 ____________ . __________ . __________ . ___________</block>
  <block id="7f7df9c7f87bea4d47136da35a80f4a9" category="list-text">Domínio de pesquisa DNS________________________________________________________________</block>
  <block id="59cd965988b8905f3416029cd3a1facf" category="list-text">Nome de host DNS do nó dois (opcional) '____________________________________________________</block>
  <block id="242e264b9e179f0ea25123089a967467" category="list-text">Endereço IP do nó dois (opcional) '____________ . __________ . __________ . ___________</block>
  <block id="4115e1d934066b360d5cdd8013198fff" category="list-text">Nome de host DNS do nó três (opcional) '____________________________________________________</block>
  <block id="8043aaa26cf3f85d9ab4df441ceb6ef3" category="list-text">Endereço IP do nó três (opcional) "_____________ . __________ . __________ . ___________</block>
  <block id="305c44d3641b44153a7487e28382fffb" category="list-text">Crie Registros DNS para todos os endereços IP acima.</block>
  <block id="ca8a2087e5557e317599344687a57391" category="inline-image-macro">Três</block>
  <block id="543a0cfd4f6527c92c513911b3079c22" category="list-title"><block ref="05b2444faffd66d76e88602ea7dd353f" category="inline-image-macro-rx" type="image"></block> Configuração de firewall de rede</block>
  <block id="76841410d8f9a6881e0b96f150e9cedf" category="inline-link">Requisitos portuários</block>
  <block id="1cb44e38b7d534b49fb7ce15d6726cb0" category="list-text">Abra as portas necessárias para os endereços IP acima indicados no firewall de rede. <block ref="d75d54fbd8f18143d683ed6f5389e615" category="inline-link-rx"></block>Consulte para obter a atualização mais recente.</block>
  <block id="981b8fcee42e1e726a67a2b9a98ea6e9" category="inline-image-macro">Quatro</block>
  <block id="640e990f06389e4b49f54086ba1aba46" category="inline-link">Edite as definições do aparelho e ative o serviço VASA</block>
  <block id="49b964c1f288e8e75650b3e86683914d" category="list-text">Para usar vVols, você deve primeiro<block ref="c9f7d482e0b51df808dc044e3e43f591" category="inline-link-rx"></block>. Ao mesmo tempo, revise os dois itens a seguir.</block>
  <block id="8ba46a1826b102cd1b8b0fb75a241176" category="inline-link">ative a alta disponibilidade</block>
  <block id="acc64c77b8528b3513e0bab18372f0d3" category="list-text">Se você planeja usar vVols na produção,<block ref="b5eaf1d61c4c1246e4e215774dc53776" category="inline-link-rx"></block> com os dois endereços IP opcionais acima.</block>
  <block id="fddd8f455515e6a6de8e8d876641e0c5" category="inline-link">Ative os serviços SRA</block>
  <block id="777b715f4e7db3295048bd9409cb3a0f" category="list-text">Se você planeja usar o adaptador de replicação de armazenamento (SRA) das ferramentas do ONTAP para o Gerenciador de recuperação de Site da VMware ou recuperação de Site ao vivo,<block ref="9eb793199b56cb94f5df0c657a62ea9e" category="inline-link-rx"></block>.</block>
  <block id="e5d9de39f7ca1ba2637e5640af3ae8aa" category="inline-image-macro">Cinco</block>
  <block id="e03ec7d1e46f44c47e1547f8c19fdbb5" category="list-text">De acordo com a VMware, os certificados assinados pela CA são necessários se estiverem usando vVols com vários vCenters.</block>
  <block id="777f90dea67a6de19d7e4287d6d65525" category="list-text">Serviços VASA__________________________________________________________________</block>
  <block id="50261e7dc97594e1ef47d1913fadd642" category="list-text">Os serviços administrativos '______________________________________________________</block>
  <block id="e6fbc0b9673f8c86726688d7607fc8f5" category="inline-image-macro">Seis</block>
  <block id="96c44f7328270a7b9e72a07f78739ecf" category="list-text">É necessário um datastore em um dispositivo de armazenamento compartilhado. Opcionalmente, você pode usar uma biblioteca de conteúdo no mesmo armazenamento de dados do nó um para facilitar a clonagem rápida do modelo com o VAAI.</block>
  <block id="656b82abf6edc190097506cd4d1d585b" category="list-text">Biblioteca de conteúdo (apenas necessária para HA</block>
  <block id="99325facb7679dc357733bd909532cfc" category="list-text">Nó um datastore '______________________________________________________</block>
  <block id="f669e2c7e65edea7adca0c4006b6cf36" category="list-text">Nó dois datastore (opcional, mas recomendado para HA) '____________________________________________________</block>
  <block id="5ba1096fffa0ecfd4695651916c48133" category="list-text">Nó três datastore (opcional, mas recomendado para HA) '___________________________________________________________</block>
  <block id="12e67aac3e7f9227cc35f8f047d7dc74" category="inline-image-macro">Sete</block>
  <block id="db5321854b38ff4107ff88c3d3fb2602" category="inline-link">Implante os ÓVULOS</block>
  <block id="62386ee2b40ea01fd147eb04a3da8b17" category="list-text"><block ref="2b093a8e786abd40836246bfb87e05bd" category="inline-link-rx"></block> Usando o cliente vSphere.</block>
  <block id="baca0ca6729684fd54206793ae4b5bd5" category="inline-image-macro">Oito</block>
  <block id="d40a477cc61e319a78ef1bb36d8ea566" category="list-text">Crie regras antiafinidade para VMs em uma implantação de HA.</block>
  <block id="4695b076293ddedd5434ae5a73b57ae2" category="list-text">Se estiver usando HA, os nós vMotion do storage dois e três para separar armazenamentos de dados (opcional, mas recomendado).</block>
  <block id="fde3f7a850bbaaac2a3706bf8c7df54c" category="inline-link">Configurar as funções de usuário do ONTAP e o Privileges</block>
  <block id="064719d8b0308f2a4bc89590c3becdab" category="inline-link">utilize gerir certificados</block>
  <block id="d59a2f6a46dd460183ac2d0c23cf6f75" category="list-text"><block ref="53fb9f19112a80479a138e84ac0182c6" category="inline-link-rx"></block> No Gerenciador de ferramentas do ONTAP para instalar todos os certificados assinados pela CA necessários.</block>
  <block id="6245e46af5a3bdaf57696763c4214c70" category="inline-link">Adicione instâncias do vCenter Server</block>
  <block id="427d083edfb4d6df118817492fea1fea" category="list-text"><block ref="9271e724c67dd3dffeb4e3ddaf43b80d" category="inline-link-rx"></block> No Gerenciador de ferramentas do ONTAP.</block>
  <block id="75299228e38c6c56354b3fbc53bd01db" category="inline-link">clusters integrados</block>
  <block id="0583aea4353aeb5998071022ebbb79ae" category="inline-link">SVMs integradas</block>
  <block id="4d5a9665c20fe0f045d612f3d7c14c3a" category="inline-link">Configure o SRA no VMware Live Site Recovery Appliance</block>
  <block id="74d3c40ee5d2741e75390e90d13a881a" category="list-text">Se você ativou o SRA para SRM/VLSR para proteger armazenamentos de dados tradicionais,<block ref="ae14a63430307f4358dbb1aa0a6215ef" category="inline-link-rx"></block>.</block>
  <block id="56b3d744b9b4be462a3690ae4544597f" category="inline-link">Perto de RPO zero</block>
  <block id="f2866fe05fc7b275f3e2c504b39a3676" category="list-text">Configurar backups nativos para<block ref="f915d15018e6084f8326718037772bc7" category="inline-link-rx"></block>o .</block>
  <block id="c6a161ea3b473fa2cdc98e5283764902" category="list-text">Configure backups regulares para outras Mídias de armazenamento.</block>
  <block id="ed0748e15540f55b7e9e13424330165e" category="paragraph">Siga estas práticas recomendadas para criar armazenamento vVols para suas máquinas virtuais.</block>
  <block id="071d555e17e95fc548b89eaa2c3d9abf" category="section-title">Preparando-se para criar datastores vVols com as ferramentas do ONTAP</block>
  <block id="ed0b328de155f4d64394b3fa01aa3eda" category="inline-link">Atribua camadas locais (agregados) a SVMs</block>
  <block id="835f14a0eb02625831ec957a0e6d8a57" category="list-text"><block ref="62ee77b15c683e37c03a082cde78e3a1" category="inline-link-rx"></block> Para todos os sistemas que não sejam ASA R2.</block>
  <block id="975336c37f4c9eec8db7574a1acdfc20" category="inline-link">Configure a visão geral dos LIFs</block>
  <block id="a51cd3bd8dc9efabd4808d4faa54cb85" category="inline-link">Combine portas físicas para criar grupos de interface</block>
  <block id="02da2876df386437299938fff21fad98" category="list-text">Pelo menos um LIF por nó para cada conexão de switch/malha. Como prática recomendada, crie dois ou mais por nó para protocolos baseados em FCP, iSCSI ou NVMe. Um LIF por nó é suficiente para vVols baseados em NFS, mas esse LIF deve ser protegido por um ifgroup LACP. <block ref="f0614b67c9ad440bb8aa968adbd6137a" category="inline-link-rx"></block>Consulte e<block ref="a5ffd5460ffa788a3fba4a7f91132efb" category="inline-link-rx"></block> para obter detalhes.</block>
  <block id="1e410bafe9c5869016fc8d733372d354" category="list-text">Pelo menos um LIF de gerenciamento por SVM se você pretende usar credenciais de escopo da SVM para seus vCenters de locatário.</block>
  <block id="88ad52445ad4b758c30b8d41e4898479" category="inline-link">Os clusters e SVMs do ONTAP são peered</block>
  <block id="9e972a46542b8d916a3d602fa7d61635" category="list-text">Se você planeja usar o SnapMirror, verifique se o código fonte e o destino<block ref="03354afe01dc1f53e5b25fc0bc002ae0" category="inline-link-rx"></block>.</block>
  <block id="2a03ee5b0887b8a6bf23fd52456544db" category="inline-link">Implantar as ferramentas do ONTAP para o VMware vSphere</block>
  <block id="23f58455f809e6f8a8a2cac1db0e49cf" category="list-text"><block ref="17b63a5e90adbe276a8874700041ac19" category="inline-link-rx"></block> Usando o OVA baixado do site de suporte da NetApp.</block>
  <block id="1bcb0e86c49aae8128bbabb5d9d3d585" category="list-text">As ferramentas do ONTAP 10,0 e posteriores oferecem suporte a vários servidores vCenter por dispositivo. Você não precisa mais implantar um dispositivo de ferramentas do ONTAP por vCenter.</block>
  <block id="951d3fc54a28f9f46798897467d96a5b" category="inline-link">Gerenciar certificados</block>
  <block id="6d8aae47de809b9e77fb4f1ee0ed7730" category="list-text">Se você planeja conetar vários vCenters a uma única instância de ferramentas do ONTAP, crie e instale certificados assinados pela CA. <block ref="32dbc6ca4c4a8bcb0695dd873f46e9e4" category="inline-link-rx"></block>Consulte para obter os passos.</block>
  <block id="31be7f8c3c1f560d4cfdde9947673161" category="list-text">Começando em 10,3, as ferramentas do ONTAP agora são implantadas como um dispositivo de tipo pequeno de nó único, adequado para a maioria dos workloads que não são vVols.</block>
  <block id="485a78e60d40cdf87a9864e840ed44a8" category="inline-link">Ferramentas de ONTAP com escalabilidade horizontal</block>
  <block id="0112f904af205a304a0144318d92a88f" category="inline-link">Usando o Affinity Rules sem o vSphere DRS</block>
  <block id="7ff088db1b9b2e6077b66b3e834c022c" category="inline-link">Crie uma regra de afinidade VM-VM</block>
  <block id="1d7299ee36dd01581c03d394e21875e9" category="inline-link">utilize o utilitário de cópia de segurança de configuração incorporado</block>
  <block id="aaccfa1f911c7ed3afac8a1c9005cf08" category="list-text">A melhor prática recomendada para o uso de vVols de produção é eliminar qualquer ponto único de falha. Crie regras antiafinidade para impedir que as VMs das ferramentas do ONTAP sejam executadas juntas no mesmo host. Após a implantação inicial, também é recomendável usar o storage vMotion para colocar as VMs das ferramentas do ONTAP em diferentes armazenamentos de dados. Leia mais sobre<block ref="9d1413939148e981fa32923e1c0a740d" category="inline-link-rx"></block> ou<block ref="33bad2ad715296cb3b9df2aa8e0bbe93" category="inline-link-rx"></block>. Você também deve agendar backups frequentes e/ou<block ref="835137bc934138d6c89439748022267d" category="inline-link-rx"></block>.</block>
  <block id="97075bcba23b351ceb599f8167247f82" category="list-text">Configure as ferramentas do ONTAP 10,3 para o seu ambiente.</block>
  <block id="46efd89ca4d682d645c74916f2c8e8f4" category="list-text"><block ref="9271e724c67dd3dffeb4e3ddaf43b80d" category="inline-link-rx"></block> Na IU do Gerenciador de ferramentas do ONTAP.</block>
  <block id="6eaf552fe4b827d87d969ecf00791fab" category="inline-link">Adicione seus clusters ONTAP</block>
  <block id="e4c64ea440c0954a75e29bee53f58731" category="list-text">As ferramentas do ONTAP 10,3 são compatíveis com a alocação segura a vários clientes. Se você não precisar de alocação segura a vários clientes, basta<block ref="c70dc775815ebe034e3eb8a346ef862b" category="inline-link-rx"></block> ir ao menu Ferramentas do ONTAP no vCenter e clicar em _backends de armazenamento_ e clicar no botão _add_.</block>
  <block id="2fdde12c870630cac6cf925e7762e8b7" category="list-text">Faça login na IU do Gerenciador de ferramentas do ONTAP</block>
  <block id="bfae79cf17053457fef781bcd20e0f14" category="inline-link">Integrar o cluster de storage</block>
  <block id="b7d3b83b5327fbad54ed641ffe056c7b" category="list-text"><block ref="b7d3b83b5327fbad54ed641ffe056c7b" category="inline-link-rx"></block></block>
  <block id="a5ff3af9e80b6313b32053dd07f43a23" category="inline-link">Associar um back-end de storage a uma instância do vCenter Server</block>
  <block id="b60bfa6652bfe8b1d4f8779e792ac95c" category="list-text"><block ref="b60bfa6652bfe8b1d4f8779e792ac95c" category="inline-link-rx"></block></block>
  <block id="e3efa7d6ee6a48514d6cd7ff7795498f" category="list-text">Forneça as credenciais específicas do SVM ao administrador do vCenter que, em seguida, adicionará o SVM como um back-end de storage no menu de back-ends de storage de ferramentas do ONTAP no vCenter.</block>
  <block id="0abec471b6c51c227aee6d0b1708d228" category="list-text">É uma prática recomendada criar funções de RBAC para suas contas de storage.</block>
  <block id="e235f10d1a7bf30f3198a59ac049dc9c" category="list-text">As ferramentas do ONTAP incluem um arquivo JSON contendo as permissões de função necessárias necessárias necessárias para contas de armazenamento de ferramentas do ONTAP. Você pode fazer o upload do arquivo JSON para o Gerenciador de sistemas do ONTAP para simplificar a criação de funções e usuários do RBAC.</block>
  <block id="8ca4b3b11e162a34da542a63661edf9a" category="list-text">Você pode ler mais sobre as funções RBAC do ONTAP em<block ref="34ad13b9bdc1ec3d2d017144f37b1766" category="inline-link-rx"></block>.</block>
  <block id="e4f0d44befb2f792ce908178a949f26d" category="admonition">O motivo pelo qual todo o cluster precisa ser integrado na IU do Gerenciador de ferramentas do ONTAP é porque muitas das APIs usadas para vVols só estão disponíveis no nível do cluster.</block>
  <block id="90aa53fd267c0c35741d35381ad7a054" category="section-title">Criação de datastores vVols com as ferramentas do ONTAP</block>
  <block id="2899926e592e956d9ee50e9ac1a3fcc5" category="paragraph">Clique com o botão direito do Mouse no host, cluster ou datacenter no qual você deseja criar o datastore vVols e selecione _ONTAP Tools_ &gt; _provision datastore_.</block>
  <block id="893534fd72b00ed504664763cdcfc0a5" category="inline-image-macro">Função "Thumb" "provision datastore wizard",300</block>
  <block id="4a68f477edf1ea24da48b805acb7318c" category="paragraph"><block ref="4a68f477edf1ea24da48b805acb7318c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="20474b1a0c7edf7bd0809f2cb13dfe99" category="list-text">Escolha vVols e forneça um nome significativo e selecione o protocolo desejado. Você também pode fornecer uma descrição do datastore.</block>
  <block id="f4f44261c4e217310cb4f0bb2cc389f5" category="list-text">Ferramentas ONTAP 10,3 com ASA R2.</block>
  <block id="39a5735e417853a21c6d8ed53aa5cb1f" category="paragraph"><block ref="39a5735e417853a21c6d8ed53aa5cb1f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e332ae811243a2074f58eb5d5efdcc21" category="list-text">Selecione o SVM do sistema ASA R2 e clique em _next_.</block>
  <block id="dac9a06ae28c99c2bc00c2f1ca94c7ed" category="paragraph"><block ref="dac9a06ae28c99c2bc00c2f1ca94c7ed" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2b3dd72cbd7ce4cf79b8fe46700d45d5" category="list-text">Clique em _finish_</block>
  <block id="278f04f3dff2f303eed4edfbc836f534" category="paragraph"><block ref="278f04f3dff2f303eed4edfbc836f534" category="inline-image-macro-rx" type="image"></block></block>
  <block id="78195be4e07f2cf980cf70b78cfd4a62" category="list-text">É tão fácil!</block>
  <block id="ca8e7cc39790460719db057ff38e167d" category="list-text">Ferramentas ONTAP 10,3 com ONTAP FAS, AFF e ASA Prior ASA R2.</block>
  <block id="7f016940a12444f321c6a4251eb495cf" category="list-text">Selecione o protocolo</block>
  <block id="c3646108adeb4be26557fcbb99f62dc2" category="paragraph"><block ref="c3646108adeb4be26557fcbb99f62dc2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b0ec44dc6f9561dfdf58606f8e389753" category="list-text">Selecione o SVM e clique em _next_.</block>
  <block id="444c0ec9fa985ffe1e7a13b90ec73f1b" category="paragraph"><block ref="444c0ec9fa985ffe1e7a13b90ec73f1b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="75403559d3b552e859c244a233ae00ac" category="list-text">Clique em _adicionar novos volumes_ ou em _usar volume existente_ e especifique os atributos. Observe que nas ferramentas do ONTAP 10,3 você pode solicitar que vários volumes sejam criados ao mesmo tempo. Você também pode adicionar manualmente vários volumes para equilibrá-los no cluster do ONTAP. Clique em _next_</block>
  <block id="9a7e72607a6faad27d7fbe6e5f295675" category="paragraph"><block ref="9a7e72607a6faad27d7fbe6e5f295675" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4e1a38b50f0db11d407ccb112de6a782" category="paragraph"><block ref="4e1a38b50f0db11d407ccb112de6a782" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2037e6ffbfee1dde5dddbbca50cda2de" category="paragraph"><block ref="2037e6ffbfee1dde5dddbbca50cda2de" category="inline-image-macro-rx" type="image"></block></block>
  <block id="775c4cf447196b1d2af4bc4eb340eab0" category="list-text">Você pode ver os volumes atribuídos no menu Ferramentas do ONTAP da guia configurar para o datastore.</block>
  <block id="f16d549f88c459ef96e6cb1cfd5e5ad6" category="paragraph"><block ref="f16d549f88c459ef96e6cb1cfd5e5ad6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="66ded2ce50d43c22f8e56efe6053a76d" category="list-text">Agora você pode criar políticas de armazenamento de VM a partir do menu _políticas e Perfis_ na IU do vCenter.</block>
  <block id="fc7ec2dfcc40e5c7c47dca5758e10523" category="paragraph">A migração de VMs de datastores tradicionais para um datastore vVols é tão simples quanto mover VMs entre datastores tradicionais. Basta selecionar a(s) VM(s), depois selecionar migrar da lista de ações e selecionar um tipo de migração de _change storage only_. Quando solicitado, selecione uma política de armazenamento de VM que corresponda ao armazenamento de dados do vVols. As operações de cópia de migração podem ser descarregadas com o vSphere 6,0 e posterior para migrações SAN VMFS para vVols, mas não de VMDKs nas para vVols.</block>
  <block id="26fcc57b7c0de02dc9e8360d6f4b3493" category="paragraph">Para automatizar o provisionamento de storage com gerenciamento baseado em políticas, você precisa criar políticas de storage de VM que sejam mapeadas para as funcionalidades de storage desejadas.</block>
  <block id="8b8944ec0cef6dd0777b2144561987fe" category="admonition">As ferramentas do ONTAP 10,0 e posteriores não usam mais perfis de capacidade de armazenamento como as versões anteriores. Em vez disso, os recursos de storage são definidos diretamente na própria política de storage da VM.</block>
  <block id="0774b1717ce18129cd8e3ec0094e8640" category="paragraph">Uma vez criada a política de storage, ela pode ser usada ao provisionar novas VMs.</block>
  <block id="473e84e674f60e2fe619202a460efdfb" category="inline-image-macro">Criação de políticas de armazenamento de VM com ferramentas ONTAP Fornecedor VASA 9,10",300</block>
  <block id="e2f8ccc321215682fc34ae142633f3ff" category="paragraph"><block ref="b8f36bdf242d29fb6768827d6130494d" category="inline-image-macro-rx" type="image"></block> <block ref="e2501bb4f16d0f74914f04323d8e5e58" category="inline-image-macro-rx" type="image"></block> <block ref="166606e94a626af27852e00771133222" category="inline-image-macro-rx" type="image"></block> <block ref="8a14d5d27355a6630c7d65d859977eb8" category="inline-image-macro-rx" type="image"></block> <block ref="50b6bc69b9e417ba7f80bbcc0baaf57d" category="inline-image-macro-rx" type="image"></block> <block ref="8ec6614ba8e8947129dafaaede18ec39" category="inline-image-macro-rx" type="image"></block> <block ref="7bf707d7de5e0a048094c66368c89e52" category="inline-image-macro-rx" type="image"></block></block>
  <block id="71ea2d7b6b501372ec2ecc7846b5bd74" category="section-title">Gerenciamento de performance com ferramentas ONTAP</block>
  <block id="4357d652f2cfe6e15b6e8c54aacec10b" category="paragraph">As ferramentas da ONTAP usam seu próprio algoritmo de colocação equilibrada para colocar uma nova evolução no melhor FlexVol volume com sistemas ASA unificados ou clássicos, ou zona de disponibilidade de armazenamento (SAZ) com sistemas ASA R2, dentro de um datastore da vVols. O posicionamento é baseado na correspondência do armazenamento de backup com a política de armazenamento de VM. Isso garante que o armazenamento de dados e o armazenamento de backup possam atender aos requisitos de desempenho especificados.</block>
  <block id="97c380438d77f28866d8fca75c697d78" category="list-text">*IOPS mínimo e máximo* podem ser especificados em uma política de VM.</block>
  <block id="f980d0e57da48ae0fc9f45625e32cf7d" category="list-text">A alteração do IOPS na política não alterará a QoS nos vVols até que a Política de VM seja reaplicada às VMs que a usam. Ou você pode criar uma nova política com o IOPS desejado e aplicá-la às VMs de destino. Geralmente, é recomendável simplesmente definir políticas de storage de VM separadas para diferentes níveis de serviço e simplesmente alterar a política de storage de VM na VM.</block>
  <block id="6c47cd98201c31f6165c0239e8fa84b8" category="list-text">As personalidades ASA, ASA R2, AFF e FAS têm configurações diferentes de IOPs. Tanto o mínimo quanto o máximo estão disponíveis em sistemas all flash; no entanto, os sistemas que não sejam AFF só podem usar configurações de IOPs máximas.</block>
  <block id="6c2d6091dcb0d9df928f0dc687f86383" category="inline-image-macro">"Reaplicando a política de armazenamento de VM",300</block>
  <block id="8551dcdff381e3430606b1ff98a1e369" category="paragraph"><block ref="8551dcdff381e3430606b1ff98a1e369" category="inline-image-macro-rx" type="image"></block></block>
  <block id="def8fabb3f167c5ac05ad7f416c77a5c" category="paragraph">A chave para usar o vVols com o NetApp são as ferramentas do ONTAP para VMware vSphere, que servidores como a interface do provedor VASA (vSphere API for Storage Awareness) para os sistemas ONTAP 9 da NetApp.</block>
  <block id="e1688cfcbc1a78418422879cc779caf5" category="paragraph">As ferramentas do ONTAP também incluem extensões de IU do vCenter, serviços de API REST, adaptadores de replicação de armazenamento para VMware Site Recovery Manager / Live Site Recovery, ferramentas de monitoramento e configuração de host e uma série de relatórios que ajudam você a gerenciar melhor seu ambiente VMware.</block>
  <block id="3122b363be1cca4e9b79843907db549f" category="paragraph">Para clientes que usam o VMware Cloud Foundation com VSAN, o vVols pode ser adicionado a qualquer domínio de gerenciamento ou workload como storage complementar. O vVols se integra perfeitamente ao VSAN por meio de uma estrutura de gerenciamento comum baseada em políticas de storage.</block>
  <block id="adcd94c2ec3aa54fc9fbaa77544ccc10" category="paragraph">A próxima geração da família de versões do ONTAP Tools 10 moderniza os recursos anteriores com uma arquitetura escalável, em contentor, baseada em microsserviços, que é implementável através de um simples dispositivo de formato OVA no ESXi. O ONTAP Tools 10 combina todas as funcionalidades de três dispositivos e produtos antigos em uma única implantação. Para o gerenciamento do vVols, você usará as extensões intuitivas da IU do vCenter ou as APIs REST para as ferramentas do provedor VASA da ONTAP. Observe que o componente SRA é para datastores tradicionais; o VMware Site Recovery Manager não usa o SRA para vVols.</block>
  <block id="b87ac5af4acce876c9cb950c7c5a1891" category="section-title">Arquitetura do provedor VASA ao usar iSCSI ou FCP com sistemas unificados ONTAP</block>
  <block id="b566b0372bb84d18bc26fdc4c0fbd397" category="paragraph">Para novas instalações, implante o dispositivo virtual em seu ambiente vSphere. Depois de implantado, você pode fazer login na IU do gerente ou usar as APIS REST para escalar ou escalar sua implantação, vCenters integrados (isso Registra o plug-in com o vCenter), sistemas de armazenamento integrados e associar sistemas de storage aos seus vCenters. A integração de sistemas de storage na IU do Gerenciador de ferramentas do ONTAP e a associação de clusters com vCenters só é necessária se você planeja usar a alocação segura a vários clientes com SVMs dedicadas. Caso contrário, você pode simplesmente integrar o(s) cluster(s) de storage desejado(s) nas extensões de IU do ONTAP Tools vCenter ou usar as APIs REST.</block>
  <block id="26ffc687a7267f96a389530199971cd1" category="inline-link">Ferramentas do ONTAP para documentação do VMware vSphere</block>
  <block id="e8d49fe128837c5d33383898126449d6" category="paragraph">Consulte <block ref="d7e84668ac8db4130d4662ae6bde9c89" category="inline-link-macro-rx"></block>neste documento, ou<block ref="b9c3640cd3dcc39d23d49bf169dd367b" category="inline-link-rx"></block>.</block>
  <block id="2e2b8d8692ea57a5a089be51e49a3104" category="paragraph">A prática recomendada é armazenar suas ferramentas do ONTAP e dispositivos vCenter em datastores NFS ou VMFS tradicionais para evitar qualquer conflito de interdependência. Como as ferramentas do vCenter e do ONTAP precisam se comunicar entre si durante as operações do vVols, não instale nem mova os dispositivos de ferramentas do ONTAP ou os dispositivos do vCenter Server (VCSA) para o storage do vVols que estão gerenciando. Se isso acontecer, reinicializar os dispositivos de ferramentas do vCenter ou do ONTAP pode resultar em uma interrupção do acesso ao plano de controle e na incapacidade de inicializar o dispositivo.</block>
  <block id="d6776ddc59d905e2967855a8949b8ff0" category="inline-link">Ferramentas do ONTAP para VMware vSphere 10 - Downloads</block>
  <block id="e085c3225ffce6bb698ac8cf50cc0dc4" category="inline-link">Atualize das ferramentas do ONTAP para o VMware vSphere 10.x para o 10,3</block>
  <block id="e43b5fd407b2bc9fda1a39851a48f9bb" category="inline-link">Migrar das ferramentas do ONTAP para o VMware vSphere 9.x para o 10,3</block>
  <block id="8374c9fea191c7d2f4430555aa250de3" category="paragraph">Para dimensionar seu dispositivo virtual e entender os limites de configuração, consulte<block ref="d602e3cdd9623c66a90a3f53a55d967f" category="inline-link-rx"></block></block>
  <block id="eddf7820ea4e2a78603e1bff3aa3bbb6" category="paragraph"><block ref="eddf7820ea4e2a78603e1bff3aa3bbb6" category="inline-link-rx"></block></block>
  <block id="a4552c6e2a6c6188a04ffaf366c67ea5" category="list-text"><block ref="a4552c6e2a6c6188a04ffaf366c67ea5" category="inline-link-rx"></block></block>
  <block id="2bd2f3ded095498e9ee97f7cc9074dc0" category="inline-link">Visão geral das ferramentas do ONTAP para VMware vSphere</block>
  <block id="0e8f3f9d7644f28839e4eb573b4c2589" category="list-text"><block ref="0e8f3f9d7644f28839e4eb573b4c2589" category="inline-link-rx"></block></block>
  <block id="b832e56b13b2026b9c4d50d0f3f07904" category="list-text"><block ref="b832e56b13b2026b9c4d50d0f3f07904" category="inline-link-rx"></block></block>
  <block id="f0bc076dbe95da208c42e642105b0125" category="list-text"><block ref="f0bc076dbe95da208c42e642105b0125" category="inline-link-rx"></block></block>
  <block id="5245dc6f2a790bb421c841d2dfa17c0d" category="inline-link">Provisionar armazenamentos de dados</block>
  <block id="607bc4263c4e2c484eb0fbbfdc21b438" category="list-text"><block ref="607bc4263c4e2c484eb0fbbfdc21b438" category="inline-link-rx"></block></block>
  <block id="f5f3c80e03e60f2a58399685adcf6610" category="list-text"><block ref="f5f3c80e03e60f2a58399685adcf6610" category="inline-link-rx"></block></block>
  <block id="1608a10fc8319b14c6c50a77edab9e7c" category="inline-link">Modifique as configurações do host ESXi</block>
  <block id="1f4b95b02061cf146ca813dd68f240b5" category="list-text"><block ref="1f4b95b02061cf146ca813dd68f240b5" category="inline-link-rx"></block></block>
  <block id="952be4c4311cd0b3b105435f5c484336" category="inline-link">Configure o vSphere Metro Storage Cluster (vmsc) usando as ferramentas do ONTAP e a sincronização ativa do SnapMirror</block>
  <block id="4e22d6ab0229a29e7c9f041b1f4263a0" category="list-text"><block ref="4e22d6ab0229a29e7c9f041b1f4263a0" category="inline-link-rx"></block></block>
  <block id="c724784c65896d8b16350f4b0580dfd4" category="inline-link">Proteja máquinas virtuais</block>
  <block id="19ffdbf6d480a0097bf46b6fe379b412" category="list-text"><block ref="7970b8a3df0aeb298f96944db6f19225" category="inline-link-rx"></block> Com SRM</block>
  <block id="cb2b70161843498e22e97eb5f155009c" category="inline-link">Monitore clusters, armazenamentos de dados e máquinas virtuais</block>
  <block id="1f901bed9e91faa77a039d895d167c4b" category="list-text"><block ref="1f901bed9e91faa77a039d895d167c4b" category="inline-link-rx"></block></block>
  <block id="90d45c9fcbbcfdfcff766c447a16f73a" category="paragraph">O provedor VASA inclui um painel com informações de desempenho e capacidade para VMs vVols individuais. Essas informações são fornecidas diretamente do ONTAP para arquivos e LUNs da VEV, incluindo latência, IOPS, taxa de transferência e muito mais. Ele é habilitado por padrão ao usar todas as versões atualmente suportadas do ONTAP 9. Observe que, após a configuração inicial, os dados podem levar até 30 minutos para preencher o painel.</block>
  <block id="6861075c55e048882e2c055171a337b2" category="section-title">Outras práticas recomendadas</block>
  <block id="ce76fed6b9276669c61e2b0b85e8e767" category="paragraph">Em geral, o ONTAP oferece suporte aos limites do vVols conforme definido pela VMware (consulte publicado<block ref="a6efdd9b1a19df6105024b4869e0582b" category="inline-link-rx"></block>). Verifique sempre o<block ref="bb9c67b5a4c15a85b5e6aa6c9afd0285" category="inline-link-rx"></block> para obter limites atualizados sobre números e tamanhos de LUNs, namespaces e arquivos.</block>
  <block id="3729a48b517da427fd2d9807ebc0fed5" category="paragraph">*Marque sua malha Fibre Channel antes de usar FCP para vVols.*</block>
  <block id="f156d8db1f2ed380f0199266e583aa1b" category="paragraph">Para sistemas que não sejam ASA R2, pode ser desejável adicionar vários volumes de backup ao armazenamento de dados vVols para distribuir a carga de trabalho pelo cluster ONTAP, dar suporte a diferentes opções de política ou aumentar o número de LUNs ou arquivos permitidos. No entanto, se for necessária eficiência máxima de storage, coloque todos os volumes de backup em um único agregado. Ou, se for necessária a performance máxima de clonagem, considere usar um único FlexVol volume e manter seus modelos ou biblioteca de conteúdo no mesmo volume. O fornecedor VASA descarrega muitas operações de storage vVols para o ONTAP, incluindo migração, clonagem e snapshots. Quando isso é feito em um único FlexVol volume, clones de arquivo com uso eficiente de espaço são usados e ficam quase instantaneamente disponíveis. Quando isso é feito em volumes do FlexVol, as cópias ficam rapidamente disponíveis e usam deduplicação e compactação in-line, mas a eficiência máxima de storage não pode ser recuperada até que as tarefas em segundo plano sejam executadas em volumes usando deduplicação e compactação em segundo plano. Dependendo da origem e destino, alguma eficiência pode ser degradada.</block>
  <block id="256a688cc49c759f4698b8d5d1dd7b6a" category="paragraph">Com os sistemas ASA R2, essa complexidade é removida, pois o conceito de um volume ou agregado é abstraído do usuário. O posicionamento dinâmico é Tratado automaticamente e os endpoints do protocolo são criados conforme necessário. Endpoints de protocolo adicionais podem ser criados automaticamente em tempo real se for necessária uma escala adicional.</block>
  <block id="66a77b29a2cc0bdf1aa1bf8f6d4dac96" category="paragraph">*Certifique-se de ter LIFs de dados suficientes.* <block ref="d7e84668ac8db4130d4662ae6bde9c89" category="inline-link-macro-rx"></block>Consulte a .</block>
  <block id="b2dd36bd4918e00f8b2e15e6d62a4b94" category="section-title">Fornecedor VASA</block>
  <block id="0a4ba68e118d83e29ea66516a02f1b48" category="section-title">Ponto final do protocolo (PE)</block>
  <block id="974863a1395a284a680d09e18cf6c9cc" category="section-title">Ponto final do protocolo virtual (VPE)</block>
  <block id="8f13bfaaa8ba18765f4525a280f647cf" category="section-title">Armazenamento de dados de volume virtual</block>
  <block id="80c64f568dcf805b418e425957b8c975" category="paragraph">| o armazenamento de dados de volume virtual é uma representação lógica de armazenamento de dados de um contentor vVols que é criado e mantido por um provedor VASA. O contentor representa um pool de capacidade de armazenamento provisionado a partir de sistemas de armazenamento gerenciados pelo Fornecedor VASA. As ferramentas do ONTAP dão suporte à alocação de vários volumes FlexVol (chamados de volumes de backup) a um único datastore vVols. Esses datastores vVols podem abranger vários nós em um cluster ONTAP, combinando flash e sistemas híbridos com recursos diferentes. O administrador pode criar novos volumes do FlexVol usando o assistente de provisionamento ou a API REST, ou selecionar volumes FlexVol pré-criados para backup de storage, se estiverem disponíveis.</block>
  <block id="9f1893d8db5ceaf62726d1a0aa228224" category="section-title">Políticas de storage de VM</block>
  <block id="0aa8052a92097a4f8ec3114e7249a0e1" category="paragraph">As políticas de armazenamento de VM são criadas no vCenter em políticas e perfis. Para vVols, crie um conjunto de regras usando regras do provedor do tipo de storage do NetApp vVols. As ferramentas do ONTAP 10.X agora oferecem uma abordagem mais simples do que as ferramentas do ONTAP 9.X, permitindo que você especifique diretamente atributos de armazenamento na própria política de armazenamento de VM.</block>
  <block id="2efad47a2579a212fb659be8b8101b3c" category="paragraph">Uma vez que uma VM é provisionada, o Fornecedor VASA continuará a verificar a conformidade e alertará o administrador da VM com um alarme no vCenter quando o volume de backup não for mais compatível com a diretiva.</block>
  <block id="1bf63b567c68de7fcd78fcc89f42f93c" category="inline-link">Proteger usando a proteção do cluster de host</block>
  <block id="b6930b017bd126db888766f9750b206b" category="section-title">Configuração do VMware vSphere</block>
  <block id="2587ca69fa38fdcf84be76d7302e4e48" category="admonition">Nada neste documento substitui<block ref="0802e50581eb79c07178f36fed073afc" category="inline-link-rx"></block>. Este conteúdo é fornecido para fácil referência e não substitui a documentação oficial da VMware.</block>
  <block id="0daafa8f38daf57ac774520f73c6131b" category="section-title">Crie clusters de datastore, se necessário</block>
  <block id="5888812a5e670c1dc41279a5d93cc502" category="paragraph">*Ao usar o armazenamento ONTAP, é recomendável desativar o DRS de armazenamento.</block>
  <block id="f58d6a99824e61e497bca94714a3efef" category="list-text">O DRS de armazenamento geralmente não é necessário ou recomendado para uso com sistemas de armazenamento ONTAP.</block>
  <block id="8525b77695e58a3254731f53ce2b2162" category="list-text">O ONTAP oferece seus próprios recursos de eficiência de storage, como deduplicação, compressão e compactação, que podem ser afetados pelo Storage DRS.</block>
  <block id="c9a841ce409cdc722c7bdd080f0f88de" category="list-text">Se você estiver usando snapshots do ONTAP, o storage vMotion deixaria para trás a cópia da VM no snapshot, aumentando potencialmente a utilização do storage e pode afetar aplicativos de backup, como o NetApp SnapCenter, que rastreiam VMs e seus snapshots do ONTAP.</block>
  <block id="e5239709587bb3ebb34629be6c41ac7b" category="paragraph">As soluções vmsc são suportadas com o NetApp MetroCluster e o SnapMirror ative Sync (anteriormente conhecido como SnapMirror Business Continuity, ou SMBC) e fornecem continuidade de negócios avançada se um ou mais domínios de falha sofrerem uma interrupção total. A resiliência a diferentes modos de falha depende de quais opções de configuração você escolher.</block>
  <block id="5c6034b4452ec29d83cf38ddf5f9e2f6" category="paragraph">A arquitetura do ONTAP é uma plataforma de storage flexível e dimensionável que fornece serviços SAN (FCP, iSCSI e NVMe-of) e nas (NFS v3 e v4,1) para datastores. Os sistemas de storage NetApp AFF, ASA e FAS usam o sistema operacional ONTAP para oferecer protocolos adicionais para acesso ao storage convidado, como S3 e SMB/CIFS.</block>
  <block id="1e1566860cb6afbc338f9fba32c4e5e5" category="list-text">Sincronização ativa simétrica (ONTAP 9.15.1)</block>
  <block id="b9ca5ba97cf75d3dafb51f78e073770a" category="inline-link">Documentos do NetApp</block>
  <block id="1c71125ba0668792e46d93c17dc6c428" category="paragraph"><block ref="9ace5d3ebe2fe57037322de54ac9a869" category="inline-link-rx"></block>Consulte para obter informações específicas sobre design e implementação para sincronização ativa do SnapMirror.</block>
  <block id="c50c3de11b39aab15ac6b3b860691105" category="paragraph">O recurso VMware Storage DRS permite a agregação de armazenamentos de dados em uma única unidade e equilibra discos de máquina virtual quando os limites de controle de e/S de armazenamento (SIOC) são excedidos.</block>
  <block id="a6389705a0010980a83767268763aa53" category="sidebar">Volumes virtuais (vVols) com as ferramentas do ONTAP 10</block>
  <block id="d858ab232a556e2be473d51d09bc0c3d" category="sidebar">Lista de verificação da instalação das ferramentas do ONTAP</block>
  <block id="2e0a1393be1d4f990f277513b8384831" category="cell">Mantenha a predefinição (1) para obter mais informações, consulte <block ref="3b98534d1167689d42f2d1a533484036" category="inline-link-macro-rx"></block></block>
  <block id="79a22fb066bcc86a371f557f30051d43" category="inline-link">configure o zoneamento</block>
  <block id="b5d661217ddfecce129a41707ffa9fa9" category="list-text">Determine se você usará Fibre Channel (FC) para conectividade de storage. Em caso afirmativo, você<block ref="1ce5ae0107fd362eacaa4ef5b56c5d82" category="inline-link-rx"></block> precisará nos switches FC para habilitar a conectividade entre os hosts ESXi e os LIFs FC da SVM.</block>
  <block id="49e1b0dac188727de519431ac2068825" category="list-text">Solicite as seguintes informações de IP da sua equipe de rede. Os três primeiros endereços IP são necessários; os nós dois e três são usados para implantações de alta disponibilidade (HA) com escalabilidade horizontal. Registros de host DNS são necessários e todos os nomes de nós e todos os endereços devem estar na mesma VLAN e sub-rede.</block>
  <block id="7be8dd6dbcd142349f300df69f6a63d2" category="list-title"><block ref="beadfa85a2fdca06b91edc1131c603e6" category="inline-image-macro-rx" type="image"></block> Armazenamento</block>
  <block id="829d9899725b36358387edfa5df0e486" category="list-title"><block ref="99e8b2f00e172bfcff96afdce69907bc" category="inline-image-macro-rx" type="image"></block> Implante os ÓVULOS</block>
  <block id="2c63315a0e6899fa3f810f1b06553689" category="list-title"><block ref="ef78558f80439832e0f51cc22cee8b8c" category="inline-image-macro-rx" type="image"></block> Adicione vCenters às ferramentas do ONTAP</block>
  <block id="0547f403694814dca82327ab77f95205" category="list-title"><block ref="36915574c413876eaa75cbd48f69fd00" category="inline-image-macro-rx" type="image"></block> Adicione backends de armazenamento às ferramentas do ONTAP</block>
  <block id="5abf46747a299bb4d24d81d3a3f343aa" category="list-text"><block ref="40ea307f91b1c1591600230b15a0b728" category="inline-link-rx"></block> No Gerenciador de ferramentas do ONTAP e associá-las ao vCenters.</block>
  <block id="e69b3c58a2b1480f291387c690bf92b4" category="list-text"><block ref="9f5477aac946ec407262cd052d80864d" category="inline-link-rx"></block> Nas ferramentas do ONTAP vCenter UI.</block>
  <block id="9e80f1d38a7781fc49c6800d20337ec2" category="list-text"><block ref="40ea307f91b1c1591600230b15a0b728" category="inline-link-rx"></block> Diretamente nas ferramentas do ONTAP vCenter UI. Alternativamente, neste cenário, é possível adicionar SVMs diretamente quando não estiver utilizando vVols.</block>
  <block id="421bdf5be659af6d75aab31df92b7907" category="list-title"><block ref="430057c670c01688e904ed2ba129a0b5" category="inline-image-macro-rx" type="image"></block> Configurar serviços de dispositivo (opcional)</block>
  <block id="24db11216549ee55172c33cf3def2f3f" category="inline-image-macro">Nove</block>
  <block id="8a339db13a88428ad39d370cfdd1129a" category="list-title"><block ref="b37b448eff4f65237cf47b29bdd2817c" category="inline-image-macro-rx" type="image"></block> Certificados (opcional)</block>
  <block id="a185c3c138dca5ef46afc33288a67d1f" category="inline-image-macro">Dez</block>
  <block id="71fc21799db94f8cae72c8732659492c" category="list-title"><block ref="6097494f0af631df68e3dcb7a6da8d2a" category="inline-image-macro-rx" type="image"></block> Outras tarefas pós-implantação</block>
  <block id="93da9d9a3842b9e17ab9de43211bf697" category="paragraph"><block ref="0802e50581eb79c07178f36fed073afc" category="inline-link-rx"></block>Consulte para obter mais informações___.__</block>
  <block id="275507174f3ab21b1a65c1d5e8446001" category="paragraph">Você também deve se referir<block ref="0802e50581eb79c07178f36fed073afc" category="inline-link-rx"></block> a .</block>
  <block id="c44625cf01f743c720301c28e8461709" category="list-text">Note que este passo pode levar até 45 minutos para ser concluído</block>
  <block id="7747c50f7bb3ac05c39d999f8d5ce43e" category="list-text">Na etapa 3 da implantação DO OVA, selecione a opção "personalizar o hardware desta máquina virtual" e defina o seguinte na etapa 10:</block>
  <block id="a7510781f5c52d40e5706471809518f0" category="list-text">"Enable CPU Hot Add" (Ativar adição automática da CPU)</block>
  <block id="5b1ae3ca31ee580e9664ebf0949a302c" category="list-text">"Memory Hot Plug" (ficha quente da memória)</block>
  <block id="2cd9adcb9e8de7c58834011ca647797d" category="list-text"><block ref="4ccf4d83bac775854f5f0cfb549c6d86" category="inline-link-rx"></block> Usando o arquivo JSON incluído se não estiver usando admin.</block>
  <block id="067561a3b92d67321174249eb7de567d" category="paragraph">A NetApp começou a trabalhar com a VMware para oferecer suporte às APIs do vSphere for Storage Awareness (VASA) para o vSphere 5 em 2012. Este provedor VASA inicial permitiu a definição de recursos de armazenamento em um perfil que poderia ser usado para filtrar datastores ao provisionar e verificar a conformidade com a política posteriormente. Com o tempo, isso evoluiu para adicionar novos recursos para permitir mais automação no provisionamento, bem como adicionar volumes virtuais ou vVols, onde objetos de storage individuais são usados para arquivos de máquina virtual e discos virtuais. Esses objetos podem ser LUNs, arquivos e agora com os namespaces vSphere 8 - NVMe (usados com as ferramentas do ONTAP 9.13P2). A NetApp trabalhou em estreita colaboração com a VMware como parceiro de referência do vVols lançado com o vSphere 6 em 2015 e novamente como parceiro de design do vVols usando o NVMe sobre Fabrics no vSphere 8. A NetApp continua a aprimorar os vVols para aproveitar os recursos mais recentes do ONTAP.</block>
  <block id="e867f73e9a09d015c82be5c45264cda9" category="paragraph">VVols são os arquivos de máquina virtual e discos armazenados no datastore vVols. Usar o termo vVol (singular) está se referindo a um único arquivo específico, LUN ou namespace. O ONTAP cria namespaces, LUNs ou arquivos NVMe dependendo do protocolo que o armazenamento de dados usa. Existem vários tipos distintos de vVols; os mais comuns são Config (o único com VMFS nele, ele contém arquivos de metadados como o arquivo VMX da VM), dados (disco virtual ou VMDK) e Swap (criado quando a VM está ligada). VVols protegido pela criptografia VMware VM será do tipo outro. A criptografia de VM VMware não deve ser confundida com o volume ONTAP ou a criptografia agregada.</block>
  <block id="f615a85ee8b4ffd3bdd64ab72c2cf934" category="paragraph">Como mencionado acima, o uso de políticas pode ajudar a simplificar a tarefa de provisionar uma VM ou VMDK. Basta selecionar uma política apropriada e o Fornecedor VASA mostrará os datastores da vols que suportam essa política e colocam a evolução em um FlexVol volume individual que esteja em conformidade.</block>
  <block id="d5938f26039c87ff0b18251b9b89e0ec" category="list-text">Os clones são rapidamente criados em um único volume ou em vários volumes em um cluster do ONTAP, o que é uma vantagem em comparação com os clones habilitados para VAAI tradicionais. Eles também são eficientes em storage. Os clones dentro de um volume usam o clone de arquivo ONTAP, que são como os volumes do FlexClone e armazenam somente alterações do arquivo VVol/LUN/namespace de origem. Assim, as VMs de longo prazo para produção ou outras aplicações são criadas rapidamente, ocupam o mínimo de espaço e podem se beneficiar da proteção no nível da VM (usando o plug-in NetApp SnapCenter para VMware vSphere, snapshots gerenciados VMware ou backup VADP) e do gerenciamento de performance (com QoS ONTAP). Clones de volume cruzado são muito mais rápidos com vVols do que com VAAI becuase com VASA, podemos criar o clone e permitir o acesso ao mesmo no destino antes que a cópia seja concluída. Os blocos de dados são copiados como um processo em segundo plano para preencher as evoluções de destino. Isso é semelhante à maneira como a movimentação de LUN sem interrupções do ONTAP funciona para LUNs tradicionais.</block>
  <block id="5c2620ed6abb266a7824246fc409e405" category="admonition">Se um volume for provisionado de forma grossa, deve-se ter cuidado para desativar completamente todos os recursos de eficiência para esse volume, incluindo descompressão e remoção de deduplicação usando<block ref="3cfeff511a11b8c5f54ce9749a719a58" prefix=" " category="inline-code"></block> o comando. O volume não deve aparecer<block ref="df899f2d908ec33afe1d01ee26b3dd47" prefix=" " category="inline-code"></block> na saída. Se isso acontecer, o volume ainda será parcialmente configurado para recursos de eficiência. Como resultado, as garantias de substituição funcionam de forma diferente, o que aumenta a chance de que a configuração seja ultrapassada fazendo com que o volume fique inesperadamente sem espaço, resultando em erros de e/S do banco de dados.</block>
  <block id="d276d666f03c049a59433c8727efaa6e" category="paragraph">Em ambientes Linux, crie grupos de volume lógicos em todo o dispositivo de unidade. Quando uma partição for necessária, verifique o alinhamento executando<block ref="ab425294b9ef9f9c8acbc3f08f92b37d" prefix=" " category="inline-code"></block> e verificando se o início de cada partição é um múltiplo de oito. Isso significa que a partição começa em um múltiplo de oito setores de 512 bytes, que é 4KB.</block>
  <block id="e23f5b5639a79ab22ace94b51b47872d" category="paragraph"><block ref="e23f5b5639a79ab22ace94b51b47872d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="39e45e79eb595c951cff8267572302f1" category="inline-image-macro">Configuração do SyncMirror</block>
  <block id="8c91b2538377a2c3400ec4694ba15e2e" category="paragraph"><block ref="8c91b2538377a2c3400ec4694ba15e2e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="073b52a996437eabf93f7783b02e2fe9" category="paragraph"><block ref="fe3ee14511b9b1e5dfd5af1f82ac3216" category="inline-link-macro-rx"></block>O software pode ser executado em um terceiro local para monitorar a integridade do ambiente MetroCluster, enviar notificações e, opcionalmente, forçar um switchover em uma situação de desastre. Uma descrição completa do desempate pode ser encontrada no <block ref="2acc94a061be1196588f7f734d193bf6" category="inline-link-macro-rx"></block>, mas o principal objetivo do desempate do MetroCluster é detetar a perda do local. Ele também deve discriminar entre a perda do local e a perda de conetividade. Por exemplo, o switchover não deve ocorrer porque o tiebreaker não conseguiu chegar ao local principal, e é por isso que o tiebreaker também monitora a capacidade do local remoto de entrar em Contato com o local principal.</block>
  <block id="007bfe897ab1dfc6713daff4c13130e2" category="admonition">O software MCTB não verifica se o NVRAM estava e/ou os plexos estão em sincronia ao forçar um switchover. O switchover automático, se configurado, deve ser desativado durante atividades de manutenção que resultem na perda de sincronização para NVRAM ou SyncMirror plexes.</block>
  <block id="d5e917df8e0b7f1db3996ead2cbeb2ac" category="paragraph">O Mediador ONTAP é usado com MetroCluster IP e outras soluções ONTAP. Ele funciona como um serviço de desempate tradicional, assim como o software de desempate do MetroCluster discutido acima, mas também inclui um recurso crítico: Executar o switchover automatizado sem supervisão.</block>
  <block id="bf74d7de09985a8ef553e5122b5d0f7c" category="inline-image-macro">ClusterLion diagrama</block>
  <block id="0354d54d7a567ab0e86cd8a04f4919a1" category="paragraph"><block ref="0354d54d7a567ab0e86cd8a04f4919a1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0db380344593268d0331dffbd0e53491" category="inline-image-macro">Arquitetura IP do MetroCluster</block>
  <block id="207f169ffa50efdada53e61e95be500f" category="paragraph"><block ref="207f169ffa50efdada53e61e95be500f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d012707a79628e35e35aa78aae04ba03" category="inline-image-macro">MetroCluster de quatro nós</block>
  <block id="d2d10d2707ff9930a55b8735ba28ca8b" category="paragraph"><block ref="d2d10d2707ff9930a55b8735ba28ca8b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f76fa4fd08c3d58e5591281c16d5c61b" category="inline-image-macro">MetroCluster de dois nós</block>
  <block id="4cc7f7e2eae466068330e3136b2e786f" category="paragraph"><block ref="4cc7f7e2eae466068330e3136b2e786f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="57d3154f4afcd986d4f30b4e06c1c434" category="paragraph">Um volume flexível ONTAP, ou mais simplesmente, um volume não é sinônimo de LUN. Os volumes são contêineres de gerenciamento de dados, como arquivos ou LUNs. Por exemplo, um banco de dados pode ser colocado em um conjunto de distribuição de 8 LUN, com todos os LUNs contidos em um único volume.</block>
  <block id="05ef9b22209f0e35efc9b6f875ad3c55" category="inline-link-macro">Documentação do ONTAP.</block>
  <block id="a9f5ed6c3fb24e75b9bbfde2801f43c5" category="paragraph">Para obter mais informações sobre instantâneos, consulte a. <block ref="8f47a9b0ccec19c7f5d940ab138ea0b4" category="inline-link-macro-rx"></block></block>
  <block id="7509bd2cfd7821f433d962315cc50a57" category="paragraph">A partir do ONTAP 9.12.1, os instantâneos não são apenas de leitura, mas também podem ser protegidos contra exclusões acidentais ou intencionais. O recurso é chamado de instantâneos à prova de violações. Um período de retenção pode ser definido e aplicado por meio da política de snapshot. Os instantâneos resultantes não podem ser eliminados até que tenham atingido a data de validade. Não há substituições administrativas ou do centro de suporte.</block>
  <block id="287130f9ebd13d6ed68dd04d8d2a295e" category="admonition">Os snapshots à prova de violações não podem ser dispostos em camadas usando o pool de malha.</block>
  <block id="c2f55c662895ff4fac4100a2a0852e43" category="paragraph">Para obter mais informações sobre instantâneos à prova de violações, consulte a. <block ref="fd5bfd16d2f3d4d67a500529a5ee8cad" category="inline-link-macro-rx"></block></block>
  <block id="be7dc70d98bcb6099a5c94c0eb263502" category="paragraph">Os instantâneos também podem ser replicados para um sistema remoto. Isso inclui instantâneos à prova de violações, onde o período de retenção é aplicado e aplicado no sistema remoto. O resultado são os mesmos benefícios de proteção de dados que os snapshots locais, mas eles ficam em um segundo storage array. Isso garante que a destruição do array original não comprometa os backups.</block>
  <block id="170814cc5599dd2691018c487b6c756b" category="paragraph">Para obter mais informações sobre o SnapMirror, consulte a. <block ref="3a921b7bc4d1ecfb45f8d64003b59241" category="inline-link-macro-rx"></block></block>
  <block id="f1e054edf08e67911f64f3d6bc85055c" category="paragraph">Um sistema de armazenamento ONTAP recém-configurado é semelhante a um servidor VMware ESX recém-provisionado porque nenhum deles pode suportar qualquer usuário até que uma máquina virtual seja criada. Com o ONTAP, você cria uma máquina virtual de storage (SVM) que se torna a unidade mais básica de gerenciamento de storage. Cada SVM tem seus próprios recursos de storage, configurações de protocolo, endereços IP e WWNs FCP. Esta é a base da alocação a vários clientes da ONTAP.</block>
  <block id="9f531561663c2d70601e59d0a2a97e22" category="paragraph">Para obter mais informações sobre SVMs, consulte a. <block ref="49f63552efbf93d6a834173c0aa523ad" category="inline-link-macro-rx"></block></block>
  <block id="7995495e3afeef685b0a0bcf51360d6c" category="paragraph">Para obter mais informações sobre o controle de acesso administrativo, consulte <block ref="a0740fbcbe9ba6690a7ab99ab89cd2c9" category="inline-link-macro-rx"></block></block>
  <block id="19fd31cbf45473230fbcebf8392cc91e" category="section-title">Autenticação de vários fatores (MFA)</block>
  <block id="96654aef2c50a23153b1537b5229776f" category="paragraph">Para obter mais informações sobre autenticação multifator (MFA), consulte a. <block ref="1786169af27633b737f29186948225e1" category="inline-link-macro-rx"></block></block>
  <block id="e888b1b74bec5238c3c604159ac1d53a" category="paragraph">Para obter mais informações sobre API RBAC, consulte <block ref="e61ba9faf8dbe169378ea875c9b479b4" category="inline-link-macro-rx"></block></block>
  <block id="6e09a67fb21def2cb508cbfe0d7c0794" category="paragraph">Para obter mais informações sobre a verificação multi-admin (MAV), consulte <block ref="88147b7c4319c7463e1de20879284ceb" category="inline-link-macro-rx"></block></block>
  <block id="d682e5055f8368ad42d44e0de5e75ed3" category="inline-image-macro">Operações normais de sincronização ativa do SnapMirror</block>
  <block id="a61d348ee21d7fdf1a9da822a79df846" category="paragraph"><block ref="a61d348ee21d7fdf1a9da822a79df846" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3fe281f607d85b52408e82cb2d7aef71" category="inline-image-macro">Falha na sincronização ativa do SnapMirror</block>
  <block id="c5ff28a15762db1ce9589bc45fe42a83" category="paragraph"><block ref="c5ff28a15762db1ce9589bc45fe42a83" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a98433bfbc9755650778888be2e155c8" category="inline-image-macro">Failover de sincronização ativa do SnapMirror</block>
  <block id="5fe2be834f0686a9a02a2872ecb20f91" category="paragraph"><block ref="5fe2be834f0686a9a02a2872ecb20f91" category="inline-image-macro-rx" type="image"></block></block>
  <block id="40685542fb725d5516910c5721538340" category="inline-image-macro">Reparação de sincronização ativa do SnapMirror</block>
  <block id="67e60a13c39559320bab1f6f456824d0" category="paragraph"><block ref="67e60a13c39559320bab1f6f456824d0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="217536ed57b639cdf05f688cf8ddaca1" category="inline-image-macro">Failback da sincronização ativa do SnapMirror</block>
  <block id="362b862a6b72622be34b2904dcbf413b" category="paragraph"><block ref="362b862a6b72622be34b2904dcbf413b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f060f17ec7a3fc2a182a4759545d4cb3" category="paragraph"><block ref="f060f17ec7a3fc2a182a4759545d4cb3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3d25a1eebebf538e68ea79a21fdeb31c" category="paragraph"><block ref="3d25a1eebebf538e68ea79a21fdeb31c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1cf9d22584fea5a10f4ed164a871a45f" category="paragraph"><block ref="1cf9d22584fea5a10f4ed164a871a45f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4be3d396256a7548ce446a9a03183122" category="paragraph"><block ref="4be3d396256a7548ce446a9a03183122" category="inline-image-macro-rx" type="image"></block></block>
  <block id="05933557921f3e80d9d78fff7d9532d6" category="paragraph"><block ref="05933557921f3e80d9d78fff7d9532d6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2a5e066e529edd11b35f46c161170620" category="paragraph">Em contraste, um aplicativo em cluster, como o Oracle RAC, pode fornecer um serviço que está disponível simultaneamente em dois locais diferentes. Perder um site não significa perda do serviço do aplicativo como um todo. As instâncias ainda estão disponíveis e em execução no local sobrevivente.</block>
  <block id="d629eadf33041c24ee81c3752a895f8d" category="paragraph"><block ref="d629eadf33041c24ee81c3752a895f8d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="267017761cb9de7ce4e0ea9f0e078628" category="paragraph"><block ref="267017761cb9de7ce4e0ea9f0e078628" category="inline-image-macro-rx" type="image"></block></block>
  <block id="fd994146b555ce2a39038a16098a6e3e" category="list-text"><block ref="9df22f196a33acd0b372fe502de51211" prefix="" category="inline-code"></block>- apenas recuperar dados lidos aleatoriamente</block>
  <block id="0c65a737281c49235c3058020e81f7b9" category="list-text"><block ref="8805d416ce540c5f2df34af5b18d742b" prefix="" category="inline-code"></block>- recuperar todos os dados de leitura sequencial ou aleatória</block>
  <block id="deea309eeb62f907bfa37ca436857255" category="list-text"><block ref="334c4a4c42fdb79d7ebc3e73b517e6f8" prefix="" category="inline-code"></block>- recuperar todos os dados de leitura sequencial ou aleatória</block>
  <block id="c4216ce97dadec9cf3de76609a5a07de" category="list-text"><block ref="a181a603769c1f98ad927e7367c7aa51" prefix="" category="inline-code"></block>- não recupere dados do nível de capacidade</block>
  <block id="47f64097ec44c9f18f4025941f2e4436" category="inline-image-macro">Disposição em camadas do FabricPool</block>
  <block id="0a5778c8b17c5df28190c8f022c4e11a" category="paragraph"><block ref="0a5778c8b17c5df28190c8f022c4e11a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e6edcd80dc55ce70fb5c4fa1c13c9bc6" category="section-title">Hyper-Threading</block>
  <block id="7e4c522ec8e0c58e24f493765888ed54" category="paragraph">O Hyper-Threading refere-se à implementação simultânea de multithreading (SMT), o que melhora a paralelização dos cálculos realizados em processadores x86. SMT está disponível em ambos os processadores Intel e AMD.</block>
  <block id="4114d233d42e1381db8a36ed5a76930b" category="paragraph">O Hyper-Threading resulta em CPUs lógicas que aparecem como CPUs físicas para o sistema operacional. O SQL Server então vê essas CPUs adicionais e as usa como se houvesse mais núcleos do que fisicamente presentes. Isso pode melhorar substancialmente o desempenho aumentando a paralelização.</block>
  <block id="fbb6d18b081bfa69df40139eb4b0213b" category="inline-image-macro">Mensagem de log do SQL Server</block>
  <block id="d78202a5fb91002bb31924c80636beee" category="paragraph"><block ref="d78202a5fb91002bb31924c80636beee" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8f2b07811863589142fb500958a93aef" category="paragraph">Embora isso seja útil para consultas grandes, pode causar problemas de desempenho e limitar a simultaneidade. Uma melhor abordagem é limitar o paralelismo ao número de núcleos físicos em um único soquete de CPU. Por exemplo, em um servidor com dois soquetes físicos de CPU com 12 núcleos por soquete, independentemente do Hyper-Threading,<block ref="1abedc5f6ab369ab9fcd16d6b7990638" prefix=" " category="inline-code"></block> deve ser definido como 12.<block ref="1abedc5f6ab369ab9fcd16d6b7990638" prefix=" " category="inline-code"></block> Não é possível restringir ou ditar qual CPU deve ser usada. Em vez disso, ele restringe o número de CPUs que podem ser usadas por uma única consulta em lote.</block>
  <block id="2bcdfd16d227f0659d58f9c368f92311" category="inline-link-macro">Configure a opção de configuração do servidor Max worker threads</block>
  <block id="784d03ae991a0cc4ef7f8b5318d0643e" category="paragraph">Quando você deve configurar o SQL Server para usar mais threads de trabalho? Se o comprimento médio da fila de trabalho para cada agendador for superior a 1, você pode se beneficiar da adição de mais threads ao sistema, mas somente se a carga não estiver ligada à CPU ou tiver outras esperas pesadas. Se qualquer uma dessas situações estiver acontecendo, adicionar mais threads não ajuda porque acabam esperando outros gargalos do sistema. Para obter mais informações sobre threads de trabalho máximo, <block ref="516f4431a9f331f442450f80b5638a9d" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="a5ee78f6f06a355d893076bd00799f33" category="inline-image-macro">MAX worker threads</block>
  <block id="06a7934dd21e03f634b6cd9fc8dfafd5" category="paragraph"><block ref="06a7934dd21e03f634b6cd9fc8dfafd5" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c7acc2cdcff9c9156a99e4f37871f0b3" category="searchtitle">Proteção de bancos de dados Microsoft SQL Server no ONTAP com comandos SnapCenter e T-SQL</block>
  <block id="d56a13248537a908d7fb7730827a3ea8" category="paragraph">Proteger um ambiente de banco de dados do SQL Server é um esforço multidimensional que vai além do gerenciamento do próprio banco de dados. O ONTAP oferece vários recursos exclusivos projetados para proteger o aspeto de armazenamento de sua infraestrutura de banco de dados.</block>
  <block id="1fdd8a4c4832d13ddabbb02c424cf87d" category="paragraph">Se os volumes, sistemas de arquivos e bancos de dados virtualizados que hospedam bancos de dados não estiverem em uso no local de recuperação de desastres antes do switchover, não há nenhum requisito para definir<block ref="a2626552f293b2377efe829e69d14daa" prefix=" " category="inline-code"></block> os volumes associados.</block>
  <block id="358f73eb3e0830400b47b849dd1ff244" category="summary">Microsoft SQL Server e o Mediador ONTAP</block>
  <block id="d7b47db08dce16a62f9ea97613e8f704" category="paragraph">O Mediator é necessário para automatizar com segurança o failover. Idealmente, ele seria colocado em um local 3rd independente, mas ainda pode funcionar para a maioria das necessidades se colocasse em um dos clusters que participam da replicação.</block>
  <block id="f9619e52c7cdde4c0b1a97530a47dd35" category="section-title">Arquitetura de sincronização ativa do SnapMirror com ativo-ativo simétrico</block>
  <block id="19faeb7ab81d5f28227fc1778d55ff90" category="inline-image-macro">Arquitetura de sincronização ativa do SnapMirror</block>
  <block id="133eca4b24d6c05606859c2288c8ac7f" category="paragraph"><block ref="133eca4b24d6c05606859c2288c8ac7f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="441756ba9f536a754940c70c53cb3b13" category="paragraph">**Mediador ONTAP**</block>
  <block id="b41efcb6893de373f77e07be9a8e0d32" category="paragraph"><block ref="b41efcb6893de373f77e07be9a8e0d32" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f830e7995cd120ac203db751bdb1174b" category="paragraph">A NetApp oferece o Astra Trident para fornecer funcionalidades avançadas de gerenciamento de storage. Por exemplo, o Astra Trident permite que um contêiner criado no Kubernetes provisione automaticamente seu storage na camada apropriada, aplique políticas de exportação, defina políticas de snapshot e até clone um contêiner para outro. Para obter informações adicionais, consulte o <block ref="d243cca937364184efa824b0525b876a" category="inline-link-macro-rx"></block>.</block>
  <block id="e5f3f995b3e054f0d6bfdd13c3597e2c" category="paragraph"><block ref="e5f3f995b3e054f0d6bfdd13c3597e2c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9b87cb3e85b59ad2d04537560673f94b" category="inline-image-macro">Tipos de e/S.</block>
  <block id="977d1017b39374152ac0d18ac3267ca2" category="paragraph"><block ref="977d1017b39374152ac0d18ac3267ca2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="77ea00d93c10244a077ab55be57f5c28" category="admonition">Você pode prejudicar seriamente o desempenho definindo este parâmetro ou o parâmetro innodb_io_Capacity_Max muito alto e wastin</block>
  <block id="04a3449528520ec35e2bce9c433ee1a4" category="admonition">Na nova plataforma ASA, replique snapshots para cluster remoto usando a política _Vault_ e bloqueie o destino para fazer snapshots à prova de violações.</block>
  <block id="c1a5c6240b77f4bda50ebb9ea018010b" category="paragraph"><block ref="c1a5c6240b77f4bda50ebb9ea018010b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a1fb4e9793df0c2c759586b0d4cc9a59" category="inline-link-macro">Limites de capacidade de computação por edição do SQL Server</block>
  <block id="c637f2ccb4ed04efecb5d430f9b8e9fa" category="paragraph">A ressalva aqui é que cada versão do SQL Server tem suas próprias limitações sobre o poder de computação que pode usar. Para obter mais informações, <block ref="5f7d6b9101e39b0f89ce2a4419443b58" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="027202a07b43ba49311d98b7812a6c84" category="searchtitle">Proteção de dados do Microsoft SQL Server com o software de gerenciamento NetApp</block>
  <block id="a6612611980ab8001eb37d9b0d21fc8b" category="list-text">Execute snapshots de vários bancos de dados nas unidades de armazenamento simultaneamente com os novos comandos DO GRUPO DE backup e DO SERVIDOR DE BACKUP.</block>
  <block id="0dedd2c3e15900b4f533838e17976dab" category="list-text">Se a carga de trabalho do banco de dados for expandida em várias unidades de armazenamento, crie grupos de consistência para simplificar a tarefa de gerenciamento. O grupo de consistência é um conjunto de unidades de armazenamento que são gerenciadas como uma única unidade.</block>
  <block id="7f9d52f3748a3a0f2854076ed4952d80" category="admonition">*A NetApp recomenda* usar o SnapCenter para criar cópias Snapshot. O método T-SQL descrito acima também funciona, mas o SnapCenter oferece automação completa no processo de backup, restauração e clonagem. Ele também executa a descoberta para garantir que os snapshots corretos estejam sendo criados.</block>
  <block id="e158a020500bd25736fbcb79dbd57ef0" category="admonition">Use o SnapCenter se os bancos de dados do SQL Server estiverem hospedados em disco virtual em execução em um ambiente virtualizado VMware. Caso os bancos de dados estejam hospedados no servidor físico bare metal ou no SCSI Guest-connect, em seguida, faça backup do banco de dados usando o comando T-SQL snapshot.</block>
  <block id="19f005706f432809f0c867f9d97c05b0" category="admonition">*A NetApp recomenda* usar o SnapCenter para criar cópias Snapshot. O método T-SQL descrito acima também funciona, mas o SnapCenter oferece automação completa no processo de backup, restauração e clonagem. Ele também executa a descoberta para garantir que os snapshots corretos estejam sendo criados. Não é necessária pré-configuração.</block>
  <block id="88db39456c39e1de4d937d721ec1f2fc" category="doc">Ficheiros da base de dados e grupo de ficheiros</block>
  <block id="2bcb2e2e60d655aca12a6062bc99f69c" category="section-title">Inicialização do arquivo de instância do banco de dados</block>
  <block id="44f4b94c8c1ceb120fb9fb9a843fbc0b" category="paragraph">O recurso de replicação de grupo de disponibilidade contínua do SQL Server pode ser uma excelente opção, e o NetApp oferece opções para integrar a proteção de dados sempre ativa. Em alguns casos, no entanto, você pode querer considerar a tecnologia de replicação do ONTAP usando as seguintes opções.</block>
  <block id="5698ceeb808e1afe078605b6dbb0a4cb" category="paragraph">A tecnologia SnapMirror oferece uma solução empresarial rápida e flexível para replicação de dados em LANs e WANs. A tecnologia SnapMirror transfere apenas blocos de dados alterados para o destino após a criação do espelhamento inicial, reduzindo significativamente os requisitos de largura de banda da rede. Ele pode ser configurado em modo síncrono ou assíncrono. A replicação síncrona do SnapMirror no NetApp ASA é configurada usando a sincronização ativa do SnapMirror.</block>
  <block id="8d4bad202645c8ab15f054b63fe34160" category="paragraph">Para muitos clientes, a continuidade dos negócios exige mais do que apenas possuir uma cópia remota de dados. Para isso, ela exige a capacidade de usar rapidamente esses dados, o que é possível no NetApp ONTAP usando a sincronização ativa do SnapMirror</block>
  <block id="07b431b6fdd20fcb79eababc436bc39b" category="paragraph">Com o SnapMirror active Sync, você tem essencialmente dois sistemas ONTAP diferentes que mantêm cópias independentes dos seus dados LUN, mas cooperam para apresentar uma única instância desse LUN. Do ponto de vista do host, é uma única entidade LUN. A sincronização ativa do SnapMirror é suportada para LUN baseado em iSCSI/FC.</block>
  <block id="2ae812ab75c34451d9dd11549d394f2a" category="paragraph">O SnapMirror active Sync pode fornecer replicação RPO igual a 0 e é fácil de implementar entre dois clusters independentes. Assim que as duas cópias de dados estiverem sincronizadas, os dois clusters só precisam espelhar gravações. Quando ocorre uma gravação em um cluster, ela é replicada para o outro cluster. A gravação só é reconhecida para o host quando a gravação for concluída em ambos os sites. Além desse comportamento de divisão de protocolo, os dois clusters são, de outra forma, clusters ONTAP normais.</block>
  <block id="1848ac209b4ee9b7c68bbc4a1711a45d" category="paragraph">Outro importante caso de uso para SM-as é para operações ativas-ativas, em que você deseja que cópias totalmente utilizáveis de dados estejam disponíveis em dois clusters diferentes localizados em dois locais diferentes com características de desempenho idênticas e, se desejado, não é necessário estender a SAN entre locais. Você pode ter suas aplicações já em execução em ambos os locais, contanto que a aplicação seja compatível, o que reduz o rto geral durante operações de failover.</block>
  <block id="bdd8b094b65ec8544e0ad9724a1984ad" category="searchtitle">Failover de sincronização ativa do Microsoft SQL Server e do SnapMirror</block>
  <block id="3fc36a3b35bb877723ed17d69c3d57fb" category="summary">Microsoft SQL Server e o mediador do ONTAP</block>
  <block id="b029689b71622a39b3564f8800798f34" category="paragraph"><block ref="b029689b71622a39b3564f8800798f34" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5a2e2e33df9734d8ef57bcb93643d89a" category="paragraph">Em contraste, um aplicativo em cluster, como o Oracle RAC, pode fornecer um serviço que está disponível simultaneamente em dois locais diferentes. Perder um site não significa perda do serviço do aplicativo como um todo. As instâncias ainda estão disponíveis e em execução no local sobrevivente.</block>
  <block id="a87e788e43169f3df56a7eee4e9bd79c" category="searchtitle">SQL Server e SnapMirror sincronização ativa</block>
  <block id="5181c0b41b072fc878e6ffdb78976292" category="paragraph">O SnapMirror active Sync é compatível com arquitetura ativo-ativo simétrica que fornece replicação bidirecional síncrona para continuidade dos negócios e recuperação de desastres. Ele ajuda você a proteger o acesso a dados para workloads SAN críticos com acesso de leitura e gravação simultâneos a dados em vários domínios de falha, garantindo operações ininterruptas e minimizando o tempo de inatividade durante desastres ou falhas do sistema.</block>
  <block id="3fa280b2a8840046be265109ff9f0696" category="section-title">Arquitetura do SnapMirror ativo com ativo-ativo simétrico</block>
  <block id="a93a13dd139e6bb0629cd0ace446c595" category="paragraph"><block ref="a93a13dd139e6bb0629cd0ace446c595" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c2048364072b2c53688aeb273047e068" category="paragraph">**Mediador ONTAP**</block>
  <block id="309d61d5c343d8fd53c2c585c64587b6" category="searchtitle">Microsoft SQL Server com sincronização ativa do SnapMirror</block>
  <block id="c3764435b077d7aa876e89575fe5dd64" category="paragraph"><block ref="c3764435b077d7aa876e89575fe5dd64" category="inline-image-macro-rx" type="image"></block></block>
  <block id="335b6de9aebdde6ff1e76f9688ff7ff7" category="paragraph"><block ref="335b6de9aebdde6ff1e76f9688ff7ff7" category="inline-image-macro-rx" type="image"></block></block>
  <block id="481a499afea5f44d3d3173e0504a6ee5" category="paragraph">Com acesso uniforme, o IO estaria atravessando a WAN. É um cluster de rede de malha completa e isso pode ou não ser desejável para todos os casos de uso.</block>
  <block id="e7de94b63ec3b4535a16228dd6f49119" category="paragraph">Se os dois locais estivessem a 100 metros de distância com conetividade de fibra, não deveria haver latência adicional detetável cruzando a WAN, mas se os locais estivessem a uma distância longa, então o desempenho de leitura sofreria em ambos os locais. O ASA com rede de acesso não uniforme seria uma opção para obter os benefícios de custo e recursos do ASA sem incorrer em uma penalidade de acesso à latência entre sites ou usar o recurso de proximidade do host para permitir acesso local de leitura/gravação para ambos os sites.</block>
  <block id="cb2187a7d951edc5247ba9c129fee8f3" category="paragraph">Os caminhos aparecerão como mostrado abaixo quando a proximidade do host for configurada.</block>
  <block id="277d64d9a84f721cc341e91f0de1dcae" category="inline-image-macro">SnapMirror ative Sync ASA rede uniforme com proximidade</block>
  <block id="7ee14065ea840a8b3d77ca1b09cd0d68" category="paragraph"><block ref="7ee14065ea840a8b3d77ca1b09cd0d68" category="inline-image-macro-rx" type="image"></block></block>
  <block id="988f5836c7a60d1374a4804da23d51e4" category="paragraph"><block ref="988f5836c7a60d1374a4804da23d51e4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b7986b8213ecdd63004689cc2dedb163" category="searchtitle">Recuperação de desastres do Microsoft SQL Server com o SnapMirror</block>
  <block id="f10483e265b11816545d508fc76923ed" category="list-text">Use a replicação síncrona com o SnapMirror active Sync, onde a demanda por recuperação rápida de dados é maior e soluções assíncronas para flexibilidade no RPO.</block>
  <block id="76deb86c7bf1ea33d737ef060d9ffff6" category="list-text">Se você estiver usando o SnapCenter para fazer backup de bancos de dados e replicar snapshots para um cluster remoto, não programe atualizações do SnapMirror dos controladores para fins de consistência. Em vez disso, ative as atualizações do SnapMirror do SnapCenter para atualizar o SnapMirror após a conclusão da cópia de segurança completa ou de registo.</block>
  <block id="ad2a53b49c8e7cc0e22f4346908a1866" category="list-text">Equilibre as unidades de storage que contêm dados do SQL Server entre diferentes nós no cluster para permitir que todos os nós de cluster compartilhem a atividade de replicação do SnapMirror. Essa distribuição otimiza o uso de recursos de nós.</block>
  <block id="98b161980bf5831bfe65c048b46d0439" category="summary">Colocação de arquivos de banco de dados do Microsoft SQL Server no ASA</block>
  <block id="1b1b4c822e9c1b28b845dcc038fec08e" category="searchtitle">Arquivos de banco de dados e grupos de arquivos do Microsoft SQL Server</block>
  <block id="ba25a3e50659c5e29996ff4f5d42a259" category="paragraph">O diretório de log é especificado no SQL Server para armazenar dados de backup de log de transação no nível do host. Se você estiver usando o SnapCenter para fazer backup de arquivos de log, cada host do SQL Server usado pelo SnapCenter deve ter um diretório de log do host configurado para executar backups de log.</block>
  <block id="c05ca2066a3b729016e386c067cd91b4" category="paragraph">Coloque o diretório de registo numa unidade de armazenamento dedicada. A quantidade de dados no diretório de log do host depende do tamanho dos backups e do número de dias em que os backups são mantidos. O SnapCenter permite apenas um diretório de log de host por host do SQL Server. Você pode configurar os diretórios de log do host em SnapCenter --&gt; Host --&gt; Configurar Plug-in.</block>
  <block id="74432d98a78bf2e3e3b497b91dc1c516" category="list-text">Crie o diretório de log do host em uma unidade de armazenamento dedicada à qual o SnapCenter copia logs de transações.</block>
  <block id="00b0277b7e21cfea83e1cd6202498b9e" category="list-text">Se você estiver usando uma instância de cluster sempre em failover, a unidade de armazenamento usada para o diretório de log do host deve ser um recurso de disco de cluster no mesmo grupo de cluster que a instância do SQL Server que está sendo feita backup no SnapCenter.</block>
  <block id="c42f502d6a45acd6c1d2a13f44016270" category="summary">Consideração de storage do Microsoft SQL Server em sistemas ASA</block>
  <block id="e7a0b265e1ae7c0bf7047bd4770bc53d" category="paragraph">O NetApp ASA R2 é uma solução simplificada e avançada para clientes somente SAN que executam workloads essenciais. A combinação da plataforma ASA R2 que executa soluções de storage ONTAP e do Microsoft SQL Server permite designs de storage de banco de dados de nível empresarial que podem atender aos requisitos de aplicativos mais exigentes da atualidade.</block>
  <block id="95cc7be66d78a646c5ee563f83198ab4" category="paragraph">As plataformas ASA a seguir são classificadas como sistemas ASA R2 compatíveis com todos os protocolos SAN (iSCSI, FC, NVMe/FC, NVMe/TCP). Os protocolos iSCSI, FC, NVMe/FC e NVMe/TCP são compatíveis com arquitetura ativo-ativo simétrica para multipathing, de modo que todos os caminhos entre os hosts e o storage fiquem ativos/otimizados:</block>
  <block id="5d6a7459a3583d9e29f4b486d809b6a1" category="list-text">ASA A1K</block>
  <block id="009f19d7e9e80eda1c7dbf7374519e58" category="list-text">ASA A90</block>
  <block id="cd527b2aadf2bebf28ba082002724ab0" category="list-text">ASA A70</block>
  <block id="3ee9bc9a210bd85fa921ca63bdeef612" category="list-text">ASA A50</block>
  <block id="e21bdbd552261278be0a5ad02fbc6fa7" category="list-text">ASA A30</block>
  <block id="3c609b480f1311eaec9774146ac50e79" category="list-text">ASA A20</block>
  <block id="2b304856171196502641312a496c6d54" category="inline-link-macro">NetApp ASA</block>
  <block id="4dd59f71d7cf036df0941aa4fcd50443" category="paragraph">Para obter mais informações, consulte <block ref="a37d9d52d65391d0ce6c582426431be1" category="inline-link-macro-rx"></block></block>
  <block id="bb9a4cadd83e3ce26b592d1a9eeafb2e" category="paragraph">A otimização de uma solução SQL Server no ONTAP requer a compreensão do padrão e/S do SQL Server. Um layout de armazenamento bem projetado para um banco de dados do SQL Server deve suportar os requisitos de desempenho do SQL Server, além de fornecer o máximo de gerenciamento da infraestrutura como um todo. Um bom layout de storage também permite que a implantação inicial seja bem-sucedida e o ambiente cresça suavemente ao longo do tempo à medida que a empresa cresce.</block>
  <block id="bfdf538d8298e1c20008ee59ebb494a0" category="paragraph">A Microsoft recomenda colocar os dados e arquivos de log em unidades separadas. Para aplicativos que simultaneamente atualizam e solicitam dados, o arquivo de log é intenso de gravação e o arquivo de dados (dependendo do aplicativo) é intenso de leitura/gravação. Para a recuperação de dados, o ficheiro de registo não é necessário. Portanto, as solicitações de dados podem ser satisfeitas a partir do arquivo de dados colocado em sua própria unidade.</block>
  <block id="801afe45de7db517b57f747a8973280a" category="section-title">Considerações sobre a unidade de armazenamento</block>
  <block id="5e64d69892f623826e85a5239abf0607" category="paragraph">A unidade de storage no ASA refere-se a LUN para hosts SCSI/FC ou um namespace NVMe para hosts NVMe. Com base no protocolo compatível, você será solicitado a criar LUN, namespace NVMe ou ambos. Antes de criar uma unidade de armazenamento para implantação de banco de dados, é importante entender como o padrão e as caraterísticas de e/S do SQL Server variam dependendo da carga de trabalho e dos requisitos de backup e recuperação. Consulte as seguintes recomendações do NetApp para a unidade de armazenamento:</block>
  <block id="506a88168c6bdfeb32f8fae8409c1eba" category="list-text">Evite compartilhar a mesma unidade de armazenamento entre vários SQL Server em execução no mesmo host para evitar gerenciamento complicado. No caso de executar várias instâncias do SQL Server no mesmo host, a menos que você esteja perto do limite da unidade de armazenamento em um nó, evite compartilhar e, em vez disso, tenha uma unidade de armazenamento separada por instância por host para facilitar o gerenciamento de dados.</block>
  <block id="3c00c0b1042b695af03e498424f2ee1e" category="list-text">Use pontos de montagem NTFS em vez de letras de unidade para superar a limitação de 26 unidades no Windows.</block>
  <block id="216443bb5f5d2545cc1881816458e899" category="list-text">Desative as programações de snapshot e as políticas de retenção. Em vez disso, use o SnapCenter para coordenar cópias Snapshot da unidade de storage de dados do SQL Server.</block>
  <block id="44d48620d1d725aaad54d642f73970a9" category="list-text">Coloque os bancos de dados do sistema do SQL Server em uma unidade de armazenamento dedicada.</block>
  <block id="5375f513e791de754ec7d070bbf5512c" category="list-text">Tempdb é um banco de dados de sistema usado pelo SQL Server como um espaço de trabalho temporário, especialmente para operações de e/S intensivas DBCC CHECKDB. Portanto, coloque esse banco de dados em uma unidade de armazenamento dedicada. Em ambientes grandes em que a contagem de unidades de armazenamento é um desafio, você pode consolidar tempdb com bancos de dados de sistema na mesma unidade de armazenamento após um Planejamento cuidadoso. A proteção de dados para tempdb não é uma prioridade alta porque este banco de dados é recriado sempre que o SQL Server é reiniciado.</block>
  <block id="5b2b825a890a5ed31984f174b5420a05" category="list-text">Coloque os arquivos de dados do usuário <block ref="937f38432beb92fdba3d47780720bdf7" prefix="(" category="inline-code"></block>) em uma unidade de armazenamento separada, porque eles são cargas de trabalho de leitura/gravação aleatórias. É comum criar backups de log de transações com mais frequência do que backups de banco de dados. Por esse motivo, coloque arquivos de log de transações <block ref="cb15b9539ae0d984ff8740c68b52561c" prefix="(" category="inline-code"></block>) em uma unidade de armazenamento separada ou VMDK dos arquivos de dados para que programações de backup independentes possam ser criadas para cada um. Essa separação também isola a e/S de gravação sequencial dos arquivos de log da e/S de leitura/gravação aleatória de arquivos de dados e melhora significativamente o desempenho do SQL Server.</block>
  <block id="892e3db84641b51931ab0dac9977d1bf" category="list-text">Certifique-se de que os arquivos do banco de dados do usuário e o diretório de log para armazenar o backup de log estão em uma unidade de armazenamento separada para impedir que a política de retenção substitua snapshots quando eles são usados com o recurso SnapMirror com diretiva Vault.</block>
  <block id="d3bcdc884b8b6c9a2e038e5aca8eb201" category="list-text">Não misture arquivos de banco de dados e não de banco de dados, como arquivos relacionados à pesquisa de texto completo, na mesma unidade de armazenamento.</block>
  <block id="c7b140168b3cdc8eaaa3041ffa0d954a" category="list-text">Colocar arquivos secundários de banco de dados (como parte de um grupo de arquivos) em uma unidade de armazenamento separada melhora o desempenho do banco de dados SQL Server. Esta separação só é válida se o ficheiro da base de dados<block ref="937f38432beb92fdba3d47780720bdf7" prefix=" " category="inline-code"></block> não partilhar a sua unidade de armazenamento com quaisquer outros<block ref="937f38432beb92fdba3d47780720bdf7" prefix=" " category="inline-code"></block> ficheiros.</block>
  <block id="47d411a79b7445f424218bb5a6265a1a" category="list-text">Ao formatar o disco usando o gerenciador de discos no servidor Windows, certifique-se de que o tamanho da unidade de alocação está definido como 64K para partição.</block>
  <block id="b1d3c04670a31b00b47ed2f54cef4f19" category="list-text">Não coloque bancos de dados do usuário ou bancos de dados do sistema em uma unidade de armazenamento que hospeda pontos de montagem.</block>
  <block id="995050bacc63636e91e211836cab350a" category="list-text">Se você estiver usando uma instância de cluster sempre em failover, os bancos de dados de usuários devem ser colocados na unidade de armazenamento compartilhada entre os nós de cluster de failover do servidor Windows e os recursos de cluster de disco físico serão atribuídos ao grupo de cluster associado à instância do SQL Server.</block>
  <block id="79b0cf2c987928face3999e45504752c" category="sidebar">Configuração de storage em sistemas AFF/FAS</block>
  <block id="120f8cb87e8ceb36804a526419a5803a" category="sidebar">Microsoft SQL Server em sistemas AFF/FAS</block>
  <block id="fc5b2b3c5350dcd6f3cc1cc3cdf1a13f" category="sidebar">Configuração de storage em sistemas ASA R2</block>
  <block id="8bdbdec629db36efc1c9bdbf743dd56a" category="sidebar">Microsoft SQL Server em sistemas ASA</block>
  <block id="3e2b4674c9afc41f9c3a0311b458ed23" category="list-text">Se os volumes e/ou LUNs não estiverem provisionados de forma fina, você deverá desativar todas as configurações de eficiência porque o uso desses recursos não oferece economia e a combinação de provisionamento espesso com eficiência de espaço habilitada pode causar comportamento inesperado, incluindo erros fora do espaço.</block>
  <block id="c2dc7d465f4be5df7a663820063fe07c" category="summary">Grupo de disponibilidade do Microsoft SQL Server com SnapCenter</block>
  <block id="b474dc2fb6ce60c11ecdfbe0a373bf34" category="doc">Grupo de disponibilidade do SQL Server com SnapCenter</block>
  <block id="0a1151b962e7b34ea7fa78538961cc63" category="paragraph">O SnapCenter suporta backup do banco de dados do grupo de disponibilidade do SQL Server configurado com cluster de failover do Windows.</block>
  <block id="55876228853abf632dec9346a4f372ec" category="inline-link-macro">documentação</block>
  <block id="19bc77c28d506c79f4e3acd767956f68" category="paragraph">O plugin SnapCenter para Microsoft SQL Server deve ser instalado em todos os nós do cluster de failover de servidor Windows. Consulte os <block ref="7ea17b48fc658598752bd1b70818d0c2" category="inline-link-macro-rx"></block>pré-requisitos e as etapas para configurar os plugins do SnapCenter.</block>
  <block id="878026ceb11256fd34df776a768794b2" category="paragraph">O SnapCenter descobre que todos os bancos de dados, instâncias e grupos de disponibilidade em hosts e recursos do Windows são enumerados na página de recursos do SnapCenter.</block>
  <block id="feb288d4161a267b78f781ef497c33f6" category="section-title">Proteção de bancos de dados no grupo disponibilidade sempre ativa</block>
  <block id="6493759953e55bc95c88e42046f8c8e1" category="paragraph">Bancos de dados no grupo disponibilidade podem ser protegidos de várias maneiras.</block>
  <block id="71903a5ca626286195e8839f74b46627" category="list-text">Backup no nível do banco de dados: Selecione o banco de dados de disponibilidade para a página de recursos do banco de dados, adicione a política que consiste em backup completo/log, programe o backup. O SnapCenter toma o backup independentemente da função de banco de dados, seja uma réplica primária ou uma réplica secundária. A proteção também pode ser configurada adicionando bancos de dados ao grupo de recursos.</block>
  <block id="402962f18d83fc2e3da0155e7c85d340" category="list-text">Backup em nível de instância: Selecione a instância e todos os bancos de dados em execução na instância são protegidos com base na política selecionada. Todos os bancos de dados, incluindo o banco de dados de disponibilidade em execução como réplica primária ou secundária, são copiados usando o SnapCenter. A proteção também pode ser configurada adicionando instância ao grupo de recursos.</block>
  <block id="4eea6cb4e656587b45ce878e96aced6c" category="list-text">Backup em nível de grupo de disponibilidade: Ao configurar a política, o SnapCenter tem uma opção avançada para backup em nível de grupo de disponibilidade. A configuração do grupo de disponibilidade na política permite que os usuários selecionem a preferência de réplica para backup. Você pode selecionar a réplica primária, secundária ou todas elas. A opção padrão é baseada na réplica de backup definida na configuração do grupo de disponibilidade do SQL Server.</block>
  <block id="df79a1b2903886af697a431a42cecd61" category="paragraph">A configuração de grupo de disponibilidade na política SnapCenter será aplicada somente se o backup em nível de grupo de disponibilidade for usado para proteger bancos de dados de grupos de disponibilidade e não se aplicar ao backup em nível de banco de dados ou instância.</block>
  <block id="2b371d66d8eda6963cd085c7a884f4d7" category="admonition">*A NetApp recomenda* para usar o backup em nível de disponibilidade para fazer backup em todas as réplicas em execução no armazenamento NetApp ONTAP.</block>
  <block id="5c0ae1f6e89ffad82dfe5e7773da2fd6" category="section-title">Configurando o backup de log no SnapCenter</block>
  <block id="b3b9b1046ddf8efb1b774f35855a0d1c" category="paragraph">Se o grupo de disponibilidade estiver configurado na configuração autônoma do SQL Server, um disco dedicado deverá ser montado em cada nó de um cluster de failover de servidor Windows. O disco dedicado deve ser usado para configurar o diretório de log para salvar backups de log de transações.</block>
  <block id="ac3f0583ff584e6a0d60cd070d6edce2" category="paragraph">Se o grupo de disponibilidade estiver configurado no cluster de failover do SQL Server, o disco em cluster deve ser criado na instância de cluster de failover do SQL Server para o diretório de log do host.</block>
  <block id="57194431a839a253461e94f7d15e0d30" category="section-title">Restaurar banco de dados na configuração do grupo de disponibilidade com o SnapCenter</block>
  <block id="cb66b1b1ce1e9f56d0a1572ba3dcccdd" category="list-text">O SnapCenter fornece a opção Reseed para recuperar automaticamente o banco de dados do snapshot mais recente disponível na réplica secundária. A operação Reseed restaurará e juntará automaticamente o backup do banco de dados ao grupo de disponibilidade.</block>
  <block id="4c25cf6fd81e138392692e0a7e5523f3" category="list-text">A maneira alternativa de restaurar o banco de dados de réplica no grupo de disponibilidade é quebrando o grupo de disponibilidade e executando a restauração completa e de log. Use o SnapCenter para restaurar o banco de dados no modo norecovery e, em seguida, use o estúdio de gerenciamento do SQL Server ou T-SQL para ingressar no banco de dados de volta ao grupo de disponibilidade.</block>
  <block id="533d3de92f8337e84aa0eccec7e4698f" category="list-text">Para recuperar apenas um subconjunto de dados, o recurso clone do SnapCenter pode ser usado para criar uma cópia clone do banco de dados. A cópia do banco de dados é criada em poucos minutos usando o SnapCenter e, em seguida, exporte os dados para a réplica primária usando ferramentas nativas do SQL Server.</block>
  <block id="f652b77e8bd5ef106d3fbeec02a874c5" category="inline-link-macro">TR-4714 melhores práticas para Microsoft SQL Server usando NetApp SnapCenter</block>
  <block id="9cc210a8901b58403ed2b299b9f87ac9" category="paragraph">Para obter as práticas recomendadas de configuração do layout de storage de banco de dados para atender aos requisitos de rto e RPO, <block ref="4619ebf0116b8a67a7bd991a2d661c12" category="inline-link-macro-rx"></block>consulte .</block>
  <block id="724394156ac637a07abed4b02026424a" category="admonition">O SnapCenter não oferece suporte ao grupo de disponibilidade distribuída e ao grupo de disponibilidade contida.</block>
  <block id="f9feae8e1753d6486bf95d4403f7d5a7" category="list-text">Não ative a deduplicação em nenhum volume no FAS que contenha arquivos de dados do SQL Server, a menos que o volume contenha várias cópias dos mesmos dados, como restaurar banco de dados de backups para um único volume.</block>
  <block id="3e7987259108445ae7c1491ed79b073d" category="list-text">Agora, o LUN é chamado de 'Clustered Disk' e é mostrado como armazenamento disponível em discos.</block>
  <block id="c1e7f55d2b03b3e23328dcdcd802d754" category="list-text">Clique com o botão direito do rato no LUN ('Clustered Disk') e clique em Adicionar ao Cluster Shared volumes. Agora, o LUN é mostrado como um CSV.</block>
  <block id="43e27ab0f91db8b4bb59d8e4c4d1e8ed" category="list-text">Copie a pasta NanoServerImageGenerator da pasta NanoServer na ISO do Windows Server para o disco rígido local.</block>
  <block id="7e5f3f135d7a8c51734f09f3d5a12050" category="list-text">Inicie o Windows PowerShell como administrador, navegue até a pasta NanoServerImageGenerator copiada no disco rígido local e execute o seguinte cmdlet:</block>
  <block id="eacb5e0f83e8ccaa90b1b924f6610ac2" category="paragraph">A QoS de storage no NetApp ONTAP permite agrupar objetos de storage e definir limites de taxa de transferência no grupo. A QoS de storage pode ser usada para limitar a taxa de transferência a workloads e monitorar a performance de workload. Com isso, um administrador de storage pode separar workloads por organização, aplicação, unidade de negócios ou ambientes de produção ou desenvolvimento.</block>
  <block id="34d1a06b342ddf788eb8d311a6a90b0f" category="paragraph">Além disso, os recursos de eficiência de storage da NetApp, como deduplicação, cópias NetApp FlexClone(R), tecnologia Snapshot da NetApp, thin Provisioning, compactação e disposição em camadas de storage, agregam valor significativo para workloads executados em Windows Server.</block>
  <block id="832d3120e6d9fa2f59f4e48705370613" category="paragraph">Vários nós são agregados em um sistema em cluster. Os nós no cluster comunicam-se continuamente entre si para coordenar as atividades do cluster. Os nós também podem mover dados de forma transparente de nó para nó usando caminhos redundantes para uma interconexão de cluster dedicada que consiste em dois switches Ethernet de 10Gb GB. Os nós no cluster podem assumir o controle uns dos outros para fornecer alta disponibilidade durante quaisquer cenários de failover. Os clusters são administrados em um cluster inteiro, em vez de por nó, e os dados são fornecidos a partir de uma ou mais máquinas virtuais de storage (SVMs). Para fornecer dados, um cluster precisa ter pelo menos um SVM.</block>
  <block id="7d1f2201f5f9a58716d9d3945ca25236" category="paragraph">A unidade básica de um cluster é o nó e os nós são adicionados ao cluster como parte de um par de alta disponibilidade (HA). Os pares DE HA permitem alta disponibilidade comunicando-se entre si por meio de uma interconexão de HA (separada da interconexão de cluster dedicada) e mantendo conexões redundantes com os discos do par de HA. Os discos não são compartilhados entre pares de HA, embora as gavetas possam conter discos que pertencem a um dos membros de um par de HA. A figura a seguir mostra uma implantação de storage do NetApp em um ambiente do Windows Server.</block>
  <block id="89b1c55fe8e272ac47674f0cc764a248" category="paragraph">O NetApp PowerShell Toolkit (PSTK) é um módulo do PowerShell que fornece automação de ponta a ponta e permite a administração de storage do ONTAP. O módulo ONTAP contém mais de 2.000 cmdlets e ajuda com a administração de NetApp AFF, FAS, hardware comum e recursos de nuvem.</block>
  <block id="511fb782308cb99c53153d22cdb1d521" category="list-text">Ao utilizar iSCSI LUNs para Hyper-V, certifique-se de que ativa "Serviço iSCSI (TCP-in) para Inbound" e "Serviço iSCSI (TCP-out) para Outbound" nas definições de firewall no anfitrião Hyper-V. Isso permite que o tráfego iSCSI passe de e para o host Hyper-V e para o controlador NetApp.</block>
  <block id="faccfad1846422576248770b7a6395e9" category="list-text">O provisionamento de uma VM usando Fibre Channel virtual requer um HBA FC habilitado para virtualização N_Port ID. Suporte para um máximo de quatro portas FC.</block>
  <block id="7b0285f3bc080c0c79f477f620f40e9e" category="list-text">Para obter informações sobre HBAs FC, consulte<block ref="5555d80b97794db0ba7e8564a4b85ca4" category="inline-link-rx"></block>.</block>
  <block id="f00baf160282989fbb1cb808699a6f2a" category="paragraph">Os servidores em cluster do Hyper-V (chamados nós) são conetados pela rede física e pelo software de cluster. Esses nós usam o armazenamento compartilhado para armazenar os arquivos VM, que incluem configuração, arquivos de disco rígido virtual (VHD) e snapshots. O storage compartilhado pode ser um compartilhamento NetApp SMB/CIFS ou um CSV em cima de um LUN NetApp, como mostrado abaixo. Esse storage compartilhado fornece um namespace consistente e distribuído que pode ser acessado simultaneamente por todos os nós do cluster. Portanto, se um nó falhar no cluster, o outro nó fornece serviço por um processo chamado failover. Os clusters de failover podem ser gerenciados usando o snap-in Gerenciador de Cluster de failover e os cmdlets do Windows PowerShell de clustering de failover.</block>
  <block id="111539b465998ea501279f7e74e96c23" category="paragraph">O ONTAP fornece recursos de eficiência de storage da NetApp, como a tecnologia NetApp Snapshot, clonagem, deduplicação, thin Provisioning, thin replication, compactação, disposição em camadas de storage virtual e muito mais, com performance e eficiência aprimoradas.</block>
  <block id="77c4f5b694a7632dd418203c35b28001" category="paragraph">Para obter uma matriz completa e atualizada regularmente de configurações SAN e nas testadas e com suporte, consulte<block ref="5555d80b97794db0ba7e8564a4b85ca4" category="inline-link-rx"></block> no site de suporte da NetApp. Com o IMT, você pode determinar as versões exatas do produto e do recurso que são suportadas para seu ambiente específico. O NetApp IMT define os componentes e versões do produto compatíveis com as configurações suportadas pelo NetApp. Os resultados específicos dependem da instalação de cada cliente de acordo com as especificações publicadas.</block>
  <block id="5dda25d6b4e823951b5421768be35626" category="paragraph">Um caminho direto para um LUN é um caminho no qual as LIFs de uma SVM e o LUN que estão sendo acessados residem no mesmo nó. Para ir de uma porta de destino físico para o disco, não é necessário atravessar a interconexão de cluster.</block>
  <block id="c364dd3fe0de768ba9017fa088c60e25" category="paragraph">Caminhos indiretos são caminhos de dados nos quais as LIFs de uma SVM e o LUN que estão sendo acessados residem em nós diferentes. Os dados devem atravessar a interconexão de cluster para ir de uma porta de destino físico para o disco.</block>
  <block id="2111c0c11662be8bb8715d01b06012e1" category="summary">O TR-4792 fornece orientação para o uso do NetApp 615C para cargas de trabalho gráficas 3D em um ambiente VMware Horizon equipado com unidades de processamento gráfico (GPUs) da NVIDIA e software de virtualização.</block>
  <block id="3797bd9f7fdebe600f0b50130ab6e88e" category="doc">Ferramentas do ONTAP para pontos de acesso do VMware vSphere 9,13 (usuários)</block>
  <block id="fe3b52cc276d9b4f6ff1d7dd52ebf482" category="doc">Máximo de solicitações simultâneas por usuário (Network security protection/dos Attack) Ferramentas do ONTAP para VMware vSphere 9,13</block>
  <block id="999ce5ccae91de7a317d5634f874aaf1" category="doc">Certificado HTTPS de 9,13 das ferramentas ONTAP</block>
  <block id="773a7bfeb117dbffddb5069c857898f1" category="doc">Verificando a integridade das ferramentas do ONTAP para os pacotes de instalação do VMware vSphere 9,13</block>
  <block id="d0190e0d0c684fb3bf0db89bc85d9fa8" category="list-text">Navegue até a IU de Gerenciamento de certificados: a. no menu inicial, selecione Administração. b. em certificados, clique em Gerenciamento de certificados.</block>
  <block id="e8783ca43a9865b78e97faa419114d3c" category="doc">ONTAP Tools 9,13 banner de login</block>
  <block id="3b3c746ae575763a882807d59864cd91" category="paragraph">O banner de login a seguir é exibido depois que o usuário insere um nome de usuário no prompt de login. Observe que o SSH está desativado por padrão e permite somente logins únicos quando habilitado a partir do console da VM.</block>
  <block id="5d012d90287d95d6d8add32b5532516f" category="doc">ONTAP Tools 9,13 TLS mútuo (autenticação baseada em certificado)</block>
  <block id="985cdfe4013537c1d4d5c214f7c0dd0d" category="doc">Configuração do protocolo de tempo de rede (NTP) para ferramentas ONTAP 9,13</block>
  <block id="5b0454dc521b829107eee95fdbdcf609" category="doc">Guia de fortalecimento da segurança para ferramentas do ONTAP para VMware vSphere 9,13</block>
  <block id="2b7bcb6c5618e904562d6803c126f1fd" category="doc">Políticas de senha para ferramentas do ONTAP 9,13</block>
  <block id="00100652bee31d3d3d08d4e151ec666b" category="doc">Portas e protocolos para ferramentas ONTAP 9,13</block>
  <block id="db739753b5ca22081d5a70569c187468" category="paragraph">Observe a tabela abaixo, que lista as portas de entrada e saída necessárias para o funcionamento adequado das ferramentas do ONTAP. É importante garantir que apenas as portas mencionadas na tabela estejam abertas para conexões de máquinas remotas, enquanto todas as outras portas devem ser bloqueadas para conexões de máquinas remotas. Isso ajudará a garantir a segurança e a segurança do seu sistema.</block>
  <block id="9fbc29d1252118b9f8037064f509bbc6" category="doc">Tempo limite de inatividade para ferramentas ONTAP 9,13</block>
  <block id="67119628cfd34ebda11e94844fd8ae42" category="inline-link-macro"><block ref="67119628cfd34ebda11e94844fd8ae42" category="inline-link-rx"></block></block>
  <block id="e1d3de60f7ed9e2b5f5783aa86ff23d8" category="list-text">Ferramentas do ONTAP para recursos do VMware vSphere 10.x. <block ref="2a13554f799535d02439d73fba6b8874" category="inline-link-macro-rx"></block></block>
  <block id="430d5e16a0652c5ee12e9434368c8970" category="list-text">Ferramentas do ONTAP para recursos do VMware vSphere 9.x. <block ref="9d52dd6d1c195e015d4baef3146522a8" category="inline-link-macro-rx"></block></block>
  <block id="4644d098069796f6576040c27eaa2902" category="inline-link-macro"><block ref="4644d098069796f6576040c27eaa2902" category="inline-link-rx"></block></block>
  <block id="f9b6e9a89bb3e4c6302d8214e9ef8e1f" category="list-text">Documentação do VMware Live Site Recovery <block ref="401159cdbd602df2732f9d02a280896a" category="inline-link-macro-rx"></block></block>
  <block id="0a94bde8cd1434df225de9583026ce2a" category="paragraph">Consulte o <block ref="de89165a46abdf575eb9a1ba0995e131" category="inline-link-macro-rx"></block>no site de suporte da NetApp para validar se as versões exatas de produtos e recursos descritas neste documento são compatíveis com o seu ambiente específico. O NetApp IMT define os componentes e versões do produto que podem ser usados para construir configurações compatíveis com o NetApp. Os resultados específicos dependem da instalação de cada cliente de acordo com as especificações publicadas.</block>
  <block id="92f5dfcc91de805d4d9a5e53648b4d2a" category="section-title">Use a versão mais recente das ferramentas do ONTAP 10</block>
  <block id="1464492cec5287ef61574839a96af5c6" category="paragraph">O ONTAP Tools 10 fornece melhorias significativas em relação às versões anteriores, incluindo o seguinte:</block>
  <block id="b87867526ca4f4c733e3ce06f5010124" category="list-text">failover de teste 8xx mais rápido*</block>
  <block id="27074144cd68d611ee2ff77b05e534c7" category="list-text">limpeza e reproteção 2xx mais rápidas*</block>
  <block id="3b8fbbed2d84b9255b899aa6e5ca940a" category="list-text">failover 32% mais rápido*</block>
  <block id="aec894aa3f9e8a2faa2fbdd72e233401" category="list-text">Suporte nativo para layouts de site compartilhados</block>
  <block id="bee99bc5e766f9e6501e1f77a31daf3b" category="paragraph">*Essas melhorias são baseadas em testes internos e podem variar de acordo com o seu ambiente.</block>
  <block id="d7d8e8809bed362c1ee6bc2b541e379d" category="list-text">A conta padrão do vsadmin SVM não tem o nível de acesso necessário para executar tarefas de ferramentas do ONTAP. Portanto, você precisa criar uma nova conta SVM.<block ref="4010916266efe7d8b0185d4d2025f808" category="inline-link-rx"></block> Usando o arquivo JSON incluído. Isso pode ser usado para contas com escopo de SVM ou cluster.</block>
  <block id="87849b3f2b772c5e059e8e32ae26acba" category="list-text">Como o plug-in da IU do vCenter, o provedor VASA e o servidor SRA são todos microsserviços totalmente integrados, você deve adicionar armazenamento ao adaptador SRA no SRM da mesma forma que você adiciona armazenamento na IU do vCenter para ferramentas do ONTAP. Caso contrário, o servidor SRA pode não reconhecer as solicitações enviadas do SRM através do adaptador SRA.</block>
  <block id="132951122a677efd5c41a88deabeabd8" category="list-text">A verificação de caminho NFS não é realizada ao usar credenciais com escopo SVM, a menos que você primeiro<block ref="ea2efd531a0984091e8158139d5ccc0c" category="inline-link-rx"></block> no Gerenciador de ferramentas do ONTAP e associe-as a vCenters. Isso ocorre porque a localização física é logicamente abstraída do SVM. No entanto, isso não é motivo de preocupação, já que os sistemas ONTAP modernos não sofrem mais nenhum declínio de desempenho percetível ao usar caminhos indiretos.</block>
  <block id="0a1fcbae4c54aa60a8f2fe5671680e27" category="doc">Novos recursos com VLSR/SRM e Ferramentas ONTAP</block>
  <block id="03a93b2df7509ea17938237f51860034" category="paragraph">A NetApp compartilhou uma parceria profunda com a VMware por quase duas décadas e se esforça para fornecer suporte para os lançamentos mais recentes o mais rápido possível. Verifique sempre o NetApp<block ref="5a1370857464a2f4fc64961fad76707f" category="inline-link-rx"></block> para obter as combinações qualificadas mais recentes de software.</block>
  <block id="bdbeaf4744c4096d9ca05899a1b20ac6" category="list-text">Não suportado com o SRM 8,2 (8,1, 8,3 e 8. 4 e posteriores são suportados)</block>
  <block id="99d2e422e054ee65d15c388ce83e3aad" category="list-text">Consulte a<block ref="5a1370857464a2f4fc64961fad76707f" category="inline-link-rx"></block> para obter as versões qualificadas mais recentes.</block>
  <block id="03e80035ff033dbb43bc1cf4dfd27b9d" category="paragraph">As ferramentas ONTAP 10,4 SRA agora podem suportar a escala máxima de VLSR/SRM.</block>
  <block id="5b71ff881fa46f7d950270720dfba930" category="list-text">Número total de VMs protegidas: 5000</block>
  <block id="00b46b3bd011b06ddc97d2d87f3f693c" category="list-text">Número de VMs por Grupo de proteção: 1000</block>
  <block id="f13d5084a9427ce818e051b68dd775de" category="list-text">Número total de planos de recuperação: 250</block>
  <block id="32037bfb6e7cea15bb8d753bacb8c6f1" category="list-text">O número total de grupos de proteção por plano de recuperação é de 250</block>
  <block id="0e10d41896dde55f485a601573eb4cd1" category="list-text">Número total de datastores replicados: 255</block>
  <block id="9f1fc329126d15e2b5b7ab32cb32d7b5" category="list-text">Número total de planos de recuperação em execução simultânea. 10</block>
  <block id="1e1088bfcfb8add5780ae378f2754112" category="paragraph">A configuração do servidor SRA agora pode ser gerenciada por APIS REST. Uma IU Swagger foi adicionada para ajudar a criar seus fluxos de trabalho de automação e pode ser encontrada em seu dispositivo de ferramentas do ONTAP em<block ref="8a609c6f0b4bce52148730c8d12b504f" prefix=" " category="inline-code"></block>.</block>
  <block id="0544f3896fcb77e4b634ce110f6bd9b9" category="list-text">Os protocolos SAN devem ser homogêneos para cada local. Você pode misturar NFS e SAN, mas os protocolos SAN não devem ser misturados em um local. Por exemplo, você pode usar FCP no local A e iSCSI no local B. você não deve usar FCP e iSCSI no local A.</block>
  <block id="4e3807553eb007466c17fb67a2210f32" category="list-text">Guias anteriores aconselharam a criação de LIF para localidade de dados. Ou seja, monte sempre um datastore usando um LIF localizado no nó que possui fisicamente o volume. Embora essa ainda seja a melhor prática, não é mais um requisito nas versões modernas do ONTAP 9. Sempre que possível, e se forem dadas credenciais com escopo de cluster, as ferramentas do ONTAP ainda escolherão o balanceamento de carga entre LIFs locais para os dados, mas não será um requisito de alta disponibilidade ou desempenho.</block>
  <block id="f48bad2be9e924ec16a98855ffa5205d" category="list-text">O ONTAP 9 pode ser configurado para remover automaticamente snapshots para preservar o tempo de atividade em caso de uma condição fora do espaço quando o dimensionamento automático não é capaz de fornecer capacidade de emergência suficiente. A configuração padrão para esse recurso não exclui automaticamente os snapshots criados pelo SnapMirror. Se os snapshots do SnapMirror forem excluídos, o NetApp SRA não poderá reverter e ressincronizar a replicação para o volume afetado. Para evitar que o ONTAP elimine instantâneos do SnapMirror, configure a capacidade de instantâneos para "tentar".</block>
  <block id="9d9eddaf9d0daee09cf623c1a7efe898" category="inline-link-macro">Configure volumes para aumentar e diminuir automaticamente o tamanho</block>
  <block id="cdf854c312fc769dc7a37371e3862cf7" category="list-text">O dimensionamento automático de volume deve ser definido como<block ref="4d200fce73a8e1cc965cfc2c43343824" prefix=" " category="inline-code"></block> para volumes que contêm armazenamentos de dados SAN e<block ref="d89f4f8b1d7c18847b88b46142f61535" prefix=" " category="inline-code"></block> para armazenamentos de dados NFS. Saiba mais sobre este tópico em <block ref="1e69033938f9e72dbed381804139dcb7" category="inline-link-macro-rx"></block>.</block>
  <block id="0f5c04a3e7eeab838bfbea0da2647014" category="paragraph">Os grupos de replicação contêm coleções lógicas de máquinas virtuais que são recuperadas juntas. Como a replicação do ONTAP SnapMirror ocorre no nível do volume, todas as VMs em um volume estão no mesmo grupo de replicação.</block>
  <block id="5e3d02d3d6c87568b9fb31c561e3c30c" category="paragraph">Há vários fatores a serem considerados nos grupos de replicação e como você distribui VMs pelos volumes do FlexVol. Agrupar VMs semelhantes no mesmo volume pode aumentar a eficiência de storage com sistemas ONTAP mais antigos que não possuem deduplicação em nível de agregado, mas o agrupamento aumenta o tamanho do volume e reduz a simultaneidade de e/S do volume. O melhor equilíbrio entre performance e eficiência de storage pode ser obtido em sistemas ONTAP modernos, distribuindo máquinas virtuais por volumes FlexVol no mesmo agregado, aproveitando a deduplicação em nível de agregado e obtendo maior paralelização de e/S em vários volumes. Você pode recuperar VMs nos volumes juntos porque um grupo de proteção (discutido abaixo) pode conter vários grupos de replicação. A desvantagem desse layout é que os blocos podem ser transmitidos por cabo várias vezes, porque o SnapMirror não leva em conta a deduplicação agregada.</block>
  <block id="63e4890c97de111da0d06968949b7dd9" category="paragraph">Por exemplo, sua empresa pode ter um aplicativo essencial para negócios de nível 1 que depende de um servidor Microsoft SQL para seu banco de dados. Então, você decide colocar suas VMs no grupo de prioridades 1. No grupo de prioridade 1, você começa a Planejar o pedido para abrir serviços. Você provavelmente quer que o controlador de domínio do Microsoft Windows seja inicializado antes do servidor Microsoft SQL, que precisaria estar online antes do servidor de aplicativos, e assim por diante. Você adicionaria todas essas VMs ao grupo de prioridade e, em seguida, definiria as dependências porque as dependências se aplicam somente a um determinado grupo de prioridade.</block>
  <block id="d64567ab52d5b1768fa4574f7913b737" category="paragraph">Como prática recomendada, sempre execute um failover de teste sempre que for feita uma alteração na configuração do storage de VM protegido. Isso garante que, no caso de um desastre, você possa confiar que o Site Recovery Manager pode restaurar serviços dentro do destino de rto esperado.</block>
  <block id="440c65ed1c918c9b0812a49f7d368131" category="summary">A solução ONTAP para o VMware Live Site Recovery (VLSR) e o Gerenciador de recuperação de local (SRM)</block>
  <block id="05d7c63979cf1697d07b8942ba9871b7" category="doc">Recuperação do site ao vivo da VMware com o ONTAP</block>
  <block id="26f37d417bce4746b39183f7a16780af" category="paragraph">A ONTAP serviu como uma solução de armazenamento de dados de primeira linha para o VMware vSphere e, mais recentemente, para ambientes Cloud Foundation desde sua introdução no data center moderno em 2002. Ele continua a introduzir recursos inovadores que simplificam o gerenciamento e reduzem custos.</block>
  <block id="e0982d67f17f6b02d88a0cbc066cd4ae" category="paragraph">Este documento se concentra nos recursos das versões recentes do ONTAP 9 quando usado em conjunto com as ferramentas do ONTAP para VMware vSphere 10,4 (que inclui o adaptador de replicação de armazenamento NetApp [SRA] e o provedor VASA [VP]), bem como o VMware Live Site Recovery 9.</block>
  <block id="07f63b028c614758695673e7c08bb043" category="section-title">Por que usar o ONTAP com VLSR ou SRM?</block>
  <block id="785b838a99d90e91a3859239a468a546" category="section-title">Como o VLSR utiliza o ONTAP 9</block>
  <block id="1625d4b695f746dca5ff4f4c76ddee9c" category="paragraph">O VLSR aproveita as tecnologias avançadas de gerenciamento de dados dos sistemas ONTAP integrando-se às ferramentas do ONTAP para VMware vSphere, um dispositivo virtual que inclui três componentes principais:</block>
  <block id="69fc564a57c8d57102ff1d2144ad8232" category="list-text">O plug-in do ONTAP Tools vCenter, anteriormente conhecido como VSC (Virtual Storage Console), simplifica o gerenciamento de storage e os recursos de eficiência, aprimora a disponibilidade e reduz os custos de storage e a sobrecarga operacional, não importa se você está usando SAN ou nas. Ele usa as práticas recomendadas para provisionar armazenamentos de dados e otimiza as configurações de host ESXi para ambientes de storage de bloco e NFS. Para todos esses benefícios, a NetApp recomenda esse plug-in ao usar o vSphere com sistemas que executam o ONTAP.</block>
  <block id="60da32bc0bc08789d91b50e6c1e297c4" category="list-text">O provedor VASA (ONTAP Tools) oferece suporte à estrutura VMware vStorage APIs for Storage Awareness (VASA). O provedor VASA coneta o vCenter Server com o ONTAP para auxiliar no provisionamento e monitoramento do armazenamento de VM. Isso permitiu o suporte ao VMware Virtual volumes (vVols), o gerenciamento de políticas de storage de VM e o desempenho individual do VM vVols. Ele também fornece alarmes para monitorar a capacidade e conformidade com os perfis.</block>
  <block id="aedad0f692989ea8f930a5704478b317" category="list-text">O SRA é usado em conjunto com o VLSR para gerenciar a replicação de dados de VM entre locais de produção e recuperação de desastres para armazenamentos de dados VMFS e NFS tradicionais e também para testes sem interrupções de réplicas de DR. Ele ajuda a automatizar as tarefas de descoberta, recuperação e reproteção. Ele inclui um dispositivo de servidor SRA e adaptadores SRA para o servidor Windows SRM e o dispositivo VLSR.</block>
  <block id="9220276841499e90e16d19b02e4be757" category="paragraph">O SRA oferece uma interface de comando e controle para o servidor VLSR gerenciar os volumes ONTAP FlexVol que contêm suas máquinas virtuais (VMs) da VMware, bem como a replicação do SnapMirror que os protege.</block>
  <block id="1590566734d497290ef7dec19c83ae27" category="paragraph">No caso de um verdadeiro desastre ou mesmo de uma migração planejada, o VLSR permite que você envie quaisquer alterações de última hora para o conjunto de dados por meio de uma atualização final do SnapMirror (se você optar por fazê-lo). Em seguida, ele quebra o espelho e monta o datastore em seus hosts de DR. Nesse ponto, suas VMs podem ser automaticamente ativadas em qualquer ordem de acordo com sua estratégia pré-planejada.</block>
  <block id="ad84b24a08fcf7b630aabbaa227285e4" category="admonition">Embora os sistemas ONTAP permitam emparelhar SVMs no mesmo cluster para replicação do SnapMirror, esse cenário não é testado e certificado com o VLSR. Portanto, é recomendável usar apenas SVMs de diferentes clusters ao usar o VLSR.</block>
  <block id="7c4dce5fd159dd8fdded222a89550c4b" category="section-title">VLSR com ONTAP e outros casos de uso: Nuvem híbrida e migração</block>
  <block id="99a06707f3209b90d504a54a5ea6d69f" category="inline-link">Storage NetApp no Equinix Metal®</block>
  <block id="8fff56a05881c6f706c3ed3a782050f2" category="paragraph">O VLSR também pode ser usado para executar migrações planejadas utilizando o SnapMirror para transferir eficientemente suas VMs de um data center para outro ou até mesmo dentro do mesmo data center, seja seu, ou por meio de qualquer número de provedores de serviços parceiros da NetApp.</block>
  <block id="d274b8ae04172dec40c6aa0549b00986" category="summary">Topologias de replicação usando o ONTAP com SnapMirror e VMware VLSR e SRM.</block>
  <block id="10140c04b3ae3f49aedaf52f157363d3" category="paragraph">Cada SVM do NetApp é Tratado como um array no VMware vCenter Site Recovery Manager. O VLSR é compatível com certos layouts de replicação de array a array (ou SVM para SVM).</block>
  <block id="08db3b842a4cb2c270982436a350d96f" category="paragraph">Uma única VM não pode possuir dados – Virtual Machine Disk (VMDK) ou RDM – em mais de um array VLSR pelos seguintes motivos:</block>
  <block id="d8a9d635a5de68d706349e0ba1582a33" category="list-text">O VLSR vê apenas o SVM, e não um controlador físico individual.</block>
  <block id="03a2d94e9dd3faa9d1c2ba5048e50ff5" category="cell">Para determinar a capacidade de suporte, tenha em mente esta regra: Para proteger uma VM usando o VLSR e o NetApp SRA, todas as partes da VM devem existir em apenas uma SVM. Esta regra aplica-se tanto no local protegido como no local de recuperação.</block>
  <block id="e30b1ded833744ef423f9c06bfca3bab" category="paragraph">As figuras a seguir mostram os cenários de layout de relacionamento do SnapMirror que o VLSR e o SRA suportam. Cada VM nos volumes replicados possui dados em apenas um array VLSR (SVM) em cada local.</block>
  <block id="aefe28ee95511224d6209514d7186d90" category="paragraph">Quando você usa a replicação baseada em array (ABR) no VLSR, os grupos de proteção são isolados a um único par de array, como mostrado na captura de tela a seguir. Neste cenário,<block ref="129864522ed0e4ac80f306ecfa130ef7" prefix=" " category="inline-code"></block> e<block ref="ec87aa7f4c8e70a139fd988f87b6549f" prefix=" " category="inline-code"></block> são percorridos com<block ref="387d04b65848414d4697f145a3782f90" prefix=" " category="inline-code"></block> e<block ref="58bdbfcb72c2dd3d883a7ca754443a4c" prefix=" " category="inline-code"></block> no local de recuperação. No entanto, você pode selecionar apenas um dos dois pares de matrizes ao criar um grupo de proteção.</block>
  <block id="2e7b54c50f0d287a5bf008ad268a0789" category="paragraph">Configurações não suportadas têm dados (VMDK ou RDM) em vários SVMs que são de propriedade de uma VM individual. Nos exemplos mostrados nas figuras a seguir,<block ref="df777c4d2477e55571925353ce589f7e" prefix=" " category="inline-code"></block> não pode ser configurado para proteção com VLSR<block ref="df777c4d2477e55571925353ce589f7e" prefix=" " category="inline-code"></block> porque tem dados em dois SVMs.</block>
  <block id="4fdeeea2f6ee5d6350aa8d922fb0a5af" category="paragraph">Qualquer relação de replicação na qual um volume de NetApp individual é replicado de uma SVM de origem para vários destinos no mesmo SVM ou em SVMs diferentes é chamada de fan-out do SnapMirror. Fan-out não é suportado com VLSR. No exemplo mostrado na figura a seguir,<block ref="df777c4d2477e55571925353ce589f7e" prefix=" " category="inline-code"></block> não pode ser configurado para proteção no VLSR porque ele é replicado com o SnapMirror para dois locais diferentes.</block>
  <block id="9aaec9a7e35a54378af7cf34a10ff7ad" category="paragraph">O VLSR não oferece suporte a cascata de relacionamentos SnapMirror, nas quais um volume de origem é replicado para um volume de destino e esse volume de destino também é replicado com o SnapMirror para outro volume de destino. No cenário mostrado na figura a seguir, o VLSR não pode ser usado para failover entre sites.</block>
  <block id="c37d439a6d3a3437f39236143c5a460a" category="paragraph">O software NetApp SnapVault permite o backup baseado em disco de dados empresariais entre sistemas de storage NetApp. O SnapVault e o SnapMirror podem coexistir no mesmo ambiente; no entanto, o VLSR suporta o failover apenas das relações SnapMirror.</block>
  <block id="79f08fde51df68a19d8383c68f8adebb" category="paragraph">Um volume de origem pode ser criado em uma configuração em cascata na qual um volume é replicado para um destino SnapMirror no local de DR e, a partir daí, é abobadado para um destino SnapVault. Um volume de origem também pode ser criado em uma relação de fan-out em que um destino é um destino SnapMirror e o outro destino é um destino SnapVault. No entanto, o SRA não reconfigura automaticamente a relação do SnapVault para usar o volume de destino do SnapMirror como a origem do Vault quando ocorre failover ou reversão de replicação do VLSR.</block>
  <block id="4cc1b133c2294fcf3e444666786b490e" category="cell">Se o SnapVault e o VLSR forem usados no mesmo ambiente, a NetApp recomenda o uso de uma configuração em cascata SnapMirror to SnapVault na qual os backups do SnapVault normalmente são executados a partir do destino do SnapMirror no local de DR. Em caso de desastre, essa configuração torna o site primário inacessível. Manter o destino do SnapVault no local de recuperação permite que os backups do SnapVault sejam reconfigurados após o failover para que os backups do SnapVault possam continuar operando no local de recuperação.</block>
  <block id="28ce1496405d55f61c08746bcc7d2134" category="paragraph">Em um ambiente VMware, cada datastore tem um identificador exclusivo universal (UUID) e cada VM tem um ID de objeto gerenciado exclusivo (MOID). Essas IDs não são mantidas pelo VLSR durante o failover ou failback. Como os UUIDs do datastore e os MOIDs de VM não são mantidos durante o failover pelo VLSR, todos os aplicativos que dependem desses IDs devem ser reconfigurados após o failover do VLSR. Um aplicativo de exemplo é o NetApp Active IQ Unified Manager, que coordena a replicação do SnapVault com o ambiente vSphere.</block>
  <block id="36021caed35d3ff177cae271cf95e17f" category="paragraph">A figura a seguir mostra a configuração depois que o VLSR foi usado para reverter a replicação do SnapMirror de volta para o local principal. O ambiente também foi reconfigurado de modo que os backups do SnapVault estão ocorrendo a partir do que é agora a fonte SnapMirror. Esta configuração é uma configuração de fan-out do SnapMirror SnapVault.</block>
  <block id="b352b28b9db88c716b387eac7bfd478e" category="paragraph">Depois que o vsrm executa o failback e uma segunda reversão das relações do SnapMirror, os dados de produção estão de volta ao local principal. Agora, esses dados estão protegidos da mesma maneira que antes do failover para o local de recuperação de desastres, por meio de backups SnapMirror e SnapVault.</block>
  <block id="0df9db9c3f8671a5c3e32d66c594a54d" category="paragraph">Qtrees são diretórios especiais que permitem a aplicação de cotas de sistema de arquivos para nas. O ONTAP 9 permite a criação de qtrees, e qtrees podem existir em volumes replicados com o SnapMirror. No entanto, o SnapMirror não permite replicação de qtrees individuais ou replicação em nível de qtree. Toda a replicação do SnapMirror está apenas no nível do volume. Por esta razão, o NetApp não recomenda o uso de qtrees com VLSR.</block>
  <block id="5c7eaf04fc264c6082cadf5fd01b4cd3" category="paragraph">O VMware VLSR e o NetApp SRA suportam o uso do protocolo FC em um local e do protocolo iSCSI no outro local. No entanto, ele não dá suporte a uma combinação de armazenamentos de dados anexados a FC e armazenamentos de dados anexados a iSCSI no mesmo host ESXi ou em hosts diferentes no mesmo cluster. Esta configuração não é suportada com o VLSR porque, durante o failover VLSR ou failover de teste, o VLSR inclui todos os iniciadores FC e iSCSI nos hosts ESXi na solicitação.</block>
  <block id="612460a6891d7eecad16636b2ccd03ec" category="cell">O VLSR e o SRA oferecem suporte a protocolos FC e iSCSI mistos entre os locais protegidos e de recuperação. No entanto, cada local deve ser configurado com apenas um protocolo, FC ou iSCSI, e não com ambos os protocolos no mesmo local. Se houver um requisito para que os protocolos FC e iSCSI sejam configurados no mesmo local, o NetApp recomenda que alguns hosts usem iSCSI e outros hosts usem FC. O NetApp também recomenda, neste caso, que os mapeamentos de recursos do VLSR sejam configurados para que as VMs sejam configuradas para failover em um grupo de hosts ou outro.</block>
  <block id="2fc50e10e291654a0ac526fdd9d85edd" category="doc">Solução de problemas do VLSRM/SRM ao usar a replicação do vVols</block>
  <block id="3d0b50d268649e9f201008e1735764c1" category="paragraph">Ao usar as ferramentas do ONTAP 9.13P2, o fluxo de trabalho dentro do VLSR e SRM é significativamente diferente ao usar a replicação vVols do que é usado com o SRA e armazenamentos de dados tradicionais. Por exemplo, não há conceito de gerenciador de array. Como tal,<block ref="0ec64480a9620a1430c0ae1b6603ea01" prefix=" " category="inline-code"></block> e<block ref="ba6c59072f543cb828e47d5bac560371" prefix=" " category="inline-code"></block> comandos nunca são vistos.</block>
  <block id="36c0e0bf3cbce9baff381f0038982596" category="inline-link">Omnissa Horizon View</block>
  <block id="713e31d24f394517ddb2727e75ad1c07" category="list-text">Clonagem e migração do vSphere usando as APIs do vSphere – Array Integration (VAAI). As operações de clonagem de VM podem ser descarregadas para o ONTAP em ambientes SAN e nas (a NetApp fornece um plug-in ESXi para habilitar o VAAI para NFS). O vSphere apenas descarrega as operações em VMs frias (desativadas) em um datastore nas, enquanto as operações em VMs quentes (clonagem e armazenamento vMotion) também são descarregadas para SAN. O ONTAP usa a abordagem mais eficiente com base na origem e no destino. Essa capacidade também é usada<block ref="d752e276b58b6c367f27570fc3212480" category="inline-link-rx"></block> pelo .</block>
  <block id="f6f2c5686cc4f0cddb9b97a821855375" category="list-text">SRA (usado com o VMware Live Site Recovery/Site Recovery Manager). Aqui, os clones são usados para testar a recuperação da réplica de DR sem interrupções.</block>
  <block id="ab145b0c5bc936679238040b42d242a8" category="list-text">Backup e recuperação usando ferramentas do NetApp, como o SnapCenter. Os clones de VM são usados para verificar as operações de backup, bem como para montar um backup de VM para que arquivos individuais possam ser restaurados.</block>
  <block id="b1fd904929f16090f01753d2728346c6" category="paragraph">A clonagem descarregada do ONTAP pode ser invocada por ferramentas VMware, NetApp e de terceiros. Clones que são descarregados para o ONTAP têm várias vantagens. Na maioria dos casos, elas usam espaço eficiente, precisando de storage somente para alterações no objeto. Não há efeito de desempenho adicional para lê-las e gravá-las e, em alguns casos, o desempenho é aprimorado ao compartilhar blocos em caches de alta velocidade. Eles também descarregam ciclos de CPU e e/S de rede do servidor ESXi. A descarga de cópia em um datastore tradicional usando um FlexVol volume pode ser rápida e eficiente com a licença FlexClone licenciada (incluída na licença ONTAP One), mas as cópias entre volumes FlexVol podem ser mais lentas. Se você mantiver os modelos de VM como uma fonte de clones, considere colocá-los no volume do datastore (use pastas ou bibliotecas de conteúdo para organizá-los) para clones rápidos e com uso eficiente de espaço.</block>
  <block id="ebd95a7e5bdcc4b40ab6f7413106b3f2" category="list-text">*Ofertas de primeira parte.* O Amazon FSX para NetApp ONTAP, o Google Cloud NetApp volumes e o Azure NetApp Files oferecem serviços de armazenamento gerenciado de vários protocolos e alta performance nos principais ambientes de nuvem pública. Eles podem ser usados diretamente pelo VMware Cloud no AWS (VMC na AWS), Azure VMware Solution (AVS) e Google Cloud VMware Engine (GCVE) como armazenamentos de dados ou storage para sistemas operacionais convidados (GOS) e instâncias de computação.</block>
  <block id="4fa2b20fbe14dd41ca86a9f5b4c5bfcb" category="list-text">*Serviços em nuvem.* Use o backup e a recuperação do BlueXP  ou o SnapMirror Cloud para proteger dados de sistemas locais usando storage de nuvem pública. O Cloud Sync ajuda a migrar e manter seus dados sincronizados em nas, armazenamentos de objetos e storage Cloud Volumes Service. A recuperação de desastres da BlueXP  oferece uma solução econômica e eficiente para aproveitar as tecnologias NetApp como base para uma solução de recuperação de desastres robusta e capaz para recuperação de desastres na nuvem, DR no local e no local.</block>
  <block id="706253931ccf2225bbabb539eead1ee1" category="paragraph">O ONTAP 9,8, juntamente com as ferramentas do ONTAP para VMware vSphere 9,8-9,13 e o plug-in SnapCenter para VMware 4,4 e versões mais recentes, adicionou suporte para datastores com suporte de volume FlexGroup no vSphere. O FlexGroup volumes simplifica a criação de grandes armazenamentos de dados e cria automaticamente os volumes constituintes distribuídos necessários no cluster do ONTAP para obter o máximo de desempenho a partir de um sistema ONTAP.</block>
  <block id="fea36c6d0158f7614a47593cee5c4381" category="paragraph">Use o FlexGroup volumes com vSphere se você precisar de um único armazenamento de dados dimensionável vSphere com o poder de um cluster ONTAP completo ou se você tiver workloads de clonagem muito grandes que podem se beneficiar do mecanismo de clonagem do FlexGroup mantendo o cache clone aquecido constantemente.</block>
  <block id="4b2e7f21f2ab284dbe47715a088a87e4" category="paragraph">Além de testes extensivos do sistema com cargas de trabalho do vSphere, o ONTAP 9.8 adicionou um novo mecanismo de descarga de cópia para datastores FlexGroup. Este novo sistema usa um mecanismo de cópia melhorado para replicar arquivos entre constituintes em segundo plano, permitindo o acesso à origem e ao destino. Esse cache constituinte-local é então usado para instanciar rapidamente clones da VM sob demanda.</block>
  <block id="a8abf0cad71a45472969fad71143d9b0" category="inline-link">Como configurar volumes ONTAP FlexGroup para permitir descarga de cópia VAAI</block>
  <block id="c53113221d1d9379aed8b77f57224f6d" category="paragraph">Para ativar a descarga de cópia otimizada do FlexGroup, consulte<block ref="fbd3cc38c04df5a782d56a4261d462a4" category="inline-link-rx"></block></block>
  <block id="dd2b1d725ccce54064350ab418850836" category="paragraph">Para obter mais informações sobre como usar o FlexGroup volumes com VAAI, consulte este artigo da KB:<block ref="23db52497ce446299e31ecc0b7572649" category="inline-link-rx"></block></block>
  <block id="b66d69c6b478b422763ae8a4362fd4cc" category="paragraph">Observe que o VMware vSphere trata todas as IO para um datastore NFS como uma única fila por host, e a regulagem da QoS em uma VM pode afetar a performance de outras VMs no mesmo datastore para esse host. Isso está em contraste com o vVols, que pode manter suas configurações de política de QoS se eles migrarem para outro datastore e não afetarem o IO de outras VMs quando forem controlados.</block>
  <block id="55fcf4f8582fc20cbc496c8370d02a9f" category="list-text">VMware e NetApp suportam entroncamento de sessão NFSv4,1 começando com ONTAP 9.14,1. Consulte as notas da ferramenta de Matriz de interoperabilidade (IMT) do NetApp NFS 4,1 para obter detalhes específicos da versão. O NFSv3 não oferece suporte a vários caminhos físicos para um volume, mas oferece suporte ao nconnect a partir do vSphere 8.0U2. Mais informações sobre o nconnect podem ser encontradas no <block ref="2b967deae9aa9df284273d8dd1c4a3f3" category="inline-link-macro-rx"></block>.</block>
  <block id="692b0504520eb51f2f7e36bb610ab39c" category="list-text">Use o plug-in NFS para VMware VAAI para descarga de cópia. Observe que, embora a clonagem seja aprimorada em um datastore FlexGroup, como mencionado anteriormente, o ONTAP não oferece vantagens significativas de desempenho em comparação com a cópia do host ESXi ao copiar VMs entre volumes FlexVol e/ou FlexGroup. Portanto, considere seus workloads de clonagem ao decidir usar volumes VAAI ou FlexGroup. Modificar o número de volumes constituintes é uma forma de otimizar a clonagem baseada em FlexGroup. Como está ajustando o tempo limite do cache mencionado anteriormente.</block>
  <block id="7e6aa8006e5e8e08a135d46ba03f7aca" category="list-text">Use as ferramentas do ONTAP para o VMware vSphere 9,8-9,13 para monitorar a performance das VMs FlexGroup usando métricas do ONTAP (painel e relatórios de VM) e gerenciar a QoS em VMs individuais. Essas métricas não estão disponíveis atualmente por meio de comandos ou APIs do ONTAP.</block>
  <block id="b8ed23c8b817e9613412fc97543a876a" category="list-text">Se você usar o fpolicy, certifique-se de excluir arquivos .lck, pois eles são usados pelo vSphere para bloquear sempre que uma VM é ligada.</block>
  <block id="d76b03755162bf8402fea0ef97d95c2b" category="list-text">Consulte as notas da tabela de interoperabilidade NFS v4,1 no <block ref="aaa18d9ccb38f09094f0c241a8585efd" category="inline-link-macro-rx"></block> para obter os níveis de patch ESXi específicos necessários para suporte.</block>
  <block id="2e5d8aa3dfa8ef34ca5131d20f9dad51" category="inline-link-macro">definições</block>
  <block id="428a818039f2f00961fdd9e4de07b721" category="inline-link">VMware KB 386364</block>
  <block id="e43e8e9d4a1f6f9dbd56154ac2df4c6a" category="list-text">Como mencionado no <block ref="5c427f7294fd54c254262776a96b148a" category="inline-link-macro-rx"></block>, se você não estiver usando o vSphere CSI for Kubernetes, você deve definir o newSyncInterval per<block ref="e3529737a3b4eef7cff2c05dcd47fcdc" category="inline-link-rx"></block></block>
  <block id="686d950560445531708a511e6ad1567c" category="paragraph">No vSphere, há quatro maneiras de usar dispositivos de armazenamento em bloco:</block>
  <block id="8f3179360beae87966e6fc5f46edfb7b" category="list-text">Como um datastore vVols</block>
  <block id="041c0652f0218403d2721d2ddd9260df" category="admonition">As extensões são um conceito de armazenamento do vSphere pelo qual você pode "unir" vários LUNs para criar um único armazenamento de dados maior. Você nunca deve usar extensões para alcançar o tamanho desejado do datastore. Um único LUN é a melhor prática para um datastore VMFS.</block>
  <block id="9d6605bbb339340832866d8bab7bf7e5" category="paragraph">O vSphere inclui suporte integrado para vários caminhos para dispositivos de armazenamento. O vSphere pode detetar o tipo de dispositivo de armazenamento para sistemas de armazenamento suportados e configurar automaticamente a pilha de multipathing para suportar os recursos do sistema de armazenamento em uso, regarldess do protocolo usado ou se estiver usando ASA, AFF, FAS ou ONTAP definido por software.</block>
  <block id="4dbfcd0fae38bf4e35602557a83d9ea3" category="paragraph">Tanto o vSphere quanto o ONTAP dão suporte ao Asymmetric Logical Unit Access (ALUA) para estabelecer caminhos ativos/otimizados e ativos/não otimizados para Fibre Channel e iSCSI, além de acesso a namespace assimétrico (ANA) para namespaces NVMe usando NVMe/FC e NVMe/TCP. No ONTAP, um caminho otimizado para ALUA ou ANA segue um caminho de dados direto, usando uma porta de destino no nó que hospeda o LUN ou namespace que está sendo acessado. O ALUA/ANA é ativado por padrão no vSphere e no ONTAP. O software multipathing no vSphere reconhece o cluster ONTAP como ALUA ou ANA e usa o plug-in nativo apropriado com a política de balanceamento de carga round robin.</block>
  <block id="c35f72eea36b7f94209ed29c1e457501" category="paragraph">Com os sistemas ASA do NetApp, os LUNs e namespaces são apresentados aos hosts ESXi com pathing simétrico. O que significa que todos os caminhos estão ativos e otimizados. O software multipathing no vSphere reconhece o sistema ASA como simétrico e usa o plug-in nativo apropriado com a política de balanceamento de carga round robin.</block>
  <block id="719d3c21fd388bea9bc6e0ae1f7aead3" category="admonition"><block ref="1f38ac07598dbb4b06912539aafa4211" category="inline-link-macro-rx"></block>Consulte para obter as definições de multipathing otimizadas.</block>
  <block id="ab0394f516e490b8b46d91283e6b9f4f" category="paragraph">O ESXi não vê LUNs, namespaces ou caminhos além de seus limites. Em um cluster ONTAP maior, é possível alcançar o limite de caminho antes do limite de LUN. Para lidar com essa limitação, o ONTAP oferece suporte ao mapa de LUN seletivo (SLM) na versão 8,3 e posterior.</block>
  <block id="43a4405ebd9c78d08e6cdf383a650243" category="paragraph">O SLM limita os nós que anunciam caminhos para um determinado LUN. É uma prática recomendada do NetApp ter pelo menos dois LIFs por nó e por SVM e usar o SLM para limitar os caminhos anunciados para o nó que hospeda o LUN e seu parceiro de HA. Embora existam outros caminhos, eles não são anunciados por padrão. É possível modificar os caminhos anunciados com os argumentos adicionar e remover nó de relatório dentro do SLM. Observe que os LUNs criados em versões anteriores ao 8,3 anunciam todos os caminhos e precisam ser modificados para anunciar apenas os caminhos para o par de HA de hospedagem. Para obter mais informações sobre o SLM, consulte a seção 5,9 do<block ref="a2bae1e6a9d1ce7703c1f95bb6ec1d6e" category="inline-link-rx"></block>. O método anterior de portsets também pode ser usado para reduzir ainda mais os caminhos disponíveis para um LUN. Os Portsets ajudam reduzindo o número de caminhos visíveis através dos quais os iniciadores em um iggroup podem ver LUNs.</block>
  <block id="b05dc829eda4798f22045fd6851afaaf" category="list-text">Para LUNs criadas antes do Data ONTAP 8.3, aplique manualmente o SLM executando o<block ref="886fd385b633a0746a8a08f8f00c67cd" prefix=" " category="inline-code"></block> comando para remover os nós de relatórios de LUN e restringir o acesso LUN ao nó proprietário de LUN e ao seu parceiro de HA.</block>
  <block id="b0bdc1022637913a5e63f708d401c7dd" category="paragraph">Os protocolos de bloco baseados em SCSI (iSCSI, FC e FCoE) acessam LUNs usando IDs de LUN e números de série, juntamente com nomes exclusivos. FC e FCoE usam nomes mundiais (WWNNs e WWPNs) e iSCSI usa nomes qualificados iSCSI (IQNs) para estabelecer caminhos com base em mapeamentos de LUN para agrupar filtrados por portsets e SLM. Os protocolos de bloco baseados em NVMe são gerenciados atribuindo o namespace com um ID de namespace gerado automaticamente a um subsistema NVMe e mapeando esse subsistema para o nome qualificado do NVMe (NQN) do(s) host(s). Independentemente do FC ou TCP, os namespaces NVMe são mapeados usando o NQN e não o WWPN ou WWNN. O host então cria um controlador definido por software para que o subsistema mapeado acesse seus namespaces. O caminho para LUNs e namespaces dentro do ONTAP não tem sentido para os protocolos de bloco e não é apresentado em nenhum lugar do protocolo. Portanto, um volume que contém apenas LUNs não precisa ser montado internamente, e um caminho de junção não é necessário para volumes que contêm LUNs usados em datastores.</block>
  <block id="274b68192b056e268f128ff63bfcd4a4" category="cell">n/a.</block>
  <block id="582afacce7e9a2be95f7ef78c502a227" category="cell">256 conexões NFS por host (impactadas pelo nconnect e pelo entroncamento de sessão) NFS padrão. MaxVolumes é 8. Use as ferramentas do ONTAP para o VMware vSphere para aumentar para 256.</block>
  <block id="10a941de93465e9a6eee9a21f0334c73" category="cell">300TB FlexVol volume ou superior com volume FlexGroup</block>
  <block id="5567896b478134e909968961c6a17720" category="cell">Live Site Recovery/Site Recovery Manager</block>
  <block id="9ec9fe6b9d42732de69c5f1b252be1db" category="cell">Instantâneos do ONTAP</block>
  <block id="ddf9393cfd2f44676f3a0bce71fc55e0" category="cell">Software de backup habilitado para SnapCenter e VADP</block>
  <block id="a383dfc926e414528d11cef825a5dbf3" category="cell">Software de backup habilitado para SnapCenter e VADP, vSphere Client e vSphere Web Client datastore browser</block>
  <block id="f44de200e9dad7356d95c3b2b370d3ef" category="cell">Software de backup habilitado para SnapCenter e VADP, somente Windows</block>
  <block id="ff9f148c8b974c820cc302f7190a7533" category="cell">Software de backup habilitado para SnapCenter e VADP e aplicativos de terceiros</block>
  <block id="920ab17e6978a5f8b455022d3ec15080" category="paragraph">*1 *a NetApp recomenda* o uso de iSCSI in-Guest para clusters da Microsoft em vez de VMDKs habilitados para vários gravadores em um armazenamento de dados VMFS. Essa abordagem é totalmente suportada pela Microsoft e VMware, oferece grande flexibilidade com o ONTAP (sistemas SnapMirror para ONTAP no local ou na nuvem), é fácil de configurar e automatizar e pode ser protegido com o SnapCenter. O vSphere 7 adiciona uma nova opção de VMDK em cluster. Isso é diferente dos VMDKs habilitados para vários gravadores, que exigem um armazenamento de dados VMFS 6 que tenha o suporte do VMDK em cluster habilitado. Aplicam-se outras restrições. Consulte a documentação da VMware <block ref="46658ede14d15d79e2a20c75a7b15bb2" category="inline-link-macro-rx"></block>para obter diretrizes de configuração.</block>
  <block id="1c39c1dd8f654eedbd266d325b8b2bfe" category="paragraph">Os sistemas que executam o ONTAP dão suporte a todos os principais protocolos de storage. Assim, os clientes podem escolher o que é melhor para o ambiente, dependendo das habilidades da equipe e da infraestrutura de rede existentes e planejadas. Historicamente, os testes de NetApp geralmente mostraram pouca diferença entre os protocolos executados em velocidades de linha semelhantes e o número de conexões. No entanto, o NVMe-of (NVMe/TCP e NVMe/FC) mostra ganhos notáveis em IOPS, redução na latência e redução de até 50% ou mais no consumo de CPU de host por IO de storage. No outro extremo do espetro, o NFS oferece a maior flexibilidade e facilidade de gerenciamento, especialmente para um grande número de VMs. Todos esses protocolos podem ser usados e gerenciados com as ferramentas do ONTAP para VMware vSphere, que fornece uma interface simples para criar e gerenciar datastores.</block>
  <block id="a057cf188c3e7763e47d59ffd633784e" category="list-text">* Ambiente operacional atual.* Embora as equipes DE TI geralmente sejam qualificadas para gerenciar a infraestrutura Ethernet IP, nem todas elas são qualificadas para gerenciar uma malha FC SAN. No entanto, usar uma rede IP de uso geral que não foi projetada para o tráfego de armazenamento pode não funcionar bem. Considere a infraestrutura de rede que você tem em vigor, quaisquer melhorias planejadas e as habilidades e disponibilidade da equipe para gerenciá-los.</block>
  <block id="03acb8fd56768c1827623c3c7e78f5ad" category="list-text">* Facilidade de gestão. * Com os protocolos SAN, se mais espaço for necessário, várias etapas são necessárias, incluindo o crescimento de um LUN, a digitalização novamente para descobrir o novo tamanho e, em seguida, o crescimento do sistema de arquivos). Embora seja possível aumentar um LUN, reduzir o tamanho de um LUN não é. O NFS permite um dimensionamento fácil para cima ou para baixo, e esse redimensionamento pode ser automatizado pelo sistema de armazenamento. O SAN oferece recuperação de espaço através de comandos Guest os desalocar/TRIM/UNMAP, permitindo que o espaço dos arquivos excluídos seja retornado ao array. Esse tipo de recuperação de espaço não é possível difícil com armazenamentos de dados NFS.</block>
  <block id="2153785b657110dbec7bac0a2931c4b0" category="paragraph">Os sistemas de storage ONTAP oferecem grande flexibilidade na criação de datastores para VMs e discos virtuais. Embora muitas práticas recomendadas do ONTAP sejam aplicadas ao usar as ferramentas do ONTAP para provisionar armazenamentos de dados para o vSphere (listadas na <block ref="2e24324ebf41be836715e1e0dd648f4f" category="inline-link-macro-rx"></block>seção ), veja algumas diretrizes adicionais a serem consideradas:</block>
  <block id="4179f1498130aa878933f74dbe16642c" category="list-text">A implantação do vSphere com armazenamentos de dados NFS do ONTAP resulta em uma implementação de alta performance e fácil de gerenciar que fornece taxas de VM para armazenamento de dados que não podem ser obtidas com protocolos de storage baseados em bloco. Essa arquitetura pode resultar em um aumento de dez vezes na densidade do datastore com uma redução correlacionada no número de datastores. Embora um datastore maior possa beneficiar a eficiência de storage e fornecer benefícios operacionais, considere o uso de pelo menos quatro datastores (volumes FlexVol) por nó para armazenar suas VMs em uma única controladora ONTAP a fim de obter o máximo de performance com os recursos de hardware. Essa abordagem também permite que você estabeleça datastores com diferentes políticas de recuperação. Alguns podem ser copiados ou replicados com mais frequência do que outros com base nas necessidades empresariais. Vários armazenamentos de dados não são necessários com o FlexGroup volumes para obter performance, pois são dimensionados de acordo com o design.</block>
  <block id="1bce4f9db0fda9ee171dac82c454e8f5" category="list-text">*A NetApp recomenda* o uso de volumes FlexVol para a maioria dos armazenamentos de dados NFS. A partir do ONTAP 9.8, os volumes FlexGroup também são compatíveis para uso como datastores, e geralmente são recomendados para certos casos de uso. Outros contentores de armazenamento do ONTAP, como qtrees, geralmente não são recomendados, porque eles não são atualmente suportados pelas ferramentas do ONTAP para VMware vSphere ou pelo plug-in do NetApp SnapCenter para VMware vSphere.</block>
  <block id="6826e55696449edeff52e813c25cad54" category="list-text">Um bom tamanho para um datastore FlexVol volume é de cerca de 4TB a 8TB. Esse tamanho é um bom ponto de equilíbrio para performance, facilidade de gerenciamento e proteção de dados. Comece pequeno (digamos, 4TB) e cresça o datastore conforme necessário (até o máximo de 300TB). Armazenamentos de dados menores são mais rápidos para se recuperar do backup ou após um desastre e podem ser movidos rapidamente pelo cluster. Considere o uso do dimensionamento automático do ONTAP para aumentar e diminuir automaticamente o volume conforme o espaço usado muda. As ferramentas do ONTAP para o Assistente de provisionamento de datastore do VMware vSphere usam o dimensionamento automático por padrão para novos datastores. A personalização adicional dos limites de crescimento e redução e o tamanho máximo e mínimo podem ser feitos com o System Manager ou com a linha de comando.</block>
  <block id="0546b812db9e807a7b499d48c3af08ef" category="list-text">Como alternativa, armazenamentos de dados VMFS podem ser configurados com LUNs ou namespaces NVMe (chamados de unidades de storage em novos sistemas ASA) acessados por FC, iSCSI, NVMe/FC ou NVMe/TCP. O VMFS permite que armazenamentos de dados sejam acessados simultaneamente por cada servidor ESX em um cluster. Os armazenamentos de dados VMFS podem ter até 64TB TB de tamanho e consistem em até 32 2TB LUNs (VMFS 3) ou um único LUN 64TB (VMFS 5). O tamanho máximo de LUN do ONTAP é de 128TB GB em sistemas AFF, ASA e FAS. O NetApp sempre recomenda o uso de um único LUN grande para cada datastore, em vez de tentar usar extensões. Assim como o NFS, considere o uso de vários armazenamentos de dados (volumes ou unidades de storage) para maximizar a performance em uma única controladora ONTAP.</block>
  <block id="69f31e71b4d944d0f4c405d0e6e39f7e" category="list-text">Em alguns casos, talvez você nem precise de um datastore. Considere sistemas de arquivos de propriedade de hóspedes, como sistemas de arquivos NFS, SMB, NVMe/TCP ou iSCSI gerenciados pelo convidado. Para obter orientações específicas sobre aplicações, consulte relatórios técnicos da NetApp para a sua aplicação. Por exemplo, <block ref="cfa0393f870bc70fd8973ae18376facc" category="inline-link-macro-rx"></block> tem uma seção sobre virtualização com detalhes úteis.</block>
  <block id="bcc3251e9d72ed4c51a3b9557e4067c9" category="list-text">Embora você possa Planejar cuidadosamente uma migração para armazenamentos de dados de destino apropriados, muitas vezes é mais simples migrar em massa e depois organizar mais tarde, conforme necessário. Talvez você queira usar essa abordagem para orientar sua migração para diferentes armazenamentos de dados se tiver necessidades específicas de proteção de dados, como diferentes programações do Snapshot. Além disso, uma vez que as VMs estão no cluster do NetApp, o storage vMotion pode usar descarregamentos do VAAI para mover VMs entre armazenamentos de dados no cluster sem exigir uma cópia baseada em host. Observe que o NFS não descarrega o storage vMotion de VMs ativadas, no entanto, o VMFS faz.</block>
  <block id="0ad05ff30fea1e84deaaa1ed7bee8fac" category="paragraph">A prática recomendada mais importante ao usar o vSphere com sistemas executando o ONTAP é instalar e usar as ferramentas do ONTAP para o plug-in do VMware vSphere (anteriormente conhecido como console de armazenamento virtual). Esse plug-in do vCenter simplifica o gerenciamento de storage, aumenta a disponibilidade e reduz os custos de storage e a sobrecarga operacional, seja usando SAN ou nas, ASA, AFF, FAS ou até mesmo ONTAP Select (uma versão definida por software ONTAP executada em uma VM VMware ou KVM). Ele usa as práticas recomendadas para provisionar armazenamentos de dados e otimiza as configurações do host ESXi para timeouts multipath e HBA (descritos no Apêndice B). Como é um plug-in do vCenter, ele está disponível para todos os clientes da Web vSphere que se conetam ao servidor vCenter.</block>
  <block id="e4aac7f3219a7f18dc97515d5997afad" category="admonition">Nos clusters do vSphere baseados em imagens, você ainda vai querer adicionar o plug-in NFS à sua imagem para que eles não fiquem em conformidade quando você o instalar com as ferramentas do ONTAP.</block>
  <block id="279b6091a0ac82b44d1b55974e5be84e" category="paragraph">As ferramentas do ONTAP também são a interface de gerenciamento para muitas funções do provedor VASA para ONTAP, oferecendo suporte ao gerenciamento baseado em políticas de storage com vVols.</block>
  <block id="56de38ee4f3cd70309ddc44c00acb1fb" category="list-text">O NetApp recomenda apenas desativar o controle de fluxo de rede nas portas de interconexão de cluster dentro de um cluster ONTAP. O NetApp não faz outras recomendações sobre as práticas recomendadas para as portas de rede restantes usadas para tráfego de dados. Você deve ativar ou desativar conforme necessário. <block ref="3455dc2b3e7cd12a38e508bec690aa67" category="inline-link-rx"></block>Consulte para obter mais informações sobre o controlo de fluxo.</block>
  <block id="3a04c6fe53e84b0859143746f9b8b3bc" category="paragraph">Fazer backup e recuperar rapidamente suas máquinas virtuais (VMs) são as principais vantagens do uso do ONTAP para vSphere. Essa funcionalidade pode ser gerenciada facilmente no vCenter por meio do plug-in do SnapCenter para VMware vSphere. Muitos clientes aprimoram suas soluções de backup de terceiros com o SnapCenter para aproveitar a tecnologia de snapshot da ONTAP, pois oferece a maneira mais rápida e simples de recuperar uma VM com o ONTAP. O SnapCenter está disponível gratuitamente para clientes que têm a licença ONTAP One e outros pacotes de licença também podem estar disponíveis.</block>
  <block id="67d2d8d1dc0c08c63452e2a455c1bf3d" category="inline-link">BlueXP  para backup e recuperação de máquinas virtuais</block>
  <block id="4ea1273c8c926cd862a042dc3ea5ea79" category="paragraph">Além disso, o plug-in SnapCenter para VMware pode ser integrado ao<block ref="1cc430bf00ff724bb248ae086da62e35" category="inline-link-rx"></block>, permitindo soluções de backup 3-2-1 eficazes para a maioria dos sistemas ONTAP. Observe que algumas taxas podem ser aplicadas se o uso de backup e recuperação do BlueXP  para máquinas virtuais com serviços premium, como armazenamentos de objetos para armazenamento de backup adicional. Esta seção descreve as várias opções disponíveis para proteger suas VMs e armazenamentos de dados.</block>
  <block id="17d20b1dcedfc04c7879e9675412b0db" category="section-title">Instantâneos de volume do NetApp ONTAP</block>
  <block id="424a2b394957a69a3a605706153f9539" category="paragraph">Os snapshots são um recurso importante do ONTAP, permitindo que você crie cópias pontuais de seus dados. Eles são eficientes em espaço e podem ser criados rapidamente, o que os torna ideais para proteger VMs e datastores. Os snapshots podem ser usados para vários fins, incluindo backup, recuperação e teste. Esses snapshots são diferentes dos snapshots VMware (consistência) e são adequados para proteção de longo prazo. Os snapshots gerenciados pelo vCenter da VMware só são recomendados para uso a curto prazo devido ao desempenho e outros efeitos. <block ref="edb84c63886608dd2a747873a2732130" category="inline-link-macro-rx"></block>Consulte para obter mais detalhes.</block>
  <block id="9fe3ffc9df0f8a5c691d2ed0c67a5b03" category="paragraph">Os snapshots são criados no nível do volume e podem ser usados para proteger todas as VMs e armazenamentos de dados dentro desse volume. Isso significa que você pode criar um snapshot de um datastore inteiro, que inclui todas as VMs dentro desse datastore.</block>
  <block id="d1c6249258c65372addf83e0659b487e" category="paragraph">Para armazenamentos de dados NFS, você pode visualizar facilmente arquivos de VM em snapshots navegando no diretório .snapshots. Isso permite que você acesse e restaure rapidamente arquivos de um snapshot sem a necessidade de usar uma solução de backup específica.</block>
  <block id="98366d305ee795988e2e64b7dc1644c0" category="paragraph">Para datastores VMFS, você pode criar um FlexClone do datastore com base no snapshot desejado. Isso permite que você crie um novo datastore baseado no snapshot, que pode ser usado para fins de teste ou desenvolvimento. O FlexClone só consumirá espaço para as alterações feitas após o snapshot ser obtido, tornando-o uma maneira eficiente de espaço para criar uma cópia do datastore. Uma vez que o FlexClone é criado, você pode mapear o LUN ou namespace para um host ESXi como um datastore comum. Isso permite que você restaure arquivos de VM específicos, além de permitir a criação rápida de ambientes de teste ou desenvolvimento com base em dados de produção sem impactar a performance do ambiente de produção.</block>
  <block id="03e4c24bf78c3a62e1dced5c76036cf1" category="inline-link">Cópias Snapshot locais do ONTAP</block>
  <block id="331645ef05e71ecf888b1c6732e111f1" category="inline-link">Replicação ONTAP SnapMirror</block>
  <block id="428f746f2aae5a59f6c035e9d5ea0b6f" category="paragraph">Para obter mais informações sobre instantâneos, consulte a documentação do ONTAP. Os seguintes links fornecem detalhes adicionais: <block ref="8952dffd5c4f20d5268260325aabe39c" category="inline-link-rx"></block> <block ref="0f48fac4970e6e00b85c774c033fa517" category="inline-link-rx"></block></block>
  <block id="27ad839d4296d122cd72e93f1112d733" category="section-title">Plug-in do SnapCenter para VMware vSphere</block>
  <block id="f3980536bb15eae0ba5c0b2657f8433a" category="paragraph">O SnapCenter permite criar políticas de backup que podem ser aplicadas a vários trabalhos. Essas políticas podem definir agendamento, retenção, replicação e outros recursos. Elas continuam permitindo uma seleção opcional de snapshots consistentes com VM, o que aproveita a capacidade do hipervisor de silenciar a I/o antes de tirar um snapshot da VMware. No entanto, devido ao efeito de desempenho dos snapshots VMware, eles geralmente não são recomendados, a menos que você precise que o sistema de arquivos Guest seja encerrado. Em vez disso, use snapshots para proteção geral e use ferramentas de aplicativos, como plug-ins de aplicativos SnapCenter, para proteger dados transacionais, como SQL Server ou Oracle.</block>
  <block id="fcc3a75d51e5e5b8a03324e1a626fb47" category="paragraph">Esses plug-ins oferecem recursos estendidos para proteger os bancos de dados em ambientes físicos e virtuais. Com o vSphere, você pode usá-los para proteger bancos de dados SQL Server ou Oracle em que os dados são armazenados em LUNs RDM, vVols ou namespaces NVMe/TCP e LUNs iSCSI diretamente conetados ao sistema operacional convidado ou arquivos VMDK em armazenamentos de dados VMFS ou NFS. Os plug-ins permitem a especificação de diferentes tipos de backups de banco de dados, suporte a backup on-line ou off-line e proteção de arquivos de banco de dados juntamente com arquivos de log. Além de backup e recuperação, os plug-ins também dão suporte à clonagem de bancos de dados para fins de desenvolvimento ou teste.</block>
  <block id="ed4b38adcac92958d35c1949278ac403" category="inline-link">Guia de dimensionamento do plug-in SnapCenter para VMware vSphere</block>
  <block id="12a351ccc1f78e4aee2d5bf9f55f754b" category="paragraph">Para obter informações sobre o dimensionamento, consulte a.<block ref="c5fb486dbca6b73042cefb5314c3e0ce" category="inline-link-rx"></block></block>
  <block id="555f2327888d8e7cf50068fd301b189d" category="section-title">Ferramentas do ONTAP para VMware vSphere com recuperação de site ao vivo da VMware</block>
  <block id="bdfe900673edfc6634c23bde843c6420" category="paragraph">As ferramentas do ONTAP para VMware vSphere (OT4VS) são um plug-in gratuito que oferece uma integração perfeita entre o VMware vSphere e o NetApp ONTAP. Ele permite que você gerencie seu armazenamento do ONTAP diretamente do cliente da Web vSphere, facilitando a execução de tarefas como provisionamento de armazenamento, gerenciamento de replicação e monitoramento de desempenho.</block>
  <block id="d6c59a18f3b83d8486f9527e20ea1941" category="paragraph">Para melhorar os recursos de recuperação de desastres, considere a utilização do NetApp SRA for ONTAP, que faz parte das ferramentas do ONTAP para VMware vSphere, juntamente com o VMware Live Site Recovery (anteriormente conhecido como Site Recovery Manager). Essa ferramenta não só dá suporte à replicação de armazenamentos de dados em um local de recuperação de desastres usando o SnapMirror, como também permite testes sem interrupções no ambiente de recuperação de desastres clonando os armazenamentos de dados replicados. Além disso, a recuperação de um desastre e a reproteção da produção após a resolução de uma interrupção são simplificadas graças aos recursos de automação incorporados.</block>
  <block id="79a1fdb37699dfdc15254e04268351a9" category="section-title">Recuperação de desastres do BlueXP</block>
  <block id="7016de5d1fb67d54b51ad6574763fd9a" category="paragraph">O BlueXP  Disaster Recovery (DR) é um serviço baseado na nuvem que fornece uma solução abrangente para proteger seus dados e aplicações em caso de desastre. Ele oferece uma variedade de recursos, incluindo failover automatizado e failback, pontos de recuperação de vários pontos no tempo, recuperação de desastres consistente com aplicações e suporte para sistemas ONTAP baseados na nuvem e no local. O BlueXP  DR foi projetado para funcionar perfeitamente com o ONTAP e seu ambiente VMware vSphere, fornecendo uma solução unificada para recuperação de desastres.</block>
  <block id="d223a7adee575c4956124c0868f0825f" category="section-title">Cluster de armazenamento Metro do vSphere (vMSC) com sincronização ativa do NetApp MetroCluster e do SnapMirror</block>
  <block id="85abd770c37e6b8f0dd32bb10e63df19" category="paragraph">Por fim, para obter o mais alto nível de proteção de dados, considere uma configuração vMSC (VMware vSphere Metro Storage Cluster) usando o NetApp MetroCluster. O vMSC é uma solução compatível com NetApp certificada pela VMware que usa replicação síncrona, oferecendo os mesmos benefícios de um cluster de alta disponibilidade, mas distribuída em locais separados para proteger contra desastres no local. A sincronização ativa do NetApp SnapMirror, com ASA e AFF, e o MetroCluster com AFF, oferece configurações econômicas para replicação síncrona com recuperação transparente de qualquer falha de componente de storage, bem como recuperação transparente no caso da sincronização ativa do SnapMirror ou recuperação de comando único no caso de um desastre no local com MetroCluster. O vMSC é descrito em mais detalhes em<block ref="252912db8b98e51588a897ab91b985e0" category="inline-link-rx"></block>.</block>
  <block id="99f033ca163a880d3ebaf5192a303bf9" category="paragraph">Os sistemas executando o ONTAP facilitam a proteção de quaisquer dados com criptografia em repouso. O NetApp Storage Encryption (NSE) usa unidades com autocriptografia (SEDs) com ONTAP para proteger dados de SAN e nas. O NetApp também oferece o NetApp volume Encryption e o NetApp Aggregate Encryption como uma abordagem simples e baseada em software para encriptar volumes em qualquer unidade de disco. Esta criptografia de software não requer unidades de disco especiais ou gerenciadores de chaves externos e está disponível para clientes ONTAP sem nenhum custo adicional. Você pode fazer upgrade e começar a usá-lo sem qualquer interrupção para seus clientes ou aplicativos, e eles são validados de acordo com o padrão FIPS 140-2 nível 1, incluindo o Gerenciador de chaves integrado.</block>
  <block id="5826cf23650ea572524e9309431c2169" category="list-text">*Onboard Key Manager incluído.* A criptografia do software NetApp inclui um Gerenciador de chaves integrado sem custo adicional, o que facilita o início sem servidores de gerenciamento de chaves de alta disponibilidade que são complexos de comprar e usar.</block>
  <block id="1499e638502a512eab8c6e5e76d54ece" category="paragraph">É simples começar a usar a criptografia de software. Depois que a licença for instalada, basta configurar o Gerenciador de chaves integrado especificando uma senha e, em seguida, criar um novo volume ou fazer uma movimentação de volume no lado do armazenamento para ativar a criptografia. A NetApp está trabalhando para adicionar suporte mais integrado aos recursos de criptografia em versões futuras de suas ferramentas VMware.</block>
  <block id="0499c7df3779345b8007d3f36acf7bae" category="list-text">Separe o tráfego de rede de armazenamento de outras redes. Uma rede separada pode ser obtida usando uma VLAN dedicada ou switches separados para armazenamento. Se a rede de armazenamento partilhar caminhos físicos, como uplinks, poderá necessitar de portas de QoS ou uplink adicionais para garantir uma largura de banda suficiente. Não conete os hosts diretamente ao storage a menos que o guia de solução o chame especificamente; use switches para ter caminhos redundantes e permitir que o VMware HA funcione sem intervenção.</block>
  <block id="d0ffa72f3503feac723dc422bf406d9f" category="list-text">Jumbo Frames devem ser usados se suportado pela sua rede. Se forem usados, certifique-se de que estejam configurados de forma idêntica em todos os dispositivos de rede, VLANs e assim por diante no caminho entre o armazenamento e o host ESXi. Caso contrário, você pode ver problemas de desempenho ou conexão. A MTU também deve ser definida de forma idêntica no switch virtual ESXi, na porta VMkernel e também nas portas físicas ou grupos de interface de cada nó ONTAP.</block>
  <block id="7e8f5f024231d60cdc9576880a7f052a" category="list-text">O NetApp recomenda apenas desativar o controle de fluxo de rede nas portas de interconexão de cluster dentro de um cluster ONTAP. A NetApp não faz outras recomendações sobre práticas recomendadas em relação ao controle de fluxo para as portas de rede restantes usadas para tráfego de dados. Você deve ativá-lo ou desativá-lo conforme necessário. <block ref="3455dc2b3e7cd12a38e508bec690aa67" category="inline-link-rx"></block>Consulte para obter mais informações sobre o controlo de fluxo.</block>
  <block id="6e4e8c0fcc610bc580228562a24b83ab" category="section-title">SAN (FC, NVMe/FC, iSCSI, NVMe/TCP), RDM</block>
  <block id="10a270aa1bdf582d9f25983e1c822f19" category="paragraph">Às vezes, os administradores de storage preferem simplificar suas infraestruturas removendo switches de rede da configuração. Isso pode ser suportado em alguns cenários. No entanto, existem algumas limitações e ressalvas a serem observadas.</block>
  <block id="020f95916177eb14567bf65de71d3668" category="paragraph">Na prática, os clientes da NetApp têm NFS com conexão direta, mas normalmente apenas para workloads em que as pausas de e/S durante failovers são aceitáveis. Quando os suportes rígidos são usados, não deve haver nenhum erro de e/S durante essas pausas. O IO deve congelar até que os serviços sejam restaurados, seja por uma intervenção de failback ou manual para mover endereços IP entre NICs no host.</block>
  <block id="72ddef074f60e5fc537d32dc77a96c36" category="paragraph">Este documento apresenta a solução ONTAP para vSphere, destacando as informações mais recentes do produto e as práticas recomendadas para simplificar a implantação, mitigar riscos e simplificar o gerenciamento.</block>
  <block id="ce688f68d7fc3cbdd2bee58fdaa7a3ae" category="paragraph">Este documento se concentra em recursos nas versões recentes do ONTAP (9.x) executadas no vSphere 7,0 ou posterior. Consulte<block ref="ab7acb1690084e25996646d49d4a381e" category="inline-link-rx"></block> e<block ref="e1593898142109fc8cd8025356d3f312" category="inline-link-rx"></block> para obter detalhes relacionados a lançamentos específicos.</block>
  <block id="7642d26aa7df3de4ab3a541dbfe31437" category="paragraph">As VMware vSphere APIs for Storage Awareness (VASA) facilitam para um administrador de storage configurar datastores com recursos bem definidos e permitir que o administrador da VM use-os sempre que necessário para provisionar VMs sem ter que interagir uns com os outros.</block>
  <block id="13844ac053869d38b76530ed8f4159a9" category="paragraph">Antes do VASA, os administradores de VM podiam definir políticas de armazenamento de VM, mas precisavam trabalhar com o administrador de armazenamento para identificar armazenamentos de dados apropriados, geralmente usando documentação ou convenções de nomenclatura. Com o VASA, o administrador de storage pode definir uma variedade de recursos de storage, incluindo desempenho, disposição em camadas, criptografia e replicação. Um conjunto de recursos para um volume ou um conjunto de volumes é chamado de Perfil de capacidade de armazenamento (SCP).</block>
  <block id="ea70c1612f8cd9738b66d05af624f8c5" category="paragraph">As VMware vSphere APIs for Storage Awareness (VASA) facilitam para um administrador de storage configurar datastores com recursos bem definidos e permitir que o administrador da VM use-os sempre que necessário para provisionar VMs sem ter que interagir uns com os outros. Vale a pena dar uma olhada nessa abordagem para ver como ela pode otimizar suas operações de storage de virtualização e evitar muito trabalho trivial.</block>
  <block id="15526db5729ae485923742110cf54c7a" category="paragraph">O VMware Storage Distributed Resource Scheduler (SDRS) é um recurso do vSphere que coloca automaticamente as VMs em um cluster de datastore com base na latência de e/S atual e no uso do espaço.</block>
  <block id="e21e1ecabc11b1c40a35e9030d8474bd" category="list-text">Não use SDRS a menos que você tenha um requisito específico para fazê-lo.</block>
  <block id="397f2530fca86e36b28c183ded119555" category="list-text">OS SDRS não são necessários ao usar o ONTAP. OS SDRS não estão cientes dos recursos de eficiência de storage da ONTAP, como deduplicação e compactação, portanto, podem tomar decisões que não são ideais para o seu ambiente.</block>
  <block id="28ef5b69fedbf0bfc161c069c66b8c56" category="list-text">OS SDRS não estão cientes das políticas de QoS do ONTAP, portanto, podem tomar decisões que não são ideais para o desempenho.</block>
  <block id="07495043326316f508fa4c530196be56" category="list-text">OS SDRS não conhecem as cópias snapshot do ONTAP, portanto, podem tomar decisões que fazem com que os snapshots cresçam exponencialmente. Por exemplo, mover uma VM para outro datastore cria novos arquivos no novo datastore, o que faz com que o snapshot cresça. Isso é especialmente verdadeiro para VMs com discos grandes ou muitos snapshots. Então, se a VM for movida de volta para o datastore original, o snapshot no datastore original aumentará ainda mais.</block>
  <block id="2b53a21ac29cb3161e892454cf7f0621" category="paragraph">Se você usar SDRS, considere as seguintes práticas recomendadas:</block>
  <block id="2c1e5c80beebd647a22327e2b18b2ddf" category="list-text">Quando OS SDRS movem VMDKs entre armazenamentos de dados, qualquer economia de espaço da clonagem ou deduplicação do ONTAP pode ser reduzida, dependendo de quão bem ele deduplica ou compacta no destino.</block>
  <block id="2d8ff546478fe1dc3783d293a5650bb1" category="inline-link">Storage DRS FAQ</block>
  <block id="9fe1a69b0192fb5955b959edd763b9d6" category="paragraph">Mais informações sobre SDRS podem ser encontradas na documentação da VMware em<block ref="6f5bfdeedeaf40bf3dcc7dcc4311a1cf" category="inline-link-rx"></block>.</block>
  <block id="2a104d02cb0299df0ebe47fa0ceb2e3f" category="paragraph">Esses valores são facilmente definidos usando as ferramentas do ONTAP para VMware vSphere: Na página de visão geral das ferramentas do ONTAP, role para baixo até a parte inferior e clique em aplicar configurações recomendadas no portlet de conformidade do host ESXi.</block>
  <block id="b8ed49f8c2faef2a05f3432a8bf20432" category="cell">NewSyncInterval</block>
  <block id="b7715db44a4dfbe51370a25ea991a2f0" category="cell">Se você não estiver usando o vSphere CSI for Kubernetes, defina per<block ref="e3529737a3b4eef7cff2c05dcd47fcdc" category="inline-link-rx"></block></block>
  <block id="bc7b51a623cfc5e288b304d2f9c93eac" category="admonition">A opção de configuração avançada NFS MaxQueueDepth pode não funcionar como esperado ao usar o VMware vSphere ESXi 7.0.1 e o VMware vSphere ESXi 7,0.2. Referência <block ref="861055760f3cd527823fd34a49459992" category="inline-link-macro-rx"></block> para obter mais informações.</block>
  <block id="93754b0c6a333efae9b897da113630eb" category="paragraph">Originalmente, essa abordagem unificada se referia ao suporte aos protocolos nas e SAN em um sistema de storage, e a ONTAP continua sendo uma plataforma líder de SAN, juntamente com sua força original em nas. O ONTAP agora também fornece suporte ao protocolo de objetos S3. Embora o S3 não seja usado para datastores, você pode usá-lo para aplicações in-Guest. Pode obter mais informações sobre o suporte ao protocolo S3 no ONTAP no <block ref="9a0a48164e4b196191c2134bda6f342d" category="inline-link-macro-rx"></block>. O termo storage unificado evoluiu para significar uma abordagem unificada para o gerenciamento de storage, incluindo a capacidade de gerenciar todos os seus recursos de storage a partir de uma única interface. Isso inclui a capacidade de gerenciar recursos de storage de nuvem e no local, os sistemas All SAN Array (ASA) mais recentes e a capacidade de gerenciar vários sistemas de storage em uma única interface.</block>
  <block id="9f4686c99993be53ee2c19ad1e4f9c69" category="paragraph">Uma máquina virtual de storage (SVM) é a unidade de alocação segura a vários clientes no ONTAP. É uma construção lógica que permite o acesso do cliente a sistemas que executam o ONTAP. Os SVMs podem servir dados simultaneamente por meio de vários protocolos de acesso a dados por meio de interfaces lógicas (LIFs). As SVMs fornecem acesso a dados no nível do arquivo por meio de protocolos nas, como CIFS e NFS, e acesso a dados em nível de bloco por meio de protocolos SAN, como iSCSI, FC/FCoE e NVMe. Os SVMs podem fornecer dados a clientes SAN e nas de forma independente ao mesmo tempo, bem como ao S3.</block>
  <block id="ddf4bde5aaaa48fac85f6c5a4c180815" category="paragraph">O NetApp fornece várias ferramentas de software independentes compatíveis com os sistemas ONTAP e ASA tradicionais, integrando o vSphere para gerenciar efetivamente seu ambiente virtualizado.</block>
  <block id="9955c42610092bf7a7dbb035ba2362df" category="paragraph">As ferramentas a seguir estão incluídas com a licença ONTAP One sem custo adicional. Consulte a Figura 1 para ver uma descrição de como essas ferramentas funcionam juntas no seu ambiente vSphere.</block>
  <block id="28c25b3bd0941927acf5da7cedf09056" category="paragraph"><block ref="b4726a9e2d7c67e5d20fb7588efe2682" category="inline-link-rx"></block> O é um conjunto de ferramentas para usar o armazenamento do ONTAP junto com o vSphere. O plug-in do vCenter, anteriormente conhecido como Virtual Storage Console (VSC), simplifica o gerenciamento de storage e os recursos de eficiência, aprimora a disponibilidade e reduz os custos de storage e a sobrecarga operacional, independentemente de você estar usando SAN ou nas. Ele usa as práticas recomendadas para provisionar armazenamentos de dados e otimiza as configurações de host ESXi para ambientes de storage de bloco e NFS. Para todos esses benefícios, a NetApp recomenda o uso dessas ferramentas do ONTAP como uma prática recomendada ao usar o vSphere com sistemas que executam o ONTAP. Ele inclui um dispositivo de servidor, extensões de IU para vCenter, provedor VASA e adaptador de replicação de armazenamento. Quase tudo nas ferramentas do ONTAP pode ser automatizado com o uso de APIs REST simples, consumíveis pela maioria das ferramentas de automação modernas.</block>
  <block id="88450f60f7fbe5f503e1fecfcab9fb4d" category="list-text">* Extensões de IU do vCenter.* As extensões de IU das ferramentas do ONTAP simplificam o trabalho das equipes de operações e administradores do vCenter, incorporando menus sensíveis ao contexto fáceis de usar para gerenciar hosts e armazenamento, portlets informativos e recursos de alerta nativos diretamente na IU do vCenter para fluxos de trabalho simplificados.</block>
  <block id="c8e653ada77ce95f09e584738b7cf6bf" category="list-text">*Adaptador de replicação de armazenamento.* O SRA é usado em conjunto com o VMware Live Site Recovery (VLSR)/Site Recovery Manager (SRM) para gerenciar a replicação de dados entre locais de produção e recuperação de desastres usando o SnapMirror para replicação baseada em array. Ele pode automatizar a tarefa de failover em caso de desastre e pode ajudar a testar as réplicas de DR sem interrupções, para garantir a confiança na sua solução de DR.</block>
  <block id="e94c7ddc81c8b496a2e0b9c41f3a0d27" category="paragraph">O<block ref="df7f63ec4790cd7696ac38c73a72d254" category="inline-link-rx"></block> é um plug-in do vCenter Server que permite gerenciar backups e restaurações de máquinas virtuais (VMs) e datastores. Ele fornece uma única interface para gerenciar backups, restaurações e clones de VMs e armazenamentos de dados em vários sistemas ONTAP. O SnapCenter dá suporte à replicação e recuperação de locais secundários que usam o SnapMirror. As versões mais recentes também são compatíveis com SnapMirror para nuvem (S3), snapshots à prova de violações, SnapLock e sincronização ativa do SnapMirror. O plug-in do SnapCenter para VMware vSphere pode ser integrado aos plugins de aplicativos do SnapCenter para fornecer backups consistentes de aplicativos.</block>
  <block id="8fc0876b17dbd4327218c6365f4d3ed1" category="inline-link">Plug-in NFS do NetApp para VMware VAAI</block>
  <block id="6b7f9103f91020461893e7625153d87c" category="paragraph">O<block ref="e56b6fbfc57db1f13007ad438701316e" category="inline-link-rx"></block> é um plug-in para hosts ESXi que permite que eles usem recursos do VAAI com datastores NFS no ONTAP. Ele dá suporte a descarga de cópia para operações de clone, reserva de espaço para arquivos de disco virtual com espessura e descarga de snapshot. Descarregar operações de cópia para armazenamento não é necessariamente mais rápido de ser concluído, mas reduz os requisitos de largura de banda da rede e descarrega recursos do host, como ciclos de CPU, buffers e filas. Você pode usar as ferramentas do ONTAP para o VMware vSphere para instalar o plug-in em hosts ESXi ou, onde for compatível, o vLCM (vSphere Lifecycle Manager).</block>
  <block id="662df1486cbd8ddf1909b804fde3b122" category="section-title">Opções de software premium</block>
  <block id="754f31315c54f74cb54fc3931b77bc4e" category="inline-link">Recuperação de desastres (DR) do BlueXP </block>
  <block id="89a13650cc26099f24645b3ebabd8681" category="inline-link">Insights de infraestrutura de dados (DII)</block>
  <block id="99d0a5a8bf2f7f9a2f986e018accdd63" category="paragraph">Os seguintes produtos de software premium estão disponíveis na NetApp. Eles não estão incluídos na licença ONTAP One e devem ser comprados separadamente. *<block ref="051ef9ea109551a5c499e15c7ed416cd" category="inline-link-rx"></block> Para VMware vSphere. Este é um serviço baseado em nuvem que oferece recuperação de desastres e backup para ambientes VMware. Ele pode ser usado com ou sem SnapCenter e dá suporte à recuperação de desastres no local ou no local usando SAN ou nas e no local de/para a nuvem usando NFS onde compatível. *<block ref="7c477508804cee468db4a7dd703b8ca2" category="inline-link-rx"></block>. Este é um serviço baseado em nuvem que fornece monitoramento e análise para ambientes VMware. Ele dá suporte a outros fornecedores de storage em ambientes de storage heterogêneos, bem como a vários fornecedores de switch e outros hipervisores. O DII fornece insights completos completos sobre a performance, a capacidade e a integridade do seu ambiente VMware.</block>
  <block id="7449970110f98c992170b6bbd68252f9" category="paragraph">Como parceiro de design de tecnologia, a NetApp forneceu informações sobre arquitetura e, em 2015, anunciou suporte para vVols. Essa nova tecnologia agora permitiu a automação do provisionamento de storage granular e verdadeiramente nativo em array por meio do SPBM.</block>
  <block id="09807314260bef27b90345fd0212a57f" category="paragraph">Os contêineres de storage são criados por administradores de storage e são usados para agrupar recursos de storage que podem ser consumidos por administradores de VM. Os contêineres de armazenamento podem ser criados de forma diferente dependendo do tipo de sistema ONTAP que você está usando. Com clusters tradicionais do ONTAP 9, os contêineres recebem um ou mais volumes do FlexVol de backup que juntos formam o pool de storage. Com os sistemas ASA R2, todo o cluster é o pool de storage.</block>
  <block id="660bee009f0ed31eb05e51ba93850f4d" category="paragraph">*Dependendo da plataforma e do protocolo</block>
  <block id="935aaefee7fac977eb8c3770e167d5f9" category="summary">Os clientes escolhem com confiança o ONTAP para vSphere devido às suas soluções de storage SAN e nas unificadas e à nova arquitetura de storage desagregado simplificada, que é incluída nos arrays SAN mais recentes. Essa plataforma oferece proteção excecional contra snapshot e ferramentas de gerenciamento robustas. Ao descarregar funções para um storage dedicado, o ONTAP maximiza os recursos do host, reduz custos e mantém o desempenho ideal. Além disso, as cargas de trabalho podem ser facilmente migradas usando o Storage vMotion em VMFS, NFS ou vVols.</block>
  <block id="b587bd8bd461a8e643d3122ed2fc385e" category="doc">Por que o ONTAP para VMware vSphere?</block>
  <block id="f89ab8928b3772533629296451ffbbf3" category="section-title">As vantagens de usar o ONTAP para vSphere</block>
  <block id="be68f84ad2e7ab7d1f2a41defa80f499" category="list-text">*All SAN Array (ASA).* Os sistemas ONTAP ASA mais recentes (começando com A1K, A90, A70, A50, A30 e A20) foram criados com base em uma nova arquitetura de storage que elimina o paradigma tradicional de storage da ONTAP de gerenciamento de agregados e volumes. Como não há compartilhamentos de sistema de arquivos, não há necessidade de volumes! Todo o storage anexado a um par de HA é Tratado como uma zona de disponibilidade de storage (SAZ) comum na qual LUNs e namespaces NVMe são provisionados como "unidades de storage" (SUS). Os sistemas ASA mais recentes foram projetados para serem simples de gerenciar, com uma experiência familiar para administradores de storage de SAN. Essa nova arquitetura é ideal para ambientes vSphere, pois permite o gerenciamento fácil de recursos de storage e oferece uma experiência simplificada para administradores de storage SAN. A arquitetura do ASA também é compatível com a mais recente tecnologia NVMe over Fabrics (NVMe-of), que oferece ainda mais performance e escalabilidade para workloads vSphere.</block>
  <block id="088651913adba4fc73fbb23602f7c656" category="list-text">*Tecnologia Snapshot.* A ONTAP foi a primeira a fornecer tecnologia snapshot para proteção de dados, e continua sendo a mais avançada do setor. Essa abordagem com uso eficiente de espaço para proteção de dados foi estendida para oferecer suporte às APIs do VMware vSphere para Array Integration (VAAI). Essa integração permite que você aproveite os recursos de snapshot do ONTAP para operações de backup e restauração, reduzindo o impacto no seu ambiente de produção. Essa abordagem também permite que você use snapshots para recuperação rápida de VMs, reduzindo o tempo e o esforço necessários para restaurar os dados. Além disso, a tecnologia de snapshot da ONTAP é integrada às soluções de recuperação de site em tempo real (VLSR, anteriormente Gerenciador de recuperação de site [SRM]) da VMware, fornecendo uma estratégia abrangente de proteção de dados para o seu ambiente virtualizado.</block>
  <block id="9406fb3af0e8e2bf8446823785c0e069" category="inline-link">Insights da infraestrutura de dados</block>
  <block id="1c951601876e4daa83bce02aba074440" category="list-text">Antes de iniciar a instalação, deve verificar o<block ref="ab7acb1690084e25996646d49d4a381e" category="inline-link-rx"></block> para garantir que a sua implementação foi certificada.</block>
  <block id="ef30f0c0c266a8b9be1816aa72a0f58f" category="list-text">Determine se você usará SVMs multitenant ou permitirá acesso total ao cluster. Se você estiver usando SVMs multitenant, precisará ter um LIF de gerenciamento de SVM em cada SVM a ser usado. Esse LIF deve ser acessível pela porta 443 pelas ferramentas do ONTAP.</block>
  <block id="9822a79db54f54873c45b9060e0caedf" category="list-text">Se estiver usando a alocação a vários clientes de storage com SVMs</block>
  <block id="7d895ca5b825b3c5a05a52e7d39c803c" category="list-text">Se *não* usando SVMs multitenant</block>
  <block id="4050ff4d6d35bffd46dbff7fad4e6941" category="doc">Implantação de vVols em sistemas AFF, ASA, ASA R2 e FAS</block>
  <block id="8a440842662a6052845e4abd1f7d5dec" category="paragraph">O provisionamento de armazenamentos de dados vVols envolve várias etapas. Os sistemas ASA R2 da NetApp foram projetados para cargas de trabalho VMware e oferecem uma experiência do usuário diferente dos sistemas ONTAP tradicionais. Ao usar os sistemas ASA R2, as ferramentas do ONTAP 10,3 ou posterior exigem menos etapas para configurar e incluem extensões de IU e suporte à API REST otimizadas para a nova arquitetura de storage.</block>
  <block id="3164e4b18dd8dcc542a3c18024fc82b6" category="inline-link-macro">lista de verificação</block>
  <block id="35d34bb35f01ef3d59680d5fb99f1085" category="paragraph">Você pode ignorar as duas primeiras etapas do processo de implantação se você já estiver usando ferramentas do ONTAP para gerenciar, automatizar e gerar relatórios sobre o seu storage VMFS existente ou baseado em NFS tradicional. Você também pode consultar este completo <block ref="9dbdf15e49c83951dd903469aa18bcda" category="inline-link-macro-rx"></block> para implantar e configurar ferramentas do ONTAP.</block>
  <block id="d851df02ab3826ddf58a3627857cb8a5" category="list-text">Crie a Storage Virtual Machine (SVM) e sua configuração de protocolo. Observe que isso pode não ser necessário para os sistemas ASA R2, uma vez que eles geralmente já terão um único SVM para serviços de dados. Você selecionará NVMe/FC (somente ferramentas ONTAP 9,13), NFSv3, NFSv4,1, iSCSI, FCP ou uma combinação dessas opções. O NVMe/TCP e o NVMe/FC também podem ser usados em datastores VMFS tradicionais com as ferramentas do ONTAP 10,3 e posteriores. Você pode usar assistentes do Gerenciador de sistema do ONTAP ou a linha de comando do shell do cluster.</block>
  <block id="0be185fbc79ad0a2e0901c2bf99d7071" category="list-text">Para sistemas que não sejam ASA R2, volumes podem ser criados no momento, mas é a prática recomendada permitir que o assistente _provision datastore_ nas ferramentas do ONTAP os crie. A única exceção a esta regra é se você planeja usar a replicação do vVols com o VMware Site Recovery Manager e as ferramentas do ONTAP 9,13. Isso é mais fácil de configurar com volumes FlexVol pré-existentes com relacionamentos SnapMirror existentes. Lembre-se de não ativar o QoS em nenhum volume a ser usado para vVols, pois isso deve ser gerenciado por ferramentas SPBM e ONTAP.</block>
  <block id="08aa56f631ccbed4e095da7781f63af4" category="list-text">A prática recomendada é usar<block ref="ef398e4ee19e56a537bbd5564e5f4512" category="inline-link-rx"></block> o 10,3 e posterior para a configuração de alta disponibilidade (HA) de 3 nós para todos os workloads de produção. Para laboratórios ou fins de teste, é possível usar uma implantação de nó único.</block>
  <block id="ee88aebf80e3a3f63dfba15f3b663832" category="list-text">Em um ambiente multitenant seguro onde você deseja delegar SVMs (Storage Virtual Machines) específicas em vCenters específicos, você deve fazer o seguinte.</block>
  <block id="ddf4cee1ee4746501a3a74ca7e1b2ce0" category="paragraph">As políticas de armazenamento de VM são usadas no vSphere para gerenciar recursos opcionais, como Storage I/o Control ou vSphere Encryption. Eles também são usados com vVols para aplicar funcionalidades de storage específicas à VM. Use o tipo de armazenamento "NetApp.Clustered.Data.ONTAP.VP.vvol". Veja o link:vmware-vvols-ONTAP.exemplo de configuração de rede usando vVols sobre NFS v3] para um exemplo disso com as ferramentas do provedor VASA da ONTAP. As regras para o armazenamento "NetApp.Clustered.Data.ONTAP.VP.VASA10" devem ser usadas com datastores não baseados em vVols.</block>
  <block id="5e182d41ad3ea710eea81b3297a29a79" category="paragraph">A licença do ONTAP One inclui todas as licenças necessárias para usar vVols com sistemas ONTAP. O único requisito adicional é o OVA de ferramentas ONTAP gratuitas, que atua como o provedor VASA. Em um ambiente vVols, o software VASA Provider traduz recursos de array em atributos orientados a políticas que podem ser aproveitados por meio das APIs VASA sem que o administrador do vSphere precise saber como os recursos são gerenciados nos bastidores. Isso permite o consumo dinâmico da capacidade de storage alocada com base na política, eliminando a necessidade de criar manualmente armazenamentos de dados tradicionais e gerenciar suas taxas de consumo de storage individuais. Em resumo, o vVols elimina toda a complexidade do gerenciamento do storage empresarial e o abstrai do administrador do vSphere para que eles possam se concentrar na camada de virtualização.</block>
  <block id="98f85fc67e5f6131ae07084cdeebb84a" category="paragraph">As atualizações no local das ferramentas do ONTAP são suportadas usando o arquivo ISO de atualização disponível para download no<block ref="b5b3717cb556fa4a89daf005a0a23ea8" category="inline-link-rx"></block> site de suporte da NetApp (login necessário). Siga as<block ref="f4c1005a920344cdec43558687897506" category="inline-link-rx"></block> instruções do guia para atualizar o aparelho. Também é possível fazer uma atualização lado a lado das ferramentas ONTAP 9,13 para 10,3. <block ref="f6676f6d529f1f81f9da02084f545f3c" category="inline-link-rx"></block>Consulte para obter um mergulho mais profundo sobre esse assunto.</block>
  <block id="96e626dfdfc4f6474618b5d6e22f052e" category="list-text"><block ref="96e626dfdfc4f6474618b5d6e22f052e" category="inline-link-rx"></block></block>
  <block id="62c6b269dc04e5f59ec38c35e3251edb" category="paragraph">Embora seja possível criar armazenamentos de dados vVols com a interface geral do vSphere, o uso de ferramentas do ONTAP criará automaticamente pontos de extremidade de protocolo conforme necessário e criará volumes FlexVol (não necessários com o ASA R2) usando as práticas recomendadas do ONTAP. Basta clicar com o botão direito do Mouse no host/cluster/data center e selecionar _ONTAP Tools_ e _provision datastore_. A partir daí, basta escolher as opções vVols desejadas no assistente.</block>
  <block id="c1d59fa07379d331f1649dd32c8b663d" category="paragraph">Isso pode resultar em uma "situação de galinha e ovo" se você precisar reiniciar os aparelhos, porque eles não serão capazes de revincular seus próprios vVols enquanto eles estão reiniciando. Você pode armazená-los em um datastore vVols gerenciado por diferentes ferramentas do ONTAP e implantação do vCenter.</block>
  <block id="4e9810675a80252409e746ff4f07c469" category="paragraph">*Planeje seus volumes de apoio FlexVol de acordo com suas necessidades.*</block>
  <block id="6ce93abd27f08d98b3c9e6da0a3d3006" category="admonition">Este documento foi atualizado para incluir novos recursos do vVols encontrados na atualização 3 do vSphere 8,0, na versão 10,4 das ferramentas do ONTAP e nos novos sistemas NetApp ASA.</block>
  <block id="183c087ffc7731fee88c6d40b2024a45" category="paragraph">As VMware vSphere APIs for Storage Awareness (VASA) facilitam o uso dos recursos de armazenamento necessários para provisionar VMs sem ter que interagir com a equipe de armazenamento. Antes do VASA, os administradores de VM podiam definir políticas de armazenamento de VM, mas tiveram que trabalhar com seus administradores de armazenamento para identificar armazenamentos de dados apropriados, geralmente usando documentação ou convenções de nomenclatura. Com o VASA, os administradores do vCenter com as permissões apropriadas podem definir uma variedade de recursos de armazenamento que os usuários do vCenter podem usar para provisionar VMs. O mapeamento entre a política de storage de VM e os recursos do datastore permite que o vCenter exiba uma lista de datastores compatíveis para seleção, bem como a habilitação de outras tecnologias como o Aria (anteriormente conhecido como vRealize) Automation ou o Tanzu Kubernetes Grid para selecionar automaticamente o storage de uma política atribuída. Essa abordagem é conhecida como gerenciamento baseado em políticas de storage. Embora as regras do provedor VASA e as políticas de armazenamento de VM também possam ser usadas com armazenamentos de dados tradicionais, nosso foco aqui é nos armazenamentos de dados vVols.</block>
  <block id="daeee50444f5c211b19aa03182c97401" category="paragraph">Quando a VMware introduziu o suporte ao vVols com o VASA 2,0 em 2015, ela o descreveu como "uma estrutura de integração e gerenciamento que fornece um novo modelo operacional para armazenamento externo (SAN/nas)". Esse modelo operacional oferece vários benefícios em conjunto com o storage ONTAP.</block>
  <block id="5631462c0980ed3fbdd07e734f163939" category="list-text">Aproveite a automação e a orquestração por meio do pacote Aria (anteriormente vRealize), OpenStack e assim por diante.</block>
  <block id="40ea6e1672fc21c11ea997d9b187dcef" category="paragraph">Na versão inicial do suporte do SRM com as ferramentas do ONTAP 9.7.1, era necessário pré-criar volumes do FlexVol e habilitar a proteção do SnapMirror antes de usá-los como volumes de backup para um datastore vVols. A partir das ferramentas ONTAP 9,10, esse processo não é mais necessário. Agora, você pode adicionar proteção SnapMirror aos volumes de backup existentes e atualizar suas políticas de storage de VM para aproveitar o gerenciamento baseado em políticas com orquestração e recuperação de desastres e automação integradas ao SRM.</block>
  <block id="0d5e4b39b7c99ac3687449b64c2f61d7" category="paragraph">Além de uma variedade de artigos da base de conhecimento para produtos de virtualização NetApp, o site de suporte da NetApp também oferece uma página de destino conveniente para o<block ref="6e90053136fd326e5d581844ca21966d" category="inline-link-rx"></block> produto. Este portal fornece links para artigos, downloads, relatórios técnicos e discussões sobre soluções VMware na Comunidade NetApp. Está disponível em:</block>
  <block id="24096e60b90028c96c0a8e8df7c3c258" category="paragraph">As instruções de configuração do NetApp MetroCluster estão disponíveis em<block ref="2c736bccede87dae47dcf61108f083c4" category="inline-link-rx"></block>. As instruções para a sincronização ativa do SnapMirror (SMA) também estão disponíveis em<block ref="14203840309dd1b6e13f73373477bb9d" category="inline-link-rx"></block>.</block>
  <block id="e69c207b2671a8571c172595068da749" category="paragraph">Se não estiver usando o MetroCluster ou se você tiver sistemas ONTAP que não sejam compatíveis com o MetroCluster, como sistemas ASA R2, poderá usar o SnapMirror active Sync, que fornece proteção granular do armazenamento de dados e acesso ativo-ativo em vários clusters ONTAP em diferentes domínios de falha. O SMA usa grupos de consistência (CGS) para garantir a consistência da ordem de gravação entre um ou mais datastores e você pode criar vários CGS dependendo dos requisitos do aplicativo e do datastore. Os grupos de consistência são especialmente úteis para aplicativos que exigem sincronização de dados entre vários datastores. Por exemplo, LVMs convidadas distribuídas entre datastores. O SMA também suporta RDMs (Mapeamentos de dispositivo brutos) e armazenamento conetado a convidados com iniciadores iSCSI in-Guest. Você pode aprender mais sobre grupos de consistência em<block ref="8bba9b5b97dba092834d7a48a07f102d" category="inline-link-rx"></block>.</block>
  <block id="646b17235be3514942344039b13b0ef5" category="paragraph">Há alguma diferença no gerenciamento de uma configuração vmsc com a sincronização ativa do SnapMirror quando comparada a um MetroCluster. Primeiro, SMA é uma configuração somente SAN, nenhum datastores NFS pode ser protegido com a sincronização ativa do SnapMirror. Em segundo lugar, você deve mapear ambas as cópias dos LUNs para os hosts ESXi para que eles acessem os datastores replicados em ambos os domínios de falha. Terceiro, você deve criar um ou mais grupos de consistência para os datastores que deseja proteger com a sincronização ativa do SnapMirror. Finalmente, você deve criar uma política do SnapMirror para os grupos de consistência criados. Tudo isso pode ser feito facilmente usando o assistente "proteger cluster" no plug-in do vCenter Tools do ONTAP, ou usando manualmente a CLI do ONTAP ou o Gerenciador do sistema.</block>
  <block id="46a01589543ca9b2c28b281bc82d5190" category="section-title">Usando o plug-in do vCenter Tools do ONTAP para o SnapMirror ative Sync</block>
  <block id="8acd56e642eabaf4e2e00e987d06c0dd" category="paragraph">O plug-in do ONTAP Tools vCenter oferece uma maneira simples e intuitiva de configurar a sincronização ativa do SnapMirror para vmsc. Você pode usar o plug-in do vCenter Tools do ONTAP para criar e gerenciar relações de sincronização ativa do SnapMirror entre dois clusters do ONTAP. Este plugin fornece uma interface fácil de usar para estabelecer e gerenciar esses relacionamentos de forma eficiente. Você pode saber mais sobre o plugin do vCenter Tools do ONTAP em<block ref="238135431b1a2d25dda1f29146112b60" category="inline-link-rx"></block>, ou ir direto para<block ref="50b45f063e0080035a4876db2aa395bd" category="inline-link-rx"></block>o .</block>
  <block id="be0e7f3621283e77712fee8493cfe7c2" category="list-text">Clique em "OK".</block>
  <block id="1dddac6a529bf77c76b061ccea8bd130" category="list-text">As seguintes configurações adicionais do vSphere HA são recomendadas para vMSC com MetroCluster:</block>
  <block id="4b0d37b4c720a2f35c5ebf18456af4c4" category="paragraph">Adicionar uma configuração avançada chamada das.heartbeatDsPerHost pode aumentar o número de datastores de heartbeat. Use quatro datastores de heartbeat (HB DSS) - dois por local. Utilize a opção "Selecionar a partir da lista mas elogio". Isso é necessário porque, se um local falhar, você ainda precisará de dois DSS HB. No entanto, eles não precisam ser protegidos com a sincronização ativa do MetroCluster ou do SnapMirror.</block>
  <block id="261a4b114a90c38336a91406135768d4" category="list-text">Você pode criar um alarme baseado em eventos que é acionado quando uma máquina virtual viola uma regra de afinidade VM-Host. No vSphere Client, adicione um novo alarme para a máquina virtual e selecione "VM is violing VM-Host Affinity Rule" como gatilho de evento. Para obter mais informações sobre como criar e editar alarmes, <block ref="68398319bb6b2bfb9f64390479799795" category="inline-link-macro-rx"></block>consulte a documentação.</block>
  <block id="d34c2eaf11cfea5ea00aa0943b8fcfab" category="admonition">Esta documentação substitui relatórios técnicos publicados anteriormente _TR-4128: VSphere no NetApp MetroCluster_</block>
  <block id="2483a165b6002a92b0e076050cb48ea0" category="paragraph">A NetApp MetroCluster usa a função de HA (failover de controladora ou CFO) da NetApp para proteger contra falhas de controladora. Ele também inclui tecnologia SyncMirror local, failover de cluster em desastre (failover de cluster em desastre ou CFOD), redundância de hardware e separação geográfica para alcançar altos níveis de disponibilidade. O SyncMirror espelha de forma síncrona os dados entre as duas metades da configuração do MetroCluster gravando dados em dois plexos: O Plex local (na gaveta local) fornecendo dados ativamente e o Plex remoto (na gaveta remota) normalmente não fornecendo dados. A redundância de hardware é implementada para todos os componentes MetroCluster, como controladores, armazenamento, cabos, switches (usados com Fabric MetroCluster) e adaptadores.</block>
  <block id="4e7a787aaa9321ad4106d26a88e54252" category="paragraph">A sincronização ativa do NetApp SnapMirror, disponível em sistemas que não sejam MetroCluster e em sistemas ASA R2, oferece proteção granular do armazenamento de dados com protocolos FCP e SAN iSCSI. Ele permite que você proteja todo o vMSC ou proteja seletivamente cargas de trabalho de alta prioridade. Ele oferece acesso ativo-ativo a locais locais e remotos, ao contrário do NetApp MetroCluster, que é uma solução de espera ativa. A partir do ONTAP 9.15.1, o SnapMirror active Sync oferece suporte a uma funcionalidade ativo-ativo simétrica, permitindo operações de e/S de leitura e gravação de ambas as cópias de um LUN protegido com replicação síncrona bidirecional, permitindo que ambas as cópias do LUN atendam às operações de e/S localmente. Antes do ONTAP 9.15.1, a sincronização ativa do SnapMirror suporta apenas configurações ativas/ativas assimétricas, nas quais os dados no local secundário são proxy para a cópia primária de um LUN.</block>
  <block id="2462481c7f95cdbb29fa1b2e3a5263ca" category="paragraph">O vSphere Metro Storage Cluster (vMSC) é uma configuração certificada que protege máquinas virtuais (VMs) e contêineres contra falhas. Isso é conseguido usando conceitos de armazenamento estendidos juntamente com clusters de hosts ESXi, que são distribuídos em diferentes domínios de falha, como racks, edifícios, campi ou até mesmo cidades. As tecnologias de storage de sincronização ativa NetApp MetroCluster e SnapMirror são usadas para fornecer uma proteção sem objetivo de ponto de restauração (RPO igual a 0) aos clusters de host. A configuração do vMSC foi projetada para garantir que os dados estejam sempre disponíveis, mesmo que um "site" físico ou lógico completo falhe. Um dispositivo de armazenamento que faça parte da configuração do vMSC deve ser certificado após passar por um processo de certificação vMSC bem-sucedido. Todos os dispositivos de armazenamento suportados podem ser encontrados no<block ref="293ceee3268d7991d7fe245e02c1c5c9" category="inline-link-rx"></block>.</block>
  <block id="0e050612c89bbe89c4a1f2c79db93a7f" category="paragraph">O NetApp MetroCluster pode ser implantado em duas configurações diferentes para uso com o vSphere:</block>
  <block id="bb74c883034be56ad2c714b34888809d" category="image-alt">Diagrama vmsc com MetroCluster</block>
  <block id="2a36d659f1adb408dfdab4248eac6770" category="image-alt">Diagrama vmsc com MSAs e Mediador ONTAP</block>
  <block id="051b8072cddf34ff82fc627b5ef88b06" category="paragraph">Essas ferramentas fornecem proteção em todo o local para todo o ambiente de storage, garantindo que seus dados estejam sempre disponíveis. Quer você esteja usando servidores autônomos, clusters de servidores de alta disponibilidade, contêineres ou servidores virtualizados, a tecnologia NetApp mantém perfeitamente a disponibilidade do storage em caso de uma interrupção total devido à perda de energia, resfriamento ou conectividade de rede, desligamento do storage array ou erro operacional.</block>
  <block id="f027f8c94b36e501200aa21bd5b3643f" category="paragraph">Durante uma takeover, LIFs nas nas configurações do MetroCluster fazem failover automático. No entanto, os LIFs SAN não fazem failover; eles continuarão a usar o caminho direto para os LUNs (Logical Unit Numbers).</block>
  <block id="3b414f3b9c656fa9b5680e32bf9b7d2d" category="paragraph">Para obter mais informações sobre a aquisição de HA e a giveback, consulte o<block ref="5a72801b431f75b7489a0e7de50680bf" category="inline-link-rx"></block>. Vale a pena notar que essa funcionalidade não é específica para a sincronização ativa do MetroCluster ou do SnapMirror.</block>
  <block id="49c8d9bbd63bc0df306259c93fa4d364" category="paragraph">Com a sincronização ativa do SnapMirror, uma vez que ambas as cópias são usadas ativamente simultaneamente, seus hosts existentes continuarão operando. O Mediador ONTAP é necessário para garantir que o failover do site ocorra corretamente.</block>
  <block id="240e602413c054e65f7a1233278f5c39" category="doc">Cenários de falha para vMSC com MetroCluster</block>
  <block id="8c3100c726feafcb8f5c89188709b8da" category="paragraph">Nesse cenário, há uma falha de mais de dois discos ou de uma gaveta inteira. Os dados são fornecidos do Plex sobrevivente sem interrupção para os serviços de dados. A falha do disco pode afetar um Plex local ou remoto. Os agregados serão apresentados como modo degradado porque apenas um Plex está ativo. Depois que os discos com falha forem substituídos, os agregados afetados serão ressincronizados automaticamente para reconstruir os dados. Após a ressincronização, os agregados retornarão automaticamente ao modo espelhado normal. Se mais de dois discos dentro de um único grupo RAID falharem, o Plex terá de ser reconstruído.</block>
  <block id="e3010a7324dc76261135a69dad98bcf2" category="paragraph">Depois que os hosts ESXi forem particionados entre sites, o agente do vSphere HA verificará os batimentos cardíacos do datastore e, em cada site, os hosts ESXi locais poderão atualizar os batimentos cardíacos do datastore para o respetivo volume/LUN de leitura/gravação. Os hosts no local A assumirão que os outros hosts ESXi no local B falharam porque não há heartbeats de rede/datastore. O vSphere HA no local A tentará reiniciar as máquinas virtuais do local B, o que acabará falhará porque os datastores do local B não estarão acessíveis devido a falha do ISL de armazenamento. Uma situação semelhante é repetida no local B..</block>
  <block id="7ae222a2c832e4ce999571e88803083d" category="paragraph">Em um cenário de falha de um ou mais ISLs, o tráfego continua através dos links restantes. Se todos os ISLs em ambas as malhas falharem, de modo que não haja nenhum link entre os locais para armazenamento e replicação do NVRAM, cada controladora continuará fornecendo seus dados locais. Em um mínimo de um ISL é restaurado, a ressincronização de todos os plexos acontecerá automaticamente.</block>
  <block id="33cb67cb29131f1d0275317dce2cf236" category="paragraph">Em um cenário de falha de enlace de cluster com peered, como os ISLs de malha ainda estão ativos, os serviços de dados (leituras e gravações) continuam em ambos os locais para ambos os plexos. Qualquer alteração na configuração de cluster (por exemplo, adicionar um novo SVM, provisionar um volume ou LUN em um SVM existente) não pode ser propagado para o outro local. Estes são mantidos nos volumes de metadados locais do CRS e propagados automaticamente para o outro cluster após a recuperação do link do cluster peered. Se for necessário um switchover forçado antes que o link do cluster com peering possa ser restaurado, as alterações pendentes na configuração do cluster serão reproduzidas automaticamente da cópia replicada remota dos volumes de metadados no local que sobreviveu como parte do processo de switchover.</block>
  <block id="5cac5bfa9407e4851e57fffb3704c323" category="paragraph">A tecnologia de cluster da VMware agrupa os servidores ESXi em pools de recursos compartilhados para máquinas virtuais e fornece o vSphere High Availability (HA). O vSphere HA oferece alta disponibilidade e fácil de usar para aplicativos executados em máquinas virtuais. Quando o recurso HA está ativado no cluster, cada servidor ESXi mantém a comunicação com outros hosts para que, se qualquer host ESXi ficar sem resposta ou isolado, o cluster HA possa negociar a recuperação das máquinas virtuais que estavam sendo executadas nesse host ESXi entre os hosts sobreviventes no cluster. No caso de uma falha do sistema operacional convidado, o vSphere HA pode reiniciar a máquina virtual afetada no mesmo servidor físico. O vSphere HA possibilita reduzir o tempo de inatividade planejado, evitar tempo de inatividade não planejado e recuperar rapidamente de interrupções.</block>
  <block id="13756f2a610f8f2a9bfce56369289ce1" category="paragraph">É importante entender que o VMware vSphere não tem conhecimento da sincronização ativa do NetApp MetroCluster ou do SnapMirror e vê todos os hosts ESXi no cluster vSphere como hosts qualificados para operações de cluster de HA, dependendo das configurações de afinidade de host e grupo de VM.</block>
  <block id="cb6dde9af508c07c13495c7ceb17dabf" category="paragraph">A resposta de isolamento é uma configuração no vSphere HA que determina a ação acionada em máquinas virtuais quando um host em um cluster do vSphere HA perde suas conexões de rede de gerenciamento, mas continua sendo executado. Existem três opções para esta definição, "Disabled" (Desativado), "Shut Down and Restart VMs" (Desligar e reiniciar as VMs) e "Power Off and Restart VMs" (Desligar e reiniciar as VMs).</block>
  <block id="f3392184f9671e794187188ae9003393" category="paragraph">"Desligar" é melhor do que "Desligar", que não libera as alterações mais recentes em transações de disco ou commit. Se as máquinas virtuais não desligarem em 300 segundos, elas serão desligadas. Para alterar o tempo de espera, use a opção avançada das.isolationshutdowntimeout.</block>
  <block id="5cda3e7fc012f3f66cb81b04173c232e" category="paragraph">A NetApp recomenda definir a "resposta de isolamento do host" como Desativado.</block>
  <block id="d32f0f71e4c6ada2841e017ad5b25fab" category="paragraph">A NetApp recomenda definir a "resposta para datastore com PDL" para "*Desligar e reiniciar VMs*". Quando essa condição é detetada, uma VM será reinicializada instantaneamente em um host saudável dentro do cluster do vSphere HA.</block>
  <block id="990ae835e5ddcf593414be2262bdace1" category="list-text">O NetApp recomenda configurar a "resposta para datastore com APD" para "*Desligar e reiniciar VMs (conservative)*".</block>
  <block id="ed239ad833fcd059d909a3b5c5ef32f0" category="list-text">Se o status do APD for resolvido e o acesso ao armazenamento for restaurado antes que o tempo limite tenha passado, o HA não reiniciará desnecessariamente a máquina virtual, a menos que você a configure explicitamente para fazê-lo. Se uma resposta for desejada, mesmo quando o ambiente foi recuperado da condição APD, então Response for APD Recovery After APD Timeout deve ser configurado para Reset VMs.</block>
  <block id="2f567a5b33a98cbc762cbf67a7d2a620" category="section-title">Implementação do VMware DRS para o NetApp SnapMirror ative Sync</block>
  <block id="c55b2a3b93f65c4f9532694d5e8ffba3" category="paragraph">O VMware DRS é um recurso que agrega os recursos de host em um cluster e é usado principalmente para o balanceamento de carga em um cluster em uma infraestrutura virtual. O VMware DRS calcula principalmente os recursos de CPU e memória para realizar o balanceamento de carga em um cluster. Como o vSphere não tem conhecimento do clustering estendido, ele considera todos os hosts em ambos os locais quando o balanceamento de carga.</block>
  <block id="7753c40d9b983d2079b72842e3406960" category="paragraph">A NetApp recomenda a implementação de regras "devem" em vez de regras "obrigatórias" porque elas são violadas pelo vSphere HA em caso de falha. O uso de regras "obrigatórias" pode potencialmente levar a interrupções de serviço.</block>
  <block id="e3537ea3aae3c4341dab60d15af5afd0" category="paragraph">A disponibilidade dos serviços deve sempre prevalecer sobre o desempenho. No cenário em que um data center completo falha, as regras "must" devem escolher hosts do grupo de afinidade de host da VM e, quando o data center não estiver disponível, as máquinas virtuais não serão reiniciadas.</block>
  <block id="b88201736c7c63fe1df854d89bf2427f" category="sidebar">Por que ONTAP para VMware</block>
  <block id="4d68c6910c7e5b8e5f736a0a37eba4e6" category="paragraph">O ONTAP tem sido uma solução de armazenamento líder para o VMware vSphere e, mais recentemente, para o Cloud Foundation, desde que o ESX foi introduzido em datacenters modernos há mais de duas décadas.  A NetApp continua a introduzir sistemas inovadores, como a última geração da série ASA A, juntamente com recursos como a sincronização ativa SnapMirror .  Esses avanços simplificam o gerenciamento, aumentam a resiliência e reduzem o custo total de propriedade (TCO) da sua infraestrutura de TI.</block>
  <block id="d51eebcc193505dec7ec133bd17d0702" category="paragraph">Este documento apresenta a solução ONTAP para VMware Live Site Recovery (VLSR), anteriormente conhecido como Site Recovery Manager (SRM), o software de recuperação de desastres (DR) líder do setor da VMware, incluindo as informações mais recentes sobre o produto e as melhores práticas para otimizar a implantação, reduzir riscos e simplificar o gerenciamento contínuo.</block>
  <block id="3f17c15e23b90a1416deb27191a1348e" category="admonition">Esta documentação substitui o relatório técnico publicado anteriormente _TR-4900: VMware Site Recovery Manager com ONTAP_</block>
  <block id="2c958a4052929ded88125b8785727f4a" category="paragraph">As plataformas de gerenciamento de dados da NetApp com tecnologia ONTAP são algumas das soluções de armazenamento mais amplamente adotadas para VLSR.  Os motivos são muitos: uma plataforma de gerenciamento de dados segura, de alto desempenho e com protocolo unificado (NAS e SAN juntos) que fornece eficiência de armazenamento que define o setor, multilocação, controles de qualidade de serviço, proteção de dados com instantâneos com eficiência de espaço e replicação com SnapMirror.  Tudo isso aproveitando a integração nativa de multi-nuvem híbrida para a proteção de cargas de trabalho do VMware e uma infinidade de ferramentas de automação e orquestração ao seu alcance.</block>
  <block id="5b2c42c877c0360cfec4222fd847686f" category="paragraph">Ao usar o SnapMirror para replicação baseada em array, você aproveita uma das tecnologias mais comprovadas e maduras do ONTAP.  O SnapMirror oferece a vantagem de transferências de dados seguras e altamente eficientes, copiando apenas blocos alterados do sistema de arquivos, não VMs ou armazenamentos de dados inteiros.  Mesmo esses blocos aproveitam a economia de espaço, como desduplicação, compactação e compactação.  Os sistemas ONTAP modernos agora usam o SnapMirror independente de versão, permitindo flexibilidade na seleção de seus clusters de origem e destino.  O SnapMirror realmente se tornou uma das ferramentas mais poderosas disponíveis para recuperação de desastres.</block>
  <block id="e6e16bd7b0eb9a9b6d1b84b252dfef52" category="paragraph">Não importa se você usa armazenamentos de dados tradicionais NFS, iSCSI ou Fibre Channel (agora com suporte para armazenamentos de dados vVols ), o VLSR fornece uma oferta primária robusta que aproveita o melhor dos recursos do ONTAP para recuperação de desastres ou planejamento e orquestração de migração de datacenter.</block>
  <block id="34ae253d12dacf4256947aab08d2797a" category="paragraph">Depois de instalar e configurar os adaptadores SRA no servidor VLSR para proteger armazenamentos de dados não vVols, você pode começar a tarefa de configurar seu ambiente vSphere para recuperação de desastres.</block>
  <block id="aa1408f10ab599451ceb8278538aceb3" category="paragraph">A VLSR pode testar seu plano de DR sem interrupções usando a tecnologia FlexClone proprietária da NetApp para fazer clones quase instantâneos de seus armazenamentos de dados protegidos em seu site de DR.  O VLSR cria um sandbox para testes seguros, para que sua organização e seus clientes estejam protegidos em caso de um desastre real, dando a você confiança na capacidade de sua organização de executar um failover durante um desastre.</block>
  <block id="761230ac1da327ae663fa55be5b71899" category="paragraph">A integração da sua implantação de VLSR com os recursos avançados de gerenciamento de dados do ONTAP permite escala e desempenho significativamente melhores quando comparado com opções de armazenamento local.  Mas mais do que isso, ele traz a flexibilidade da nuvem híbrida.  A nuvem híbrida permite que você economize dinheiro ao hierarquizar blocos de dados não utilizados do seu array de alto desempenho para o seu hiperescalador preferido usando o FabricPool, que pode ser um armazenamento S3 local, como o NetApp StorageGRID.  Você também pode usar o SnapMirror para sistemas baseados em edge com ONTAP Select definido por software ou DR baseado em nuvem usando Cloud Volumes ONTAP (CVO) ou<block ref="c7af35041041143315810379f153ee16" category="inline-link-rx"></block> , ou outros serviços ONTAP hospedados.</block>
  <block id="4a3ecc4c037b88a5dd4a78c48aa300b8" category="cell">vSphere 7.0 a 8.0, definido como 128.  Esta configuração é ignorada nas versões do ESXi posteriores à 8.0.</block>
  <block id="4ca458329416c6834c4fcde7d851a203" category="list-text">Ao usar sistemas não ASA em ambientes de alto desempenho ou ao testar o desempenho com um único armazenamento de dados LUN, considere alterar a configuração de balanceamento de carga da política de seleção de caminho (PSP) round-robin (VMW_PSP_RR) da configuração IOPS padrão de 1000 para um valor de 1.  Ver<block ref="1687988694c35db61b845d7b15620672" category="inline-link-macro-rx"></block> para mais informações.</block>
  <block id="b236a2de8d4b9a7647b4e38da0f41f0f" category="list-text">No vSphere 6.7 Update 1, a VMware introduziu um novo mecanismo de balanceamento de carga de latência para o Round Robin PSP.  A opção de latência agora também está disponível ao usar o HPP (High Performance Plugin) com namespaces NVMe e com vSphere 8.0u2 e posteriores, LUNs conectados por iSCSI e FCP.  A nova opção considera a largura de banda de E/S e a latência do caminho ao selecionar o caminho ideal para E/S.  A NetApp recomenda usar a opção de latência em ambientes com conectividade de caminho não equivalente, como casos com mais saltos de rede em um caminho do que em outro, ou ao usar um sistema NetApp ASA .  Ver<block ref="d244127cef9364538ba1012ad8871adc" category="inline-link-rx"></block> para maiores informações.</block>
  <block id="8c243b1b00784482e5851745cf6cbb46" category="paragraph">Os clientes selecionam com confiança o ONTAP para vSphere para soluções de armazenamento SAN e NAS.  A nova arquitetura simplificada de armazenamento desagregado, presente nos mais recentes All SAN Arrays, proporciona uma experiência simplificada e familiar aos administradores de armazenamento SAN, mantendo a maioria das integrações e o conjunto de recursos dos sistemas ONTAP tradicionais.  Os sistemas ONTAP fornecem proteção excepcional de instantâneos e ferramentas de gerenciamento robustas.  Ao transferir funções para armazenamento dedicado, o ONTAP maximiza os recursos do host, reduz custos e mantém o desempenho ideal.  Além disso, as cargas de trabalho podem ser facilmente migradas usando o Storage vMotion entre VMFS, NFS ou vVols.</block>
  <block id="90d5572babcb90a9380df46334d2e1e8" category="paragraph">Usar o ONTAP junto com o vSphere é uma ótima combinação que permite reduzir despesas com hardware de host e software VMware.  Você também pode proteger seus dados a um custo menor com alto desempenho consistente.  Como as cargas de trabalho virtualizadas são móveis, você pode explorar diferentes abordagens usando o Storage vMotion para mover VMs entre datastores VMFS, NFS ou vVols , tudo no mesmo sistema de armazenamento.</block>
  <block id="e74fa8c8fcfd6e51d8817a758d558fc7" category="paragraph">Aqui estão os principais fatores que os clientes valorizam hoje:</block>
  <block id="bf6e1db9bc182aafee86baa8047fa767" category="list-text">*Armazenamento unificado.*  Os sistemas que executam o ONTAP são unificados de várias maneiras significativas.  Originalmente, essa abordagem se referia aos protocolos NAS e SAN, e o ONTAP continua sendo uma plataforma líder para SAN, juntamente com sua força original no NAS.  No mundo do vSphere, essa abordagem também pode significar um sistema unificado para infraestrutura de desktop virtual (VDI) junto com infraestrutura de servidor virtual (VSI).  Os sistemas que executam ONTAP geralmente são mais baratos para VSI do que os arrays empresariais tradicionais e ainda têm recursos avançados de eficiência de armazenamento para lidar com VDI no mesmo sistema.  O ONTAP também unifica uma variedade de mídias de armazenamento, de SSDs a SATA, e pode estendê-las facilmente para a nuvem.  Não há necessidade de comprar um sistema operacional de armazenamento para desempenho, outro para arquivos e ainda outro para a nuvem.  ONTAP une todos eles.</block>
  <block id="2afba2255c7be3f11ffd2cc4f8b80e6f" category="list-text">*Gerenciamento baseado em políticas de armazenamento e volumes virtuais.*  A NetApp foi uma das primeiras parceiras de design da VMware no desenvolvimento do vSphere Virtual Volumes (vVols), fornecendo informações arquitetônicas e suporte inicial para vVols e VMware vSphere APIs for Storage Awareness (VASA).  Essa abordagem não apenas trouxe gerenciamento granular de armazenamento de VM para o VMFS, como também ofereceu suporte à automação do provisionamento de armazenamento por meio do gerenciamento baseado em políticas de armazenamento.  Essa abordagem permite que arquitetos de armazenamento projetem pools de armazenamento com diferentes recursos que podem ser facilmente consumidos por administradores de VM.  ONTAP lidera o setor de armazenamento em escala de vVol, dando suporte a centenas de milhares de vVols em um único cluster, enquanto fornecedores de matrizes corporativas e matrizes flash menores dão suporte a apenas alguns milhares de vVols por matriz.  A NetApp também está impulsionando a evolução do gerenciamento granular de VMs com recursos futuros.</block>
  <block id="6876f82e64fd9d6a64f99665e3913906" category="list-text">*Eficiência de armazenamento.*  Embora a NetApp tenha sido a primeira a oferecer desduplicação para cargas de trabalho de produção, essa inovação não foi a primeira nem a última nessa área.  Tudo começou com snapshots, um mecanismo de proteção de dados com eficiência de espaço e sem impacto no desempenho, juntamente com a tecnologia FlexClone para fazer instantaneamente cópias de leitura/gravação de VMs para uso em produção e backup.  A NetApp passou a fornecer recursos em linha, incluindo desduplicação, compactação e desduplicação de bloco zero, para extrair o máximo de armazenamento de SSDs caros.  O ONTAP também adicionou a capacidade de compactar operações de E/S e arquivos menores em um bloco de disco usando compactação.  A combinação desses recursos fez com que os clientes geralmente observassem economias de até 5:1 para VSI e até 30:1 para VDI.  A mais nova geração de sistemas ONTAP também inclui compactação e desduplicação aceleradas por hardware, o que pode melhorar ainda mais a eficiência do armazenamento e reduzir custos.  Essa abordagem permite que você armazene mais dados em menos espaço, reduzindo o custo geral de armazenamento e melhorando o desempenho.  A NetApp está tão confiante em seus recursos de eficiência de armazenamento que oferece um link: https://www.netapp.com/pdf.html?item=/media/79014-ng-937-Efficiency-Guarantee-Customer-Flyer.pdf [Garantia de Eficiência^].</block>
  <block id="a54f2a3da40d66f7a06b1a0b6fdfa9a8" category="list-text">*Multilocação.*  O ONTAP é líder em multilocação há muito tempo, permitindo que você crie várias máquinas virtuais de armazenamento (SVMs) em um único cluster.  Essa abordagem permite isolar cargas de trabalho e fornecer diferentes níveis de serviço para diferentes locatários, tornando-a ideal para provedores de serviços e grandes empresas.  A última geração de sistemas ONTAP também inclui suporte para gerenciamento de capacidade de locatários.  Esse recurso permite que você defina limites de capacidade para cada locatário, garantindo que nenhum locatário possa consumir todos os recursos disponíveis.  Essa abordagem ajuda a garantir que todos os inquilinos recebam o nível de serviço esperado, ao mesmo tempo em que proporciona um alto nível de segurança e isolamento entre eles.  Além disso, os recursos de multilocação do ONTAP são integrados à plataforma vSphere da VMware, permitindo que você gerencie e monitore facilmente seu ambiente virtualizado por meio de<block ref="238135431b1a2d25dda1f29146112b60" category="inline-link-rx"></block> e<block ref="409cf7667ac8df435e8d9883234935b9" category="inline-link-rx"></block> .</block>
  <block id="2a2939154778c60691f9f31e86248f82" category="list-text">*Nuvem híbrida.*  Seja usado para nuvem privada local, infraestrutura de nuvem pública ou uma nuvem híbrida que combina o melhor de ambas, as soluções ONTAP ajudam você a construir sua estrutura de dados para simplificar e otimizar o gerenciamento de dados.  Comece com sistemas all-flash de alto desempenho e, em seguida, combine-os com sistemas de armazenamento em disco ou em nuvem para proteção de dados e computação em nuvem.  Escolha entre Azure, AWS, IBM ou Google Cloud para otimizar custos e evitar aprisionamento. Aproveite o suporte avançado para OpenStack e tecnologias de contêiner conforme necessário.  A NetApp também oferece backup baseado em nuvem (SnapMirror Cloud, Cloud Backup Service e Cloud Sync) e ferramentas de arquivamento e níveis de armazenamento (FabricPool) para ONTAP para ajudar a reduzir despesas operacionais e aproveitar o amplo alcance da nuvem.</block>
</blocks>